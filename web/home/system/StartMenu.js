Ext.ux.StartMenu=Ext.extend(Ext.menu.Menu,{height:300,toolPanelWidth:100,width:"auto",initComponent:function(A){delete this.width;Ext.ux.StartMenu.superclass.initComponent.call(this,A);var B=this.toolItems;this.toolItems=new Ext.util.MixedCollection();if(B){this.addTool.apply(this,B);}},onRender:function(G,F){Ext.ux.StartMenu.superclass.onRender.call(this,G,F);var A=this.el.addClass("ux-start-menu");var E=A.createChild({tag:"div"});E.setStyle("padding","7px 0 0 0");this.header=E;var N=E.wrap({cls:"ux-start-menu-tl"});var J=E.wrap({cls:"ux-start-menu-tr"});var C=E.wrap({cls:"ux-start-menu-tc"});this.menuBWrap=A.createChild({tag:"div",cls:"ux-start-menu-body x-border-layout-ct ux-start-menu-body"});var D=this.menuBWrap.wrap({cls:"ux-start-menu-ml"});var K=this.menuBWrap.wrap({cls:"ux-start-menu-mc ux-start-menu-bwrap"});this.menuPanel=this.menuBWrap.createChild({tag:"div",cls:"x-panel x-border-panel ux-start-menu-apps-panel opaque"});this.toolsPanel=this.menuBWrap.createChild({tag:"div",cls:"x-panel x-border-panel ux-start-menu-tools-panel"});var I=D.wrap({cls:"x-window-bwrap"});var H=I.createChild({tag:"div",cls:"ux-start-menu-bc"});var B=H.wrap({cls:"ux-start-menu-bl x-panel-nofooter"});var M=H.wrap({cls:"ux-start-menu-br"});H.setStyle({height:"0px",padding:"0 0 6px 0"});this.keyNav=new Ext.menu.MenuNav(this);if(this.plain){A.addClass("x-menu-plain");}if(this.cls){A.addClass(this.cls);}this.focusEl=A.createChild({tag:"a",cls:"x-menu-focus",href:"#",onclick:"return false;",tabIndex:"-1"});this.ul.appendTo(this.menuPanel);var L=this.toolsPanel.createChild({tag:"ul",cls:"x-menu-list"});this.mon(L,"click",this.onClick,this);this.mon(L,"mouseover",this.onMouseOver,this);this.mon(L,"mouseout",this.onMouseOut,this);this.items.each(function(O){O.parentMenu=this;},this);this.toolItems.each(function(P){var O=document.createElement("li");O.className="x-menu-list-item";L.dom.appendChild(O);P.render(O);P.parentMenu=this;},this);this.toolsUl=L;this.menuBWrap.setStyle("position","relative");this.menuBWrap.setHeight(this.height-12);this.menuPanel.setStyle({padding:"2px",position:"absolute",overflow:"auto"});this.toolsPanel.setStyle({padding:"2px 4px 2px 2px",position:"absolute",overflow:"auto"});this.setTitle(this.title);},findTargetItem:function(B){var A=B.getTarget(".x-menu-list-item",this.ul,true);if(A&&A.menuItemId){if(this.items.get(A.menuItemId)){return this.items.get(A.menuItemId);}else{return this.toolItems.get(A.menuItemId);}}return null;},show:function(C,G,B){this.parentMenu=B;if(!this.el){this.render();}this.fireEvent("beforeshow",this);this.showAt(this.el.getAlignToXY(C,G||this.defaultAlign),B,false);var E=this.toolPanelWidth;var F=this.menuPanel.getWidth()+2;if(Ext.isIE&&F>768){F=200;if(this.items.length>0){F-=100;var A=Ext.util.TextMetrics.createInstance(this.items.get(0).el);this.items.each(function(I){var H=A.getWidth(I.text);if(H>F){F=H;}});F+=100;this.width=F+E+6;this.setWidth(this.width);}}this.menuPanel.setWidth(F);this.menuBWrap.setWidth(F+E);var D=this.menuBWrap.getBox();this.menuPanel.setHeight(D.height);this.toolsPanel.setWidth(E);this.toolsPanel.setX(D.x+D.width-E);this.toolsPanel.setHeight(D.height);},addTool:function(){var B=arguments,A=B.length,E;for(var C=0;C<A;C++){var D=B[C];if(D.render){E=this.addToolItem(D);}else{if(typeof D=="string"){if(D=="separator"||D=="-"){E=this.addToolSeparator();}else{E=this.addText(D);}}else{if(D.tagName||D.el){E=this.addElement(D);}else{if(typeof D=="object"){E=this.addToolMenuItem(D);}}}}}return E;},addToolSeparator:function(){return this.addToolItem(new Ext.menu.Separator({itemCls:"ux-toolmenu-sep"}));},addToolItem:function(B){this.toolItems.add(B);if(this.toolsUl){var A=document.createElement("li");A.className="x-menu-list-item";this.toolsUl.dom.appendChild(A);B.render(A,this);this.delayAutoWidth();}return B;},addToolMenuItem:function(A){if(!(A instanceof Ext.menu.Item)){if(typeof A.checked=="boolean"){A=new Ext.menu.CheckItem(A);}else{A=new Ext.menu.Item(A);}}return this.addToolItem(A);},setTitle:function(B,A){this.title=B;if(this.header.child("span")){this.header.child("span").update(B);}return this;},getToolButton:function(A){var B=new Ext.Button({handler:A.handler,minWidth:this.toolPanelWidth-10,scope:A.scope,text:A.text});return B;}});Ext.ux.StartMenuApplication=function(A){A&&Ext.apply(this,A);};Ext.ux.StartMenuApplication.prototype={window:null,windowConfig:false,showWindow:true,singleMode:true,init:function(G){if(this.singleMode&&G.desktop.getWindow(G.windowId)){return ;}var B;if(G.isIFrame=="true"){B=new Ext.ux.IFrameComponent({id:G.windowId,url:G.url});}else{B=this.main(G);}var F=G.desktop.getViewWidth();var A=G.desktop.getViewHeight();function E(I,H){if(I==0){return H;}return I<1?H*I:I;}function D(J,H,I){if(J==-1){return(H-I)/2;}if(J<0){J*=-1;}if(J<1&&J>0){return H*J;}return J;}G.winWidth=E(+G.winWidth,F);G.winHeight=E(+G.winHeight,A);Ext.isMultiScreen&&(G.winWidth/=2);var C={id:G.windowId,title:G.text||G.tooltip,layout:"fit",items:B||{},icon:G.icon||G.windowIcon,shim:true,animCollapse:false,constrainHeader:true,minimizable:true,maximizable:true,width:G.winWidth,height:G.winHeight,x:D(+G.x,F,G.winWidth),y:D(+G.y,A,G.winHeight)};this.windowConfig&&Ext.apply(C,this.windowConfig);this.window=G.desktop.createWindow(C);if(this.showWindow){this.window.show();}},main:function(A){}};