var mxClient={VERSION:"1.4.0.6",IS_IE:navigator.userAgent.indexOf("MSIE")>=0,IS_IE6:navigator.userAgent.indexOf("MSIE 6")>=0,IS_NS:navigator.userAgent.indexOf("Mozilla/")>=0&&navigator.userAgent.indexOf("MSIE")<0,IS_OP:navigator.userAgent.indexOf("Opera/")>=0,IS_OT:navigator.userAgent.indexOf("Presto/2.4")<0&&navigator.userAgent.indexOf("Presto/2.3")<0&&navigator.userAgent.indexOf("Presto/2.2")<0&&navigator.userAgent.indexOf("Presto/2.1")<0&&navigator.userAgent.indexOf("Presto/2.0")<0&&navigator.userAgent.indexOf("Presto/1")<0,IS_SF:navigator.userAgent.indexOf("AppleWebKit/")>=0&&navigator.userAgent.indexOf("Chrome/")<0,IS_GC:navigator.userAgent.indexOf("Chrome/")>=0,IS_MT:(navigator.userAgent.indexOf("Firefox/")>=0&&navigator.userAgent.indexOf("Firefox/1")<0&&navigator.userAgent.indexOf("Firefox/2")<0)||(navigator.userAgent.indexOf("Iceweasel/")>=0&&navigator.userAgent.indexOf("Iceweasel/1")<0&&navigator.userAgent.indexOf("Iceweasel/2")<0)||(navigator.userAgent.indexOf("SeaMonkey/")>=0&&navigator.userAgent.indexOf("SeaMonkey/1")<0)||(navigator.userAgent.indexOf("Iceape/")>=0&&navigator.userAgent.indexOf("Iceape/1")<0),IS_SVG:navigator.userAgent.indexOf("Firefox/")>=0||navigator.userAgent.indexOf("Iceweasel/")>=0||navigator.userAgent.indexOf("Seamonkey/")>=0||navigator.userAgent.indexOf("Iceape/")>=0||navigator.userAgent.indexOf("Galeon/")>=0||navigator.userAgent.indexOf("Epiphany/")>=0||navigator.userAgent.indexOf("AppleWebKit/")>=0||navigator.userAgent.indexOf("Gecko/")>=0||navigator.userAgent.indexOf("Opera/")>=0,NO_FO:navigator.userAgent.indexOf("Firefox/1")>=0||navigator.userAgent.indexOf("Iceweasel/1")>=0||navigator.userAgent.indexOf("Firefox/2")>=0||navigator.userAgent.indexOf("Iceweasel/2")>=0||navigator.userAgent.indexOf("SeaMonkey/1")>=0||navigator.userAgent.indexOf("Iceape/1")>=0||navigator.userAgent.indexOf("Camino/1")>=0||navigator.userAgent.indexOf("Epiphany/2")>=0||navigator.userAgent.indexOf("Opera/")>=0||navigator.userAgent.indexOf("Mozilla/2")>=0,IS_VML:navigator.appName.toUpperCase()=="MICROSOFT INTERNET EXPLORER",IS_MAC:navigator.userAgent.toUpperCase().indexOf("MACINTOSH")>0,IS_TOUCH:navigator.userAgent.toUpperCase().indexOf("IPAD")>0,IS_LOCAL:document.location.href.indexOf("http://")<0&&document.location.href.indexOf("https://")<0,WINDOW_SHADOWS:true,TOOLTIP_SHADOWS:true,MENU_SHADOWS:true,isBrowserSupported:function(){return false||true;},link:function(A,B,E){E=E||document;if(false){E.write('<link rel="'+A+'" href="'+B+'" charset="ISO-8859-1" type="text/css"/>');}else{var D=E.createElement("link");D.setAttribute("rel",A);D.setAttribute("href",B);D.setAttribute("charset","ISO-8859-1");D.setAttribute("type","text/css");var C=E.getElementsByTagName("head")[0];C.appendChild(D);}},include:function(A){document.write('<script src="'+A+'"><\/script>');},unload:function(){mxEvent.release(document.documentElement);mxEvent.release(window);}};mxBasePath="/dev/workflow/";if(typeof (mxBasePath)!="undefined"&&mxBasePath.length>0){if(mxBasePath.substring(mxBasePath.length-1)=="/"){mxBasePath=mxBasePath.substring(0,mxBasePath.length-1);}mxClient.basePath=mxBasePath;}else{mxClient.basePath=".";}if(typeof (mxImageBasePath)!="undefined"&&mxImageBasePath.length>0){if(mxImageBasePath.substring(mxImageBasePath.length-1)=="/"){mxImageBasePath=mxImageBasePath.substring(0,mxImageBasePath.length-1);}mxClient.imageBasePath=mxImageBasePath;}else{mxClient.imageBasePath=mxClient.basePath+"/images";}if(typeof (mxLanguage)!="undefined"){mxClient.language=mxLanguage;}else{mxClient.language=(false)?navigator.userLanguage:navigator.language;var dash=mxClient.language.indexOf("-");if(dash>0){mxClient.language=mxClient.language.substring(0,dash);}}mxClient.link("stylesheet",mxClient.basePath+"/css/common.css");if(false){document.namespaces.add("v","urn:schemas-microsoft-com:vml");document.namespaces.add("o","urn:schemas-microsoft-com:office:office");mxClient.link("stylesheet",mxClient.basePath+"/css/explorer.css");}var mxLog={consoleResource:(mxClient.language!="none")?"console":"",TRACE:false,DEBUG:true,WARN:true,buffer:"",init:function(){if(mxLog.window==null&&document.body!=null){var G=(mxResources.get(mxLog.consoleResource)||mxLog.consoleResource)+" - mxGraph "+mxClient.VERSION;var I=document.createElement("table");I.setAttribute("width","100%");I.setAttribute("height","100%");var D=document.createElement("tbody");var F=document.createElement("tr");var B=document.createElement("td");B.style.verticalAlign="top";mxLog.textarea=document.createElement("textarea");mxLog.textarea.setAttribute("readOnly","true");mxLog.textarea.style.width="100%";mxLog.textarea.style.height="100%";mxLog.textarea.value=mxLog.buffer;B.appendChild(mxLog.textarea);F.appendChild(B);D.appendChild(F);F=document.createElement("tr");mxLog.td=document.createElement("td");mxLog.td.style.verticalAlign="top";mxLog.td.setAttribute("height","30px");F.appendChild(mxLog.td);D.appendChild(F);I.appendChild(D);mxLog.addButton("Info",function(J){mxLog.info();});mxLog.addButton("DOM",function(J){var K=mxUtils.getInnerHtml(document.body);mxLog.debug(K);});mxLog.addButton("Trace",function(J){mxLog.TRACE=!mxLog.TRACE;if(mxLog.TRACE){mxLog.debug("Tracing enabled");}else{mxLog.debug("Tracing disabled");}});mxLog.addButton("Copy",function(J){try{mxUtils.copy(mxLog.textarea.value);}catch(K){mxUtils.alert(K);}});mxLog.addButton("Show",function(J){try{mxUtils.popup(mxLog.textarea.value);}catch(K){mxUtils.alert(K);}});mxLog.addButton("Clear",function(J){mxLog.textarea.value="";});var H=document.body.clientWidth;var E=(document.body.clientHeight||document.documentElement.clientHeight);mxLog.window=new mxWindow(G,I,H-320,E-210,300,160);mxLog.window.setMaximizable(true);mxLog.window.setScrollable(true);mxLog.window.setResizable(true);mxLog.window.setClosable(true);mxLog.window.destroyOnClose=false;if(true&&document.compatMode!="BackCompat"){var A=function(L,J){var K=mxLog.window.getElement();mxLog.textarea.style.height=(K.offsetHeight-78)+"px";};mxLog.window.addListener(mxEvent.RESIZE_END,A);mxLog.window.addListener(mxEvent.MAXIMIZE,A);mxLog.window.addListener(mxEvent.NORMALIZE,A);var C=mxLog.window.getElement();mxLog.textarea.style.height="96px";}}},info:function(){mxLog.writeln(mxUtils.toString(navigator));},addButton:function(C,A){var B=document.createElement("button");mxUtils.write(B,C);mxEvent.addListener(B,"click",A);mxLog.td.appendChild(B);},isVisible:function(){if(mxLog.window!=null){return mxLog.window.isVisible();}return false;},show:function(){mxLog.setVisible(true);},setVisible:function(A){if(mxLog.window==null){mxLog.init();}if(mxLog.window!=null){mxLog.window.setVisible(A);}},enter:function(A){if(mxLog.TRACE){mxLog.writeln("Entering "+A);return new Date().getTime();}},leave:function(A,C){if(mxLog.TRACE){var B=(C!=0)?" ("+(new Date().getTime()-C)+" ms)":"";mxLog.writeln("Leaving "+A+B);}},debug:function(){if(mxLog.DEBUG){mxLog.writeln.apply(this,arguments);}},warn:function(){if(mxLog.WARN){mxLog.writeln.apply(this,arguments);}},write:function(){var A="";for(var B=0;B<arguments.length;B++){A+=arguments[B];if(B<arguments.length-1){A+=" ";}}if(mxLog.textarea!=null){mxLog.textarea.value=mxLog.textarea.value+A;if(navigator.userAgent.indexOf("Presto/2.5")>=0){mxLog.textarea.style.visibility="hidden";mxLog.textarea.style.visibility="visible";}mxLog.textarea.scrollTop=mxLog.textarea.scrollHeight;}else{mxLog.buffer+=A;}},writeln:function(){var A="";for(var B=0;B<arguments.length;B++){A+=arguments[B];if(B<arguments.length-1){A+=" ";}}mxLog.write(A+"\n");}};var mxObjectIdentity={FIELD_NAME:"mxObjectId",counter:0,get:function(B){if(typeof (B)=="object"&&B[mxObjectIdentity.FIELD_NAME]==null){var A=mxUtils.getFunctionName(B.constructor);B[mxObjectIdentity.FIELD_NAME]=A+"#"+mxObjectIdentity.counter++;}return B[mxObjectIdentity.FIELD_NAME];},clear:function(A){if(typeof (A)=="object"){delete A[mxObjectIdentity.FIELD_NAME];}}};function mxDictionary(){this.clear();}mxDictionary.prototype.map=null;mxDictionary.prototype.clear=function(){this.map={};};mxDictionary.prototype.get=function(A){var B=mxObjectIdentity.get(A);return this.map[B];};mxDictionary.prototype.put=function(A,C){var D=mxObjectIdentity.get(A);var B=this.map[D];this.map[D]=C;return B;};mxDictionary.prototype.remove=function(A){var C=mxObjectIdentity.get(A);var B=this.map[C];delete this.map[C];return B;};mxDictionary.prototype.getKeys=function(){var A=[];for(key in this.map){A.push(key);}return A;};mxDictionary.prototype.getValues=function(){var A=[];for(key in this.map){A.push(this.map[key]);}return A;};mxDictionary.prototype.visit=function(A){for(key in this.map){A(key,this.map[key]);}};var mxResources={resources:[],add:function(D,A){A=(A!=null)?A:mxClient.language;if(A!=mxConstants.NONE){try{var B=mxUtils.load(D+".properties");if(B.isReady()){mxResources.parse(B.getText());}}catch(C){}try{var B=mxUtils.load(D+"_"+A+".properties");if(B.isReady()){mxResources.parse(B.getText());}}catch(C){}}},parse:function(G){if(G!=null){var B=G.split("\n");for(var E=0;E<B.length;E++){var C=B[E].indexOf("=");if(C>0){var D=B[E].substring(0,C);var A=B[E].length;if(B[E].charCodeAt(A-1)==13){A--;}var F=B[E].substring(C+1,A);mxResources.resources[D]=unescape(F);}}}},get:function(E,G,B){var F=mxResources.resources[E];if(F==null){F=B;}if(F!=null&&G!=null){var A=[];var C=null;for(var D=0;D<F.length;D++){var H=F.charAt(D);if(H=="{"){C="";}else{if(C!=null&&H=="}"){C=parseInt(C)-1;if(C>=0&&C<G.length){A.push(G[C]);}C=null;}else{if(C!=null){C+=H;}else{A.push(H);}}}}F=A.join("");}return F;}};function mxPoint(A,B){this.x=(A!=null)?A:0;this.y=(B!=null)?B:0;}mxPoint.prototype.x=null;mxPoint.prototype.y=null;mxPoint.prototype.equals=function(A){return A.x==this.x&&A.y==this.y;};mxPoint.prototype.clone=function(){return mxUtils.clone(this);};function mxRectangle(B,D,C,A){mxPoint.call(this,B,D);this.width=(C!=null)?C:0;this.height=(A!=null)?A:0;}mxRectangle.prototype=new mxPoint();mxRectangle.prototype.constructor=mxRectangle;mxRectangle.prototype.width=null;mxRectangle.prototype.height=null;mxRectangle.prototype.getCenterX=function(){return this.x+this.width/2;};mxRectangle.prototype.getCenterY=function(){return this.y+this.height/2;};mxRectangle.prototype.add=function(B){if(B!=null){var A=Math.min(this.x,B.x);var E=Math.min(this.y,B.y);var D=Math.max(this.x+this.width,B.x+B.width);var C=Math.max(this.y+this.height,B.y+B.height);this.x=A;this.y=E;this.width=D-A;this.height=C-E;}};mxRectangle.prototype.grow=function(A){this.x-=A;this.y-=A;this.width+=2*A;this.height+=2*A;};mxRectangle.prototype.getPoint=function(){return new mxPoint(this.x,this.y);};mxRectangle.prototype.equals=function(A){return A.x==this.x&&A.y==this.y&&A.width==this.width&&A.height==this.height;};var mxEffects={animateChanges:function(G,E,B){var A=10;var F=0;var C=function(){var J=false;for(var K=0;K<E.length;K++){var M=E[K];if(M.constructor==mxGeometryChange||M.constructor==mxTerminalChange||M.constructor==mxValueChange||M.constructor==mxChildChange||M.constructor==mxStyleChange){var H=G.getView().getState(M.cell||M.child,false);if(H!=null){J=true;if(M.constructor!=mxGeometryChange||G.model.isEdge(M.cell)){mxUtils.setOpacity(H.shape.node,100*F/A);}else{var I=G.getView().scale;var P=(M.geometry.x-M.previous.x)*I;var O=(M.geometry.y-M.previous.y)*I;var N=(M.geometry.width-M.previous.width)*I;var L=(M.geometry.height-M.previous.height)*I;if(F==0){H.x-=P;H.y-=O;H.width-=N;H.height-=L;}else{H.x+=P/A;H.y+=O/A;H.width+=N/A;H.height+=L/A;}G.cellRenderer.redraw(H);mxEffects.cascadeOpacity(G,M.cell,100*F/A);}}}}mxUtils.repaintGraph(G,new mxPoint(1,1));if(F<A&&J){F++;window.setTimeout(C,D);}else{if(B!=null){B();}}};var D=30;C();},cascadeOpacity:function(H,G,F){var B=H.model.getChildCount(G);for(var D=0;D<B;D++){var A=H.model.getChildAt(G,D);var I=H.getView().getState(A);if(I!=null){mxUtils.setOpacity(I.shape.node,F);mxEffects.cascadeOpacity(H,A,F);}}var C=H.model.getEdges(G);if(C!=null){for(var D=0;D<C.length;D++){var E=H.getView().getState(C[D]);if(E!=null){mxUtils.setOpacity(E.shape.node,F);}}}},fadeOut:function(F,H,A,E,C,D){E=E||40;C=C||30;var B=H||100;mxUtils.setOpacity(F,B);if(D||D==null){var G=function(){B=Math.max(B-E,0);mxUtils.setOpacity(F,B);if(B>0){window.setTimeout(G,C);}else{F.style.visibility="hidden";if(A&&F.parentNode){F.parentNode.removeChild(F);}}};window.setTimeout(G,C);}else{F.style.visibility="hidden";if(A&&F.parentNode){F.parentNode.removeChild(F);}}}};var mxUtils={errorResource:(mxClient.language!="none")?"error":"",closeResource:(mxClient.language!="none")?"close":"",errorImage:mxClient.imageBasePath+"/error.gif",removeCursors:function(D){if(D.style!=null){D.style.cursor="";}var C=D.childNodes;if(C!=null){var A=C.length;for(var B=0;B<A;B+=1){mxUtils.removeCursors(C[B]);}}},repaintGraph:function(A,C){var D=A.container;if(D!=null&&C!=null&&(false||false||false)&&(D.scrollLeft>0||D.scrollTop>0)){var B=document.createElement("div");B.style.position="absolute";B.style.left=C.x+"px";B.style.top=C.y+"px";B.style.width="1px";B.style.height="1px";D.appendChild(B);D.removeChild(B);}},getCurrentStyle:function(){if(false){return function(A){return(A!=null)?A.currentStyle:null;};}else{return function(A){return(A!=null)?window.getComputedStyle(A,""):null;};}}(),hasScrollbars:function(B){var A=mxUtils.getCurrentStyle(B);return A!=null&&(A.overflow=="scroll"||A.overflow=="auto");},bind:function(B,A){return function(){return A.apply(B,arguments);};},eval:function(expr){var result=null;if(expr.indexOf("function")>=0){try{eval("var _mxJavaScriptExpression="+expr);result=_mxJavaScriptExpression;_mxJavaScriptExpression=null;}catch(e){mxLog.warn(e.message+" while evaluating "+expr);}}else{try{result=eval(expr);}catch(e){mxLog.warn(e.message+" while evaluating "+expr);}}return result;},findNode:function(D,B,E){var C=D.getAttribute(B);if(C!=null&&C==E){return D;}D=D.firstChild;while(D!=null){var A=mxUtils.findNode(D,B,E);if(A!=null){return A;}D=D.nextSibling;}return null;},selectSingleNode:function(){if(false){return function(B,A){return B.selectSingleNode(A);};}else{return function(C,B){var A=C.evaluate(B,C,null,XPathResult.ANY_TYPE,null);return A.iterateNext();};}}(),getFunctionName:function(D){var E=null;if(D!=null){if(D.name!=null){E=D.name;}else{var C=D.toString();var B=9;while(C.charAt(B)==" "){B++;}var A=C.indexOf("(",B);E=C.substring(B,A);}}return E;},indexOf:function(C,B){if(C!=null&&B!=null){for(var A=0;A<C.length;A++){if(C[A]==B){return A;}}}return -1;},remove:function(D,E){var A=null;if(typeof (E)=="object"){var B=mxUtils.indexOf(E,D);while(B>=0){E.splice(B,1);A=D;B=mxUtils.indexOf(E,D);}}for(var C in E){if(E[C]==D){delete E[C];A=D;}}return A;},isNode:function(C,D,A,B){if(C!=null&&!isNaN(C.nodeType)&&(D==null||C.nodeName.toLowerCase()==D.toLowerCase())){return A==null||C.getAttribute(A)==B;}return false;},getChildNodes:function(D,A){A=A||mxConstants.NODETYPE_ELEMENT;var C=[];var B=D.firstChild;while(B!=null){if(B.nodeType==A){C.push(B);}B=B.nextSibling;}return C;},createXmlDocument:function(){var A=null;if(document.implementation&&document.implementation.createDocument){A=document.implementation.createDocument("","",null);}else{if(window.ActiveXObject){A=new ActiveXObject("Microsoft.XMLDOM");}}return A;},parseXml:function(){if(false){return function(B){var A=mxUtils.createXmlDocument();A.async="false";A.loadXML(B);return A;};}else{return function(A){var B=new DOMParser();return B.parseFromString(A,"text/xml");};}}(),clearSelection:function(){if(document.selection){return function(){document.selection.empty();};}else{if(window.getSelection){return function(){window.getSelection().removeAllRanges();};}}}(),getPrettyXml:function(G,F,B){var A=[];if(G!=null){F=F||"  ";B=B||"";if(G.nodeType==mxConstants.NODETYPE_TEXT){A.push(G.nodeValue);}else{A.push(B+"<"+G.nodeName);var C=G.attributes;if(C!=null){for(var E=0;E<C.length;E++){var H=mxUtils.htmlEntities(C[E].nodeValue);A.push(" "+C[E].nodeName+'="'+H+'"');}}var D=G.firstChild;if(D!=null){A.push(">\n");while(D!=null){A.push(mxUtils.getPrettyXml(D,F,B+F));D=D.nextSibling;}A.push(B+"</"+G.nodeName+">\n");}else{A.push("/>\n");}}}return A.join("");},removeWhitespace:function(C,D){var A=(D)?C.previousSibling:C.nextSibling;while(A!=null&&A.nodeType==mxConstants.NODETYPE_TEXT){var B=(D)?A.previousSibling:A.nextSibling;var E=mxUtils.getTextContent(A);if(mxUtils.trim(E).length==0){A.parentNode.removeChild(A);}A=B;}},htmlEntities:function(B,A){B=B||"";B=B.replace(/&/g,"&amp;");B=B.replace(/"/g,"&quot;");B=B.replace(/\'/g,"&#39;");B=B.replace(/</g,"&lt;");B=B.replace(/>/g,"&gt;");if(A==null||A){B=B.replace(/\n/g,"&#xa;");}return B;},isVml:function(A){return A!=null&&A.tagUrn=="urn:schemas-microsoft-com:vml";},getXml:function(D,B){var C="";if(D!=null){C=D.xml;if(C==null){if(false){C=D.innerHTML;}else{var A=new XMLSerializer();C=A.serializeToString(D);}}else{C=C.replace(/\r\n\t[\t]*/g,"").replace(/>\r\n/g,">").replace(/\r\n/g,"\n");}}B=B||"&#xa;";C=C.replace(/\n/g,B);return C;},getTextContent:function(B){var A="";if(B!=null){if(B.firstChild!=null){B=B.firstChild;}A=B.nodeValue||"";}return A;},getInnerHtml:function(){if(false){return function(A){if(A!=null){return A.innerHTML;}return"";};}else{return function(B){if(B!=null){var A=new XMLSerializer();return A.serializeToString(B);}return"";};}}(),getOuterHtml:function(){if(false){return function(D){if(D!=null){var C=[];C.push("<"+D.nodeName);var A=D.attributes;for(var B=0;B<A.length;B++){var E=A[B].nodeValue;if(E!=null&&E.length>0){C.push(" ");C.push(A[B].nodeName);C.push('="');C.push(E);C.push('"');}}if(D.innerHTML.length==0){C.push("/>");}else{C.push(">");C.push(D.innerHTML);C.push("</"+D.nodeName+">");}return C.join("");}return"";};}else{return function(B){if(B!=null){var A=new XMLSerializer();return A.serializeToString(B);}return"";};}}(),write:function(A,D,C){C=(C!=null)?C:document;var B=C.createTextNode(D);if(A!=null){A.appendChild(B);}return B;},writeln:function(A,D,C){C=(C!=null)?C:document;var B=C.createTextNode(D);if(A!=null){A.appendChild(B);A.appendChild(document.createElement("br"));}return B;},br:function(C,D){D=D||1;var B;for(var A=0;A<D;A++){B=document.createElement("br");if(C!=null){C.appendChild(B);}}return B;},button:function(B,A){var C=document.createElement("button");mxUtils.write(C,B);mxEvent.addListener(C,"click",function(D){A(D);});return C;},para:function(A,C){var B=document.createElement("p");mxUtils.write(B,C);if(A!=null){A.appendChild(B);}return B;},linkAction:function(B,E,A,C,D){return mxUtils.link(B,E,function(){A.execute(C);},D);},linkInvoke:function(D,F,C,B,A,E){return mxUtils.link(D,F,function(){C[B](A);},E);},link:function(C,E,B,D){var A=document.createElement("span");A.style.color="blue";A.style.textDecoration="underline";A.style.cursor="pointer";if(D!=null){A.style.paddingLeft=D+"px";}mxEvent.addListener(A,"click",B);mxUtils.write(A,E);if(C!=null){C.appendChild(A);}return A;},fit:function(D){var C=parseInt(D.offsetLeft);var B=parseInt(D.offsetWidth);var G=document.body;var E=document.documentElement;var H=(G.scrollLeft||E.scrollLeft)+(G.clientWidth||E.clientWidth);if(C+B>H){D.style.left=Math.max((G.scrollLeft||E.scrollLeft),H-B)+"px";}var F=parseInt(D.offsetTop);var I=parseInt(D.offsetHeight);var A=(G.scrollTop||E.scrollTop)+Math.max(G.clientHeight||0,E.clientHeight);if(F+I>A){D.style.top=Math.max((G.scrollTop||E.scrollTop),A-I)+"px";}},open:function(B){if(true){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");}catch(G){mxUtils.alert("Permission to read file denied.");return"";}var D=Components.classes["@mozilla.org/file/local;1"].createInstance(Components.interfaces.nsILocalFile);D.initWithPath(B);if(!D.exists()){mxUtils.alert("File not found.");return"";}var F=Components.classes["@mozilla.org/network/file-input-stream;1"].createInstance(Components.interfaces.nsIFileInputStream);F.init(D,1,4,null);var E=Components.classes["@mozilla.org/scriptableinputstream;1"].createInstance(Components.interfaces.nsIScriptableInputStream);E.init(F);var C=E.read(E.available());return C;}else{var H=new ActiveXObject("Scripting.FileSystemObject");var A=H.OpenTextFile(B,1);var I=A.readAll();A.close();return I;}return null;},save:function(B,D){if(true){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");}catch(F){mxUtils.alert("Permission to write file denied.");return ;}var C=Components.classes["@mozilla.org/file/local;1"].createInstance(Components.interfaces.nsILocalFile);C.initWithPath(B);if(!C.exists()){C.create(0,420);}var A=Components.classes["@mozilla.org/network/file-output-stream;1"].createInstance(Components.interfaces.nsIFileOutputStream);A.init(C,32|2,4,null);A.write(D,D.length);A.flush();A.close();}else{var E=new ActiveXObject("Scripting.FileSystemObject");var C=E.CreateTextFile(B,true);C.Write(D);C.Close();}},saveAs:function(B){var A=document.createElement("iframe");A.setAttribute("src","");A.style.visibility="hidden";document.body.appendChild(A);try{if(true){var D=A.contentDocument;D.open();D.write(B);D.close();try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");A.focus();saveDocument(D);}catch(C){mxUtils.alert("Permission to save document denied.");}}else{var D=A.contentWindow.document;D.write(B);D.execCommand("SaveAs",false,document.location);}}finally{document.body.removeChild(A);}},copy:function(D){if(window.clipboardData){window.clipboardData.setData("Text",D);}else{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");var C=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(!C){return ;}var B=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!B){return ;}B.addDataFlavor("text/unicode");var F=new Object();var A=new Object();var F=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);var G=D;F.data=G;B.setTransferData("text/unicode",F,G.length*2);var E=Components.interfaces.nsIClipboard;C.setData(B,null,E.kGlobalClipboard);}},load:function(A){var B=new mxXmlRequest(A,null,"GET",false);B.send();return B;},get:function(B,C,A){return new mxXmlRequest(B,null,"GET").send(C,A);},post:function(B,D,C,A){return new mxXmlRequest(B,D).send(C,A);},submit:function(A,C,B){return new mxXmlRequest(A,C).simulate(B);},loadInto:function(A,C,B){if(false){C.onreadystatechange=function(){if(C.readyState==4){B();}};}else{C.addEventListener("load",B,false);}C.load(A);},getValue:function(D,B,A){var C=(D!=null)?D[B]:null;if(C==null){C=A;}return C;},clone:function(D,B,C){C=(C!=null)?C:false;var E=null;if(D!=null&&typeof (D.constructor)=="function"){E=new D.constructor();for(var A in D){if(A!=mxObjectIdentity.FIELD_NAME&&(B==null||mxUtils.indexOf(B,A)<0)){if(!C&&typeof (D[A])=="object"){E[A]=mxUtils.clone(D[A]);}else{E[A]=D[A];}}}}return E;},equalPoints:function(B,A){if((B==null&&A!=null)||(B!=null&&A==null)||(B!=null&&A!=null&&B.length!=A.length)){return false;}else{if(B!=null&&A!=null){for(var C=0;C<B.length;C++){if(B[C]==A[C]||(B[C]!=null&&!B[C].equals(A[C]))){return false;}}}}return true;},equalEntries:function(B,A){if((B==null&&A!=null)||(B!=null&&A==null)||(B!=null&&A!=null&&B.length!=A.length)){return false;}else{if(B!=null&&A!=null){for(var C in B){if(B[C]!=A[C]){return false;}}}}return true;},toString:function(E){var A="";for(var B in E){try{if(E[B]==null){A+=B+" = [null]\n";}else{if(typeof (E[B])=="function"){A+=B+" => [Function]\n";}else{if(typeof (E[B])=="object"){var C=mxUtils.getFunctionName(E[B].constructor);A+=B+" => ["+C+"]\n";}else{A+=B+" = "+E[B]+"\n";}}}}catch(D){A+=B+"="+D.message;}}return A;},toRadians:function(A){return Math.PI*A/180;},getBoundingBox:function(D,J){var K=null;if(D!=null&&J!=null&&J!=0){var C=mxUtils.toRadians(J);var I=Math.cos(C);var B=Math.sin(C);var A=new mxPoint(D.x+D.width/2,D.y+D.height/2);var H=new mxPoint(D.x,D.y);var G=new mxPoint(D.x+D.width,D.y);var F=new mxPoint(G.x,D.y+D.height);var E=new mxPoint(D.x,F.y);H=mxUtils.getRotatedPoint(H,I,B,A);G=mxUtils.getRotatedPoint(G,I,B,A);F=mxUtils.getRotatedPoint(F,I,B,A);E=mxUtils.getRotatedPoint(E,I,B,A);K=new mxRectangle(H.x,H.y,0,0);K.add(new mxRectangle(G.x,G.y,0,0));K.add(new mxRectangle(F.x,F.y,0,0));K.add(new mxRectangle(E.x,E.Y,0,0));}return K;},getRotatedPoint:function(G,F,C,B){B=(B!=null)?B:new mxPoint();var A=G.x-c.x;var H=G.y-c.y;var D=A*F-H*C;var E=H*F+A*C;return new mxPoint(D+c.x,E+c.y);},findNearestSegment:function(A,H,G){var D=-1;if(A.absolutePoints.length>0){var I=A.absolutePoints[0];var B=null;for(var C=1;C<A.absolutePoints.length;C++){var E=A.absolutePoints[C];var F=mxUtils.ptSegDistSq(I.x,I.y,E.x,E.y,H,G);if(B==null||F<B){B=F;D=C-1;}I=E;}}return D;},contains:function(B,A,C){return(B.x<=A&&B.x+B.width>=A&&B.y<=C&&B.y+B.height>=C);},intersects:function(I,H){var G=I.width;var C=I.height;var D=H.width;var J=H.height;if(D<=0||J<=0||G<=0||C<=0){return false;}var F=I.x;var E=I.y;var B=H.x;var A=H.y;D+=B;J+=A;G+=F;C+=E;return((D<B||D>F)&&(J<A||J>E)&&(G<F||G>B)&&(C<E||C>A));},intersectsHotspot:function(A,K,I,B,F,J){B=(B!=null)?B:1;F=(F!=null)?F:0;J=(J!=null)?J:0;if(B>0){var E=A.getCenterX();var D=A.getCenterY();var L=A.width;var G=A.height;var C=mxUtils.getValue(A.style,mxConstants.STYLE_STARTSIZE);if(C>0){if(mxUtils.getValue(A.style,mxConstants.STYLE_HORIZONTAL,true)){D=A.y+C/2;G=C;}else{E=A.x+C/2;L=C;}}var L=Math.max(F,L*B);var G=Math.max(F,G*B);if(J>0){L=Math.min(L,J);G=Math.min(G,J);}var H=new mxRectangle(E-L/2,D-G/2,L,G);return mxUtils.contains(H,K,I);}return true;},getOffset:function(A){var C=0;var B=0;while(A.offsetParent){C+=A.offsetLeft;B+=A.offsetTop;A=A.offsetParent;}return new mxPoint(C,B);},getScrollOrigin:function(E){var C=document.body;var F=document.documentElement;var B=(C.scrollLeft||F.scrollLeft);var D=(C.scrollTop||F.scrollTop);var A=new mxPoint(B,D);while(E!=null&&E!=C&&E!=F){A.x+=E.scrollLeft;A.y+=E.scrollTop;E=E.parentNode;}return A;},convertPoint:function(B,A,E){var C=mxUtils.getScrollOrigin(B);var D=mxUtils.getOffset(B);D.x-=C.x;D.y-=C.y;return new mxPoint(A-D.x,E-D.y);},ltrim:function(B,A){A=A||"\\s";return B.replace(new RegExp("^["+A+"]+","g"),"");},rtrim:function(B,A){A=A||"\\s";return B.replace(new RegExp("["+A+"]+$","g"),"");},trim:function(B,A){return mxUtils.ltrim(mxUtils.rtrim(B,A),A);},isNumeric:function(A){return A!=null&&(A.length==null||(A.length>0&&A.indexOf("0x")<0)&&A.indexOf("0X")<0)&&!isNaN(A);},mod:function(B,A){return((B%A)+A)%A;},intersection:function(F,O,E,M,D,K,B,J){var I=((J-K)*(E-F))-((B-D)*(M-O));var N=((B-D)*(O-K))-((J-K)*(F-D));var L=((E-F)*(O-K))-((M-O)*(F-D));var C=N/I;var A=L/I;if(C>=0&&C<=1&&A>=0&&A<=1){var H=F+C*(E-F);var G=O+C*(M-O);return new mxPoint(H,G);}return null;},ptSegDistSq:function(C,G,B,E,I,H){B-=C;E-=G;I-=C;H-=G;var F=I*B+H*E;var A;if(F<=0){A=0;}else{I=B-I;H=E-H;F=I*B+H*E;if(F<=0){A=0;}else{A=F*F/(B*B+E*E);}}var D=I*I+H*H-A;if(D<0){D=0;}return D;},relativeCcw:function(D,G,B,F,E,C){B-=D;F-=G;E-=D;C-=G;var A=E*F-C*B;if(A==0){A=E*B+C*F;if(A>0){E-=B;C-=F;A=E*B+C*F;if(A<0){A=0;}}}return(A<0)?-1:((A>0)?1:0);},animateChanges:function(B,A){mxEffects.animateChanges.apply(this,arguments);},cascadeOpacity:function(C,A,B){mxEffects.cascadeOpacity.apply(this,arguments);},fadeOut:function(E,F,A,D,B,C){mxEffects.fadeOut.apply(this,arguments);},setOpacity:function(A,B){if(mxUtils.isVml(A)){if(B>=100){A.style.filter=null;}else{A.style.filter="alpha(opacity="+(B/5)+")";}}else{if(false){if(B>=100){A.style.filter=null;}else{A.style.filter="alpha(opacity="+B+")";}}else{A.style.opacity=(B/100);}}},createImage:function(C){var A=C.toUpperCase();var B=null;if(A.substring(A.length-3,A.length).toUpperCase()=="PNG"&&false){B=document.createElement("DIV");B.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader (src='"+C+"', sizingMethod='scale')";}else{B=document.createElement("img");B.setAttribute("src",C);B.setAttribute("border","0");}return B;},sortCells:function(A,B){B=(B!=null)?B:true;A.sort(function(E,D){var G=mxCellPath.create(E).split(mxCellPath.PATH_SEPARATOR);var F=mxCellPath.create(D).split(mxCellPath.PATH_SEPARATOR);var C=mxCellPath.compare(G,F);return(C==0)?0:(((C>0)==B)?1:-1);});return A;},getStylename:function(A){if(A!=null){var C=A.split(";");var B=C[0];if(B.indexOf("=")<0){return B;}}return"";},getStylenames:function(C){var A=[];if(C!=null){var D=C.split(";");for(var B=0;B<D.length;B++){if(D[B].indexOf("=")<0){A.push(D[B]);}}}return A;},indexOfStylename:function(B,C){if(B!=null&&C!=null){var D=B.split(";");var E=0;for(var A=0;A<D.length;A++){if(D[A]==C){return E;}E+=D[A].length+1;}}return -1;},addStylename:function(A,B){if(mxUtils.indexOfStylename(A,B)<0){if(A==null){A="";}else{if(A.length>0&&A.charAt(A.length-1)!=";"){A+=";";}}A+=B;}return A;},removeStylename:function(C,D){var A=[];if(C!=null){var E=C.split(";");for(var B=0;B<E.length;B++){if(E[B]!=D){A.push(E[B]);}}}return A.join(";");},removeAllStylenames:function(C){var A=[];if(C!=null){var D=C.split(";");for(var B=0;B<D.length;B++){if(D[B].indexOf("=")>=0){A.push(D[B]);}}}return A.join(";");},setCellStyles:function(B,A,D,F){if(A!=null&&A.length>0){B.beginUpdate();try{for(var C=0;C<A.length;C++){if(A[C]!=null){var E=mxUtils.setStyle(B.getStyle(A[C]),D,F);B.setStyle(A[C],E);}}}finally{B.endUpdate();}}},setStyle:function(F,E,G){var H=G!=null&&(typeof (G.length)=="undefined"||G.length>0);if(F==null||F.length==0){if(H){F=E+"="+G;}}else{var C=F.indexOf(E+"=");if(C<0){if(H){var B=(F.charAt(F.length-1)==";")?"":";";F=F+B+E+"="+G;}}else{var D=(H)?(E+"="+G):"";var A=F.indexOf(";",C);if(!H){A++;}F=F.substring(0,C)+D+((A>C)?F.substring(A):"");}}return F;},setCellStyleFlags:function(C,B,E,A,G){if(B!=null&&B.length>0){C.beginUpdate();try{for(var D=0;D<B.length;D++){if(B[D]!=null){var F=mxUtils.setStyleFlag(C.getStyle(B[D]),E,A,G);C.setStyle(B[D],F);}}}finally{C.endUpdate();}}},setStyleFlag:function(G,F,B,H){if(G==null||G.length==0){if(H||H==null){G=F+"="+B;}else{G=F+"=0";}}else{var D=G.indexOf(F+"=");if(D<0){var C=(G.charAt(G.length-1)==";")?"":";";if(H||H==null){G=G+C+F+"="+B;}else{G=G+C+F+"=0";}}else{var A=G.indexOf(";",D);var E="";if(A<0){E=G.substring(D+F.length+1);}else{E=G.substring(D+F.length+1,A);}if(H==null){E=parseInt(E)^B;}else{if(H){E=parseInt(E)|B;}else{E=parseInt(E)&~B;}}G=G.substring(0,D)+F+"="+E+((A>=0)?G.substring(A):"");}}return G;},getSizeForString:function(D,C,A){var E=document.createElement("div");E.style.fontSize=C||mxConstants.DEFAULT_FONTSIZE;E.style.fontFamily=A||mxConstants.DEFAULT_FONTFAMILY;E.style.position="absolute";E.style.display="inline";E.style.visibility="hidden";E.innerHTML=D;document.body.appendChild(E);var B=new mxRectangle(0,0,E.offsetWidth,E.offsetHeight);document.body.removeChild(E);return B;},getViewXml:function(K,C,L,A,I){A=(A!=null)?A:0;I=(I!=null)?I:0;C=(C!=null)?C:1;if(L==null){var E=K.getModel();L=[E.getRoot()];}var G=K.getView();var M=null;var F=G.isEventsEnabled();G.setEventsEnabled(false);var H=G.drawPane;if(K.dialect==mxConstants.DIALECT_SVG){G.drawPane=document.createElementNS(mxConstants.NS_SVG,"g");G.canvas.appendChild(G.drawPane);}else{G.drawPane=G.drawPane.cloneNode(false);G.canvas.appendChild(G.drawPane);}var B=G.getTranslate();G.translate=new mxPoint(A,I);var J=new mxTemporaryCellStates(K.getView(),C,L);try{var D=new mxCodec();M=D.encode(K.getView());}finally{J.destroy();G.translate=B;G.canvas.removeChild(G.drawPane);G.drawPane=H;G.setEventsEnabled(F);}return M;},getScaleForPageCount:function(R,G,S,T){if(R<1){return 1;}S=(S!=null)?S:mxConstants.PAGE_FORMAT_A4_PORTRAIT;T=(T!=null)?T:0;var Q=S.width-(T*2);var C=S.height-(T*2);var H=G.getGraphBounds().clone();var E=G.getView().getScale();H.width/=E;H.height/=E;var L=H.width;var N=H.height;var W=1;var J=Q/C;var U=L/N;var O=U/J;var B=Math.sqrt(R);var A=Math.sqrt(O);var F=B*A;var M=B/A;if(F<1&&M>R){var X=M/R;M=R;F/=X;}if(M<1&&F>R){var X=F/R;F=R;M/=X;}var D=Math.ceil(F)*Math.ceil(M);var K=0;while(D>R){var V=Math.floor(F)/F;var I=Math.floor(M)/M;if(V==1){V=Math.floor(F-1)/F;}if(I==1){I=Math.floor(M-1)/M;}var X=1;if(V>I){X=V;}else{X=I;}F=F*X;M=M*X;D=Math.ceil(F)*Math.ceil(M);K++;if(K>10){break;}}var P=Q*F;W=P/L;return W*0.99999;},show:function(N,K,C,L){C=(C!=null)?C:0;L=(L!=null)?L:0;if(K==null){var E=window.open();K=E.document;}else{K.open();}var A=N.getGraphBounds();var Q=-A.x+C;var P=-A.y+L;if(false){var G="<html>";G+="<head>";var B=document.getElementsByTagName("base");for(var F=0;F<B.length;F++){G+=B[F].outerHTML;}G+="<style>";for(var F=0;F<document.styleSheets.length;F++){try{G+=document.styleSheets(F).cssText;}catch(H){}}G+="</style>";G+="</head>";G+="<body>";G+=N.container.innerHTML;G+="</body>";G+="<html>";K.writeln(G);K.close();var D=K.body.getElementsByTagName("DIV")[0];if(D!=null){D.style.position="absolute";D.style.left=Q+"px";D.style.top=P+"px";}}else{K.writeln("<html");K.writeln("<head>");var B=document.getElementsByTagName("base");for(var F=0;F<B.length;F++){K.writeln(mxUtils.getOuterHtml(B[F]));}var M=document.getElementsByTagName("link");for(var F=0;F<M.length;F++){K.writeln(mxUtils.getOuterHtml(M[F]));}var O=document.getElementsByTagName("style");for(var F=0;F<O.length;F++){K.writeln(mxUtils.getOuterHtml(O[F]));}K.writeln("</head>");K.writeln("</html>");K.close();K.documentElement.appendChild(K.createElement("body"));var D=N.container.firstChild;while(D!=null){var I=D.cloneNode(true);K.body.appendChild(I);D=D.nextSibling;}var D=K.getElementsByTagName("g")[0];if(D!=null){D.setAttribute("transform","translate("+Q+","+P+")");var J=D.ownerSVGElement;J.setAttribute("width",A.width+Math.max(A.x,0)+3);J.setAttribute("height",A.height+Math.max(A.y,0)+3);}}mxUtils.removeCursors(K.body);return K;},printScreen:function(C){var B=window.open();mxUtils.show(C,B.document);var A=function(){B.focus();B.print();B.close();};if(false){B.setTimeout(A,500);}else{A();}},popup:function(D,G){if(G){var F=document.createElement("div");F.style.overflow="scroll";F.style.width="636px";F.style.height="460px";var E=document.createElement("pre");E.innerHTML=mxUtils.htmlEntities(D,false).replace(/\n/g,"<br>").replace(/ /g,"&nbsp;");F.appendChild(E);var A=document.body.clientWidth;var B=(document.body.clientHeight||document.documentElement.clientHeight);var C=new mxWindow("Popup Window",F,A/2-320,B/2-240,640,480,false,true);C.setClosable(true);C.setVisible(true);}else{if(true){var C=window.open();C.document.writeln("<pre>"+mxUtils.htmlEntities(D)+"</pre");C.document.close();}else{var C=window.open();var E=C.document.createElement("pre");E.innerHTML=mxUtils.htmlEntities(D,false).replace(/\n/g,"<br>").replace(/ /g,"&nbsp;");C.document.body.appendChild(E);}}},alert:function(A){alert(A);},prompt:function(B,A){return prompt(B,A);},confirm:function(A){return confirm(A);},error:function(K,B,J,H){var A=document.createElement("div");A.style.padding="20px";var D=document.createElement("img");D.setAttribute("src",H||mxUtils.errorImage);D.setAttribute("valign","bottom");D.style.verticalAlign="middle";A.appendChild(D);A.appendChild(document.createTextNode("\u00a0"));A.appendChild(document.createTextNode("\u00a0"));A.appendChild(document.createTextNode("\u00a0"));mxUtils.write(A,K);var I=document.body.clientWidth;var F=(document.body.clientHeight||document.documentElement.clientHeight);var G=new mxWindow(mxResources.get(mxUtils.errorResource)||mxUtils.errorResource,A,(I-B)/2,F/4,B,null,false,true);if(J){mxUtils.br(A);var C=document.createElement("p");var E=document.createElement("button");if(false){E.style.cssText="float:right";}else{E.setAttribute("style","float:right");}mxEvent.addListener(E,"click",function(L){G.destroy();});mxUtils.write(E,mxResources.get(mxUtils.closeResource)||mxUtils.closeResource);C.appendChild(E);A.appendChild(C);mxUtils.br(A);G.setClosable(true);}G.setVisible(true);return G;},makeDraggable:function(E,J,B,A,M,K,I,G,D,F){M=(M!=null)?M:0;K=(K!=null)?K:mxConstants.TOOLTIP_VERTICAL_OFFSET;D=(D!=null)?D:true;F=(F!=null)?F:function(N,O){return J.getCellAt(N,O);};var H=(mxClient.IS_TOUCH)?"touchstart":"mousedown";var C=(mxClient.IS_TOUCH)?"touchmove":"mousemove";var L=(mxClient.IS_TOUCH)?"touchend":"mouseup";mxEvent.addListener(E,H,function(X){if(J.isEnabled()&&!mxEvent.isConsumed(X)){J.isMouseDown=true;var W=(A!=null)?A.cloneNode(true):E.cloneNode(true);if(G){var R=J.view.scale;W.style.width=(parseInt(W.style.width)*R)+"px";W.style.height=(parseInt(W.style.height)*R)+"px";M*=R;K*=R;}W.style.zIndex=3;W.style.position="absolute";mxUtils.setOpacity(W,70);var N=null;var P=false;var U=mxEvent.getClientX(X);var S=mxEvent.getClientY(X);var Q=null;var T=function(){};if(D&&J.isDropEnabled()){Q=new mxCellHighlight(J,mxConstants.DROP_TARGET_COLOR);T=function(Y){var Z=J.getView().getState(Y);Q.highlight(Z);};}var V=function(Y){var d=mxEvent.getClientX(Y);var b=mxEvent.getClientY(Y);var Z=mxUtils.getScrollOrigin();var a=mxUtils.convertPoint(J.container,d,b);W.style.left=(d+Z.x+M)+"px";W.style.top=(b+Z.y+K)+"px";if(!P){P=true;document.body.appendChild(W);}else{if(J.autoScroll&&(I==null||I)){J.scrollPointToVisible(a.x,a.y,J.autoExtend);}}N=F(a.x,a.y);T(N);mxEvent.consume(Y);};var O=function(Z){mxEvent.removeListener(document,C,V);mxEvent.removeListener(document,L,O);if(W.parentNode!=null){W.parentNode.removeChild(W);}if(Q!=null){Q.destroy();Q=null;}try{var b=mxEvent.getClientX(Z);var a=mxEvent.getClientY(Z);var d=mxUtils.convertPoint(J.container,b,a);var Y=2*J.tolerance;J.container.focus();B(J,Z,N);}finally{mxEvent.consume(Z);J.isMouseDown=false;}};mxEvent.addListener(document,C,V);mxEvent.addListener(document,L,O);mxEvent.consume(X);}});}};var mxConstants={DEFAULT_HOTSPOT:0.3,MIN_HOTSPOT_SIZE:8,MAX_HOTSPOT_SIZE:0,RENDERING_HINT_EXACT:"exact",RENDERING_HINT_FASTER:"faster",RENDERING_HINT_FASTEST:"fastest",DIALECT_SVG:"svg",DIALECT_VML:"vml",DIALECT_MIXEDHTML:"mixedHtml",DIALECT_PREFERHTML:"preferHtml",DIALECT_STRICTHTML:"strictHtml",NS_SVG:"http://www.w3.org/2000/svg",NS_XHTML:"http://www.w3.org/1999/xhtml",NS_XLINK:"http://www.w3.org/1999/xlink",SHADOWCOLOR:"gray",SVG_SHADOWTRANSFORM:"translate(2 3)",NODETYPE_ELEMENT:1,NODETYPE_ATTRIBUTE:2,NODETYPE_TEXT:3,NODETYPE_CDATA:4,NODETYPE_ENTITY_REFERENCE:5,NODETYPE_ENTITY:6,NODETYPE_PROCESSING_INSTRUCTION:7,NODETYPE_COMMENT:8,NODETYPE_DOCUMENT:9,NODETYPE_DOCUMENTTYPE:10,NODETYPE_DOCUMENT_FRAGMENT:11,NODETYPE_NOTATION:12,TOOLTIP_VERTICAL_OFFSET:16,DEFAULT_VALID_COLOR:"#00FF00",DEFAULT_INVALID_COLOR:"#FF0000",HIGHLIGHT_STROKEWIDTH:3,CURSOR_MOVABLE_VERTEX:"move",CURSOR_MOVABLE_EDGE:"move",CURSOR_MOVABLE_LABEL:"default",CURSOR_BEND_HANDLE:"pointer",CURSOR_CONNECT:"pointer",HIGHLIGHT_COLOR:"#00FF00",CONNECT_TARGET_COLOR:"#0000FF",INVALID_CONNECT_TARGET_COLOR:"#FF0000",DROP_TARGET_COLOR:"#0000FF",VALID_COLOR:"#00FF00",INVALID_COLOR:"#FF0000",EDGE_SELECTION_COLOR:"#00FF00",VERTEX_SELECTION_COLOR:"#00FF00",VERTEX_SELECTION_STROKEWIDTH:1,EDGE_SELECTION_STROKEWIDTH:1,VERTEX_SELECTION_DASHED:true,EDGE_SELECTION_DASHED:true,OUTLINE_COLOR:"#0099FF",OUTLINE_STROKEWIDTH:(false)?2:3,HANDLE_SIZE:7,LABEL_HANDLE_SIZE:4,HANDLE_FILLCOLOR:"#00FF00",HANDLE_STROKECOLOR:"black",LABEL_HANDLE_FILLCOLOR:"yellow",CONNECT_HANDLE_FILLCOLOR:"#0000FF",LOCKED_HANDLE_FILLCOLOR:"#FF0000",OUTLINE_HANDLE_FILLCOLOR:"#00FFFF",OUTLINE_HANDLE_STROKECOLOR:"#0033FF",DEFAULT_FONTFAMILY:"Arial,Helvetica",DEFAULT_FONTSIZE:11,DEFAULT_STARTSIZE:40,DEFAULT_MARKERSIZE:6,DEFAULT_IMAGESIZE:24,ENTITY_SEGMENT:30,RECTANGLE_ROUNDING_FACTOR:0.15,LINE_ARCSIZE:20,ARROW_SPACING:10,ARROW_WIDTH:30,ARROW_SIZE:30,PAGE_FORMAT_A4_PORTRAIT:new mxRectangle(0,0,826,1169),PAGE_FORMAT_A4_LANDSCAPE:new mxRectangle(0,0,1169,826),NONE:"none",STYLE_PERIMETER:"perimeter",STYLE_SOURCE_PORT:"sourcePort",STYLE_TARGET_PORT:"targetPort",STYLE_OPACITY:"opacity",STYLE_TEXT_OPACITY:"textOpacity",STYLE_OVERFLOW:"overflow",STYLE_ORTHOGONAL:"orthogonal",STYLE_EXIT_X:"exitX",STYLE_EXIT_Y:"exitY",STYLE_EXIT_PERIMETER:"exitPerimeter",STYLE_ENTRY_X:"entryX",STYLE_ENTRY_Y:"entryY",STYLE_ENTRY_PERIMETER:"entryPerimeter",STYLE_WHITE_SPACE:"whiteSpace",STYLE_ROTATION:"rotation",STYLE_FILLCOLOR:"fillColor",STYLE_GRADIENTCOLOR:"gradientColor",STYLE_GRADIENT_DIRECTION:"gradientDirection",STYLE_STROKECOLOR:"strokeColor",STYLE_SEPARATORCOLOR:"separatorColor",STYLE_STROKEWIDTH:"strokeWidth",STYLE_ALIGN:"align",STYLE_VERTICAL_ALIGN:"verticalAlign",STYLE_LABEL_POSITION:"labelPosition",STYLE_VERTICAL_LABEL_POSITION:"verticalLabelPosition",STYLE_IMAGE_ALIGN:"imageAlign",STYLE_IMAGE_VERTICAL_ALIGN:"imageVerticalAlign",STYLE_IMAGE:"image",STYLE_IMAGE_WIDTH:"imageWidth",STYLE_IMAGE_HEIGHT:"imageHeight",STYLE_IMAGE_BACKGROUND:"imageBackground",STYLE_IMAGE_BORDER:"imageBorder",STYLE_NOLABEL:"noLabel",STYLE_NOEDGESTYLE:"noEdgeStyle",STYLE_LABEL_BACKGROUNDCOLOR:"labelBackgroundColor",STYLE_LABEL_BORDERCOLOR:"labelBorderColor",STYLE_INDICATOR_SHAPE:"indicatorShape",STYLE_INDICATOR_IMAGE:"indicatorImage",STYLE_INDICATOR_COLOR:"indicatorColor",STYLE_INDICATOR_STROKECOLOR:"indicatorStrokeColor",STYLE_INDICATOR_GRADIENTCOLOR:"indicatorGradientColor",STYLE_INDICATOR_SPACING:"indicatorSpacing",STYLE_INDICATOR_WIDTH:"indicatorWidth",STYLE_INDICATOR_HEIGHT:"indicatorHeight",STYLE_INDICATOR_DIRECTION:"indicatorDirection",STYLE_SHADOW:"shadow",STYLE_SEGMENT:"segment",STYLE_ENDARROW:"endArrow",STYLE_STARTARROW:"startArrow",STYLE_ENDSIZE:"endSize",STYLE_STARTSIZE:"startSize",STYLE_DASHED:"dashed",STYLE_ROUNDED:"rounded",STYLE_SMOOTH:"smooth",STYLE_SOURCE_PERIMETER_SPACING:"sourcePerimeterSpacing",STYLE_TARGET_PERIMETER_SPACING:"targetPerimeterSpacing",STYLE_PERIMETER_SPACING:"perimeterSpacing",STYLE_SPACING:"spacing",STYLE_SPACING_TOP:"spacingTop",STYLE_SPACING_LEFT:"spacingLeft",STYLE_SPACING_BOTTOM:"spacingBottom",STYLE_SPACING_RIGHT:"spacingRight",STYLE_HORIZONTAL:"horizontal",STYLE_DIRECTION:"direction",STYLE_ELBOW:"elbow",STYLE_FONTCOLOR:"fontColor",STYLE_FONTFAMILY:"fontFamily",STYLE_FONTSIZE:"fontSize",STYLE_FONTSTYLE:"fontStyle",STYLE_SHAPE:"shape",STYLE_EDGE:"edgeStyle",STYLE_LOOP:"loopStyle",STYLE_ROUTING_CENTER_X:"routingCenterX",STYLE_ROUTING_CENTER_Y:"routingCenterY",FONT_BOLD:1,FONT_ITALIC:2,FONT_UNDERLINE:4,FONT_SHADOW:8,SHAPE_RECTANGLE:"rectangle",SHAPE_ELLIPSE:"ellipse",SHAPE_DOUBLE_ELLIPSE:"doubleEllipse",SHAPE_RHOMBUS:"rhombus",SHAPE_LINE:"line",SHAPE_IMAGE:"image",SHAPE_ARROW:"arrow",SHAPE_LABEL:"label",SHAPE_CYLINDER:"cylinder",SHAPE_SWIMLANE:"swimlane",SHAPE_CONNECTOR:"connector",SHAPE_ACTOR:"actor",SHAPE_CLOUD:"cloud",SHAPE_TRIANGLE:"triangle",SHAPE_HEXAGON:"hexagon",ARROW_CLASSIC:"classic",ARROW_BLOCK:"block",ARROW_OPEN:"open",ARROW_OVAL:"oval",ARROW_DIAMOND:"diamond",ALIGN_LEFT:"left",ALIGN_CENTER:"center",ALIGN_RIGHT:"right",ALIGN_TOP:"top",ALIGN_MIDDLE:"middle",ALIGN_BOTTOM:"bottom",DIRECTION_NORTH:"north",DIRECTION_SOUTH:"south",DIRECTION_EAST:"east",DIRECTION_WEST:"west",ELBOW_VERTICAL:"vertical",ELBOW_HORIZONTAL:"horizontal",EDGESTYLE_ELBOW:"elbowEdgeStyle",EDGESTYLE_ENTITY_RELATION:"entityRelationEdgeStyle",EDGESTYLE_LOOP:"loopEdgeStyle",EDGESTYLE_SIDETOSIDE:"sideToSideEdgeStyle",EDGESTYLE_TOPTOBOTTOM:"topToBottomEdgeStyle",PERIMETER_ELLIPSE:"ellipsePerimeter",PERIMETER_RECTANGLE:"rectanglePerimeter",PERIMETER_RHOMBUS:"rhombusPerimeter",PERIMETER_TRIANGLE:"trianglePerimeter"};function mxEventObject(A){this.name=A;this.properties=[];for(var B=1;B<arguments.length;B+=2){if(arguments[B+1]!=null){this.properties[arguments[B]]=arguments[B+1];}}}mxEventObject.prototype.properties=null;mxEventObject.prototype.properties=null;mxEventObject.prototype.consumed=false;mxEventObject.prototype.getName=function(){return this.name;};mxEventObject.prototype.getProperties=function(){return this.properties;};mxEventObject.prototype.getProperty=function(A){return this.properties[A];};mxEventObject.prototype.isConsumed=function(){return this.consumed;};mxEventObject.prototype.consume=function(){this.consumed=true;};function mxMouseEvent(A,B){this.evt=A;this.state=B;}mxMouseEvent.prototype.consumed=false;mxMouseEvent.prototype.evt=null;mxMouseEvent.prototype.state=null;mxMouseEvent.prototype.getEvent=function(){return this.evt;};mxMouseEvent.prototype.getSource=function(){return mxEvent.getSource(this.evt);};mxMouseEvent.prototype.isSource=function(A){if(A!=null){var B=this.getSource();while(B!=null){if(B==A.node){return true;}B=B.parentNode;}}return false;};mxMouseEvent.prototype.getX=function(){return mxEvent.getClientX(this.getEvent());};mxMouseEvent.prototype.getY=function(){return mxEvent.getClientY(this.getEvent());};mxMouseEvent.prototype.getState=function(){return this.state;};mxMouseEvent.prototype.getCell=function(){var A=this.getState();if(A!=null){return A.cell;}return null;};mxMouseEvent.prototype.isPopupTrigger=function(){return mxEvent.isPopupTrigger(this.getEvent());};mxMouseEvent.prototype.isConsumed=function(){return this.consumed;};mxMouseEvent.prototype.consume=function(A){A=(A!=null)?A:true;if(A&&this.evt.preventDefault){this.evt.preventDefault();}this.consumed=true;};function mxEventSource(A){this.setEventSource(A);}mxEventSource.prototype.eventListeners=null;mxEventSource.prototype.eventsEnabled=true;mxEventSource.prototype.eventSource=null;mxEventSource.prototype.isEventsEnabled=function(){return this.eventsEnabled;};mxEventSource.prototype.setEventsEnabled=function(A){this.eventsEnabled=A;};mxEventSource.prototype.getEventSource=function(){return this.eventSource;};mxEventSource.prototype.setEventSource=function(A){this.eventSource=A;};mxEventSource.prototype.addListener=function(B,A){if(this.eventListeners==null){this.eventListeners=[];}this.eventListeners.push(B);this.eventListeners.push(A);};mxEventSource.prototype.removeListener=function(A){if(this.eventListeners!=null){var B=0;while(B<this.eventListeners.length){if(this.eventListeners[B+1]==A){this.eventListeners.splice(B,2);}else{B+=2;}}}};mxEventSource.prototype.fireEvent=function(A,E){if(this.eventListeners!=null&&this.isEventsEnabled()){if(A==null){A=new mxEventObject();}if(E==null){E=this.getEventSource();}if(E==null){E=this;}var B=[E,A];for(var D=0;D<this.eventListeners.length;D+=2){var C=this.eventListeners[D];if(C==null||C==A.getName()){this.eventListeners[D+1].apply(this,B);}}}};var mxEvent={addListener:function(){var A=function(D,C,B){if(D.mxListenerList==null){D.mxListenerList=[];}var E={name:C,f:B};D.mxListenerList.push(E);};if(false){return function(D,C,B){D.attachEvent("on"+C,B);A(D,C,B);};}else{return function(D,C,B){D.addEventListener(C,B,false);A(D,C,B);};}}(),redirectMouseEvents:function(C,J,A,I,D,F,B){var G=function(){return(typeof (A)=="function")?A():A;};var H=(mxClient.IS_TOUCH)?"touchstart":"mousedown";var E=(mxClient.IS_TOUCH)?"touchmove":"mousemove";var K=(mxClient.IS_TOUCH)?"touchend":"mouseup";mxEvent.addListener(C,H,function(L){if(I!=null){I(L);}else{if(!mxEvent.isConsumed(L)){J.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(L,G()));}}});mxEvent.addListener(C,E,function(L){if(D!=null){D(L);}else{if(!mxEvent.isConsumed(L)){J.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(L,G()));}}});mxEvent.addListener(C,K,function(L){if(F!=null){F(L);}else{if(!mxEvent.isConsumed(L)){J.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(L,G()));}}});mxEvent.addListener(C,"dblclick",function(L){if(B!=null){B(L);}else{if(!mxEvent.isConsumed(L)){var M=G();J.dblClick(L,(M!=null)?M.cell:null);}}});},removeListener:function(){var A=function(E,C,B){if(E.mxListenerList!=null){var G=E.mxListenerList.length;for(var D=0;D<G;D++){var F=E.mxListenerList[D];if(F.f==B){E.mxListenerList.splice(D,1);break;}}if(E.mxListenerList.length==0){E.mxListenerList=null;}}};if(false){return function(D,C,B){D.detachEvent("on"+C,B);A(D,C,B);};}else{return function(D,C,B){D.removeEventListener(C,B,false);A(D,C,B);};}}(),removeAllListeners:function(A){var C=A.mxListenerList;if(C!=null){while(C.length>0){var B=C[0];mxEvent.removeListener(A,B.name,B.f);}}},release:function(D){if(D!=null){mxEvent.removeAllListeners(D);var C=D.childNodes;if(C!=null){var A=C.length;for(var B=0;B<A;B+=1){mxEvent.release(C[B]);}}}},addMouseWheelListener:function(A){if(A!=null){var C=function(D){if(D==null){D=window.event;}var E=0;if(true&&!false&&!false){E=-D.detail/2;}else{E=D.wheelDelta/120;}if(E!=0){A(D,E>0);}};if(true){var B=(false||false)?"mousewheel":"DOMMouseScroll";mxEvent.addListener(window,B,C);}else{mxEvent.addListener(document,"mousewheel",C);}}},disableContextMenu:function(){if(false){return function(A){mxEvent.addListener(A,"contextmenu",function(){return false;});};}else{return function(A){A.setAttribute("oncontextmenu","return false;");};}}(),getSource:function(A){return(A.srcElement!=null)?A.srcElement:A.target;},isConsumed:function(A){return A.isConsumed!=null&&A.isConsumed;},isLeftMouseButton:function(A){return A.button==((false)?1:0);},isRightMouseButton:function(A){return A.button==2;},isPopupTrigger:function(A){return mxEvent.isRightMouseButton(A)||(mxEvent.isShiftDown(A)&&!mxEvent.isControlDown(A));},isShiftDown:function(A){return(A!=null)?A.shiftKey:false;},isAltDown:function(A){return(A!=null)?A.altKey:false;},isControlDown:function(A){return(A!=null)?A.ctrlKey:false;},isMetaDown:function(A){return(A!=null)?A.metaKey:false;},getMainEvent:function(A){if((A.type=="touchstart"||A.type=="touchmove")&&A.touches!=null&&A.touches[0]!=null){A=A.touches[0];}else{if(A.type=="touchend"&&A.changedTouches!=null&&A.changedTouches[0]!=null){A=A.changedTouches[0];}}return A;},getClientX:function(A){return mxEvent.getMainEvent(A).clientX;},getClientY:function(A){return mxEvent.getMainEvent(A).clientY;},consume:function(A,B){if(B==null||B){if(A.preventDefault){A.stopPropagation();A.preventDefault();}else{A.cancelBubble=true;}}A.isConsumed=true;A.returnValue=false;},LABEL_HANDLE:-1,MOUSE_DOWN:"mouseDown",MOUSE_MOVE:"mouseMove",MOUSE_UP:"mouseUp",ACTIVATE:"activate",RESIZE_START:"resizeStart",RESIZE:"resize",RESIZE_END:"resizeEnd",MOVE_START:"moveStart",MOVE:"move",MOVE_END:"moveEnd",MINIMIZE:"minimize",NORMALIZE:"normalize",MAXIMIZE:"maximize",HIDE:"hide",SHOW:"show",CLOSE:"close",DESTROY:"destroy",REFRESH:"refresh",SIZE:"size",SELECT:"select",FIRED:"fired",GET:"get",RECEIVE:"receive",CONNECT:"connect",DISCONNECT:"disconnect",SUSPEND:"suspend",RESUME:"resume",MARK:"mark",SESSION:"session",ROOT:"root",POST:"post",OPEN:"open",SAVE:"save",BEFORE_ADD_VERTEX:"beforeAddVertex",ADD_VERTEX:"addVertex",AFTER_ADD_VERTEX:"afterAddVertex",DONE:"done",EXECUTE:"execute",BEGIN_UPDATE:"beginUpdate",END_UPDATE:"endUpdate",BEFORE_UNDO:"beforeUndo",UNDO:"undo",REDO:"redo",CHANGE:"change",NOTIFY:"notify",LAYOUT_CELLS:"layoutCells",CLICK:"click",SCALE:"scale",TRANSLATE:"translate",SCALE_AND_TRANSLATE:"scaleAndTranslate",UP:"up",DOWN:"down",ADD:"add",CLEAR:"clear",ADD_CELLS:"addCells",CELLS_ADDED:"cellsAdded",MOVE_CELLS:"moveCells",CELLS_MOVED:"cellsMoved",RESIZE_CELLS:"resizeCells",CELLS_RESIZED:"cellsResized",TOGGLE_CELLS:"toggleCells",CELLS_TOGGLED:"cellsToggled",ORDER_CELLS:"orderCells",CELLS_ORDERED:"cellsOrdered",REMOVE_CELLS:"removeCells",CELLS_REMOVED:"cellsRemoved",GROUP_CELLS:"groupCells",UNGROUP_CELLS:"ungroupCells",REMOVE_CELLS_FROM_PARENT:"removeCellsFromParent",FOLD_CELLS:"foldCells",CELLS_FOLDED:"cellsFolded",ALIGN_CELLS:"alignCells",LABEL_CHANGED:"labelChanged",CONNECT_CELL:"connectCell",CELL_CONNECTED:"cellConnected",SPLIT_EDGE:"splitEdge",FLIP_EDGE:"flipEdge",START_EDITING:"startEditing",ADD_OVERLAY:"addOverlay",REMOVE_OVERLAY:"removeOverlay",UPDATE_CELL_SIZE:"updateCellSize",ESCAPE:"escape",CLICK:"click",DOUBLE_CLICK:"doubleClick"};function mxXmlRequest(B,D,F,C,E,A){this.url=B;this.params=D;this.method=F||"POST";this.async=(C!=null)?C:true;this.username=E;this.password=A;}mxXmlRequest.prototype.url=null;mxXmlRequest.prototype.params=null;mxXmlRequest.prototype.method=null;mxXmlRequest.prototype.async=null;mxXmlRequest.prototype.username=null;mxXmlRequest.prototype.password=null;mxXmlRequest.prototype.request=null;mxXmlRequest.prototype.isReady=function(){return this.request.readyState==4;};mxXmlRequest.prototype.getDocumentElement=function(){var A=this.getXml();if(A!=null){return A.documentElement;}return null;};mxXmlRequest.prototype.getXml=function(){var A=this.request.responseXML;if(A==null||A.documentElement==null){A=mxUtils.parseXml(this.request.responseText);}return A;};mxXmlRequest.prototype.getText=function(){return this.request.responseText;};mxXmlRequest.prototype.getStatus=function(){return this.request.status;};mxXmlRequest.prototype.create=function(){if(window.XMLHttpRequest){return function(){return new XMLHttpRequest();};}else{if(typeof (ActiveXObject)!="undefined"){return function(){return new ActiveXObject("Microsoft.XMLHTTP");};}}}();mxXmlRequest.prototype.send=function(B,A){this.request=this.create();if(this.request!=null){this.request.onreadystatechange=mxUtils.bind(this,function(){if(this.isReady()){if(B!=null){B(this);}}});this.request.open(this.method,this.url,this.async,this.username,this.password);this.setRequestHeaders(this.request,this.params);this.request.send(this.params);}};mxXmlRequest.prototype.setRequestHeaders=function(A,B){if(B!=null){A.setRequestHeader("Content-Type","application/x-www-form-urlencoded");}};mxXmlRequest.prototype.simulate=function(K,G){K=K||document;var D=null;if(K==document){D=window.onbeforeunload;window.onbeforeunload=null;}var B=K.createElement("form");B.setAttribute("method",this.method);B.setAttribute("action",this.url);if(G!=null){B.setAttribute("target",G);}B.style.display="none";B.style.visibility="hidden";var C=(this.params.indexOf("&")>0)?this.params.split("&"):this.params.split();for(var E=0;E<C.length;E++){var H=C[E].indexOf("=");if(H>0){var A=C[E].substring(0,H);var J=C[E].substring(H+1);var I=K.createElement("textarea");I.setAttribute("name",A);J=J.replace(/\n/g,"&#xa;");var F=K.createTextNode(J);I.appendChild(F);B.appendChild(I);}}K.body.appendChild(B);B.submit();K.body.removeChild(B);if(D!=null){window.onbeforeunload=D;}};var mxClipboard={STEPSIZE:10,insertCount:1,cells:null,isEmpty:function(){return mxClipboard.cells==null;},cut:function(B,A){A=mxClipboard.copy(B,A);mxClipboard.insertCount=0;mxClipboard.removeCells(B,A);return A;},removeCells:function(B,A){B.removeCells(A);},copy:function(C,B){B=B||C.getSelectionCells();var A=C.getExportableCells(B);mxClipboard.insertCount=1;mxClipboard.cells=C.cloneCells(A);return A;},paste:function(C){if(mxClipboard.cells!=null){var A=C.getImportableCells(mxClipboard.cells);var D=mxClipboard.insertCount*mxClipboard.STEPSIZE;var B=C.getDefaultParent();A=C.importCells(A,D,D,B);mxClipboard.insertCount++;C.setSelectionCells(A);}}};function mxWindow(G,E,H,F,B,I,C,J,D,A){if(E!=null){C=(C!=null)?C:true;this.content=E;this.init(H,F,B,I,A);this.installMaximizeHandler();this.installMinimizeHandler();this.installCloseHandler();this.setMinimizable(C);mxUtils.write(this.title,G||"");if(J==null||J){this.installMoveHandler();}if(D!=null&&D.parentNode!=null){D.parentNode.replaceChild(this.div,D);}else{document.body.appendChild(this.div);}}}mxWindow.prototype=new mxEventSource();mxWindow.prototype.constructor=mxWindow;mxWindow.prototype.closeImage=mxClient.imageBasePath+"/close.gif";mxWindow.prototype.minimizeImage=mxClient.imageBasePath+"/minimize.gif";mxWindow.prototype.normalizeImage=mxClient.imageBasePath+"/normalize.gif";mxWindow.prototype.maximizeImage=mxClient.imageBasePath+"/maximize.gif";mxWindow.prototype.resizeImage=mxClient.imageBasePath+"/resize.gif";mxWindow.prototype.visible=false;mxWindow.prototype.content=false;mxWindow.prototype.minimumSize=new mxRectangle(0,0,50,40);mxWindow.prototype.content=false;mxWindow.prototype.destroyOnClose=true;mxWindow.prototype.init=function(B,H,E,A,D){D=(D!=null)?D:"mxWindow";this.div=document.createElement("div");this.div.className=D;this.div.style.left=B+"px";this.div.style.top=H+"px";if(!false&&mxClient.WINDOW_SHADOWS){this.shadow=document.createElement("div");this.shadow.style.background=mxConstants.SHADOWCOLOR;mxUtils.setOpacity(this.shadow,70);this.shadow.style.position="absolute";this.shadow.style.display="inline";}else{if(false&&!mxClient.WINDOW_SHADOWS){this.div.style.filter="";}}this.table=document.createElement("table");this.table.className=D;if(E!=null){if(!false){this.div.style.width=E+"px";}this.table.style.width=E+"px";}if(A!=null){if(!false){this.div.style.height=A+"px";}this.table.style.height=A+"px";}var C=document.createElement("tbody");var G=document.createElement("tr");this.title=document.createElement("td");this.title.className=D+"Title";G.appendChild(this.title);C.appendChild(G);G=document.createElement("tr");this.td=document.createElement("td");this.td.className=D+"Pane";this.contentWrapper=document.createElement("div");this.contentWrapper.className=D+"Pane";this.contentWrapper.style.width="100%";this.contentWrapper.appendChild(this.content);if(false||this.content.nodeName.toUpperCase()!="DIV"){this.contentWrapper.style.height="100%";}this.td.appendChild(this.contentWrapper);G.appendChild(this.td);C.appendChild(G);this.table.appendChild(C);this.div.appendChild(this.table);var F=mxUtils.bind(this,function(I){this.activate();});mxEvent.addListener(this.title,"mousedown",F);mxEvent.addListener(this.table,"mousedown",F);if(this.shadow!=null){mxEvent.addListener(this.div,"DOMNodeInserted",mxUtils.bind(this,function(I){var J=mxEvent.getSource(I);var K=mxUtils.bind(this,function(L){mxEvent.removeListener(J,"load",K);this.updateShadow();});mxEvent.addListener(J,"load",K);this.updateShadow();}));}this.hide();};mxWindow.prototype.setScrollable=function(A){if(navigator.userAgent.indexOf("Presto/2.5")<0){if(A){this.contentWrapper.style.overflow="auto";}else{this.contentWrapper.style.overflow="hidden";}}};mxWindow.prototype.updateShadow=function(){if(this.shadow!=null){this.shadow.style.visibility=this.div.style.visibility;this.shadow.style.left=(parseInt(this.div.style.left)+3)+"px";this.shadow.style.top=(parseInt(this.div.style.top)+3)+"px";this.shadow.style.width=this.div.offsetWidth+"px";this.shadow.style.height=this.div.offsetHeight+"px";if(this.shadow.parentNode!=this.div.parentNode){this.div.parentNode.appendChild(this.shadow);}}};mxWindow.prototype.activate=function(){if(mxWindow.activeWindow!=this){var D=mxUtils.getCurrentStyle(this.getElement());var B=(D!=null)?D.zIndex:3;if(mxWindow.activeWindow){var A=mxWindow.activeWindow.getElement();if(A!=null&&A.style!=null){A.style.zIndex=B;}}var C=mxWindow.activeWindow;this.getElement().style.zIndex=B+1;mxWindow.activeWindow=this;this.fireEvent(new mxEventObject(mxEvent.ACTIVATE,"previousWindow",C));}};mxWindow.prototype.getElement=function(){return this.div;};mxWindow.prototype.fit=function(){mxUtils.fit(this.div);};mxWindow.prototype.isResizable=function(){if(this.resize!=null){return this.resize.style.display!="none";}return false;};mxWindow.prototype.setResizable=function(B){if(B){if(this.resize==null){this.resize=document.createElement("img");this.resize.style.position="absolute";this.resize.style.bottom="2px";this.resize.style.right="2px";this.resize.setAttribute("src",mxClient.imageBasePath+"/resize.gif");this.resize.style.cursor="nw-resize";var C=(mxClient.IS_TOUCH)?"touchstart":"mousedown";var D=(mxClient.IS_TOUCH)?"touchmove":"mousemove";var A=(mxClient.IS_TOUCH)?"touchend":"mouseup";mxEvent.addListener(this.resize,C,mxUtils.bind(this,function(H){this.activate();var G=H.clientX;var F=H.clientY;var K=this.div.offsetWidth;var E=this.div.offsetHeight;var J=mxUtils.bind(this,function(M){var N=M.clientX-G;var L=M.clientY-F;this.setSize(K+N,E+L);this.updateShadow();this.fireEvent(new mxEventObject(mxEvent.RESIZE,"event",M));mxEvent.consume(M);});var I=mxUtils.bind(this,function(L){mxEvent.removeListener(document,D,J);mxEvent.removeListener(document,A,I);this.fireEvent(new mxEventObject(mxEvent.RESIZE_END,"event",L));mxEvent.consume(L);});mxEvent.addListener(document,D,J);mxEvent.addListener(document,A,I);this.fireEvent(new mxEventObject(mxEvent.RESIZE_START,"event",H));mxEvent.consume(H);}));this.div.appendChild(this.resize);}else{this.resize.style.display="inline";}}else{if(this.resize!=null){this.resize.style.display="none";}}};mxWindow.prototype.setSize=function(B,A){B=Math.max(this.minimumSize.width,B);A=Math.max(this.minimumSize.height,A);if(!false){this.div.style.width=B+"px";this.div.style.height=A+"px";}this.table.style.width=B+"px";this.table.style.height=A+"px";if(!false){this.contentWrapper.style.height=(this.div.offsetHeight-this.title.offsetHeight-2)+"px";}};mxWindow.prototype.setMinimizable=function(A){this.minimize.style.display=(A)?"":"none";};mxWindow.prototype.installMinimizeHandler=function(){this.minimize=document.createElement("img");this.minimize.setAttribute("src",this.minimizeImage);this.minimize.setAttribute("align","right");this.minimize.setAttribute("title","Minimize");this.minimize.style.cursor="pointer";this.minimize.style.marginRight="1px";this.minimize.style.display="none";this.title.appendChild(this.minimize);var C=false;var D=null;var A=null;var B=mxUtils.bind(this,function(E){this.activate();if(!C){C=true;this.minimize.setAttribute("src",this.normalizeImage);this.minimize.setAttribute("title","Normalize");this.contentWrapper.style.display="none";D=this.maximize.style.display;this.maximize.style.display="none";A=this.table.style.height;if(!false){this.div.style.height=this.title.offsetHeight+"px";}this.table.style.height=this.title.offsetHeight+"px";if(this.resize!=null){this.resize.style.visibility="hidden";}this.updateShadow();this.fireEvent(new mxEventObject(mxEvent.MINIMIZE,"event",E));}else{C=false;this.minimize.setAttribute("src",this.minimizeImage);this.minimize.setAttribute("title","Minimize");this.contentWrapper.style.display="";this.maximize.style.display=D;if(!false){this.div.style.height=A;}this.table.style.height=A;if(this.resize!=null){this.resize.style.visibility="";}this.updateShadow();this.fireEvent(new mxEventObject(mxEvent.NORMALIZE,"event",E));}mxEvent.consume(E);});mxEvent.addListener(this.minimize,"mousedown",B);};mxWindow.prototype.setMaximizable=function(A){this.maximize.style.display=(A)?"":"none";};mxWindow.prototype.installMaximizeHandler=function(){this.maximize=document.createElement("img");this.maximize.setAttribute("src",this.maximizeImage);this.maximize.setAttribute("align","right");this.maximize.setAttribute("title","Maximize");this.maximize.style.cursor="default";this.maximize.style.marginLeft="1px";this.maximize.style.cursor="pointer";this.maximize.style.display="none";this.title.appendChild(this.maximize);var D=false;var B=null;var F=null;var A=null;var E=null;var C=mxUtils.bind(this,function(G){this.activate();if(this.maximize.style.display!="none"){if(!D){D=true;this.maximize.setAttribute("src",this.normalizeImage);this.maximize.setAttribute("title","Normalize");this.contentWrapper.style.display="";this.minimize.style.visibility="hidden";B=parseInt(this.div.style.left);F=parseInt(this.div.style.top);A=this.table.style.height;E=this.table.style.width;this.div.style.left="0px";this.div.style.top="0px";if(!false){this.div.style.height=(document.body.clientHeight-2)+"px";this.div.style.width=(document.body.clientWidth-2)+"px";}this.table.style.width=(document.body.clientWidth-2)+"px";this.table.style.height=(document.body.clientHeight-2)+"px";if(this.resize!=null){this.resize.style.visibility="hidden";}if(this.shadow!=null){this.shadow.style.visibility="none";}if(!false){var H=mxUtils.getCurrentStyle(this.contentWrapper);if(H.overflow=="auto"||this.resize!=null){this.contentWrapper.style.height=(this.div.offsetHeight-this.title.offsetHeight-2)+"px";}}this.fireEvent(new mxEventObject(mxEvent.MAXIMIZE,"event",G));}else{D=false;this.maximize.setAttribute("src",this.maximizeImage);this.maximize.setAttribute("title","Maximize");this.contentWrapper.style.display="";this.minimize.style.visibility="";this.div.style.left=B+"px";this.div.style.top=F+"px";if(!false){this.div.style.height=A;this.div.style.width=E;var H=mxUtils.getCurrentStyle(this.contentWrapper);if(H.overflow=="auto"||this.resize!=null){this.contentWrapper.style.height=(this.div.offsetHeight-this.title.offsetHeight-2)+"px";}}this.table.style.height=A;this.table.style.width=E;if(this.resize!=null){this.resize.style.visibility="";}this.updateShadow();this.fireEvent(new mxEventObject(mxEvent.NORMALIZE,"event",G));}mxEvent.consume(G);}});mxEvent.addListener(this.maximize,"mousedown",C);mxEvent.addListener(this.title,"dblclick",C);};mxWindow.prototype.installMoveHandler=function(){this.title.style.cursor="move";var B=(mxClient.IS_TOUCH)?"touchstart":"mousedown";var C=(mxClient.IS_TOUCH)?"touchmove":"mousemove";var A=(mxClient.IS_TOUCH)?"touchend":"mouseup";mxEvent.addListener(this.title,B,mxUtils.bind(this,function(G){var F=G.clientX;var E=G.clientY;var D=this.getX();var J=this.getY();var I=mxUtils.bind(this,function(L){var M=L.clientX-F;var K=L.clientY-E;this.setLocation(D+M,J+K);this.fireEvent(new mxEventObject(mxEvent.MOVE,"event",L));mxEvent.consume(L);});var H=mxUtils.bind(this,function(K){mxEvent.removeListener(document,C,I);mxEvent.removeListener(document,A,H);this.fireEvent(new mxEventObject(mxEvent.MOVE_END,"event",K));mxEvent.consume(K);});mxEvent.addListener(document,C,I);mxEvent.addListener(document,A,H);this.fireEvent(new mxEventObject(mxEvent.MOVE_START,"event",G));mxEvent.consume(G);}));};mxWindow.prototype.setLocation=function(A,B){this.div.style.left=A+"px";this.div.style.top=B+"px";this.updateShadow();};mxWindow.prototype.getX=function(){return parseInt(this.div.style.left);};mxWindow.prototype.getY=function(){return parseInt(this.div.style.top);};mxWindow.prototype.installCloseHandler=function(){this.closeImg=document.createElement("img");this.closeImg.setAttribute("src",this.closeImage);this.closeImg.setAttribute("align","right");this.closeImg.setAttribute("title","Close");this.closeImg.style.marginLeft="2px";this.closeImg.style.cursor="pointer";this.closeImg.style.display="none";this.title.insertBefore(this.closeImg,this.title.firstChild);mxEvent.addListener(this.closeImg,"mousedown",mxUtils.bind(this,function(A){this.fireEvent(new mxEventObject(mxEvent.CLOSE,"event",A));if(this.destroyOnClose){this.destroy();}else{this.setVisible(false);}mxEvent.consume(A);}));};mxWindow.prototype.setImage=function(A){this.image=document.createElement("img");this.image.setAttribute("src",A);this.image.setAttribute("align","left");this.image.style.marginRight="4px";this.image.style.marginLeft="0px";this.image.style.marginTop="-2px";this.title.insertBefore(this.image,this.title.firstChild);};mxWindow.prototype.setClosable=function(A){this.closeImg.style.display=(A)?"":"none";};mxWindow.prototype.isVisible=function(){if(this.div!=null){return this.div.style.visibility!="hidden";}return false;};mxWindow.prototype.setVisible=function(A){if(this.div!=null&&this.isVisible()!=A){if(A){this.show();}else{this.hide();}}this.updateShadow();};mxWindow.prototype.show=function(){this.div.style.visibility="";this.activate();var A=mxUtils.getCurrentStyle(this.contentWrapper);if(!false&&(A.overflow=="auto"||this.resize!=null)){this.contentWrapper.style.height=(this.div.offsetHeight-this.title.offsetHeight-2)+"px";}this.fireEvent(new mxEventObject(mxEvent.SHOW));};mxWindow.prototype.hide=function(){this.div.style.visibility="hidden";this.fireEvent(new mxEventObject(mxEvent.HIDE));};mxWindow.prototype.destroy=function(){this.fireEvent(new mxEventObject(mxEvent.DESTROY));if(this.div!=null){mxEvent.release(this.div);this.div.parentNode.removeChild(this.div);this.div=null;}if(this.shadow!=null){this.shadow.parentNode.removeChild(this.shadow);this.shadow=null;}this.title=null;this.content=null;this.contentWrapper=null;};function mxForm(A){this.table=document.createElement("table");this.table.className=A;this.body=document.createElement("tbody");this.table.appendChild(this.body);}mxForm.prototype.table=null;mxForm.prototype.body=false;mxForm.prototype.getTable=function(){return this.table;};mxForm.prototype.addButtons=function(C,E){var B=document.createElement("tr");var D=document.createElement("td");B.appendChild(D);D=document.createElement("td");var A=document.createElement("button");mxUtils.write(A,mxResources.get("ok")||"OK");D.appendChild(A);mxEvent.addListener(A,"click",function(){C();});A=document.createElement("button");mxUtils.write(A,mxResources.get("cancel")||"Cancel");D.appendChild(A);mxEvent.addListener(A,"click",function(){E();});B.appendChild(D);this.body.appendChild(B);};mxForm.prototype.addText=function(B,C){var A=document.createElement("input");A.setAttribute("type","text");A.value=C;return this.addField(B,A);};mxForm.prototype.addCheckbox=function(B,C){var A=document.createElement("input");A.setAttribute("type","checkbox");this.addField(B,A);if(C){A.checked=true;}return A;};mxForm.prototype.addTextarea=function(B,D,C){var A=document.createElement("textarea");if(true){C--;}A.setAttribute("rows",C||2);A.value=D;return this.addField(B,A);};mxForm.prototype.addCombo=function(B,D,C){var A=document.createElement("select");if(C!=null){A.setAttribute("size",C);}if(D){A.setAttribute("multiple","true");}return this.addField(B,A);};mxForm.prototype.addOption=function(E,B,D,A){var C=document.createElement("option");mxUtils.writeln(C,B);C.setAttribute("value",D);if(A){C.setAttribute("selected",A);}E.appendChild(C);};mxForm.prototype.addField=function(B,A){var C=document.createElement("tr");var D=document.createElement("td");mxUtils.write(D,B);C.appendChild(D);D=document.createElement("td");D.appendChild(A);C.appendChild(D);this.body.appendChild(C);return A;};function mxImage(C,B,A){this.src=C;this.width=B;this.height=A;}mxImage.prototype.src=null;mxImage.prototype.width=null;mxImage.prototype.height=null;function mxDivResizer(C,A){if(C.nodeName.toLowerCase()=="div"){if(A==null){A=window;}this.div=C;var B=mxUtils.getCurrentStyle(C);if(B!=null){this.resizeWidth=B.width=="auto";this.resizeHeight=B.height=="auto";}mxEvent.addListener(A,"resize",mxUtils.bind(this,function(D){if(!this.handlingResize){this.handlingResize=true;this.resize();this.handlingResize=false;}}));this.resize();}}mxDivResizer.prototype.resizeWidth=true;mxDivResizer.prototype.resizeHeight=true;mxDivResizer.prototype.handlingResize=false;mxDivResizer.prototype.resize=function(){var C=this.getDocumentWidth();var E=this.getDocumentHeight();var B=parseInt(this.div.style.left);var F=parseInt(this.div.style.right);var D=parseInt(this.div.style.top);var A=parseInt(this.div.style.bottom);if(this.resizeWidth&&!isNaN(B)&&!isNaN(F)&&B>=0&&F>=0&&C-F-B>0){this.div.style.width=(C-F-B)+"px";}if(this.resizeHeight&&!isNaN(D)&&!isNaN(A)&&D>=0&&A>=0&&E-D-A>0){this.div.style.height=(E-D-A)+"px";}};mxDivResizer.prototype.getDocumentWidth=function(){return document.body.clientWidth;};mxDivResizer.prototype.getDocumentHeight=function(){return document.body.clientHeight;};function mxToolbar(A){this.container=A;}mxToolbar.prototype=new mxEventSource();mxToolbar.prototype.constructor=mxToolbar;mxToolbar.prototype.container=null;mxToolbar.prototype.enabled=true;mxToolbar.prototype.noReset=false;mxToolbar.prototype.updateDefaultMode=true;mxToolbar.prototype.addItem=function(I,H,A,E,B,C){var F=document.createElement((H!=null)?"img":"button");var D=B||((C!=null)?"mxToolbarMode":"mxToolbarItem");F.className=D;F.setAttribute("src",H);if(I!=null){if(H!=null){F.setAttribute("title",I);}else{mxUtils.write(F,I);}}this.container.appendChild(F);if(A!=null){mxEvent.addListener(F,"click",A);}mxEvent.addListener(F,"mousedown",mxUtils.bind(this,function(K){if(E!=null){F.setAttribute("src",E);}else{F.style.backgroundColor="gray";}if(C!=null){if(this.menu==null){this.menu=new mxPopupMenu();this.menu.init();}var L=this.currentImg;if(this.menu.isMenuShowing()){this.menu.hideMenu();}if(L!=F){this.currentImg=F;this.menu.factoryMethod=C;var J=new mxPoint(F.offsetLeft,F.offsetTop+F.offsetHeight);this.menu.popup(J.x,J.y,null,K);if(this.menu.isMenuShowing()){F.className=D+"Selected";this.menu.hideMenu=function(){mxPopupMenu.prototype.hideMenu.apply(this);F.className=D;this.currentImg=null;};}}}}));var G=mxUtils.bind(this,function(J){if(E!=null){F.setAttribute("src",H);}else{F.style.backgroundColor="";}});mxEvent.addListener(F,"mouseup",G);mxEvent.addListener(F,"mouseout",G);return F;};mxToolbar.prototype.addCombo=function(B){var C=document.createElement("div");C.style.display="inline";C.className="mxToolbarComboContainer";var A=document.createElement("select");A.className=B||"mxToolbarCombo";C.appendChild(A);this.container.appendChild(C);return A;};mxToolbar.prototype.addActionCombo=function(C,B){var A=document.createElement("select");A.className=B||"mxToolbarCombo";this.addOption(A,C,null);mxEvent.addListener(A,"change",function(D){var E=A.options[A.selectedIndex];A.selectedIndex=0;if(E.funct!=null){E.funct(D);}});this.container.appendChild(A);return A;};mxToolbar.prototype.addOption=function(C,D,B){var A=document.createElement("option");mxUtils.writeln(A,D);if(typeof (B)=="function"){A.funct=B;}else{A.setAttribute("value",B);}C.appendChild(A);return A;};mxToolbar.prototype.addSwitchMode=function(G,F,A,E,D){var B=document.createElement("img");B.initialClassName=D||"mxToolbarMode";B.className=B.initialClassName;B.setAttribute("src",F);B.altIcon=E;if(G!=null){B.setAttribute("title",G);}mxEvent.addListener(B,"click",mxUtils.bind(this,function(H){var I=this.selectedMode.altIcon;if(I!=null){this.selectedMode.altIcon=this.selectedMode.getAttribute("src");this.selectedMode.setAttribute("src",I);}else{this.selectedMode.className=this.selectedMode.initialClassName;}if(this.updateDefaultMode){this.defaultMode=B;}this.selectedMode=B;var I=B.altIcon;if(I!=null){B.altIcon=B.getAttribute("src");B.setAttribute("src",I);}else{B.className=B.initialClassName+"Selected";}this.fireEvent(new mxEventObject(mxEvent.SELECT));A();}));this.container.appendChild(B);if(this.defaultMode==null){this.defaultMode=B;this.selectedMode=B;var C=B.altIcon;if(C!=null){B.altIcon=B.getAttribute("src");B.setAttribute("src",C);}else{B.className=B.initialClassName+"Selected";}A();}return B;};mxToolbar.prototype.addMode=function(G,F,A,E,D){var B=document.createElement((F!=null)?"img":"button");B.initialClassName=D||"mxToolbarMode";B.className=B.initialClassName;B.setAttribute("src",F);B.altIcon=E;if(G!=null){B.setAttribute("title",G);}if(this.enabled){mxEvent.addListener(B,"click",mxUtils.bind(this,function(H){this.selectMode(B,A);this.noReset=false;}));mxEvent.addListener(B,"dblclick",mxUtils.bind(this,function(H){this.selectMode(B,A);this.noReset=true;}));if(this.defaultMode==null){this.defaultMode=B;this.selectedMode=B;var C=B.altIcon;if(C!=null){B.altIcon=B.getAttribute("src");B.setAttribute("src",C);}else{B.className=B.initialClassName+"Selected";}}}this.container.appendChild(B);return B;};mxToolbar.prototype.selectMode=function(C,A){if(this.selectedMode!=C){var B=this.selectedMode.altIcon;if(B!=null){this.selectedMode.altIcon=this.selectedMode.getAttribute("src");this.selectedMode.setAttribute("src",B);}else{this.selectedMode.className=this.selectedMode.initialClassName;}this.selectedMode=C;var B=this.selectedMode.altIcon;if(B!=null){this.selectedMode.altIcon=this.selectedMode.getAttribute("src");this.selectedMode.setAttribute("src",B);}else{this.selectedMode.className=this.selectedMode.initialClassName+"Selected";}this.fireEvent(new mxEventObject(mxEvent.SELECT,"function",A));}};mxToolbar.prototype.resetMode=function(A){if((A||!this.noReset)&&this.selectedMode!=this.defaultMode){this.selectMode(this.defaultMode,null);}};mxToolbar.prototype.addSeparator=function(A){return this.addItem(null,A,null);};mxToolbar.prototype.addBreak=function(){mxUtils.br(this.container);};mxToolbar.prototype.addLine=function(){var A=document.createElement("hr");A.style.marginRight="6px";A.setAttribute("size","1");this.container.appendChild(A);};mxToolbar.prototype.destroy=function(){mxEvent.release(this.container);this.container=null;this.defaultMode=null;this.selectedMode=null;if(this.menu!=null){this.menu.destroy();}};function mxSession(C,B,A,D){this.model=C;this.urlInit=B;this.urlPoll=A;this.urlNotify=D;if(C!=null){this.codec=new mxCodec();this.codec.lookup=function(E){return C.getCell(E);};}C.addListener(mxEvent.NOTIFY,mxUtils.bind(this,function(F,E){var G=E.getProperty("changes");if(G!=null&&this.debug||(this.connected&&!this.suspended)){this.notify(this.encodeChanges(G));}}));}mxSession.prototype=new mxEventSource();mxSession.prototype.constructor=mxSession;mxSession.prototype.model=null;mxSession.prototype.urlInit=null;mxSession.prototype.urlPoll=null;mxSession.prototype.urlNotify=null;mxSession.prototype.codec=null;mxSession.prototype.linefeed="&#xa;";mxSession.prototype.escapePostData=true;mxSession.prototype.significantRemoteChanges=true;mxSession.prototype.sent=0;mxSession.prototype.received=0;mxSession.prototype.debug=false;mxSession.prototype.connected=false;mxSession.prototype.suspended=false;mxSession.prototype.polling=false;mxSession.prototype.start=function(){if(this.debug){this.connected=true;this.fireEvent(new mxEventObject(mxEvent.CONNECT));}else{if(!this.connected){this.get(this.urlInit,mxUtils.bind(this,function(A){this.connected=true;this.fireEvent(new mxEventObject(mxEvent.CONNECT));this.poll();}));}}};mxSession.prototype.suspend=function(){if(this.connected&&!this.suspended){this.suspended=true;this.fireEvent(new mxEventObject(mxEvent.SUSPEND));}};mxSession.prototype.resume=function(B,A,C){if(this.connected&&this.suspended){this.suspended=false;this.fireEvent(new mxEventObject(mxEvent.RESUME));if(!this.polling){this.poll();}}};mxSession.prototype.stop=function(A){if(this.connected){this.connected=false;}this.fireEvent(new mxEventObject(mxEvent.DISCONNECT,"reason",A));};mxSession.prototype.poll=function(){if(this.connected&&!this.suspended&&this.urlPoll!=null){this.polling=true;this.get(this.urlPoll,mxUtils.bind(this,function(){this.poll();}));}else{this.polling=false;}};mxSession.prototype.notify=function(A,B,C){if(A!=null&&A.length>0){if(this.urlNotify!=null){if(this.debug){mxLog.show();mxLog.debug("mxSession.notify: "+this.urlNotify+" xml="+A);}else{if(this.escapePostData){A=encodeURIComponent(A);}mxUtils.post(this.urlNotify,"xml="+A,B,C);}}this.sent+=A.length;this.fireEvent(new mxEventObject(mxEvent.NOTIFY,"url",this.urlNotify,"xml",A));}};mxSession.prototype.get=function(B,C,E){if(typeof (mxUtils)!="undefined"){var A=mxUtils.bind(this,function(F){if(E!=null){E(F);}else{this.stop(F);}});var D=mxUtils.get(B,mxUtils.bind(this,function(H){if(typeof (mxUtils)!="undefined"){try{if(H.isReady()&&H.getStatus()!=404){this.received+=H.getText().length;this.fireEvent(new mxEventObject(mxEvent.GET,"url",B,"request",H));if(this.isValidResponse(H)){if(H.getText().length>0){var G=H.getDocumentElement();if(G==null){A("Invalid response: "+H.getText());}else{this.receive(G);}}if(C!=null){C(H);}}}else{A("Response not ready");}}catch(F){A(F);throw F;}}}),function(F){A("Transmission error");});}};mxSession.prototype.isValidResponse=function(A){return A.getText().indexOf("<?php")<0;};mxSession.prototype.encodeChanges=function(C){var A="";for(var B=0;B<C.length;B++){var D=this.codec.encode(C[B]);A+=mxUtils.getXml(D,this.linefeed);}return A;};mxSession.prototype.receive=function(F){if(F!=null&&F.nodeType==mxConstants.NODETYPE_ELEMENT){var B=F.nodeName.toLowerCase();if(B=="state"){var C=F.firstChild;while(C!=null){this.receive(C);C=C.nextSibling;}var A=F.getAttribute("namespace");this.model.prefix=A+"-";}else{if(B=="delta"){var D=this.decodeChanges(F);if(D.length>0){var E=this.createUndoableEdit(D);this.model.fireEvent(new mxEventObject(mxEvent.UNDO,"edit",E));this.model.fireEvent(new mxEventObject(mxEvent.CHANGE,"changes",D));this.fireEvent(new mxEventObject(mxEvent.FIRED,"changes",D));}}}this.fireEvent(new mxEventObject(mxEvent.RECEIVE,"node",F));}};mxSession.prototype.createUndoableEdit=function(A){var B=new mxUndoableEdit(this.model,this.significantRemoteChanges);B.changes=A;B.notify=function(){B.source.fireEvent(new mxEventObject(mxEvent.CHANGE,"changes",B.changes));B.source.fireEvent(new mxEventObject(mxEvent.NOTIFY,"changes",B.changes));};return B;};mxSession.prototype.decodeChanges=function(B){this.codec.document=B.ownerDocument;var A=[];B=B.firstChild;while(B!=null){if(B.nodeType==mxConstants.NODETYPE_ELEMENT){var D=null;if(B.nodeName=="mxRootChange"){var C=new mxCodec(B.ownerDocument);D=C.decode(B);}else{D=this.codec.decode(B);}if(D!=null){D.model=this.model;D.execute();A.push(D);}}B=B.nextSibling;}return A;};function mxUndoableEdit(B,A){this.source=B;this.changes=[];this.significant=(A!=null)?A:true;}mxUndoableEdit.prototype.source=null;mxUndoableEdit.prototype.changes=null;mxUndoableEdit.prototype.significant=null;mxUndoableEdit.prototype.undone=false;mxUndoableEdit.prototype.redone=false;mxUndoableEdit.prototype.isEmpty=function(){return this.changes.length==0;};mxUndoableEdit.prototype.isSignificant=function(){return this.significant;};mxUndoableEdit.prototype.add=function(A){this.changes.push(A);};mxUndoableEdit.prototype.notify=function(){};mxUndoableEdit.prototype.die=function(){};mxUndoableEdit.prototype.undo=function(){if(!this.undone){var B=this.changes.length;for(var A=B-1;A>=0;A--){var C=this.changes[A];if(C.execute!=null){C.execute();}else{if(C.undo!=null){C.undo();}}}this.undone=true;this.redone=false;}this.notify();};mxUndoableEdit.prototype.redo=function(){if(!this.redone){var B=this.changes.length;for(var A=0;A<B;A++){var C=this.changes[A];if(C.execute!=null){C.execute();}else{if(C.redo!=null){C.redo();}}}this.undone=false;this.redone=true;}this.notify();};function mxUndoManager(A){this.size=A||100;this.clear();}mxUndoManager.prototype=new mxEventSource();mxUndoManager.prototype.constructor=mxUndoManager;mxUndoManager.prototype.size=null;mxUndoManager.prototype.history=null;mxUndoManager.prototype.indexOfNextAdd=0;mxUndoManager.prototype.isEmpty=function(){return this.history.length==0;};mxUndoManager.prototype.clear=function(){this.history=[];this.indexOfNextAdd=0;this.fireEvent(new mxEventObject(mxEvent.CLEAR));};mxUndoManager.prototype.canUndo=function(){return this.indexOfNextAdd>0;};mxUndoManager.prototype.undo=function(){while(this.indexOfNextAdd>0){var A=this.history[--this.indexOfNextAdd];A.undo();if(A.isSignificant()){this.fireEvent(new mxEventObject(mxEvent.UNDO,"edit",A));break;}}};mxUndoManager.prototype.canRedo=function(){return this.indexOfNextAdd<this.history.length;};mxUndoManager.prototype.redo=function(){var B=this.history.length;while(this.indexOfNextAdd<B){var A=this.history[this.indexOfNextAdd++];A.redo();if(A.isSignificant()){this.fireEvent(new mxEventObject(mxEvent.REDO,"edit",A));break;}}};mxUndoManager.prototype.undoableEditHappened=function(A){this.trim();if(this.size>0&&this.size==this.history.length){this.history.shift();}this.history.push(A);this.indexOfNextAdd=this.history.length;this.fireEvent(new mxEventObject(mxEvent.ADD,"edit",A));};mxUndoManager.prototype.trim=function(){if(this.history.length>this.indexOfNextAdd){var A=this.history.splice(this.indexOfNextAdd,this.history.length-this.indexOfNextAdd);for(var B=0;B<A.length;B++){A[B].die();}}};function mxPath(A){this.format=A;this.path=[];this.translate=new mxPoint(0,0);}mxPath.prototype.format=null;mxPath.prototype.translate=null;mxPath.prototype.path=null;mxPath.prototype.isVml=function(){return this.format=="vml";};mxPath.prototype.getPath=function(){return this.path.join("");};mxPath.prototype.setTranslate=function(A,B){this.translate=new mxPoint(A,B);};mxPath.prototype.moveTo=function(A,B){if(this.isVml()){this.path.push("m ",Math.floor(this.translate.x+A)," ",Math.floor(this.translate.y+B)," ");}else{this.path.push("M ",Math.floor(this.translate.x+A)," ",Math.floor(this.translate.y+B)," ");}};mxPath.prototype.lineTo=function(A,B){if(this.isVml()){this.path.push("l ",Math.floor(this.translate.x+A)," ",Math.floor(this.translate.y+B)," ");}else{this.path.push("L ",Math.floor(this.translate.x+A)," ",Math.floor(this.translate.y+B)," ");}};mxPath.prototype.quadTo=function(B,C,A,D){if(this.isVml()){this.path.push("qb ",Math.floor(this.translate.x+B)," ",Math.floor(this.translate.y+C)," ",Math.floor(this.translate.x+A)," ",Math.floor(this.translate.y+D)," l ",Math.floor(this.translate.x+A)," ",Math.floor(this.translate.y+D)," ");}else{this.path.push("Q ",(this.translate.x+B)," ",(this.translate.y+C)," ",(this.translate.x+A)," ",(this.translate.y+D)," ");}};mxPath.prototype.curveTo=function(C,E,B,D,A,F){if(this.isVml()){this.path.push("c ",Math.floor(this.translate.x+C)," ",Math.floor(this.translate.y+E)," ",Math.floor(this.translate.x+B)," ",Math.floor(this.translate.y+D)," ",Math.floor(this.translate.x+A)," ",Math.floor(this.translate.y+F)," ");}else{this.path.push("C ",(this.translate.x+C)," ",(this.translate.y+E)," ",(this.translate.x+B)," ",(this.translate.y+D)," ",(this.translate.x+A)," ",(this.translate.y+F)," ");}};mxPath.prototype.write=function(A){this.path.push(A," ");};mxPath.prototype.end=function(){if(this.format=="vml"){this.path.push("e");}};mxPath.prototype.close=function(){if(this.format=="vml"){this.path.push("x e");}else{this.path.push("Z");}};function mxPopupMenu(A){this.factoryMethod=A;}mxPopupMenu.prototype.submenuImage=mxClient.imageBasePath+"/submenu.gif";mxPopupMenu.prototype.zIndex=10006;mxPopupMenu.prototype.factoryMethod=true;mxPopupMenu.prototype.useLeftButtonForPopup=false;mxPopupMenu.prototype.enabled=true;mxPopupMenu.prototype.itemCount=0;mxPopupMenu.prototype.init=function(){this.table=document.createElement("table");this.table.className="mxPopupMenu";this.tbody=document.createElement("tbody");this.table.appendChild(this.tbody);this.div=document.createElement("div");this.div.className="mxPopupMenu";this.div.style.display="inline";this.div.style.zIndex=this.zIndex;this.div.appendChild(this.table);if(!false&&mxClient.MENU_SHADOWS){this.shadow=document.createElement("div");this.shadow.className="mxPopupMenuShadow";this.shadow.style.zIndex=this.zIndex-1;mxUtils.setOpacity(this.shadow,70);}else{if(false&&!mxClient.MENU_SHADOWS){this.div.style.filter="";}}mxEvent.disableContextMenu(this.div);};mxPopupMenu.prototype.isEnabled=function(){return this.enabled;};mxPopupMenu.prototype.setEnabled=function(A){this.enabled=A;};mxPopupMenu.prototype.isPopupTrigger=function(A){return A.isPopupTrigger()||(this.useLeftButtonForPopup&&mxEvent.isLeftMouseButton(A.getEvent()));};mxPopupMenu.prototype.addItem=function(J,B,A,K){K=K||this;this.itemCount++;var H=document.createElement("tr");H.className="mxPopupMenuItem";var G=document.createElement("td");G.className="mxPopupMenuIcon";if(B!=null){var D=document.createElement("img");if(!false){if(this.loading==null){this.loading=0;}this.loading++;var L=mxUtils.bind(this,function(){mxEvent.removeListener(D,"load",L);this.loading--;if(this.loading==0){this.showShadow();}});mxEvent.addListener(D,"load",L);}D.src=B;G.appendChild(D);}H.appendChild(G);var F=document.createElement("td");F.className="mxPopupMenuItem";mxUtils.write(F,J);F.align="left";H.appendChild(F);var E=document.createElement("td");E.style.width="10px";E.style.paddingRight="6px";H.appendChild(E);if(K.div==null){this.createSubmenu(K);}K.tbody.appendChild(H);var I=(mxClient.IS_TOUCH)?"touchstart":"mousedown";var C=(mxClient.IS_TOUCH)?"touchmove":"mousemove";var M=(mxClient.IS_TOUCH)?"touchend":"mouseup";mxEvent.addListener(H,I,mxUtils.bind(this,function(N){this.eventReceiver=H;if(K.activeRow!=H&&K.activeRow!=K){if(K.activeRow!=null&&K.activeRow.div.parentNode!=null){this.hideSubmenu(K);}if(H.div!=null){this.showSubmenu(K,H);K.activeRow=H;}}mxEvent.consume(N);}));mxEvent.addListener(H,C,mxUtils.bind(this,function(N){if(K.activeRow!=H&&K.activeRow!=K){if(K.activeRow!=null&&K.activeRow.div.parentNode!=null){this.hideSubmenu(K);}}if(false){H.style.backgroundColor="#000066";H.style.color="white";}}));mxEvent.addListener(H,M,mxUtils.bind(this,function(N){if(this.eventReceiver==H){if(K.activeRow!=H){this.hideMenu();}if(A!=null){A(N);}}this.eventReceiver=null;mxEvent.consume(N);}));if(false){mxEvent.addListener(H,"mouseout",mxUtils.bind(this,function(N){H.style.backgroundColor="";H.style.color="";}));}return H;};mxPopupMenu.prototype.createSubmenu=function(B){B.table=document.createElement("table");B.table.className="mxPopupMenu";B.tbody=document.createElement("tbody");B.table.appendChild(B.tbody);B.div=document.createElement("div");B.div.className="mxPopupMenu";B.div.style.position="absolute";B.div.style.display="inline";B.div.appendChild(B.table);var A=document.createElement("img");A.setAttribute("src",this.submenuImage);td=B.firstChild.nextSibling.nextSibling;td.appendChild(A);};mxPopupMenu.prototype.showSubmenu=function(D,G){if(G.div!=null){G.div.style.left=(D.div.offsetLeft+G.offsetLeft+G.offsetWidth-1)+"px";G.div.style.top=(D.div.offsetTop+G.offsetTop)+"px";document.body.appendChild(G.div);var E=parseInt(G.div.offsetLeft);var C=parseInt(G.div.offsetWidth);var A=document.body;var F=document.documentElement;var B=(A.scrollLeft||F.scrollLeft)+(A.clientWidth||F.clientWidth);if(E+C>B){G.div.style.left=(D.div.offsetLeft-C+((false)?6:-6))+"px";}mxUtils.fit(G.div);}};mxPopupMenu.prototype.addSeparator=function(B){B=B||this;var D=document.createElement("tr");var E=document.createElement("td");E.className="mxPopupMenuIcon";E.style.padding="0 0 0 0px";D.appendChild(E);var C=document.createElement("td");C.style.padding="0 0 0 0px";C.setAttribute("colSpan","2");var A=document.createElement("hr");A.setAttribute("size","1");C.appendChild(A);D.appendChild(C);B.tbody.appendChild(D);};mxPopupMenu.prototype.popup=function(B,D,A,C){if(this.div!=null&&this.tbody!=null&&this.factoryMethod!=null){this.div.style.left=B+"px";this.div.style.top=D+"px";while(this.tbody.firstChild!=null){mxEvent.release(this.tbody.firstChild);this.tbody.removeChild(this.tbody.firstChild);}this.itemCount=0;this.factoryMethod(this,A,C);if(this.itemCount>0){this.showMenu();}}};mxPopupMenu.prototype.isMenuShowing=function(){return this.div!=null&&this.div.parentNode==document.body;};mxPopupMenu.prototype.showMenu=function(){document.body.appendChild(this.div);mxUtils.fit(this.div);if(this.shadow!=null){if(!this.loading){this.showShadow();}}};mxPopupMenu.prototype.showShadow=function(){if(this.shadow!=null&&this.div.parentNode==document.body){this.shadow.style.left=(parseInt(this.div.style.left)+3)+"px";this.shadow.style.top=(parseInt(this.div.style.top)+3)+"px";this.shadow.style.width=this.div.offsetWidth+"px";this.shadow.style.height=this.div.offsetHeight+"px";document.body.appendChild(this.shadow);}};mxPopupMenu.prototype.hideMenu=function(){if(this.div!=null){if(this.div.parentNode!=null){this.div.parentNode.removeChild(this.div);}if(this.shadow!=null){if(this.shadow.parentNode!=null){this.shadow.parentNode.removeChild(this.shadow);}}this.hideSubmenu(this);}};mxPopupMenu.prototype.hideSubmenu=function(A){if(A.activeRow!=null){this.hideSubmenu(A.activeRow);if(A.activeRow.div.parentNode!=null){A.activeRow.div.parentNode.removeChild(A.activeRow.div);}A.activeRow=null;}};mxPopupMenu.prototype.destroy=function(){if(this.div!=null){mxEvent.release(this.div);if(this.div.parentNode!=null){this.div.parentNode.removeChild(this.div);}this.div=null;}if(this.shadow!=null){mxEvent.release(this.shadow);if(this.shadow.parentNode!=null){this.shadow.parentNode.removeChild(this.shadow);}this.shadow=null;}};function mxAutoSaveManager(A){this.changeHandler=mxUtils.bind(this,function(C,B){if(this.isEnabled()){this.graphModelChanged(B.getProperty("changes"));}});this.setGraph(A);}mxAutoSaveManager.prototype=new mxEventSource();mxAutoSaveManager.prototype.constructor=mxAutoSaveManager;mxAutoSaveManager.prototype.graph=null;mxAutoSaveManager.prototype.autoSaveDelay=10;mxAutoSaveManager.prototype.autoSaveThrottle=2;mxAutoSaveManager.prototype.autoSaveThreshold=5;mxAutoSaveManager.prototype.ignoredChanges=0;mxAutoSaveManager.prototype.lastSnapshot=0;mxAutoSaveManager.prototype.enabled=true;mxAutoSaveManager.prototype.changeHandler=null;mxAutoSaveManager.prototype.isEnabled=function(){return this.enabled;};mxAutoSaveManager.prototype.setEnabled=function(A){this.enabled=A;};mxAutoSaveManager.prototype.setGraph=function(A){if(this.graph!=null){this.graph.getModel().removeListener(this.changeHandler);}this.graph=A;if(this.graph!=null){this.graph.getModel().addListener(mxEvent.CHANGE,this.changeHandler);}};mxAutoSaveManager.prototype.save=function(){};mxAutoSaveManager.prototype.graphModelChanged=function(B){var A=new Date().getTime();var C=(A-this.lastSnapshot)/1000;if(C>this.autoSaveDelay||(this.ignoredChanges>=this.autoSaveThreshold&&C>this.autoSaveThrottle)){this.save();this.reset();}else{this.ignoredChanges++;}};mxAutoSaveManager.prototype.reset=function(){this.lastSnapshot=new Date().getTime();this.ignoredChanges=0;};mxAutoSaveManager.prototype.destroy=function(){this.setGraph(null);};function mxAnimation(A){this.delay=(A!=null)?A:20;}mxAnimation.prototype=new mxEventSource();mxAnimation.prototype.constructor=mxAnimation;mxAnimation.prototype.delay=null;mxAnimation.prototype.thread=null;mxAnimation.prototype.startAnimation=function(){if(this.thread==null){this.thread=window.setInterval(mxUtils.bind(this,this.updateAnimation),this.delay);}};mxAnimation.prototype.updateAnimation=function(){this.fireEvent(new mxEventObject(mxEvent.EXECUTE));};mxAnimation.prototype.stopAnimation=function(){if(this.thread!=null){window.clearInterval(this.thread);this.thread=null;this.fireEvent(new mxEventObject(mxEvent.DONE));}};function mxMorphing(C,A,D,B){mxAnimation.call(this,B);this.graph=C;this.steps=(A!=null)?A:6;this.ease=(D!=null)?D:1.5;}mxMorphing.prototype=new mxAnimation();mxMorphing.prototype.constructor=mxMorphing;mxMorphing.prototype.graph=null;mxMorphing.prototype.steps=null;mxMorphing.prototype.step=0;mxMorphing.prototype.ease=null;mxMorphing.prototype.cells=null;mxMorphing.prototype.updateAnimation=function(){var A=new mxCellStatePreview(this.graph);if(this.cells!=null){for(var B=0;B<this.cells.length;B++){this.animateCell(cells[B],A,false);}}else{this.animateCell(this.graph.getModel().getRoot(),A,true);}this.show(A);if(A.isEmpty()||this.step++>=this.steps){this.stopAnimation();}};mxMorphing.prototype.show=function(A){A.show();};mxMorphing.prototype.animateCell=function(I,D,B){var A=this.graph.getView().getState(I);var H=null;if(A!=null){H=this.getDelta(A);if(this.graph.getModel().isVertex(I)&&(H.x!=0||H.y!=0)){var C=this.graph.view.getTranslate();var E=this.graph.view.getScale();H.x+=C.x*E;H.y+=C.y*E;D.moveState(A,-H.x/this.ease,-H.y/this.ease);}}if(B&&!this.stopRecursion(A,H)){var F=this.graph.getModel().getChildCount(I);for(var G=0;G<F;G++){this.animateCell(this.graph.getModel().getChildAt(I,G),D,B);}}};mxMorphing.prototype.stopRecursion=function(A,B){return B!=null&&(B.x!=0||B.y!=0);};mxMorphing.prototype.getDelta=function(B){var A=this.getOriginForCell(B.cell);var E=this.graph.getView().getTranslate();var D=this.graph.getView().getScale();var C=new mxPoint(B.x/D-E.x,B.y/D-E.y);return new mxPoint((A.x-C.x)*D,(A.y-C.y)*D);};mxMorphing.prototype.getOriginForCell=function(B){var A=null;if(B!=null){A=this.getOriginForCell(this.graph.getModel().getParent(B));var D=this.graph.getCellGeometry(B);if(D!=null){A.x+=D.x;A.y+=D.y;}}if(A==null){var C=this.graph.view.getTranslate();A=new mxPoint(-C.x,-C.y);}return A;};function mxShape(){}mxShape.prototype.SVG_STROKE_TOLERANCE=8;mxShape.prototype.scale=1;mxShape.prototype.dialect=null;mxShape.prototype.crisp=false;mxShape.prototype.mixedModeHtml=true;mxShape.prototype.preferModeHtml=true;mxShape.prototype.bounds=null;mxShape.prototype.points=null;mxShape.prototype.node=null;mxShape.prototype.label=null;mxShape.prototype.innerNode=null;mxShape.prototype.style=null;mxShape.prototype.startOffset=null;mxShape.prototype.endOffset=null;mxShape.prototype.init=function(A){if(this.node==null){this.node=this.create(A);if(A!=null){A.appendChild(this.node);}}this.redraw();if(this.insertGradientNode!=null){this.insertGradient(this.insertGradientNode);this.insertGradientNode=null;}};mxShape.prototype.insertGradient=function(D){if(D!=null){var C=0;var F=D.getAttribute("id");var E=document.getElementById(F);while(E!=null&&E.ownerSVGElement!=this.node.ownerSVGElement){C++;F=D.getAttribute("id")+"-"+C;E=document.getElementById(F);}if(E==null){D.setAttribute("id",F);this.node.ownerSVGElement.appendChild(D);E=D;}if(E!=null){var B="url(#"+F+")";var A=(this.innerNode!=null)?this.innerNode:this.node;if(A!=null&&A.getAttribute("fill")!=B){A.setAttribute("fill",B);}}}};mxShape.prototype.isMixedModeHtml=function(){return this.mixedModeHtml&&!this.isRounded&&!this.isShadow&&this.gradient==null;};mxShape.prototype.create=function(A){var B=null;if(this.dialect==mxConstants.DIALECT_SVG){B=this.createSvg();}else{if(this.dialect==mxConstants.DIALECT_STRICTHTML||(this.preferModeHtml&&this.dialect==mxConstants.DIALECT_PREFERHTML)||(this.isMixedModeHtml()&&this.dialect==mxConstants.DIALECT_MIXEDHTML)){B=this.createHtml();}else{B=this.createVml();}}return B;};mxShape.prototype.createHtml=function(){var A=document.createElement("DIV");this.configureHtmlShape(A);return A;};mxShape.prototype.destroy=function(){if(this.node!=null){mxEvent.release(this.node);if(this.node.parentNode!=null){this.node.parentNode.removeChild(this.node);}this.node=null;}};mxShape.prototype.apply=function(B){var A=B.style;this.style=A;if(A!=null){this.fill=mxUtils.getValue(A,mxConstants.STYLE_FILLCOLOR,this.fill);this.gradient=mxUtils.getValue(A,mxConstants.STYLE_GRADIENTCOLOR,this.gradient);this.gradientDirection=mxUtils.getValue(A,mxConstants.STYLE_GRADIENT_DIRECTION,this.gradientDirection);this.opacity=mxUtils.getValue(A,mxConstants.STYLE_OPACITY,this.opacity);this.stroke=mxUtils.getValue(A,mxConstants.STYLE_STROKECOLOR,this.stroke);this.strokewidth=mxUtils.getValue(A,mxConstants.STYLE_STROKEWIDTH,this.strokewidth);this.isShadow=mxUtils.getValue(A,mxConstants.STYLE_SHADOW,this.isShadow);this.isDashed=mxUtils.getValue(A,mxConstants.STYLE_DASHED,this.isDashed);this.spacing=mxUtils.getValue(A,mxConstants.STYLE_SPACING,this.spacing);this.startSize=mxUtils.getValue(A,mxConstants.STYLE_STARTSIZE,this.startSize);this.endSize=mxUtils.getValue(A,mxConstants.STYLE_ENDSIZE,this.endSize);this.isRounded=mxUtils.getValue(A,mxConstants.STYLE_ROUNDED,this.isRounded);this.startArrow=mxUtils.getValue(A,mxConstants.STYLE_STARTARROW,this.startArrow);this.endArrow=mxUtils.getValue(A,mxConstants.STYLE_ENDARROW,this.endArrow);this.rotation=mxUtils.getValue(A,mxConstants.STYLE_ROTATION,this.rotation);this.direction=mxUtils.getValue(A,mxConstants.STYLE_DIRECTION,this.direction);}};mxShape.prototype.createSvgGroup=function(A){var B=document.createElementNS(mxConstants.NS_SVG,"g");this.innerNode=document.createElementNS(mxConstants.NS_SVG,A);this.configureSvgShape(this.innerNode);if(A=="rect"&&this.strokewidth*this.scale>=1&&!this.isRounded){this.innerNode.setAttribute("shape-rendering","optimizeSpeed");}this.shadowNode=this.createSvgShadow(this.innerNode);if(this.shadowNode!=null){B.appendChild(this.shadowNode);}B.appendChild(this.innerNode);return B;};mxShape.prototype.createSvgShadow=function(A){if(this.isShadow&&this.fill!=null){var B=A.cloneNode(true);B.setAttribute("stroke",mxConstants.SHADOWCOLOR);B.setAttribute("fill",mxConstants.SHADOWCOLOR);B.setAttribute("transform",mxConstants.SVG_SHADOWTRANSFORM);return B;}return null;};mxShape.prototype.configureHtmlShape=function(B){if(mxUtils.isVml(B)){this.configureVmlShape(B);}else{B.style.position="absolute";B.style.overflow="hidden";var A=this.stroke;if(A!=null&&A!=mxConstants.NONE){B.style.borderColor=A;if(this.isDashed){B.style.borderStyle="dashed";}else{if(this.strokewidth>0){B.style.borderStyle="solid";}}B.style.borderWidth=this.strokewidth+"px";}else{B.style.borderWidth="0px";}A=this.fill;B.style.background="";if(A!=null&&A!=mxConstants.NONE){B.style.backgroundColor=A;}else{if(this.points==null){B.style.background="url('"+mxClient.imageBasePath+"/transparent.gif')";}}if(this.opacity!=null){mxUtils.setOpacity(B,this.opacity);}}};mxShape.prototype.configureVmlShape=function(B){B.style.position="absolute";var A=this.stroke;if(A!=null&&A!=mxConstants.NONE){B.setAttribute("stroked","true");B.setAttribute("strokecolor",A);}else{B.setAttribute("stroked","false");}A=this.fill;B.style.background="";if(A!=null&&A!=mxConstants.NONE){B.setAttribute("filled","true");B.setAttribute("fillcolor",A);if(B.fillNode==null){B.fillNode=document.createElement("v:fill");B.appendChild(B.fillNode);}B.fillNode.setAttribute("color",A);if(this.gradient!=null){B.fillNode.setAttribute("type","gradient");B.fillNode.setAttribute("color2",this.gradient);var D="180";if(this.gradientDirection==mxConstants.DIRECTION_EAST){D="270";}else{if(this.gradientDirection==mxConstants.DIRECTION_WEST){D="90";}else{if(this.gradientDirection==mxConstants.DIRECTION_NORTH){D="0";}}}B.fillNode.setAttribute("angle",D);}if(this.opacity!=null){B.fillNode.setAttribute("opacity",this.opacity+"%");if(this.gradient!=null){B.fillNode.setAttribute("o:opacity2",this.opacity+"%");}}}else{B.setAttribute("filled","false");if(this.points==null){this.configureTransparentVmlBackground(B);}if(B.fillNode!=null){mxEvent.release(B.fillNode);B.removeChild(B.fillNode);B.fillNode=null;}}if((this.isDashed||this.opacity!=null)&&this.strokeNode==null){this.strokeNode=document.createElement("v:stroke");B.appendChild(this.strokeNode);}if(this.strokeNode!=null){if(this.isDashed){this.strokeNode.setAttribute("dashstyle","2 2");}else{this.strokeNode.setAttribute("dashstyle","solid");}if(this.opacity!=null){this.strokeNode.setAttribute("opacity",this.opacity+"%");}}if(this.isShadow&&this.fill!=null){if(this.shadowNode==null){this.shadowNode=document.createElement("v:shadow");this.shadowNode.setAttribute("on","true");this.shadowNode.setAttribute("color",mxConstants.SHADOWCOLOR);B.appendChild(this.shadowNode);}}if(B.nodeName=="roundrect"){try{B.setAttribute("arcsize",String(mxConstants.RECTANGLE_ROUNDING_FACTOR*100)+"%");}catch(C){}}};mxShape.prototype.configureTransparentVmlBackground=function(A){A.style.background="url('"+mxClient.imageBasePath+"/transparent.gif')";};mxShape.prototype.configureSvgShape=function(B){var A=this.stroke;if(A!=null&&A!=mxConstants.NONE){B.setAttribute("stroke",A);}else{B.setAttribute("stroke","none");}A=this.fill;if(A!=null&&A!=mxConstants.NONE){if(this.gradient!=null){var C=this.getGradientId(A,this.gradient,this.opacity);if(this.gradientNode!=null&&this.gradientNode.getAttribute("id")!=C){this.gradientNode=null;B.setAttribute("fill","");}if(this.gradientNode==null){this.gradientNode=this.createSvgGradient(C,A,this.gradient,this.opacity,B);B.setAttribute("fill","url(#"+C+")");}}else{this.gradientNode=null;B.setAttribute("fill",A);}}else{B.setAttribute("fill","none");}if(this.isDashed){B.setAttribute("stroke-dasharray","3, 3");}if(this.opacity!=null){B.setAttribute("fill-opacity",this.opacity/100);B.setAttribute("stroke-opacity",this.opacity/100);}};mxShape.prototype.getGradientId=function(E,A,C){E=E.toLowerCase();A=A.toLowerCase();var D=(C!=null)?C:100;var B=null;if(this.gradientDirection==null||this.gradientDirection==mxConstants.DIRECTION_SOUTH){B="south";}else{if(this.gradientDirection==mxConstants.DIRECTION_EAST){B="east";}else{if(this.gradientDirection==mxConstants.DIRECTION_NORTH){B="north";}else{if(this.gradientDirection==mxConstants.DIRECTION_WEST){B="west";}}}}return"-mx-gradient-"+E+"-"+A+"-"+D+"-"+B;};mxShape.prototype.createSvgGradient=function(H,G,A,B,D){var F=(B!=null)?B:100;var E=this.insertGradientNode;if(E==null){var E=document.createElementNS(mxConstants.NS_SVG,"linearGradient");E.setAttribute("id",H);E.setAttribute("x1","0%");E.setAttribute("y1","0%");E.setAttribute("x2","0%");E.setAttribute("y2","0%");if(this.gradientDirection==null||this.gradientDirection==mxConstants.DIRECTION_SOUTH){E.setAttribute("y2","100%");}else{if(this.gradientDirection==mxConstants.DIRECTION_EAST){E.setAttribute("x2","100%");}else{if(this.gradientDirection==mxConstants.DIRECTION_NORTH){E.setAttribute("y1","100%");}else{if(this.gradientDirection==mxConstants.DIRECTION_WEST){E.setAttribute("x1","100%");}}}}var C=document.createElementNS(mxConstants.NS_SVG,"stop");C.setAttribute("offset","0%");C.setAttribute("style","stop-color:"+G+";stop-opacity:"+(F/100));E.appendChild(C);C=document.createElementNS(mxConstants.NS_SVG,"stop");C.setAttribute("offset","100%");C.setAttribute("style","stop-color:"+A+";stop-opacity:"+(F/100));E.appendChild(C);}this.insertGradientNode=E;return E;};mxShape.prototype.createPoints=function(Q,B,L,H){var O=(H)?this.bounds.x:0;var N=(H)?this.bounds.y:0;if(isNaN(this.points[0].x)||isNaN(this.points[0].y)){return null;}var E=mxConstants.LINE_ARCSIZE*this.scale;var K=Q+" "+Math.floor(this.points[0].x-O)+" "+Math.floor(this.points[0].y-N)+" ";for(var M=1;M<this.points.length;M++){var G=this.points[M];var A=this.points[M-1];if(isNaN(G.x)||isNaN(G.y)){return null;}if(M==1&&this.startOffset!=null){A=A.clone();A.x+=this.startOffset.x;A.y+=this.startOffset.y;}else{if(M==this.points.length-1&&this.endOffset!=null){G=G.clone();G.x+=this.endOffset.x;G.y+=this.endOffset.y;}}var D=A.x-G.x;var C=A.y-G.y;if((this.isRounded&&M<this.points.length-1)&&(D!=0||C!=0)&&this.scale>0.3){var I=Math.sqrt(D*D+C*C);var J=D*Math.min(E,I/2)/I;var S=C*Math.min(E,I/2)/I;K+=B+" "+Math.floor(G.x+J-O)+" "+Math.floor(G.y+S-N)+" ";var R=this.points[M+1];D=R.x-G.x;C=R.y-G.y;I=Math.max(1,Math.sqrt(D*D+C*C));if(I!=0){var F=D*Math.min(E,I/2)/I;var P=C*Math.min(E,I/2)/I;K+=L+" "+Math.floor(G.x-O)+" "+Math.floor(G.y-N)+" "+Math.floor(G.x-O)+","+Math.floor(G.y-N)+" "+Math.floor(G.x+F-O)+" "+Math.floor(G.y+P-N)+" ";}}else{K+=B+" "+Math.floor(G.x-O)+" "+Math.floor(G.y-N)+" ";}}return K;};mxShape.prototype.updateHtmlShape=function(M){if(M!=null){if(mxUtils.isVml(M)){this.updateVmlShape(M);}else{M.style.borderWidth=Math.max(1,Math.floor(this.strokewidth*this.scale))+"px";if(this.bounds!=null&&!isNaN(this.bounds.x)&&!isNaN(this.bounds.y)&&!isNaN(this.bounds.width)&&!isNaN(this.bounds.height)){M.style.left=Math.floor(Math.max(0,this.bounds.x))+"px";M.style.top=Math.floor(Math.max(0,this.bounds.y))+"px";M.style.width=Math.floor(Math.max(0,this.bounds.width))+"px";M.style.height=Math.floor(Math.max(0,this.bounds.height))+"px";}}if(this.points!=null&&this.bounds!=null&&!mxUtils.isVml(M)){if(this.divContainer==null){this.divContainer=M;}while(this.divContainer.firstChild!=null){mxEvent.release(this.divContainer.firstChild);this.divContainer.removeChild(this.divContainer.firstChild);}M.style.borderStyle="";M.style.background="";if(this.points.length==2){var A=this.points[0];var U=this.points[1];var I=U.x-A.x;var G=U.y-A.y;if(I==0||G==0){M.style.borderStyle="solid";}else{M.style.width=Math.floor(this.bounds.width+1)+"px";M.style.height=Math.floor(this.bounds.height+1)+"px";var C=Math.sqrt(I*I+G*G);var B=1+(C/(8*this.scale));var R=I/B;var Q=G/B;var F=A.x-this.bounds.x;var E=A.y-this.bounds.y;for(var N=0;N<B;N++){var S=document.createElement("DIV");S.style.position="absolute";S.style.overflow="hidden";S.style.left=Math.floor(F)+"px";S.style.top=Math.floor(E)+"px";S.style.width=Math.max(1,2*this.scale)+"px";S.style.height=Math.max(1,2*this.scale)+"px";S.style.backgroundColor=this.stroke;this.divContainer.appendChild(S);F+=R;E+=Q;}}}else{if(this.points.length==3){var T=this.points[1];var L="0";var J="1";var H="0";var P="1";if(T.x==this.bounds.x){P="0";H="1";}if(T.y==this.bounds.y){L="1";J="0";}M.style.borderStyle="solid";M.style.borderWidth=L+" "+P+" "+J+" "+H+"px";}else{M.style.width=Math.floor(this.bounds.width+1)+"px";M.style.height=Math.floor(this.bounds.height+1)+"px";var D=this.points[0];for(var N=1;N<this.points.length;N++){var K=this.points[N];var S=document.createElement("DIV");S.style.position="absolute";S.style.overflow="hidden";S.style.borderColor=this.stroke;S.style.borderStyle="solid";S.style.borderWidth="1 0 0 1px";var F=Math.min(K.x,D.x)-this.bounds.x;var E=Math.min(K.y,D.y)-this.bounds.y;var H=Math.max(1,Math.abs(K.x-D.x));var O=Math.max(1,Math.abs(K.y-D.y));S.style.left=F+"px";S.style.top=E+"px";S.style.width=H+"px";S.style.height=O+"px";this.divContainer.appendChild(S);D=K;}}}}}};mxShape.prototype.updateVmlShape=function(E){E.setAttribute("strokeweight",this.strokewidth*this.scale);if(this.bounds!=null&&!isNaN(this.bounds.x)&&!isNaN(this.bounds.y)&&!isNaN(this.bounds.width)&&!isNaN(this.bounds.height)){E.style.left=Math.floor(this.bounds.x)+"px";E.style.top=Math.floor(this.bounds.y)+"px";E.style.width=Math.floor(Math.max(0,this.bounds.width))+"px";E.style.height=Math.floor(Math.max(0,this.bounds.height))+"px";if(this.points==null){if(this.rotation!=null&&this.rotation!=0){E.style.rotation=this.rotation;}else{if(E.style.rotation!=null){E.style.rotation="";}}}}if(this.points!=null){if(E.nodeName=="polyline"&&E.points!=null){var C="";for(var B=0;B<this.points.length;B++){C+=this.points[B].x+","+this.points[B].y+" ";}E.points.value=C;E.style.left=null;E.style.top=null;E.style.width=null;E.style.height=null;}else{if(this.bounds!=null){this.node.setAttribute("coordsize",Math.floor(this.bounds.width)+","+Math.floor(this.bounds.height));var C=this.createPoints("m","l","c",true);if(this.style!=null&&this.style[mxConstants.STYLE_SMOOTH]){var F=this.points;var G=F.length;if(G>3){var A=this.bounds.x;var D=this.bounds.y;C="m "+Math.floor(F[0].x-A)+" "+Math.floor(F[0].y-D)+" qb";for(var B=1;B<G-1;B++){C+=" "+Math.floor(F[B].x-A)+" "+Math.floor(F[B].y-D);}C+=" nf l "+Math.floor(F[G-1].x-A)+" "+Math.floor(F[G-1].y-D);}}E.setAttribute("path",C+" e");}}}};mxShape.prototype.updateSvgShape=function(C){var G=Math.max(1,this.strokewidth*this.scale);C.setAttribute("stroke-width",G);if(this.crisp){C.setAttribute("shape-rendering","crispEdges");}else{C.removeAttribute("shape-rendering");}if(this.points!=null&&this.points[0]!=null){var F=this.createPoints("M","L","C",false);if(F!=null){C.setAttribute("d",F);if(this.style!=null&&this.style[mxConstants.STYLE_SMOOTH]){var J=this.points;var B=J.length;if(B>3){var I="M "+J[0].x+" "+J[0].y+" ";I+=" Q "+J[1].x+" "+J[1].y+"  "+J[2].x+" "+J[2].y;for(var D=3;D<B;D++){I+=" T "+J[D].x+" "+J[D].y;}C.setAttribute("d",I);}}C.removeAttribute("x");C.removeAttribute("y");C.removeAttribute("width");C.removeAttribute("height");}}else{if(this.bounds!=null){C.setAttribute("x",this.bounds.x);C.setAttribute("y",this.bounds.y);var H=this.bounds.width;var E=this.bounds.height;C.setAttribute("width",H);C.setAttribute("height",E);if(this.isRounded){var A=Math.min(H*mxConstants.RECTANGLE_ROUNDING_FACTOR,E*mxConstants.RECTANGLE_ROUNDING_FACTOR);C.setAttribute("rx",A);C.setAttribute("ry",A);}this.updateSvgTransform(C,C==this.shadowNode);}}};mxShape.prototype.updateSvgTransform=function(B,D){if(this.rotation!=null&&this.rotation!=0){var A=this.bounds.x+this.bounds.width/2;var C=this.bounds.y+this.bounds.height/2;if(D){B.setAttribute("transform","rotate("+this.rotation+","+A+","+C+") "+mxConstants.SVG_SHADOWTRANSFORM);}else{B.setAttribute("transform","rotate("+this.rotation+","+A+","+C+")");}}else{if(D){B.setAttribute("transform",mxConstants.SVG_SHADOWTRANSFORM);}else{B.removeAttribute("transform");}}};mxShape.prototype.reconfigure=function(){if(this.dialect==mxConstants.DIALECT_SVG){if(this.innerNode!=null){this.configureSvgShape(this.innerNode);}else{this.configureSvgShape(this.node);}if(this.insertGradientNode!=null){this.insertGradient(this.insertGradientNode);this.insertGradientNode=null;}}else{if(mxUtils.isVml(this.node)){this.configureVmlShape(this.node);}else{this.configureHtmlShape(this.node);}}};mxShape.prototype.redraw=function(){if(this.dialect==mxConstants.DIALECT_SVG){this.redrawSvg();}else{if(mxUtils.isVml(this.node)){this.redrawVml();}else{this.redrawHtml();}}};mxShape.prototype.redrawSvg=function(){if(this.innerNode!=null){this.updateSvgShape(this.innerNode);if(this.shadowNode!=null){this.updateSvgShape(this.shadowNode);}}else{this.updateSvgShape(this.node);}};mxShape.prototype.redrawVml=function(){this.updateVmlShape(this.node);};mxShape.prototype.redrawHtml=function(){this.updateHtmlShape(this.node);};mxShape.prototype.createPath=function(B){var A=this.bounds.x;var F=this.bounds.y;var C=this.bounds.width;var D=this.bounds.height;var E=null;if(this.dialect==mxConstants.DIALECT_SVG){E=new mxPath("svg");E.setTranslate(A,F);}else{E=new mxPath("vml");}this.redrawPath(E,A,F,C,D,B);return E.getPath();};mxShape.prototype.redrawPath=function(D,A,E,B,C){};function mxActor(B,D,C,A){this.bounds=B;this.fill=D;this.stroke=C;this.strokewidth=A||1;}mxActor.prototype=new mxShape();mxActor.prototype.constructor=mxActor;mxActor.prototype.mixedModeHtml=false;mxActor.prototype.preferModeHtml=false;mxActor.prototype.createVml=function(){var A=document.createElement("v:shape");this.configureVmlShape(A);return A;};mxActor.prototype.redrawVml=function(){this.updateVmlShape(this.node);var A=Math.floor(this.bounds.width);var C=Math.floor(this.bounds.height);var B=this.strokewidth*this.scale;this.node.setAttribute("coordsize",A+","+C);this.node.setAttribute("strokeweight",B);var D=this.createPath();this.node.setAttribute("path",D);};mxActor.prototype.createSvg=function(){return this.createSvgGroup("path");};mxActor.prototype.redrawSvg=function(){var B=Math.max(1,this.strokewidth*this.scale);this.innerNode.setAttribute("stroke-width",B);var A=this.createPath();if(A.length>0){this.innerNode.setAttribute("d",A);this.updateSvgTransform(this.innerNode,false);if(this.shadowNode!=null){this.shadowNode.setAttribute("stroke-width",B);this.shadowNode.setAttribute("d",A);this.updateSvgTransform(this.shadowNode,true);}}else{this.innerNode.removeAttribute("d");if(this.shadowNode!=null){this.shadowNode.removeAttribute("d");}}};mxActor.prototype.redrawPath=function(E,A,F,B,D){var C=B/3;E.moveTo(0,D);E.curveTo(0,3*D/5,0,2*D/5,B/2,2*D/5);E.curveTo(B/2-C,2*D/5,B/2-C,0,B/2,0);E.curveTo(B/2+C,0,B/2+C,2*D/5,B/2,2*D/5);E.curveTo(B,2*D/5,B,3*D/5,B,D);E.close();};function mxCloud(B,D,C,A){this.bounds=B;this.fill=D;this.stroke=C;this.strokewidth=A||1;}mxCloud.prototype=new mxActor();mxCloud.prototype.constructor=mxActor;mxCloud.prototype.redrawPath=function(D,A,E,B,C){D.moveTo(0.25*B,0.25*C);D.curveTo(0.05*B,0.25*C,0,0.5*C,0.16*B,0.55*C);D.curveTo(0,0.66*C,0.18*B,0.9*C,0.31*B,0.8*C);D.curveTo(0.4*B,C,0.7*B,C,0.8*B,0.8*C);D.curveTo(B,0.8*C,B,0.6*C,0.875*B,0.5*C);D.curveTo(B,0.3*C,0.8*B,0.1*C,0.625*B,0.2*C);D.curveTo(0.5*B,0.05*C,0.3*B,0.05*C,0.25*B,0.25*C);D.close();};function mxRectangleShape(B,D,C,A){this.bounds=B;this.fill=D;this.stroke=C;this.strokewidth=A||1;}mxRectangleShape.prototype=new mxShape();mxRectangleShape.prototype.constructor=mxRectangleShape;mxRectangleShape.prototype.createHtml=function(){var A=document.createElement("DIV");this.configureHtmlShape(A);return A;};mxRectangleShape.prototype.createVml=function(){var A=(this.isRounded)?"v:roundrect":"v:rect";var B=document.createElement(A);this.configureVmlShape(B);return B;};mxRectangleShape.prototype.createSvg=function(){return this.createSvgGroup("rect");};mxRectangleShape.prototype.redrawSvg=function(){this.crisp=!this.isRounded;mxShape.prototype.redrawSvg.apply(this,arguments);};function mxEllipse(B,D,C,A){this.bounds=B;this.fill=D;this.stroke=C;this.strokewidth=A||1;}mxEllipse.prototype=new mxShape();mxEllipse.prototype.constructor=mxEllipse;mxEllipse.prototype.mixedModeHtml=false;mxEllipse.prototype.preferModeHtml=false;mxEllipse.prototype.createVml=function(){var A=document.createElement("v:arc");A.setAttribute("startangle","0");A.setAttribute("endangle","360");this.configureVmlShape(A);return A;};mxEllipse.prototype.createSvg=function(){return this.createSvgGroup("ellipse");};mxEllipse.prototype.redrawSvg=function(){this.updateSvgNode(this.innerNode);this.updateSvgNode(this.shadowNode);};mxEllipse.prototype.updateSvgNode=function(A){if(A!=null){var B=Math.max(1,this.strokewidth*this.scale);A.setAttribute("stroke-width",B);A.setAttribute("cx",this.bounds.x+this.bounds.width/2);A.setAttribute("cy",this.bounds.y+this.bounds.height/2);A.setAttribute("rx",this.bounds.width/2);A.setAttribute("ry",this.bounds.height/2);}};function mxDoubleEllipse(B,D,C,A){this.bounds=B;this.fill=D;this.stroke=C;this.strokewidth=A||1;}mxDoubleEllipse.prototype=new mxShape();mxDoubleEllipse.prototype.constructor=mxDoubleEllipse;mxDoubleEllipse.prototype.mixedModeHtml=false;mxDoubleEllipse.prototype.preferModeHtml=false;mxDoubleEllipse.prototype.createVml=function(){var A=document.createElement("v:group");this.background=document.createElement("v:arc");this.background.setAttribute("startangle","0");this.background.setAttribute("endangle","360");this.configureVmlShape(this.background);A.appendChild(this.background);this.label=this.background;this.isShadow=false;this.fill=null;this.foreground=document.createElement("v:oval");this.configureVmlShape(this.foreground);A.appendChild(this.foreground);this.stroke=null;this.configureVmlShape(A);return A;};mxDoubleEllipse.prototype.redrawVml=function(){var A=Math.floor(this.bounds.x);var F=Math.floor(this.bounds.y);var B=Math.floor(this.bounds.width);var E=Math.floor(this.bounds.height);var D=this.strokewidth*this.scale;this.updateVmlShape(this.node);this.node.setAttribute("coordsize",B+","+E);this.updateVmlShape(this.background);this.background.setAttribute("strokeweight",D);this.background.style.top="0px";this.background.style.left="0px";this.updateVmlShape(this.foreground);this.foreground.setAttribute("strokeweight",D);var C=3+D;this.foreground.style.top=C+"px";this.foreground.style.left=C+"px";this.foreground.style.width=Math.max(0,B-2*C)+"px";this.foreground.style.height=Math.max(0,E-2*C)+"px";};mxDoubleEllipse.prototype.createSvg=function(){var A=this.createSvgGroup("ellipse");this.foreground=document.createElementNS(mxConstants.NS_SVG,"ellipse");if(this.stroke!=null){this.foreground.setAttribute("stroke",this.stroke);}else{this.foreground.setAttribute("stroke","none");}this.foreground.setAttribute("fill","none");A.appendChild(this.foreground);return A;};mxDoubleEllipse.prototype.redrawSvg=function(){var A=this.strokewidth*this.scale;this.updateSvgNode(this.innerNode);this.updateSvgNode(this.shadowNode);this.updateSvgNode(this.foreground,3*this.scale+A);};mxDoubleEllipse.prototype.updateSvgNode=function(B,A){A=(A!=null)?A:0;if(B!=null){var C=Math.max(1,this.strokewidth*this.scale);B.setAttribute("stroke-width",C);B.setAttribute("cx",this.bounds.x+this.bounds.width/2);B.setAttribute("cy",this.bounds.y+this.bounds.height/2);B.setAttribute("rx",Math.max(0,this.bounds.width/2-A));B.setAttribute("ry",Math.max(0,this.bounds.height/2-A));}};function mxRhombus(B,D,C,A){this.bounds=B;this.fill=D;this.stroke=C;this.strokewidth=A||1;}mxRhombus.prototype=new mxShape();mxRhombus.prototype.constructor=mxRhombus;mxRhombus.prototype.mixedModeHtml=false;mxRhombus.prototype.preferModeHtml=false;mxRhombus.prototype.createHtml=function(){var A=document.createElement("DIV");this.configureHtmlShape(A);return A;};mxRhombus.prototype.createVml=function(){var A=document.createElement("v:shape");this.configureVmlShape(A);return A;};mxRhombus.prototype.createSvg=function(){return this.createSvgGroup("path");};mxRhombus.prototype.redrawVml=function(){this.node.setAttribute("strokeweight",this.strokewidth*this.scale);this.updateVmlShape(this.node);var A=0;var E=0;var B=Math.floor(this.bounds.width);var D=Math.floor(this.bounds.height);this.node.setAttribute("coordsize",B+","+D);var C="m "+Math.floor(A+B/2)+" "+E+" l "+(A+B)+" "+Math.floor(E+D/2)+" l "+Math.floor(A+B/2)+" "+(E+D)+" l "+A+" "+Math.floor(E+D/2);this.node.setAttribute("path",C+" x e");};mxRhombus.prototype.redrawHtml=function(){this.updateHtmlShape(this.node);};mxRhombus.prototype.redrawSvg=function(){this.updateSvgNode(this.innerNode);if(this.shadowNode!=null){this.updateSvgNode(this.shadowNode);}};mxRhombus.prototype.updateSvgNode=function(D){var G=Math.max(1,this.strokewidth*this.scale);D.setAttribute("stroke-width",G);var A=this.bounds.x;var F=this.bounds.y;var B=this.bounds.width;var C=this.bounds.height;var E="M "+(A+B/2)+" "+F+" L "+(A+B)+" "+(F+C/2)+" L "+(A+B/2)+" "+(F+C)+" L "+A+" "+(F+C/2)+" Z ";D.setAttribute("d",E);this.updateSvgTransform(D,D==this.shadowNode);};function mxPolyline(B,C,A){this.points=B;this.stroke=C||"black";this.strokewidth=A||1;}mxPolyline.prototype=new mxShape();mxPolyline.prototype.constructor=mxPolyline;mxPolyline.prototype.create=function(){var A=null;if(this.dialect==mxConstants.DIALECT_SVG){A=this.createSvg();}else{if(this.dialect==mxConstants.DIALECT_STRICTHTML||(this.dialect==mxConstants.DIALECT_PREFERHTML&&this.points!=null&&this.points.length>0)){A=document.createElement("DIV");this.configureHtmlShape(A);A.style.borderStyle="";A.style.background="";}else{A=document.createElement("v:shape");this.configureVmlShape(A);var B=document.createElement("v:stroke");if(this.opacity!=null){B.setAttribute("opacity",this.opacity+"%");}A.appendChild(B);}}return A;};mxPolyline.prototype.redrawVml=function(){if(this.points!=null&&this.points.length>0&&this.points[0]!=null){this.bounds=new mxRectangle(this.points[0].x,this.points[0].y,0,0);for(var A=1;A<this.points.length;A++){this.bounds.add(new mxRectangle(this.points[A].x,this.points[A].y,0,0));}}mxShape.prototype.redrawVml.apply(this,arguments);};mxPolyline.prototype.createSvg=function(){var B=this.createSvgGroup("path");var A=this.innerNode.getAttribute("stroke");this.pipe=document.createElementNS(mxConstants.NS_SVG,"path");this.pipe.setAttribute("stroke",A);this.pipe.setAttribute("visibility","hidden");this.pipe.setAttribute("pointer-events","stroke");B.appendChild(this.pipe);return B;};mxPolyline.prototype.redrawSvg=function(){this.updateSvgShape(this.innerNode);var A=this.innerNode.getAttribute("d");if(A!=null){this.pipe.setAttribute("d",A);var B=this.strokewidth*this.scale;this.pipe.setAttribute("stroke-width",B+mxShape.prototype.SVG_STROKE_TOLERANCE);}};function mxArrow(C,E,D,B,A,G,F){this.points=C;this.fill=E;this.stroke=D;this.strokewidth=B||1;this.arrowWidth=A||mxConstants.ARROW_WIDTH;this.spacing=G||mxConstants.ARROW_SPACING;this.endSize=F||mxConstants.ARROW_SIZE;}mxArrow.prototype=new mxShape();mxArrow.prototype.constructor=mxArrow;mxArrow.prototype.mixedModeHtml=false;mxArrow.prototype.preferModeHtml=false;mxArrow.prototype.DEG_PER_RAD=57.2957795;mxArrow.prototype.createVml=function(){var A=document.createElement("v:shape");this.configureVmlShape(A);return A;};mxArrow.prototype.redrawVml=function(){this.node.setAttribute("strokeweight",this.strokewidth*this.scale);if(this.points!=null){this.updateVmlShape(this.node);var F=this.spacing*this.scale;var R=this.arrowWidth*this.scale;var D=this.endSize*this.scale;var C=this.points[0];var Z=this.points[this.points.length-1];var P=Z.x-C.x;var O=Z.y-C.y;var Q=Math.sqrt(P*P+O*O);var E=Q-2*F-D;var Y=P/Q;var X=O/Q;var J=E*Y;var I=E*X;var H=R*X/3;var G=-R*Y/3;var U=C.x-H/2+F*Y;var S=C.y-G/2+F*X;var B=U+H;var A=S+G;var M=B+J;var K=A+I;var V=M+H;var T=K+G;var N=V-3*H;var L=T-3*G;var W="m"+Math.round(U)+","+Math.round(S)+" l"+Math.round(B)+","+Math.round(A)+","+Math.round(M)+","+Math.round(K)+","+Math.round(V)+","+Math.round(T)+","+Math.round(Z.x-F*Y)+","+Math.round(Z.y-F*X)+","+Math.round(N)+","+Math.round(L)+","+Math.round(N+H)+","+Math.round(L+G)+","+Math.round(U)+","+Math.round(S)+" xe";this.node.style.left=null;this.node.style.top=null;this.node.setAttribute("path",W);}};mxArrow.prototype.createSvg=function(){var A=document.createElementNS(mxConstants.NS_SVG,"polygon");this.configureSvgShape(A);return A;};mxArrow.prototype.redrawSvg=function(){if(this.points!=null){var K=Math.max(1,this.strokewidth*this.scale);this.node.setAttribute("stroke-width",K);var P=this.points[0];var G=this.points[this.points.length-1];var D=G.x-P.x;var C=G.y-P.y;var H=Math.sqrt(D*D+C*C);var E=this.spacing*this.scale;var F=Math.min(25,Math.max(20,H/5))*this.scale;var L=H-2*E;var J=P.x+E;var I=P.y-F/2;var Q=F;var O=F*0.3;var N=J+L;var A=I+F;var M=J+","+(I+O)+" "+(N-Q)+","+(I+O)+" "+(N-Q)+","+I+" "+N+","+(I+F/2)+" "+(N-Q)+","+A+" "+(N-Q)+","+(A-O)+" "+J+","+(A-O);this.node.setAttribute("points",M);var Q=G.x-P.x;var O=G.y-P.y;var B=Math.atan(O/Q)*this.DEG_PER_RAD;if(Q<0){B-=180;}this.node.setAttribute("transform","rotate("+B+","+P.x+","+P.y+")");}};function mxText(L,G,O,F,N,Q,J,D,E,S,B,H,C,R,P,M,I,A,K){this.value=L;this.bounds=G;this.color=N||"black";this.align=O||"";this.valign=F||"";this.family=Q||mxConstants.DEFAULT_FONTFAMILY;this.size=J||mxConstants.DEFAULT_FONTSIZE;this.fontStyle=D||0;this.spacing=parseInt(E||2);this.spacingTop=this.spacing+parseInt(S||0);this.spacingRight=this.spacing+parseInt(B||0);this.spacingBottom=this.spacing+parseInt(H||0);this.spacingLeft=this.spacing+parseInt(C||0);this.horizontal=(R!=null)?R:true;this.background=P;this.border=M;this.wrap=(I!=null)?I:false;this.clipped=(A!=null)?A:false;this.overflow=(K!=null)?K:"visible";}mxText.prototype=new mxShape();mxText.prototype.constructor=mxText;mxText.prototype.isStyleSet=function(A){return(this.fontStyle&A)==A;};mxText.prototype.create=function(A){var B=null;if(this.dialect==mxConstants.DIALECT_SVG){B=this.createSvg();}else{if(this.dialect==mxConstants.DIALECT_STRICTHTML||this.dialect==mxConstants.DIALECT_PREFERHTML||!mxUtils.isVml(A)){if(true&&!mxClient.NO_FO){B=this.createForeignObject();}else{B=this.createHtml();}}else{B=this.createVml();}}return B;};mxText.prototype.createForeignObject=function(){var C=document.createElementNS(mxConstants.NS_SVG,"g");var B=document.createElementNS(mxConstants.NS_SVG,"foreignObject");B.setAttribute("pointer-events","fill");var A=document.createElementNS(mxConstants.NS_XHTML,"body");A.setAttribute("xmlns","http://www.w3.org/1999/xhtml");A.style.margin="0px";A.style.height="100%";B.appendChild(A);C.appendChild(B);return C;};mxText.prototype.createHtml=function(){var A=this.createHtmlTable();A.style.position="absolute";return A;};mxText.prototype.createVml=function(){return document.createElement("v:textbox");};mxText.prototype.redrawHtml=function(){this.redrawVml();};mxText.prototype.getOffset=function(H,F,A,E,B){B=(B!=null)?B:this.horizontal;var D=(B)?this.align:this.valign;var C=(B)?this.valign:this.align;var I=A-H;var G=E-F;if(D==mxConstants.ALIGN_CENTER||D==mxConstants.ALIGN_MIDDLE){I=Math.floor(I/2);}else{if(D==mxConstants.ALIGN_LEFT||D===mxConstants.ALIGN_TOP){I=(B)?0:(A-E)/2;}else{if(!B){I=(A+E)/2-H;}}}if(C==mxConstants.ALIGN_MIDDLE||C==mxConstants.ALIGN_CENTER){G=Math.floor(G/2);}else{if(C==mxConstants.ALIGN_TOP||C==mxConstants.ALIGN_LEFT){G=(B)?0:(E+A)/2-F;}else{if(!B){G=(E-A)/2;}}}return new mxPoint(I,G);};mxText.prototype.getSpacing=function(B){B=(B!=null)?B:this.horizontal;var C=this.spacingLeft;var A=this.spacingTop;if(this.align==mxConstants.ALIGN_CENTER){C-=this.spacingRight;}else{if(this.align==mxConstants.ALIGN_RIGHT){C=-this.spacingRight;}}if(this.valign==mxConstants.ALIGN_MIDDLE){A-=this.spacingBottom;}else{if(this.valign==mxConstants.ALIGN_BOTTOM){A=-this.spacingBottom;}}return(B)?new mxPoint(C,A):new mxPoint(A,C);};mxText.prototype.createHtmlTable=function(){var B=document.createElement("table");B.style.borderCollapse="collapse";var A=document.createElement("tbody");var C=document.createElement("tr");var D=document.createElement("td");C.appendChild(D);A.appendChild(C);B.appendChild(A);return B;};mxText.prototype.updateHtmlTable=function(A,D){D=(D!=null)?D:1;var E=A.firstChild.firstChild.firstChild;if(mxUtils.isNode(this.value)){E.appendChild(this.value);}else{if(this.lastValue!=this.value){E.innerHTML=this.value.replace(/\n/g,"<br/>");this.lastValue=this.value;}}var C=Math.round(this.size*D);if(C<=0){A.style.visibility="hidden";}else{A.style.visibility="";}A.style.fontSize=(C)+"px";A.style.color=this.color;A.style.fontFamily=this.family;if(this.isStyleSet(mxConstants.FONT_BOLD)){A.style.fontWeight="bold";}else{A.style.fontWeight="normal";}if(this.isStyleSet(mxConstants.FONT_ITALIC)){A.style.fontStyle="italic";}else{A.style.fontStyle="";}if(this.isStyleSet(mxConstants.FONT_UNDERLINE)){A.style.textDecoration="underline";}else{A.style.textDecoration="";}if(this.opacity!=null){mxUtils.setOpacity(A,this.opacity);}if(false){if(this.isStyleSet(mxConstants.FONT_SHADOW)){E.style.filter="Shadow(Color=#666666,Direction=135,Strength=%)";}else{E.style.removeAttribute("filter");}}if(this.wrap&&this.bounds.width>0&&this.dialect!=mxConstants.DIALECT_SVG){if(false){A.style.width=this.bounds.width+"px";}else{var B=((this.horizontal||mxUtils.isVml(this.node))?this.bounds.width:this.bounds.height)/this.scale;A.style.width=B+"px";}E.style.whiteSpace="";}else{A.style.width="";E.style.whiteSpace="nowrap";}E.style.textAlign=(this.align==mxConstants.ALIGN_RIGHT)?"right":((this.align==mxConstants.ALIGN_CENTER)?"center":"left");E.style.verticalAlign=(this.valign==mxConstants.ALIGN_BOTTOM)?"bottom":((this.valign==mxConstants.ALIGN_MIDDLE)?"middle":"top");if(this.value.length>0&&this.background!=null){E.style.background=this.background;}else{E.style.background="";}if(this.value.length>0&&this.border!=null){A.style.borderColor=this.border;A.style.borderWidth="1px";A.style.borderStyle="solid";}else{A.style.borderStyle="none";}};mxText.prototype.redrawVml=function(){if(this.node.nodeName=="g"){this.redrawForeignObject();}else{if(mxUtils.isVml(this.node)){this.redrawTextbox();}else{this.redrawHtmlTable();}}};mxText.prototype.redrawTextbox=function(){var M=this.node;if(M.firstChild==null){M.appendChild(this.createHtmlTable());}var Q=M.firstChild;this.updateHtmlTable(Q);Q.style.filter="";M.inset="0px,0px,0px,0px";if(this.overflow!="fill"){var H=Q.offsetWidth*this.scale;var O=Q.offsetHeight*this.scale;var D=this.getOffset(this.bounds.width,this.bounds.height,H,O);if(!this.horizontal){Q.style.filter="progid:DXImageTransform.Microsoft.BasicImage(rotation=3)";}var B=this.getSpacing();var F=this.bounds.x-D.x+B.x*this.scale;var E=this.bounds.y-D.y+B.y*this.scale;var P=this.bounds.x;var A=this.bounds.y;var C=this.bounds.width;var K=this.bounds.height;if(this.horizontal){var T=Math.round(F-P);var S=Math.round(E-A);var L=Math.min(0,Math.round(P+C-F-H-1));var R=Math.min(0,Math.round(A+K-E-O-1));M.inset=T+"px,"+S+"px,"+L+"px,"+R+"px";}else{var J=0;var N=0;var L=0;var R=0;if(this.align==mxConstants.ALIGN_CENTER){J=(K-H)/2;R=J;}else{if(this.align==mxConstants.ALIGN_LEFT){J=K-H;}else{R=K-H;}}if(this.valign==mxConstants.ALIGN_MIDDLE){N=(C-O)/2;L=N;}else{if(this.valign==mxConstants.ALIGN_BOTTOM){N=C-O;}else{L=C-O;}}N+=hs*this.scale;J+=vs*this.scale;L+=hs*this.scale;R+=vs*this.scale;M.inset=N+"px,"+J+"px,"+L+"px,"+R+"px";}M.style.zoom=this.scale;if(this.clipped&&this.bounds.width>0&&this.bounds.height>0){this.boundingBox=this.bounds.clone();var I=Math.round(P-F);var G=Math.round(A-E);M.style.clip="rect("+(G/this.scale)+" "+((I+this.bounds.width)/this.scale)+" "+((G+this.bounds.height)/this.scale)+" "+(I/this.scale)+")";}else{this.boundingBox=new mxRectangle(F,E,H,O);}}else{this.boundingBox=this.bounds.clone();}};mxText.prototype.redrawHtmlTable=function(){if(isNaN(this.bounds.x)||isNaN(this.bounds.y)||isNaN(this.bounds.width)||isNaN(this.bounds.height)){return ;}var Q=this.node;var F=Q.firstChild.firstChild.firstChild;var E=false;var O=1;if(false){Q.style.removeAttribute("filter");}else{if(false||false){Q.style.WebkitTransform="";}else{if(true){Q.style.MozTransform="";F.style.MozTransform="";}else{if(mxClient.IS_OT){Q.style.OTransform="";}O=this.scale;E=true;}}}this.updateHtmlTable(Q,O);if(this.overflow!="fill"){Q.style.left="";Q.style.top="";Q.style.height="";var L=parseFloat(F.style.zoom)||1;var J=Q.offsetWidth/L;var P=Q.offsetHeight/L;var C=this.getOffset(this.bounds.width/this.scale,this.bounds.height/this.scale,J,P,E||this.horizontal);var B=this.getSpacing(E||this.horizontal);var H=this.bounds.x/this.scale-C.x+B.x;var G=this.bounds.y/this.scale-C.y+B.y;var M=this.scale;var A=1;var S=0;var R=0;if(!this.horizontal){if(false){Q.style.filter="progid:DXImageTransform.Microsoft.BasicImage(rotation=3)";S=J/2-P/2;R=-S;}else{if(false||false){Q.style.WebkitTransform="rotate(-90deg)";}else{if(mxClient.IS_OT){Q.style.OTransform="rotate(-90deg)";}else{if(true){Q.style.MozTransform="rotate(-90deg)";F.style.MozTransform="rotate(0deg)";A=1/this.scale;M=1;}}}}}if(true||E){if(true){Q.style.MozTransform+=" scale("+this.scale+")";A=1/this.scale;}S=(this.scale-1)*J/(2*this.scale);R=(this.scale-1)*P/(2*this.scale);M=1;}else{if(!E){F.style.zoom=this.scale;}}Q.style.left=Math.round((H+S)*this.scale)+"px";Q.style.top=Math.round((G+R)*this.scale)+"px";Q.style.width=Math.round(J*M)+"px";Q.style.height=Math.round(P*M)+"px";if(this.clipped&&this.bounds.width>0&&this.bounds.height>0){this.boundingBox=this.bounds.clone();if(this.horizontal||(E&&!mxClient.IS_OT)){var K=Math.max(0,C.x*M);var I=Math.max(0,C.y*M);Q.style.clip="rect("+(I)+" "+(K+this.bounds.width*A)+" "+(I+this.bounds.height*A)+" "+(K)+")";}else{if(false){var D=this.bounds.width;var N=this.bounds.height;var K=0;var I=0;if(this.align==mxConstants.ALIGN_LEFT){K=Math.max(0,J-N/this.scale)*this.scale;}else{if(this.align==mxConstants.ALIGN_CENTER){K=Math.max(0,J-N/this.scale)*this.scale/2;}}if(this.valign==mxConstants.ALIGN_BOTTOM){I=Math.max(0,P-D/this.scale)*this.scale;}else{if(this.valign==mxConstants.ALIGN_MIDDLE){I=Math.max(0,P-D/this.scale)*this.scale/2;}}Q.style.clip="rect("+(K)+" "+(I+D-1)+" "+(K+N-1)+" "+(I)+")";}else{var D=this.bounds.width/this.scale;var N=this.bounds.height/this.scale;if(mxClient.IS_OT){D=this.bounds.width;N=this.bounds.height;}var K=0;var I=0;if(this.align==mxConstants.ALIGN_RIGHT){K=Math.max(0,J-N);}else{if(this.align==mxConstants.ALIGN_CENTER){K=Math.max(0,J-N)/2;}}if(this.valign==mxConstants.ALIGN_BOTTOM){I=Math.max(0,P-D);}else{if(this.valign==mxConstants.ALIGN_MIDDLE){I=Math.max(0,P-D)/2;}}if(false||false){K*=this.scale;I*=this.scale;D*=this.scale;N*=this.scale;}Q.style.clip="rect("+(I)+" "+(K+N)+" "+(I+D)+" "+(K)+")";}}}else{this.boundingBox=new mxRectangle(H*this.scale,G*this.scale,J*this.scale,P*this.scale);}}else{this.boundingBox=this.bounds.clone();Q.style.left=Math.round(this.bounds.x)+"px";Q.style.top=Math.round(this.bounds.y)+"px";Q.style.width=Math.round(this.bounds.width)+"px";Q.style.height=Math.round(this.bounds.height)+"px";}};mxText.prototype.redrawForeignObject=function(){var F=this.node;var E=F.firstChild;while(E==this.backgroundNode){E=E.nextSibling;}var K=E.firstChild;if(K.firstChild==null){K.appendChild(this.createHtmlTable());}var Q=K.firstChild;this.updateHtmlTable(Q);if(false||false){Q.style.borderStyle="none";Q.firstChild.firstChild.firstChild.style.background="";if(this.backgroundNode==null&&(this.background!=null||this.border!=null)){this.backgroundNode=document.createElementNS(mxConstants.NS_SVG,"rect");F.insertBefore(this.backgroundNode,F.firstChild);}else{if(this.backgroundNode!=null&&this.background==null&&this.border==null){this.backgroundNode.parentNode.removeChild(this.backgroundNode);this.backgroundNode=null;}}if(this.backgroundNode!=null){if(this.background!=null){this.backgroundNode.setAttribute("fill",this.background);}else{this.backgroundNode.setAttribute("fill","none");}if(this.border!=null){this.backgroundNode.setAttribute("stroke",this.border);}else{this.backgroundNode.setAttribute("stroke","none");}}}if(this.overflow!="fill"){E.removeAttribute("x");E.removeAttribute("y");E.removeAttribute("width");E.removeAttribute("height");E.style.width="";E.style.height="";E.style.clip="";if(!false&&!false){document.body.appendChild(Q);}var J=Q.offsetWidth;var N=Q.offsetHeight;if(Q.parentNode!=K){K.appendChild(Q);}var B=this.getSpacing();var H=this.bounds.x/this.scale+B.x;var G=this.bounds.y/this.scale+B.y;var D=this.bounds.width/this.scale;var M=this.bounds.height/this.scale;var C=this.getOffset(D,M,J,N);if(this.horizontal){H-=C.x;G-=C.y;F.setAttribute("transform","scale("+this.scale+")");}else{var O=H+J/2;var A=G+N/2;F.setAttribute("transform","scale("+this.scale+") rotate(270 "+O+" "+A+")");H+=C.y;G-=C.x;}if(this.backgroundNode!=null){this.backgroundNode.setAttribute("x",H);this.backgroundNode.setAttribute("y",G);this.backgroundNode.setAttribute("width",J);this.backgroundNode.setAttribute("height",N);}E.setAttribute("x",H);E.setAttribute("y",G);E.setAttribute("width",J);E.setAttribute("height",N);if(this.clipped&&this.bounds.width>0&&this.bounds.height>0){this.boundingBox=this.bounds.clone();var L=Math.max(0,C.x);var I=Math.max(0,C.y);if(this.horizontal){E.style.clip="rect("+I+" "+(L+D)+" "+(I+M)+" "+(L)+")";}else{var L=0;var I=0;if(this.align==mxConstants.ALIGN_RIGHT){L=Math.max(0,J-M);}else{if(this.align==mxConstants.ALIGN_CENTER){L=Math.max(0,J-M)/2;}}if(this.valign==mxConstants.ALIGN_BOTTOM){I=Math.max(0,N-D);}else{if(this.valign==mxConstants.ALIGN_MIDDLE){I=Math.max(0,N-D)/2;}}E.style.clip="rect("+(I)+" "+(L+M)+" "+(I+D)+" "+(L)+")";}if(this.backgroundNode!=null){H=this.bounds.x/this.scale;G=this.bounds.y/this.scale;if(!this.horizontal){H+=(N+J)/2-M;G+=(N-J)/2;var R=D;D=M;M=R;}var P=this.getSvgClip(this.node.ownerSVGElement,H,G,D,M);if(P!=this.clip){this.releaseSvgClip();this.clip=P;P.refCount++;}this.backgroundNode.setAttribute("clip-path","url(#"+P.getAttribute("id")+")");}}else{this.releaseSvgClip();if(this.backgroundNode!=null){this.backgroundNode.removeAttribute("clip-path");}if(this.horizontal){this.boundingBox=new mxRectangle(H*this.scale,G*this.scale,J*this.scale,N*this.scale);}else{this.boundingBox=new mxRectangle(H*this.scale,G*this.scale,N*this.scale,J*this.scale);}}}else{E.setAttribute("x",this.bounds.x);E.setAttribute("y",this.bounds.y);E.setAttribute("width",this.bounds.width);E.setAttribute("height",this.bounds.height);if(this.backgroundNode!=null){this.backgroundNode.setAttribute("x",H);this.backgroundNode.setAttribute("y",G);this.backgroundNode.setAttribute("width",this.bounds.width);this.backgroundNode.setAttribute("height",this.bounds.height);}Q.style.width="100%";Q.style.height="100%";}};mxText.prototype.createSvg=function(){var B=document.createElementNS(mxConstants.NS_SVG,"g");var E=this.isStyleSet(mxConstants.FONT_UNDERLINE)?"underline":"none";var C=this.isStyleSet(mxConstants.FONT_BOLD)?"bold":"normal";var A=this.isStyleSet(mxConstants.FONT_ITALIC)?"italic":null;var D=(this.align==mxConstants.ALIGN_RIGHT)?"end":(this.align==mxConstants.ALIGN_CENTER)?"middle":"start";B.setAttribute("text-decoration",E);B.setAttribute("text-anchor",D);B.setAttribute("font-family",this.family);B.setAttribute("font-weight",C);B.setAttribute("font-size",Math.floor(this.size*this.scale)+"px");B.setAttribute("fill",this.color);if(A!=null){B.setAttribute("font-style",A);}if(this.background!=null||this.border!=null){this.backgroundNode=document.createElementNS(mxConstants.NS_SVG,"rect");this.backgroundNode.setAttribute("shape-rendering","crispEdges");if(this.background!=null){this.backgroundNode.setAttribute("fill",this.background);}else{this.backgroundNode.setAttribute("fill","none");}if(this.border!=null){this.backgroundNode.setAttribute("stroke",this.border);}else{this.backgroundNode.setAttribute("stroke","none");}}this.updateSvgValue(B);return B;};mxText.prototype.updateSvgValue=function(C){if(this.currentValue!=this.value){while(C.firstChild!=null){C.removeChild(C.firstChild);}if(this.value!=null){var A=this.value.split("\n");this.textNodes=new Array(A.length);for(var B=0;B<A.length;B++){if(!this.isEmptyString(A[B])){var D=this.createSvgSpan(A[B]);C.appendChild(D);this.textNodes[B]=D;D.setAttribute("text-decoration","inherit");}else{this.textNodes[B]=null;}}}this.currentValue=this.value;}};mxText.prototype.redrawSvg=function(){if(this.node.nodeName=="foreignObject"){this.redrawHtml();return ;}var B=Math.round(this.size*this.scale);if(B<=0){this.node.setAttribute("visibility","hidden");}else{this.node.removeAttribute("visibility");}this.updateSvgValue(this.node);this.node.setAttribute("font-size",B+"px");if(this.opacity!=null){this.node.setAttribute("fill-opacity",this.opacity/100);this.node.setAttribute("stroke-opacity",this.opacity/100);}var G=this.size*1.3*this.scale;var P=this.node.childNodes.length;var K=(this.textNodes!=null)?this.textNodes.length:0;if(this.backgroundNode!=null){P--;}var F=this.bounds.x;var E=this.bounds.y;F+=(this.align==mxConstants.ALIGN_RIGHT)?((this.horizontal)?this.bounds.width:this.bounds.height)-this.spacingRight*this.scale:(this.align==mxConstants.ALIGN_CENTER)?this.spacingLeft+(((this.horizontal)?this.bounds.width:this.bounds.height)-this.spacingLeft-this.spacingRight)/2:this.spacingLeft*this.scale;E+=(this.valign==mxConstants.ALIGN_BOTTOM)?((this.horizontal)?this.bounds.height:this.bounds.width)-(K-1)*G-this.spacingBottom*this.scale-3:(this.valign==mxConstants.ALIGN_MIDDLE)?(this.spacingTop*this.scale+((this.horizontal)?this.bounds.height:this.bounds.width)-this.spacingBottom*this.scale-(K-1.5)*G)/2+1:this.spacingTop*this.scale+G-2;if(!this.horizontal){var D=this.bounds.x+this.bounds.width/2;var A=this.bounds.y+this.bounds.height/2;var T=(this.bounds.width-this.bounds.height)/2;var Q=(this.bounds.height-this.bounds.width)/2;this.node.setAttribute("transform","rotate(-90 "+D+" "+A+") translate("+-Q+" "+(-T)+")");}if(this.textNodes!=null){var M=E;for(var N=0;N<K;N++){var L=this.textNodes[N];if(L!=null){L.setAttribute("x",F);L.setAttribute("y",M);L.setAttribute("style","pointer-events: all");}M+=G;}}if(this.overflow!="fill"){var C=this.value;var S=this.createHtmlTable();this.lastValue=null;this.value=mxUtils.htmlEntities(this.value,false);this.updateHtmlTable(S);document.body.appendChild(S);var H=S.offsetWidth*this.scale;var O=S.offsetHeight*this.scale;S.parentNode.removeChild(S);this.value=C;var I=2*this.scale;if(this.align==mxConstants.ALIGN_CENTER){I+=H/2;}else{if(this.align==mxConstants.ALIGN_RIGHT){I+=H;}}this.boundingBox=new mxRectangle(F-I,E-G,H+4*this.scale,O+1*this.scale);}else{this.boundingBox=this.bounds.clone();}if(this.value.length>0&&this.backgroundNode!=null&&this.node.firstChild!=null){if(this.node.firstChild!=this.backgroundNode){this.node.insertBefore(this.backgroundNode,this.node.firstChild);}this.backgroundNode.setAttribute("x",this.boundingBox.x+2*this.scale);this.backgroundNode.setAttribute("y",this.boundingBox.y+2*this.scale);this.backgroundNode.setAttribute("width",this.boundingBox.width);this.backgroundNode.setAttribute("height",this.boundingBox.height);var J=Math.round(Math.max(1,this.scale));this.backgroundNode.setAttribute("stroke-width",J);}if(this.clipped&&this.bounds.width>0&&this.bounds.height>0){this.boundingBox=this.bounds.clone();if(!this.horizontal){this.boundingBox.width=this.bounds.height;this.boundingBox.height=this.bounds.width;}F=this.bounds.x;E=this.bounds.y;if(this.horizontal){H=this.bounds.width;O=this.bounds.height;}else{H=this.bounds.height;O=this.bounds.width;}var R=this.getSvgClip(this.node.ownerSVGElement,F,E,H,O);if(R!=this.clip){this.releaseSvgClip();this.clip=R;R.refCount++;}this.node.setAttribute("clip-path","url(#"+R.getAttribute("id")+")");}else{this.releaseSvgClip();this.node.removeAttribute("clip-path");}};mxText.prototype.releaseSvgClip=function(){if(this.clip!=null){this.clip.refCount--;if(this.clip.refCount==0){this.clip.parentNode.removeChild(this.clip);}this.clip=null;}};mxText.prototype.getSvgClip=function(F,I,H,J,E){I=Math.round(I);H=Math.round(H);J=Math.round(J);E=Math.round(E);var B="-mx-clip+"+I+"+"+H+"+"+J+"+"+E;if(this.clip!=null&&this.clip.ident==B){return this.clip;}var A=0;var D=B+"-"+A;var C=document.getElementById(D);while(C!=null){if(C.ownerSVGElement==F){return C;}A++;D=B+"-"+A;C=document.getElementById(D)[0];}if(C!=null){C=C.cloneNode(true);A++;}else{C=document.createElementNS(mxConstants.NS_SVG,"clipPath");var G=document.createElementNS(mxConstants.NS_SVG,"rect");G.setAttribute("x",I);G.setAttribute("y",H);G.setAttribute("width",J);G.setAttribute("height",E);C.appendChild(G);}C.setAttribute("id",B+"-"+A);C.ident=B;F.appendChild(C);C.refCount=0;return C;};mxText.prototype.isEmptyString=function(A){return A.replace(/ /g,"").length==0;};mxText.prototype.createSvgSpan=function(B){var A=document.createElementNS(mxConstants.NS_SVG,"text");mxUtils.write(A,B);return A;};mxText.prototype.destroy=function(){this.releaseSvgClip();mxShape.prototype.destroy.apply(this,arguments);};function mxTriangle(){}mxTriangle.prototype=new mxActor();mxTriangle.prototype.constructor=mxTriangle;mxTriangle.prototype.redrawPath=function(D,A,E,B,C){if(this.direction==mxConstants.DIRECTION_NORTH){D.moveTo(0,C);D.lineTo(0.5*B,0);D.lineTo(B,C);}else{if(this.direction==mxConstants.DIRECTION_SOUTH){D.moveTo(0,0);D.lineTo(0.5*B,C);D.lineTo(B,0);}else{if(this.direction==mxConstants.DIRECTION_WEST){D.moveTo(B,0);D.lineTo(0,0.5*C);D.lineTo(B,C);}else{D.moveTo(0,0);D.lineTo(B,0.5*C);D.lineTo(0,C);}}}D.close();};function mxHexagon(){}mxHexagon.prototype=new mxActor();mxHexagon.prototype.constructor=mxHexagon;mxHexagon.prototype.redrawPath=function(D,A,E,B,C){if(this.direction==mxConstants.DIRECTION_NORTH||this.direction==mxConstants.DIRECTION_SOUTH){D.moveTo(0.5*B,0);D.lineTo(B,0.25*C);D.lineTo(B,0.75*C);D.lineTo(0.5*B,C);D.lineTo(0,0.75*C);D.lineTo(0,0.25*C);}else{D.moveTo(0.25*B,0);D.lineTo(0.75*B,0);D.lineTo(B,0.5*C);D.lineTo(0.75*B,C);D.lineTo(0.25*B,C);D.lineTo(0,0.5*C);}D.close();};function mxLine(B,C,A){this.bounds=B;this.stroke=C||"black";this.strokewidth=A||1;}mxLine.prototype=new mxShape();mxLine.prototype.constructor=mxLine;mxLine.prototype.mixedModeHtml=false;mxLine.prototype.preferModeHtml=false;mxLine.prototype.clone=function(){var A=new mxLine(this.bounds,this.stroke,this.strokewidth);A.isDashed=this.isDashed;return A;};mxLine.prototype.createVml=function(){var A=document.createElement("v:group");A.setAttribute("coordorigin","0,0");A.style.position="absolute";A.style.overflow="visible";this.label=document.createElement("v:rect");this.configureVmlShape(this.label);this.label.setAttribute("stroked","false");this.label.setAttribute("filled","false");A.appendChild(this.label);this.innerNode=document.createElement("v:shape");this.configureVmlShape(this.innerNode);A.appendChild(this.innerNode);return A;};mxLine.prototype.redrawVml=function(){var A=Math.round(this.bounds.x);var D=Math.round(this.bounds.y);var B=Math.round(this.bounds.width);var C=Math.round(this.bounds.height);this.updateVmlShape(this.node);this.node.setAttribute("coordsize",B+","+C);this.updateVmlShape(this.label);this.label.style.left="0px";this.label.style.top="0px";this.innerNode.setAttribute("coordsize",B+","+C);this.innerNode.style.left=A+"px";this.innerNode.style.top=D+"px";this.innerNode.style.width=B+"px";this.innerNode.style.height=C+"px";this.innerNode.setAttribute("strokeweight",this.strokewidth*this.scale);if(this.direction==mxConstants.DIRECTION_NORTH||this.direction==mxConstants.DIRECTION_SOUTH){this.innerNode.setAttribute("path","m "+(B/2-A)+" "+(-D)+" l "+(B/2-A)+" "+(C-D)+" e");}else{this.innerNode.setAttribute("path","m "+(-A)+" "+(C/2-D)+" l "+(B-A)+" "+(C/2-D)+" e");}};mxLine.prototype.createSvg=function(){var B=this.createSvgGroup("path");var A=this.innerNode.getAttribute("stroke");this.pipe=document.createElementNS(mxConstants.NS_SVG,"path");this.pipe.setAttribute("stroke",A);this.pipe.setAttribute("visibility","hidden");this.pipe.setAttribute("pointer-events","stroke");B.appendChild(this.pipe);return B;};mxLine.prototype.redrawSvg=function(){var F=Math.max(1,this.strokewidth*this.scale);this.innerNode.setAttribute("stroke-width",F);if(this.bounds!=null){var A=this.bounds.x;var E=this.bounds.y;var B=this.bounds.width;var C=this.bounds.height;var D=null;if(this.direction==mxConstants.DIRECTION_NORTH||this.direction==mxConstants.DIRECTION_SOUTH){D="M "+(A+B/2)+" "+E+" L "+(A+B/2)+" "+(E+C);}else{D="M "+A+" "+(E+C/2)+" L "+(A+B)+" "+(E+C/2);}this.innerNode.setAttribute("d",D);this.pipe.setAttribute("d",D);this.pipe.setAttribute("stroke-width",this.strokewidth*this.scale+mxShape.prototype.SVG_STROKE_TOLERANCE);this.updateSvgTransform(this.innerNode,false);this.updateSvgTransform(this.pipe,false);}};function mxImageShape(B,E,D,C,A){this.bounds=B;this.image=E;this.fill=D;this.stroke=C;this.strokewidth=A||1;this.isShadow=false;}mxImageShape.prototype=new mxShape();mxImageShape.prototype.constructor=mxImageShape;mxImageShape.prototype.apply=function(A){mxShape.prototype.apply.apply(this,arguments);this.fill=null;this.stroke=null;if(this.style!=null){this.fill=mxUtils.getValue(this.style,mxConstants.STYLE_IMAGE_BACKGROUND);this.stroke=mxUtils.getValue(this.style,mxConstants.STYLE_IMAGE_BORDER);}};mxImageShape.prototype.create=function(){var C=null;if(this.dialect==mxConstants.DIALECT_SVG){C=this.createSvgGroup("rect");this.innerNode.setAttribute("fill",this.fill);this.innerNode.setAttribute("visibility","hidden");this.innerNode.setAttribute("pointer-events","fill");this.imageNode=document.createElementNS(mxConstants.NS_SVG,"image");this.imageNode.setAttributeNS(mxConstants.NS_XLINK,"xlink:href",this.image);this.imageNode.setAttribute("style","pointer-events:none");this.configureSvgShape(this.imageNode);this.imageNode.removeAttribute("stroke");this.imageNode.removeAttribute("fill");C.insertBefore(this.imageNode,this.innerNode);if((this.fill!=null&&this.fill!=mxConstants.NONE)||(this.stroke!=null&&this.stroke!=mxConstants.NONE)){this.bg=document.createElementNS(mxConstants.NS_SVG,"rect");this.bg.setAttribute("fill",this.fill||"none");this.bg.setAttribute("stroke",this.stroke||"none");C.insertBefore(this.bg,C.firstChild);}}else{if(this.dialect==mxConstants.DIALECT_STRICTHTML||this.dialect==mxConstants.DIALECT_PREFERHTML){C=document.createElement("DIV");this.configureHtmlShape(C);var B=this.image.toUpperCase();if(B.substring(B.length-3,B.length)=="PNG"&&false){C.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader (src='"+this.image+"', sizingMethod='scale')";}else{var A=document.createElement("img");A.setAttribute("src",this.image);A.style.width="100%";A.style.height="100%";A.setAttribute("border","0");C.appendChild(A);}}else{C=document.createElement("v:image");C.setAttribute("src",this.image);this.configureVmlShape(C);}}return C;};mxImageShape.prototype.configureTransparentVmlBackground=function(A){};mxImageShape.prototype.redrawSvg=function(){this.updateSvgShape(this.innerNode);this.updateSvgShape(this.imageNode);if(this.bg!=null){this.updateSvgShape(this.bg);this.bg.setAttribute("fill",this.innerNode.getAttribute("fill"));this.bg.setAttribute("stroke",this.innerNode.getAttribute("stroke"));this.bg.setAttribute("shape-rendering","crispEdges");}};function mxLabel(B,D,C,A){this.bounds=B;this.fill=D;this.stroke=C;this.strokewidth=A||1;}mxLabel.prototype=new mxShape();mxLabel.prototype.constructor=mxLabel;mxLabel.prototype.imageSize=mxConstants.DEFAULT_IMAGESIZE;mxLabel.prototype.spacing=2;mxLabel.prototype.indicatorSize=10;mxLabel.prototype.indicatorSpacing=2;mxLabel.prototype.init=function(A){mxShape.prototype.init.apply(this,arguments);if(this.indicatorColor!=null&&this.indicatorShape!=null){this.indicator=new this.indicatorShape();this.indicator.dialect=this.dialect;this.indicator.bounds=this.bounds;this.indicator.fill=this.indicatorColor;this.indicator.stroke=this.indicatorColor;this.indicator.gradient=this.indicatorGradientColor;this.indicator.direction=this.indicatorDirection;this.indicator.init(this.node);this.indicatorShape=null;}};mxLabel.prototype.reconfigure=function(){mxShape.prototype.reconfigure.apply(this);if(this.indicator!=null){this.indicator.fill=this.indicatorColor;this.indicator.stroke=this.indicatorColor;this.indicator.gradient=this.indicatorGradientColor;this.indicator.direction=this.indicatorDirection;this.indicator.reconfigure();}};mxLabel.prototype.createHtml=function(){var A="DIV";var B=document.createElement(A);this.configureHtmlShape(B);if(this.indicatorImage!=null){this.indicatorImageNode=mxUtils.createImage(this.indicatorImage);this.indicatorImageNode.style.position="absolute";B.appendChild(this.indicatorImageNode);}if(this.image!=null){this.imageNode=mxUtils.createImage(this.image);this.stroke=null;this.configureHtmlShape(this.imageNode);B.appendChild(this.imageNode);}return B;};mxLabel.prototype.createVml=function(){var B=document.createElement("v:group");var A=(this.isRounded)?"v:roundrect":"v:rect";this.rectNode=document.createElement(A);this.configureVmlShape(this.rectNode);this.isShadow=false;this.configureVmlShape(B);B.setAttribute("coordorigin","0,0");B.appendChild(this.rectNode);if(this.indicatorImage!=null){this.indicatorImageNode=document.createElement("v:image");this.indicatorImageNode.setAttribute("src",this.indicatorImage);B.appendChild(this.indicatorImageNode);}if(this.image!=null){this.imageNode=document.createElement("v:image");this.imageNode.setAttribute("src",this.image);this.configureVmlShape(this.imageNode);B.appendChild(this.imageNode);}this.label=document.createElement("v:rect");this.label.style.top="0px";this.label.style.left="0px";this.label.setAttribute("filled","false");this.label.setAttribute("stroked","false");B.appendChild(this.label);return B;};mxLabel.prototype.createSvg=function(){var A=this.createSvgGroup("rect");if(this.indicatorImage!=null){this.indicatorImageNode=document.createElementNS(mxConstants.NS_SVG,"image");this.indicatorImageNode.setAttributeNS(mxConstants.NS_XLINK,"href",this.indicatorImage);A.appendChild(this.indicatorImageNode);}if(this.image!=null){this.imageNode=document.createElementNS(mxConstants.NS_SVG,"image");this.imageNode.setAttributeNS(mxConstants.NS_XLINK,"href",this.image);this.imageNode.setAttribute("style","pointer-events:none");this.configureSvgShape(this.imageNode);A.appendChild(this.imageNode);}return A;};mxLabel.prototype.redraw=function(){var C=(this.dialect==mxConstants.DIALECT_SVG);var M=mxUtils.isVml(this.node);if(C){this.updateSvgShape(this.innerNode);if(this.shadowNode!=null){this.updateSvgShape(this.shadowNode);}}else{if(M){this.updateVmlShape(this.node);this.node.setAttribute("coordsize",this.bounds.width+","+this.bounds.height);this.updateVmlShape(this.rectNode);this.rectNode.style.top="0px";this.rectNode.style.left="0px";this.label.style.width=this.bounds.width+"px";this.label.style.height=this.bounds.height+"px";}else{this.updateHtmlShape(this.node);}}var G=0;var E=0;if(this.imageNode!=null){G=(this.style[mxConstants.STYLE_IMAGE_WIDTH]||this.imageSize)*this.scale;E=(this.style[mxConstants.STYLE_IMAGE_HEIGHT]||this.imageSize)*this.scale;}var I=0;var D=0;var B=0;if(this.indicator!=null||this.indicatorImageNode!=null){I=(this.style[mxConstants.STYLE_INDICATOR_SPACING]||this.indicatorSpacing)*this.scale;D=(this.style[mxConstants.STYLE_INDICATOR_WIDTH]||this.indicatorSize)*this.scale;B=(this.style[mxConstants.STYLE_INDICATOR_HEIGHT]||this.indicatorSize)*this.scale;}var F=this.style[mxConstants.STYLE_IMAGE_ALIGN];var K=this.style[mxConstants.STYLE_IMAGE_VERTICAL_ALIGN];var N=this.spacing*this.scale;var A=Math.max(G,D);var L=E+I+B;var J=(C)?this.bounds.x:0;if(F==mxConstants.ALIGN_RIGHT){J+=this.bounds.width-A-N;}else{if(F==mxConstants.ALIGN_CENTER){J+=(this.bounds.width-A)/2;}else{J+=N;}}var H=(C)?this.bounds.y:0;if(K==mxConstants.ALIGN_BOTTOM){H+=this.bounds.height-L-N;}else{if(K==mxConstants.ALIGN_TOP){H+=N;}else{H+=(this.bounds.height-L)/2;}}if(this.imageNode!=null){if(C){this.imageNode.setAttribute("x",(J+(A-G)/2)+"px");this.imageNode.setAttribute("y",H+"px");this.imageNode.setAttribute("width",G+"px");this.imageNode.setAttribute("height",E+"px");}else{this.imageNode.style.left=(J+A-G)+"px";this.imageNode.style.top=H+"px";this.imageNode.style.width=G+"px";this.imageNode.style.height=E+"px";}}if(this.indicator!=null){this.indicator.bounds=new mxRectangle(J+(A-D)/2,H+E+I,D,B);this.indicator.redraw();}else{if(this.indicatorImageNode!=null){if(C){this.indicatorImageNode.setAttribute("x",(J+(A-D)/2)+"px");this.indicatorImageNode.setAttribute("y",(H+E+I)+"px");this.indicatorImageNode.setAttribute("width",D+"px");this.indicatorImageNode.setAttribute("height",B+"px");}else{this.indicatorImageNode.style.left=(J+(A-D)/2)+"px";this.indicatorImageNode.style.top=(H+E+I)+"px";this.indicatorImageNode.style.width=D+"px";this.indicatorImageNode.style.height=B+"px";}}}};mxLabel.prototype.updateSvgShape=function(){this.crisp=!this.isRounded;mxShape.prototype.updateSvgShape.apply(this,arguments);};function mxCylinder(B,D,C,A){this.bounds=B;this.fill=D;this.stroke=C;this.strokewidth=A||1;}mxCylinder.prototype=new mxShape();mxCylinder.prototype.constructor=mxCylinder;mxCylinder.prototype.mixedModeHtml=false;mxCylinder.prototype.preferModeHtml=false;mxCylinder.prototype.maxHeight=40;mxCylinder.prototype.create=function(A){if(this.stroke==null){this.stroke=this.fill;}return mxShape.prototype.create.apply(this,arguments);};mxCylinder.prototype.reconfigure=function(){if(this.dialect==mxConstants.DIALECT_SVG){this.configureSvgShape(this.foreground);this.foreground.setAttribute("fill","none");}else{if(mxUtils.isVml(this.node)){this.configureVmlShape(this.background);this.configureVmlShape(this.foreground);}}mxShape.prototype.reconfigure.apply(this);};mxCylinder.prototype.createVml=function(){var A=document.createElement("v:group");this.background=document.createElement("v:shape");this.label=this.background;this.configureVmlShape(this.background);A.appendChild(this.background);this.fill=null;this.isShadow=false;this.configureVmlShape(A);this.foreground=document.createElement("v:shape");this.configureVmlShape(this.foreground);A.appendChild(this.foreground);return A;};mxCylinder.prototype.redrawVml=function(){var A=Math.floor(this.bounds.x);var F=Math.floor(this.bounds.y);var B=Math.floor(this.bounds.width);var D=Math.floor(this.bounds.height);var C=this.strokewidth*this.scale;this.node.setAttribute("coordsize",B+","+D);this.background.setAttribute("coordsize",B+","+D);this.foreground.setAttribute("coordsize",B+","+D);this.updateVmlShape(this.node);this.updateVmlShape(this.background);this.background.style.top="0px";this.background.style.left="0px";this.background.style.rotation=null;this.updateVmlShape(this.foreground);this.foreground.style.top="0px";this.foreground.style.left="0px";this.foreground.style.rotation=null;this.background.setAttribute("strokeweight",C);this.foreground.setAttribute("strokeweight",C);var E=this.createPath(false);this.background.setAttribute("path",E);var E=this.createPath(true);this.foreground.setAttribute("path",E);};mxCylinder.prototype.createSvg=function(){var A=this.createSvgGroup("path");this.foreground=document.createElementNS(mxConstants.NS_SVG,"path");if(this.stroke!=null&&this.stroke!=mxConstants.NONE){this.foreground.setAttribute("stroke",this.stroke);}else{this.foreground.setAttribute("stroke","none");}this.foreground.setAttribute("fill","none");A.appendChild(this.foreground);return A;};mxCylinder.prototype.redrawSvg=function(){var B=Math.max(1,this.strokewidth*this.scale);this.innerNode.setAttribute("stroke-width",B);var A=this.createPath(false);if(A.length>0){this.innerNode.setAttribute("d",A);this.updateSvgTransform(this.innerNode,false);}else{this.innerNode.removeAttribute("d");}if(this.shadowNode!=null){this.shadowNode.setAttribute("stroke-width",B);this.shadowNode.setAttribute("d",A);this.updateSvgTransform(this.shadowNode,true);}A=this.createPath(true);if(A.length>0){this.foreground.setAttribute("stroke-width",B);this.foreground.setAttribute("d",A);this.updateSvgTransform(this.foreground,false);}else{this.foreground.removeAttribute("d");}};mxCylinder.prototype.redrawPath=function(F,A,G,C,E,D){var B=Math.min(this.maxHeight,Math.floor(E/5));if(D){F.moveTo(0,B);F.curveTo(0,2*B,C,2*B,C,B);}else{F.moveTo(0,B);F.curveTo(0,-B/3,C,-B/3,C,B);F.lineTo(C,E-B);F.curveTo(C,E+B/3,0,E+B/3,0,E-B);F.close();}};function mxConnector(B,C,A){this.points=B;this.stroke=C||"black";this.strokewidth=A||1;}mxConnector.prototype=new mxShape();mxConnector.prototype.constructor=mxConnector;mxConnector.prototype.mixedModeHtml=false;mxConnector.prototype.preferModeHtml=false;mxConnector.prototype.configureHtmlShape=function(A){mxShape.prototype.configureHtmlShape.apply(this,arguments);A.style.borderStyle="";A.style.background="";};mxConnector.prototype.createVml=function(){var A=document.createElement("v:shape");this.strokeNode=document.createElement("v:stroke");this.configureVmlShape(A);this.strokeNode.setAttribute("endarrow",this.endArrow);this.strokeNode.setAttribute("startarrow",this.startArrow);if(this.opacity!=null){this.strokeNode.setAttribute("opacity",this.opacity+"%");}A.appendChild(this.strokeNode);return A;};mxConnector.prototype.redrawVml=function(){if(this.node!=null&&this.strokeNode!=null){var C=mxUtils.getValue(this.style,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_MARKERSIZE)*this.scale;var F=mxUtils.getValue(this.style,mxConstants.STYLE_ENDSIZE,mxConstants.DEFAULT_MARKERSIZE)*this.scale;var B="medium";var D="medium";var E="medium";var A="medium";if(C<6){B="narrow";D="short";}else{if(C>10){B="wide";D="long";}}if(F<6){E="narrow";A="short";}else{if(F>10){E="wide";A="long";}}this.strokeNode.setAttribute("startarrowwidth",B);this.strokeNode.setAttribute("startarrowlength",D);this.strokeNode.setAttribute("endarrowwidth",E);this.strokeNode.setAttribute("endarrowlength",A);this.updateVmlShape(this.node);}};mxConnector.prototype.createSvg=function(){var B=this.createSvgGroup("path");var A=this.innerNode.getAttribute("stroke");if(this.shadowNode!=null){this.shadowNode.setAttribute("fill","none");}if(this.startArrow!=null){this.start=document.createElementNS(mxConstants.NS_SVG,"path");B.appendChild(this.start);}if(this.endArrow!=null){this.end=document.createElementNS(mxConstants.NS_SVG,"path");B.appendChild(this.end);}this.pipe=document.createElementNS(mxConstants.NS_SVG,"path");this.pipe.setAttribute("stroke",A);this.pipe.setAttribute("visibility","hidden");this.pipe.setAttribute("pointer-events","stroke");B.appendChild(this.pipe);return B;};mxConnector.prototype.redrawSvg=function(){mxShape.prototype.redrawSvg.apply(this,arguments);var G=this.strokewidth*this.scale;var B=this.innerNode.getAttribute("stroke");if(this.points!=null&&this.points[0]!=null){if(this.start!=null){var F=this.points[1];var A=this.points[0];var C=mxUtils.getValue(this.style,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_MARKERSIZE);this.startOffset=this.redrawSvgMarker(this.start,this.startArrow,F,A,B,C);}if(this.end!=null){var E=this.points.length;var F=this.points[E-2];var A=this.points[E-1];var C=mxUtils.getValue(this.style,mxConstants.STYLE_ENDSIZE,mxConstants.DEFAULT_MARKERSIZE);this.endOffset=this.redrawSvgMarker(this.end,this.endArrow,F,A,B,C);}}this.updateSvgShape(this.innerNode);var D=this.innerNode.getAttribute("d");if(D!=null){this.pipe.setAttribute("d",this.innerNode.getAttribute("d"));this.pipe.setAttribute("stroke-width",G+mxShape.prototype.SVG_STROKE_TOLERANCE);}this.innerNode.setAttribute("fill","none");};mxConnector.prototype.redrawSvgMarker=function(B,J,L,H,C,M){var D=null;var N=H.x-L.x;var K=H.y-L.y;if(isNaN(N)||isNaN(K)){return ;}var I=Math.max(1,Math.sqrt(N*N+K*K));var A=M*this.scale;var F=N*A/I;var E=K*A/I;H=H.clone();H.x-=F*this.strokewidth/(2*M);H.y-=E*this.strokewidth/(2*M);F*=0.5+this.strokewidth/2;E*=0.5+this.strokewidth/2;if(J=="classic"||J=="block"){var G="M "+H.x+" "+H.y+" L "+(H.x-F-E/2)+" "+(H.y-E+F/2)+((J!="classic")?"":" L "+(H.x-F*3/4)+" "+(H.y-E*3/4))+" L "+(H.x+E/2-F)+" "+(H.y-E-F/2)+" z";B.setAttribute("d",G);D=new mxPoint(-F*3/4,-E*3/4);}else{if(J=="open"){F*=1.2;E*=1.2;var G="M "+(H.x-F-E/2)+" "+(H.y-E+F/2)+" L "+(H.x-F/6)+" "+(H.y-E/6)+" L "+(H.x+E/2-F)+" "+(H.y-E-F/2)+" M "+H.x+" "+H.y;B.setAttribute("d",G);B.setAttribute("fill","none");B.setAttribute("stroke-width",this.scale*this.strokewidth);D=new mxPoint(-F/4,-E/4);}else{if(J=="oval"){F*=1.2;E*=1.2;A*=1.2;var G="M "+(H.x-E/2)+" "+(H.y+F/2)+" a "+(A/2)+" "+(A/2)+" 0  1,1 "+(F/8)+" "+(E/8)+" z";B.setAttribute("d",G);}else{if(J=="diamond"){var G="M "+(H.x+F/2)+" "+(H.y+E/2)+" L "+(H.x-E/2)+" "+(H.y+F/2)+" L "+(H.x-F/2)+" "+(H.y-E/2)+" L "+(H.x+E/2)+" "+(H.y-F/2)+" z";B.setAttribute("d",G);}}}}B.setAttribute("stroke",C);if(J!="open"){B.setAttribute("fill",C);}else{B.setAttribute("stroke-linecap","round");}if(this.opacity!=null){B.setAttribute("fill-opacity",this.opacity/100);B.setAttribute("stroke-opacity",this.opacity/100);}return D;};function mxSwimlane(B,D,C,A){this.bounds=B;this.fill=D;this.stroke=C;this.strokewidth=A||1;}mxSwimlane.prototype=new mxShape();mxSwimlane.prototype.constructor=mxSwimlane;mxSwimlane.prototype.imageSize=16;mxSwimlane.prototype.mixedModeHtml=false;mxRhombus.prototype.preferModeHtml=false;mxSwimlane.prototype.createHtml=function(){var C=document.createElement("DIV");this.configureHtmlShape(C);C.style.background="";C.style.backgroundColor="";C.style.borderStyle="none";this.label=document.createElement("DIV");this.configureHtmlShape(this.label);C.appendChild(this.label);this.content=document.createElement("DIV");var B=this.fill;this.configureHtmlShape(this.content);this.content.style.backgroundColor="";if(mxUtils.getValue(this.style,mxConstants.STYLE_HORIZONTAL,true)){this.content.style.borderTopStyle="none";}else{this.content.style.borderLeftStyle="none";}this.content.style.cursor="default";C.appendChild(this.content);var A=this.style[mxConstants.STYLE_SEPARATORCOLOR];if(A!=null){this.separator=document.createElement("DIV");this.separator.style.borderColor=A;this.separator.style.borderLeftStyle="dashed";C.appendChild(this.separator);}if(this.image!=null){this.imageNode=mxUtils.createImage(this.image);this.configureHtmlShape(this.imageNode);this.imageNode.style.borderStyle="none";C.appendChild(this.imageNode);}return C;};mxSwimlane.prototype.reconfigure=function(A){mxShape.prototype.reconfigure.apply(this,arguments);if(this.dialect==mxConstants.DIALECT_SVG){if(this.shadowNode!=null){this.updateSvgShape(this.shadowNode);if(mxUtils.getValue(this.style,mxConstants.STYLE_HORIZONTAL,true)){this.shadowNode.setAttribute("height",this.startSize*this.scale);}else{this.shadowNode.setAttribute("width",this.startSize*this.scale);}}}else{if(!mxUtils.isVml(this.node)){this.node.style.background="";this.node.style.backgroundColor="";}}};mxSwimlane.prototype.redrawHtml=function(){this.updateHtmlShape(this.node);this.node.style.background="";this.node.style.backgroundColor="";this.startSize=parseInt(mxUtils.getValue(this.style,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_STARTSIZE));this.updateHtmlShape(this.label);this.label.style.top="0px";this.label.style.left="0px";if(mxUtils.getValue(this.style,mxConstants.STYLE_HORIZONTAL,true)){this.startSize=Math.min(this.startSize,this.bounds.height);this.label.style.height=(this.startSize*this.scale)+"px";this.updateHtmlShape(this.content);this.content.style.background="";this.content.style.backgroundColor="";var B=this.startSize*this.scale;this.content.style.top=B+"px";this.content.style.left="0px";this.content.style.height=Math.max(1,this.bounds.height-B)+"px";if(this.separator!=null){this.separator.style.left=Math.floor(this.bounds.width)+"px";this.separator.style.top=Math.floor(this.startSize*this.scale)+"px";this.separator.style.width="1px";this.separator.style.height=Math.floor(this.bounds.height)+"px";this.separator.style.borderWidth=Math.floor(this.scale)+"px";}if(this.imageNode!=null){this.imageNode.style.left=(this.bounds.width-this.imageSize-4)+"px";this.imageNode.style.top="0px";this.imageNode.style.width=Math.floor(this.imageSize*this.scale)+"px";this.imageNode.style.height=Math.floor(this.imageSize*this.scale)+"px";}}else{this.startSize=Math.min(this.startSize,this.bounds.width);this.label.style.width=(this.startSize*this.scale)+"px";this.updateHtmlShape(this.content);this.content.style.background="";this.content.style.backgroundColor="";var A=this.startSize*this.scale;this.content.style.top="0px";this.content.style.left=A+"px";this.content.style.width=Math.max(0,this.bounds.width-A)+"px";if(this.separator!=null){this.separator.style.left=Math.floor(this.startSize*this.scale)+"px";this.separator.style.top=Math.floor(this.bounds.height)+"px";this.separator.style.width=Math.floor(this.bounds.width)+"px";this.separator.style.height="1px";}if(this.imageNode!=null){this.imageNode.style.left=(this.bounds.width-this.imageSize-4)+"px";this.imageNode.style.top="0px";this.imageNode.style.width=this.imageSize*this.scale+"px";this.imageNode.style.height=this.imageSize*this.scale+"px";}}};mxSwimlane.prototype.createVml=function(){var D=document.createElement("v:group");var B=(this.isRounded)?"v:roundrect":"v:rect";this.label=document.createElement(B);this.configureVmlShape(this.label);if(this.isRounded){this.label.setAttribute("arcsize","20%");}this.isShadow=false;this.configureVmlShape(D);D.setAttribute("coordorigin","0,0");D.appendChild(this.label);this.content=document.createElement(B);var C=this.fill;this.fill=null;this.configureVmlShape(this.content);D.style.background="";if(this.isRounded){this.content.setAttribute("arcsize","4%");}this.fill=C;this.content.style.borderBottom="0px";D.appendChild(this.content);var A=this.style[mxConstants.STYLE_SEPARATORCOLOR];if(A!=null){this.separator=document.createElement("v:shape");this.separator.setAttribute("strokecolor",A);this.separator.style.position="absolute";var E=document.createElement("v:stroke");E.setAttribute("dashstyle","2 2");this.separator.appendChild(E);D.appendChild(this.separator);}if(this.image!=null){this.imageNode=document.createElement("v:image");this.imageNode.setAttribute("src",this.image);this.configureVmlShape(this.imageNode);D.appendChild(this.imageNode);}return D;};mxSwimlane.prototype.redrawVml=function(){var A=Math.round(this.bounds.x);var G=Math.round(this.bounds.y);var B=Math.round(this.bounds.width);var D=Math.round(this.bounds.height);this.updateVmlShape(this.node);this.node.setAttribute("coordsize",B+","+D);this.updateVmlShape(this.label);this.label.style.top="0px";this.label.style.left="0px";this.label.style.rotation=null;this.startSize=parseInt(mxUtils.getValue(this.style,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_STARTSIZE));var F=Math.floor(this.startSize*this.scale);if(this.separator!=null){this.separator.setAttribute("coordsize",B+","+D);this.separator.style.left=A+"px";this.separator.style.top=G+"px";this.separator.style.width=B+"px";this.separator.style.height=D+"px";}if(mxUtils.getValue(this.style,mxConstants.STYLE_HORIZONTAL,true)){F=Math.min(F,this.bounds.height);this.label.style.height=F+"px";this.updateVmlShape(this.content);this.content.style.background="";this.content.style.top=F+"px";this.content.style.left="0px";this.content.style.height=Math.max(0,D-F)+"px";if(this.separator!=null){var E="m "+(B-A)+" "+(F-G)+" l "+(B-A)+" "+(D-G)+" e";this.separator.setAttribute("path",E);}if(this.imageNode!=null){var C=Math.floor(this.imageSize*this.scale);this.imageNode.style.left=(B-C-4)+"px";this.imageNode.style.top="0px";this.imageNode.style.width=C+"px";this.imageNode.style.height=C+"px";}}else{F=Math.min(F,this.bounds.width);this.label.style.width=F+"px";this.updateVmlShape(this.content);this.content.style.background="";this.content.style.top="0px";this.content.style.left=F+"px";this.content.style.width=Math.max(0,B-F)+"px";if(this.separator!=null){var E="m "+(F-A)+" "+(D-G)+" l "+(B-A)+" "+(D-G)+" e";this.separator.setAttribute("path",E);}if(this.imageNode!=null){var C=Math.floor(this.imageSize*this.scale);this.imageNode.style.left=(B-C-4)+"px";this.imageNode.style.top="0px";this.imageNode.style.width=C+"px";this.imageNode.style.height=C+"px";}}this.content.style.rotation=null;};mxSwimlane.prototype.createSvg=function(){var B=this.createSvgGroup("rect");if(this.isRounded){this.innerNode.setAttribute("rx",10);this.innerNode.setAttribute("ry",10);}this.content=document.createElementNS(mxConstants.NS_SVG,"path");this.configureSvgShape(this.content);this.content.setAttribute("fill","none");if(this.isRounded){this.content.setAttribute("rx",10);this.content.setAttribute("ry",10);}B.appendChild(this.content);var A=this.style[mxConstants.STYLE_SEPARATORCOLOR];if(A!=null){this.separator=document.createElementNS(mxConstants.NS_SVG,"line");this.separator.setAttribute("stroke",A);this.separator.setAttribute("fill","none");this.separator.setAttribute("stroke-dasharray","2, 2");B.appendChild(this.separator);}if(this.image!=null){this.imageNode=document.createElementNS(mxConstants.NS_SVG,"image");this.imageNode.setAttributeNS(mxConstants.NS_XLINK,"href",this.image);this.configureSvgShape(this.imageNode);B.appendChild(this.imageNode);}return B;};mxSwimlane.prototype.redrawSvg=function(){this.crisp=!this.isRounded;var C=this.isRounded;this.isRounded=false;this.updateSvgShape(this.innerNode);this.updateSvgShape(this.content);var B=mxUtils.getValue(this.style,mxConstants.STYLE_HORIZONTAL,true);if(this.shadowNode!=null){this.updateSvgShape(this.shadowNode);if(B){this.shadowNode.setAttribute("height",this.startSize*this.scale);}else{this.shadowNode.setAttribute("width",this.startSize*this.scale);}}this.isRounded=C;this.startSize=parseInt(mxUtils.getValue(this.style,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_STARTSIZE));if(B){this.startSize=Math.min(this.startSize,this.bounds.height);this.innerNode.setAttribute("height",this.startSize*this.scale);var E=this.startSize*this.scale;var D="M "+this.bounds.x+" "+(this.bounds.y+E)+" l 0 "+(this.bounds.height-E)+" l "+this.bounds.width+" 0 l 0 "+(-this.bounds.height+E);this.content.setAttribute("d",D);this.content.removeAttribute("x");this.content.removeAttribute("y");this.content.removeAttribute("width");this.content.removeAttribute("height");if(this.separator!=null){this.separator.setAttribute("x1",this.bounds.x+this.bounds.width);this.separator.setAttribute("y1",this.bounds.y+this.startSize*this.scale);this.separator.setAttribute("x2",this.bounds.x+this.bounds.width);this.separator.setAttribute("y2",this.bounds.y+this.bounds.height);}if(this.imageNode!=null){this.imageNode.setAttribute("x",this.bounds.x+this.bounds.width-this.imageSize-4);this.imageNode.setAttribute("y",this.bounds.y);this.imageNode.setAttribute("width",this.imageSize*this.scale+"px");this.imageNode.setAttribute("height",this.imageSize*this.scale+"px");}}else{this.startSize=Math.min(this.startSize,this.bounds.width);this.innerNode.setAttribute("width",this.startSize*this.scale);var A=this.startSize*this.scale;var D="M "+(this.bounds.x+A)+" "+this.bounds.y+" l "+(this.bounds.width-A)+" 0 l 0 "+this.bounds.height+" l "+(-this.bounds.width+A)+" 0";this.content.setAttribute("d",D);this.content.removeAttribute("x");this.content.removeAttribute("y");this.content.removeAttribute("width");this.content.removeAttribute("height");if(this.separator!=null){this.separator.setAttribute("x1",this.bounds.x+this.startSize*this.scale);this.separator.setAttribute("y1",this.bounds.y+this.bounds.height);this.separator.setAttribute("x2",this.bounds.x+this.bounds.width);this.separator.setAttribute("y2",this.bounds.y+this.bounds.height);}if(this.imageNode!=null){this.imageNode.setAttribute("x",this.bounds.x+this.bounds.width-this.imageSize-4);this.imageNode.setAttribute("y",this.bounds.y);this.imageNode.setAttribute("width",this.imageSize*this.scale+"px");this.imageNode.setAttribute("height",this.imageSize*this.scale+"px");}}};function mxGraphLayout(A){this.graph=A;}mxGraphLayout.prototype.graph=null;mxGraphLayout.prototype.useBoundingBox=true;mxGraphLayout.prototype.moveCell=function(B,A,C){};mxGraphLayout.prototype.execute=function(A){};mxGraphLayout.prototype.getGraph=function(){return this.graph;};mxGraphLayout.prototype.getConstraint=function(B,A,D,F){var E=this.graph.view.getState(A);var C=(E!=null)?E.style:this.graph.getCellStyle(A);return(C!=null)?C[B]:null;};mxGraphLayout.prototype.isVertexMovable=function(A){return this.graph.isCellMovable(A);};mxGraphLayout.prototype.isVertexIgnored=function(A){return !this.graph.getModel().isVertex(A)||!this.graph.isCellVisible(A);};mxGraphLayout.prototype.isEdgeIgnored=function(B){var A=this.graph.getModel();return !A.isEdge(B)||!this.graph.isCellVisible(B)||A.getTerminal(B,true)==null||A.getTerminal(B,false)==null;};mxGraphLayout.prototype.setEdgeStyleEnabled=function(A,B){this.graph.setCellStyles(mxConstants.STYLE_NOEDGESTYLE,(B)?"0":"1",[A]);};mxGraphLayout.prototype.setEdgePoints=function(C,B){if(C!=null){var A=this.graph.model;var D=A.getGeometry(C);if(D==null){D=new mxGeometry();D.setRelative(true);}else{D=D.clone();}D.points=B;A.setGeometry(C,D);}};mxGraphLayout.prototype.setVertexLocation=function(H,G,E){var D=this.graph.getModel();var F=D.getGeometry(H);var I=null;if(F!=null){I=new mxRectangle(G,E,F.width,F.height);if(this.useBoundingBox){var A=this.graph.getView().getState(H);if(A!=null&&A.text!=null&&A.text.boundingBox!=null){var B=this.graph.getView().scale;var C=A.text.boundingBox;if(A.text.boundingBox.x<A.x){G+=(A.x-C.x)/B;I.width=C.width;}if(A.text.boundingBox.y<A.y){E+=(A.y-C.y)/B;I.height=C.height;}}}if(F.x!=G||F.y!=E){F=F.clone();F.x=G;F.y=E;D.setGeometry(H,F);}}return I;};mxGraphLayout.prototype.getVertexBounds=function(H){var C=this.graph.getModel().getGeometry(H);if(this.useBoundingBox){var A=this.graph.getView().getState(H);if(A!=null&&A.text!=null&&A.text.boundingBox!=null){var B=this.graph.getView().scale;var D=A.text.boundingBox;var I=Math.max(A.x-D.x,0)/B;var F=Math.max(A.y-D.y,0)/B;var G=Math.max((D.x+D.width)-(A.x+A.width),0)/B;var E=Math.max((D.y+D.height)-(A.y+A.height),0)/B;C=new mxRectangle(C.x-I,C.y-F,C.width+I+G,C.height+F+E);}}return new mxRectangle(C.x,C.y,C.width,C.height);};function mxStackLayout(E,A,F,C,D,B){mxGraphLayout.call(this,E);this.horizontal=(A!=null)?A:true;this.spacing=(F!=null)?F:0;this.x0=(C!=null)?C:0;this.y0=(D!=null)?D:0;this.border=(B!=null)?B:0;}mxStackLayout.prototype=new mxGraphLayout();mxStackLayout.prototype.constructor=mxStackLayout;mxStackLayout.prototype.horizontal=null;mxStackLayout.prototype.spacing=null;mxStackLayout.prototype.x0=null;mxStackLayout.prototype.y0=null;mxStackLayout.prototype.border=0;mxStackLayout.prototype.keepFirstLocation=false;mxStackLayout.prototype.fill=false;mxStackLayout.prototype.resizeParent=false;mxStackLayout.prototype.wrap=null;mxStackLayout.prototype.isHorizontal=function(){return this.horizontal;};mxStackLayout.prototype.moveCell=function(O,J,I){var H=this.graph.getModel();var M=H.getParent(O);var B=this.isHorizontal();if(O!=null&&M!=null){var G=0;var N=0;var D=H.getChildCount(M);var L=(B)?J:I;var F=this.graph.getView().getState(M);if(F!=null){L-=(B)?F.x:F.y;}for(G=0;G<D;G++){var C=H.getChildAt(M,G);if(C!=O){var A=H.getGeometry(C);if(A!=null){var E=(B)?A.x+A.width/2:A.y+A.height/2;if(N<L&&E>L){break;}N=E;}}}var K=M.getIndex(O);K=Math.max(0,G-((G>K)?1:0));H.add(M,O,K);}};mxStackLayout.prototype.getParentSize=function(E){var C=this.graph.getModel();var B=C.getGeometry(E);if(this.graph.container!=null&&((B==null&&C.isLayer(E))||E==this.graph.getView().currentRoot)){var D=this.graph.container.offsetWidth-1;var A=this.graph.container.offsetHeight-1;B=new mxRectangle(0,0,D,A);}return B;};mxStackLayout.prototype.execute=function(L){if(L!=null){var A=this.isHorizontal();var I=this.graph.getModel();var D=this.getParentSize(L);var J=0;if(D!=null){J=(A)?D.height:D.width;}J-=2*this.spacing+2*this.border;var N=(this.graph.isSwimlane(L))?this.graph.getStartSize(L):new mxRectangle();J-=(A)?N.height:N.width;var C=this.x0+N.width+this.border;var K=this.y0+N.height+this.border;I.beginUpdate();try{var H=0;var M=null;var E=I.getChildCount(L);for(var G=0;G<E;G++){var B=I.getChildAt(L,G);if(!this.isVertexIgnored(B)&&this.isVertexMovable(B)){var F=I.getGeometry(B);if(F!=null){F=F.clone();if(this.wrap!=null&&M!=null){if((A&&M.x+M.width+F.width+2*this.spacing>this.wrap)||(!A&&M.y+M.height+F.height+2*this.spacing>this.wrap)){M=null;if(A){K+=H+this.spacing;}else{C+=H+this.spacing;}H=0;}}H=Math.max(H,(A)?F.height:F.width);if(M!=null){if(A){F.x=M.x+M.width+this.spacing;}else{F.y=M.y+M.height+this.spacing;}}else{if(!this.keepFirstLocation){if(A){F.x=C;}else{F.y=K;}}}if(A){F.y=K;}else{F.x=C;}if(this.fill&&J>0){if(A){F.height=J;}else{F.width=J;}}I.setGeometry(B,F);M=F;}}}if(this.resizeParent&&D!=null&&M!=null&&!this.graph.isCellCollapsed(L)){D=D.clone();if(A){D.width=M.x+M.width+this.spacing;}else{D.height=M.y+M.height+this.spacing;}I.setGeometry(L,D);}}finally{I.endUpdate();}}};function mxPartitionLayout(C,A,D,B){mxGraphLayout.call(this,C);this.horizontal=(A!=null)?A:true;this.spacing=D||0;this.border=B||0;}mxPartitionLayout.prototype=new mxGraphLayout();mxPartitionLayout.prototype.constructor=mxPartitionLayout;mxPartitionLayout.prototype.horizontal=null;mxPartitionLayout.prototype.spacing=null;mxPartitionLayout.prototype.border=null;mxPartitionLayout.prototype.resizeVertices=true;mxPartitionLayout.prototype.isHorizontal=function(){return this.horizontal;};mxPartitionLayout.prototype.moveCell=function(L,H,G){var F=this.graph.getModel();var J=F.getParent(L);if(L!=null&&J!=null){var E=0;var K=0;var C=F.getChildCount(J);for(E=0;E<C;E++){var B=F.getChildAt(J,E);var A=this.getVertexBounds(B);if(A!=null){var D=A.x+A.width/2;if(K<H&&D>H){break;}K=D;}}var I=J.getIndex(L);I=Math.max(0,E-((E>I)?1:0));F.add(J,L,I);}};mxPartitionLayout.prototype.execute=function(F){var P=this.isHorizontal();var B=this.graph.getModel();var L=B.getGeometry(F);if(this.graph.container!=null&&((L==null&&B.isLayer(F))||F==this.graph.getView().currentRoot)){var J=this.graph.container.offsetWidth-1;var H=this.graph.container.offsetHeight-1;L=new mxRectangle(0,0,J,H);}if(L!=null){var C=[];var N=B.getChildCount(F);for(var M=0;M<N;M++){var E=B.getChildAt(F,M);if(!this.isVertexIgnored(E)&&this.isVertexMovable(E)){C.push(E);}}var I=C.length;if(I>0){var O=this.border;var A=this.border;var D=(P)?L.height:L.width;D-=2*this.border;var G=(this.graph.isSwimlane(F))?this.graph.getStartSize(F):new mxRectangle();D-=(P)?G.height:G.width;O=O+G.width;A=A+G.height;var Q=this.border+(I-1)*this.spacing;var K=(P)?((L.width-O-Q)/I):((L.height-A-Q)/I);if(K>0){B.beginUpdate();try{for(var M=0;M<I;M++){var E=C[M];var R=B.getGeometry(E);if(R!=null){R=R.clone();R.x=O;R.y=A;if(P){if(this.resizeVertices){R.width=K;R.height=D;}O+=K+this.spacing;}else{if(this.resizeVertices){R.height=K;R.width=D;}A+=K+this.spacing;}B.setGeometry(E,R);}}}finally{B.endUpdate();}}}}};function mxCompactTreeLayout(B,A,C){mxGraphLayout.call(this,B);this.horizontal=(A!=null)?A:true;this.invert=(C!=null)?C:false;}mxCompactTreeLayout.prototype=new mxGraphLayout();mxCompactTreeLayout.prototype.constructor=mxCompactTreeLayout;mxCompactTreeLayout.prototype.horizontal=null;mxCompactTreeLayout.prototype.invert=null;mxCompactTreeLayout.prototype.resizeParent=true;mxCompactTreeLayout.prototype.moveTree=true;mxCompactTreeLayout.prototype.levelDistance=10;mxCompactTreeLayout.prototype.nodeDistance=20;mxCompactTreeLayout.prototype.resetEdges=true;mxCompactTreeLayout.prototype.isVertexIgnored=function(A){return mxGraphLayout.prototype.isVertexIgnored.apply(this,arguments)||this.graph.getConnections(A).length==0;};mxCompactTreeLayout.prototype.isHorizontal=function(){return this.horizontal;};mxCompactTreeLayout.prototype.execute=function(J,H){var F=this.graph.getModel();if(H==null){if(this.graph.getEdges(J,F.getParent(J),this.invert,!this.invert,false).length>0){H=J;}else{var L=this.graph.findTreeRoots(J,true,this.invert);if(L.length>0){for(var E=0;E<L.length;E++){if(!this.isVertexIgnored(L[E])&&this.graph.getEdges(L[E],null,this.invert,!this.invert,false).length>0){H=L[E];break;}}}}}if(H!=null){J=F.getParent(H);F.beginUpdate();try{var D=this.dfs(H,J);if(D!=null){this.layout(D);var C=this.graph.gridSize;var I=C;if(!this.moveTree||F.isLayer(J)){var G=F.getGeometry(H);if(G!=null){C=G.x;I=G.y;}}var A=null;if(this.isHorizontal()){A=this.horizontalLayout(D,C,I);}else{A=this.verticalLayout(D,null,C,I);}if(A!=null){var O=0;var M=0;if(A.x<0){O=Math.abs(C-A.x);}if(A.y<0){M=Math.abs(I-A.y);}if(J!=null){var N=(this.graph.isSwimlane(J))?this.graph.getStartSize(J):new mxRectangle();O+=N.width;M+=N.height;if(this.resizeParent&&!this.graph.isCellCollapsed(J)){var G=F.getGeometry(J);if(G!=null){var B=A.width+N.width-A.x+2*C;var K=A.height+N.height-A.y+2*I;G=G.clone();if(G.width>B){O+=(G.width-B)/2;}else{G.width=B;}if(G.height>K){if(this.isHorizontal()){M+=(G.height-K)/2;}}else{G.height=K;}F.setGeometry(J,G);}}}this.moveNode(D,O,M);}}}finally{F.endUpdate();}}};mxCompactTreeLayout.prototype.moveNode=function(C,B,A){C.x+=B;C.y+=A;this.apply(C);var D=C.child;while(D!=null){this.moveNode(D,B,A);D=D.next;}};mxCompactTreeLayout.prototype.dfs=function(L,K,J){J=(J!=null)?J:[];var A=mxCellPath.create(L);var C=null;if(L!=null&&J[A]==null&&!this.isVertexIgnored(L)){J[A]=L;C=this.createNode(L);var H=this.graph.getModel();var D=null;var E=this.graph.getEdges(L,K,this.invert,!this.invert,false);for(var G=0;G<E.length;G++){var B=E[G];if(!this.isEdgeIgnored(B)){if(this.resetEdges){this.setEdgePoints(B,null);}var I=this.graph.getView().getVisibleTerminal(B,this.invert);var F=this.dfs(I,K,J);if(F!=null&&H.getGeometry(I)!=null){if(D==null){C.child=F;}else{D.next=F;}D=F;}}}}return C;};mxCompactTreeLayout.prototype.layout=function(A){if(A!=null){var B=A.child;while(B!=null){this.layout(B);B=B.next;}if(A.child!=null){this.attachParent(A,this.join(A));}else{this.layoutLeaf(A);}}};mxCompactTreeLayout.prototype.horizontalLayout=function(F,B,E,D){F.x+=B+F.offsetX;F.y+=E+F.offsetY;D=this.apply(F,D);var G=F.child;if(G!=null){D=this.horizontalLayout(G,F.x,F.y,D);var A=F.y+G.offsetY;var C=G.next;while(C!=null){D=this.horizontalLayout(C,F.x+G.offsetX,A,D);A+=C.offsetY;C=C.next;}}return D;};mxCompactTreeLayout.prototype.verticalLayout=function(G,D,B,F,E){G.x+=B+G.offsetY;G.y+=F+G.offsetX;E=this.apply(G,E);var H=G.child;if(H!=null){E=this.verticalLayout(H,G,G.x,G.y,E);var A=G.x+H.offsetY;var C=H.next;while(C!=null){E=this.verticalLayout(C,G,A,G.y+H.offsetX,E);A+=C.offsetY;C=C.next;}}return E;};mxCompactTreeLayout.prototype.attachParent=function(E,B){var A=this.nodeDistance+this.levelDistance;var C=(B-E.width)/2-this.nodeDistance;var D=C+E.width+2*this.nodeDistance-B;E.child.offsetX=A+E.height;E.child.offsetY=D;E.contour.upperHead=this.createLine(E.height,0,this.createLine(A,D,E.contour.upperHead));E.contour.lowerHead=this.createLine(E.height,0,this.createLine(A,C,E.contour.lowerHead));};mxCompactTreeLayout.prototype.layoutLeaf=function(A){var B=2*this.nodeDistance;A.contour.upperTail=this.createLine(A.height+B,0);A.contour.upperHead=A.contour.upperTail;A.contour.lowerTail=this.createLine(0,-A.width-B);A.contour.lowerHead=this.createLine(A.height+B,0,A.contour.lowerTail);};mxCompactTreeLayout.prototype.join=function(C){var E=2*this.nodeDistance;var F=C.child;C.contour=F.contour;var B=F.width+E;var A=B;F=F.next;while(F!=null){var D=this.merge(C.contour,F.contour);F.offsetY=D+B;F.offsetX=0;B=F.width+E;A+=D+B;F=F.next;}return A;};mxCompactTreeLayout.prototype.merge=function(I,G){var F=0;var D=0;var E=0;var H=I.lowerHead;var A=G.upperHead;while(A!=null&&H!=null){var B=this.offset(F,D,A.dx,A.dy,H.dx,H.dy);D+=B;E+=B;if(F+A.dx<=H.dx){F+=A.dx;D+=A.dy;A=A.next;}else{F-=H.dx;D-=H.dy;H=H.next;}}if(A!=null){var C=this.bridge(I.upperTail,0,0,A,F,D);I.upperTail=(C.next!=null)?G.upperTail:C;I.lowerTail=G.lowerTail;}else{var C=this.bridge(G.lowerTail,F,D,H,0,0);if(C.next==null){I.lowerTail=C;}}I.lowerHead=G.lowerHead;return E;};mxCompactTreeLayout.prototype.offset=function(G,F,B,A,E,D){var C=0;if(E<=G||G+B<=0){return 0;}var H=E*A-B*D;if(H>0){if(G<0){var I=G*A;C=I/B-F;}else{if(G>0){var I=G*D;C=I/E-F;}else{C=-F;}}}else{if(E<G+B){var I=(E-G)*A;C=D-(F+I/B);}else{if(E>G+B){var I=(B+G)*D;C=I/E-(F+A);}else{C=D-(F+A);}}}if(C>0){return C;}else{return 0;}};mxCompactTreeLayout.prototype.bridge=function(G,C,E,F,B,D){var J=B+F.dx-C;var H=0;var I=0;if(F.dx==0){H=F.dy;}else{var I=J*F.dy;H=I/F.dx;}var A=this.createLine(J,H,F.next);G.next=this.createLine(0,D+F.dy-H-E,A);return A;};mxCompactTreeLayout.prototype.createNode=function(A){var B=new Object();B.cell=A;B.x=0;B.y=0;B.width=0;B.height=0;var C=this.getVertexBounds(A);if(C!=null){if(this.isHorizontal()){B.width=C.height;B.height=C.width;}else{B.width=C.width;B.height=C.height;}}B.offsetX=0;B.offsetY=0;B.contour=new Object();return B;};mxCompactTreeLayout.prototype.apply=function(C,B){var A=this.graph.getModel().getGeometry(C.cell);if(C.cell!=null&&A!=null){if(this.isVertexMovable(C.cell)){A=this.setVertexLocation(C.cell,C.x,C.y);}if(B==null){B=new mxRectangle(A.x,A.y,A.width,A.height);}else{B=new mxRectangle(Math.min(B.x,A.x),Math.min(B.y,A.y),Math.max(B.x+B.width,A.x+A.width),Math.max(B.y+B.height,A.y+A.height));}}return B;};mxCompactTreeLayout.prototype.createLine=function(C,B,D){var A=new Object();A.dx=C;A.dy=B;A.next=D;return A;};function mxFastOrganicLayout(A){mxGraphLayout.call(this,A);}mxFastOrganicLayout.prototype=new mxGraphLayout();mxFastOrganicLayout.prototype.constructor=mxFastOrganicLayout;mxFastOrganicLayout.prototype.useInputOrigin=true;mxFastOrganicLayout.prototype.resetEdges=true;mxFastOrganicLayout.prototype.disableEdgeStyle=true;mxFastOrganicLayout.prototype.forceConstant=50;mxFastOrganicLayout.prototype.forceConstantSquared=0;mxFastOrganicLayout.prototype.minDistanceLimit=2;mxFastOrganicLayout.prototype.minDistanceLimitSquared=4;mxFastOrganicLayout.prototype.initialTemp=200;mxFastOrganicLayout.prototype.temperature=0;mxFastOrganicLayout.prototype.maxIterations=0;mxFastOrganicLayout.prototype.iteration=0;mxFastOrganicLayout.prototype.vertexArray;mxFastOrganicLayout.prototype.dispX;mxFastOrganicLayout.prototype.dispY;mxFastOrganicLayout.prototype.cellLocation;mxFastOrganicLayout.prototype.radius;mxFastOrganicLayout.prototype.radiusSquared;mxFastOrganicLayout.prototype.isMoveable;mxFastOrganicLayout.prototype.neighbours;mxFastOrganicLayout.prototype.indices;mxFastOrganicLayout.prototype.allowedToRun=true;mxFastOrganicLayout.prototype.isVertexIgnored=function(A){return mxGraphLayout.prototype.isVertexIgnored.apply(this,arguments)||this.graph.getConnections(A).length==0;};mxFastOrganicLayout.prototype.execute=function(I){var D=this.graph.getModel();this.vertexArray=[];var C=this.graph.getChildVertices(I);for(var S=0;S<C.length;S++){if(!this.isVertexIgnored(C[S])){this.vertexArray.push(C[S]);}}var H=(this.useInputOrigin)?this.graph.view.getBounds(this.vertexArray):null;var P=this.vertexArray.length;this.indices=[];this.dispX=[];this.dispY=[];this.cellLocation=[];this.isMoveable=[];this.neighbours=[];this.radius=[];this.radiusSquared=[];if(this.forceConstant<0.001){this.forceConstant=0.001;}this.forceConstantSquared=this.forceConstant*this.forceConstant;for(var S=0;S<this.vertexArray.length;S++){var T=this.vertexArray[S];this.cellLocation[S]=[];var O=mxCellPath.create(T);this.indices[O]=S;var G=this.getVertexBounds(T);var Q=G.width;var N=G.height;var K=G.x;var J=G.y;this.cellLocation[S][0]=K+Q/2;this.cellLocation[S][1]=J+N/2;this.radius[S]=Math.min(Q,N);this.radiusSquared[S]=this.radius[S]*this.radius[S];}D.beginUpdate();try{for(var S=0;S<P;S++){this.dispX[S]=0;this.dispY[S]=0;this.isMoveable[S]=this.isVertexMovable(this.vertexArray[S]);var A=this.graph.getConnections(this.vertexArray[S],I);var C=this.graph.getOpposites(A,this.vertexArray[S]);this.neighbours[S]=[];for(var R=0;R<C.length;R++){if(this.resetEdges){this.graph.resetEdge(A[R]);}if(this.disableEdgeStyle){this.setEdgeStyleEnabled(A[R],false);}var O=mxCellPath.create(C[R]);var F=this.indices[O];if(F!=null){this.neighbours[S][R]=F;}else{this.neighbours[S][R]=S;}}}this.temperature=this.initialTemp;if(this.maxIterations==0){this.maxIterations=20*Math.sqrt(P);}for(this.iteration=0;this.iteration<this.maxIterations;this.iteration++){if(!this.allowedToRun){return ;}this.calcRepulsion();this.calcAttraction();this.calcPositions();this.reduceTemperature();}var E=null;var B=null;for(var S=0;S<this.vertexArray.length;S++){var T=this.vertexArray[S];if(this.isVertexMovable(T)){var G=this.getVertexBounds(T);if(G!=null){this.cellLocation[S][0]-=G.width/2;this.cellLocation[S][1]-=G.height/2;var K=this.graph.snap(this.cellLocation[S][0]);var J=this.graph.snap(this.cellLocation[S][1]);this.setVertexLocation(T,K,J);if(E==null){E=K;}else{E=Math.min(E,K);}if(B==null){B=J;}else{B=Math.min(B,J);}}}}var M=-(E||0)+1;var L=-(B||0)+1;if(H!=null){M+=H.x;L+=H.y;}this.graph.moveCells(this.vertexArray,M,L);}finally{D.endUpdate();}};mxFastOrganicLayout.prototype.calcPositions=function(){for(var B=0;B<this.vertexArray.length;B++){if(this.isMoveable[B]){var C=Math.sqrt(this.dispX[B]*this.dispX[B]+this.dispY[B]*this.dispY[B]);if(C<0.001){C=0.001;}var D=this.dispX[B]/C*Math.min(C,this.temperature);var A=this.dispY[B]/C*Math.min(C,this.temperature);this.dispX[B]=0;this.dispY[B]=0;this.cellLocation[B][0]+=D;this.cellLocation[B][1]+=A;}}};mxFastOrganicLayout.prototype.calcAttraction=function(){for(var I=0;I<this.vertexArray.length;I++){for(var F=0;F<this.neighbours[I].length;F++){var G=this.neighbours[I][F];if(I!=G&&this.isMoveable[I]&&this.isMoveable[G]){var H=this.cellLocation[I][0]-this.cellLocation[G][0];var J=this.cellLocation[I][1]-this.cellLocation[G][1];var E=H*H+J*J-this.radiusSquared[I]-this.radiusSquared[G];if(E<this.minDistanceLimitSquared){E=this.minDistanceLimitSquared;}var D=Math.sqrt(E);var C=(E)/this.forceConstant;var B=(H/D)*C;var A=(J/D)*C;this.dispX[I]-=B;this.dispY[I]-=A;this.dispX[G]+=B;this.dispY[G]+=A;}}}};mxFastOrganicLayout.prototype.calcRepulsion=function(){var B=this.vertexArray.length;for(var H=0;H<B;H++){for(var F=H;F<B;F++){if(!this.allowedToRun){return ;}if(F!=H&&this.isMoveable[H]&&this.isMoveable[F]){var G=this.cellLocation[H][0]-this.cellLocation[F][0];var I=this.cellLocation[H][1]-this.cellLocation[F][1];if(G==0){G=0.01+Math.random();}if(I==0){I=0.01+Math.random();}var E=Math.sqrt((G*G)+(I*I));var J=E-this.radius[H]-this.radius[F];if(J<this.minDistanceLimit){J=this.minDistanceLimit;}var D=this.forceConstantSquared/J;var C=(G/E)*D;var A=(I/E)*D;this.dispX[H]+=C;this.dispY[H]+=A;this.dispX[F]-=C;this.dispY[F]-=A;}}}};mxFastOrganicLayout.prototype.reduceTemperature=function(){this.temperature=this.initialTemp*(1-this.iteration/this.maxIterations);};function mxCircleLayout(B,A){mxGraphLayout.call(this,B);this.radius=(A!=null)?A:100;}mxCircleLayout.prototype=new mxGraphLayout();mxCircleLayout.prototype.constructor=mxCircleLayout;mxCircleLayout.prototype.radius=null;mxCircleLayout.prototype.moveCircle=false;mxCircleLayout.prototype.x0=0;mxCircleLayout.prototype.y0=0;mxCircleLayout.prototype.resetEdges=true;mxCircleLayout.prototype.disableEdgeStyle=true;mxCircleLayout.prototype.execute=function(K){var G=this.graph.getModel();G.beginUpdate();try{var J=0;var I=null;var D=null;var H=[];var E=G.getChildCount(K);for(var F=0;F<E;F++){var L=G.getChildAt(K,F);if(!this.isVertexIgnored(L)){H.push(L);var C=this.getVertexBounds(L);if(I==null){I=C.y;}else{I=Math.min(I,C.y);}if(D==null){D=C.x;}else{D=Math.min(D,C.x);}J=Math.max(J,Math.max(C.width,C.height));}else{if(!this.isEdgeIgnored(L)){if(this.resetEdges){this.graph.resetEdge(L);}if(this.disableEdgeStyle){this.setEdgeStyleEnabled(L,false);}}}}var B=H.length;var A=Math.max(B*J/Math.PI,this.radius);if(this.moveCircle){I=this.x0;D=this.y0;}this.circle(H,A,D,I);}finally{G.endUpdate();}};mxCircleLayout.prototype.circle=function(A,E,G,F){var C=A.length;var D=2*Math.PI/C;for(var B=0;B<C;B++){if(this.isVertexMovable(A[B])){this.setVertexLocation(A[B],G+E+E*Math.sin(B*D),F+E+E*Math.cos(B*D));}}};function mxParallelEdgeLayout(A){mxGraphLayout.call(this,A);}mxParallelEdgeLayout.prototype=new mxGraphLayout();mxParallelEdgeLayout.prototype.constructor=mxParallelEdgeLayout;mxParallelEdgeLayout.prototype.spacing=20;mxParallelEdgeLayout.prototype.execute=function(C){var D=this.findParallels(C);this.graph.model.beginUpdate();try{for(var B in D){var A=D[B];if(A.length>1){this.layout(A);}}}finally{this.graph.model.endUpdate();}};mxParallelEdgeLayout.prototype.findParallels=function(E){var A=this.graph.getView();var C=this.graph.getModel();var F=[];var B=C.getChildCount(E);for(var D=0;D<B;D++){var H=C.getChildAt(E,D);if(!this.isEdgeIgnored(H)){var G=this.getEdgeId(H);if(G!=null){if(F[G]==null){F[G]=[];}F[G].push(H);}}}return F;};mxParallelEdgeLayout.prototype.getEdgeId=function(C){var B=this.graph.getView();var D=B.getVisibleTerminal(C,true);var A=B.getVisibleTerminal(C,false);if(D!=null&&A!=null){D=mxCellPath.create(D);A=mxCellPath.create(A);return(D>A)?A+"-"+D:D+"-"+A;}return null;};mxParallelEdgeLayout.prototype.layout=function(J){var C=J[0];var I=this.graph.getView();var B=this.graph.getModel();var F=B.getGeometry(B.getTerminal(C,true));var O=B.getGeometry(B.getTerminal(C,false));if(F==O){var P=F.x+F.width+this.spacing;var A=F.y+F.height/2;for(var L=0;L<J.length;L++){this.route(J[L],P,A);P+=this.spacing;}}else{if(F!=null&&O!=null){var M=F.x+F.width/2;var K=F.y+F.height/2;var E=O.x+O.width/2;var D=O.y+O.height/2;var H=E-M;var G=D-K;var N=Math.sqrt(H*H+G*G);var P=M+H/2;var A=K+G/2;var R=G*this.spacing/N;var Q=H*this.spacing/N;P+=R*(J.length-1)/2;A-=Q*(J.length-1)/2;for(var L=0;L<J.length;L++){this.route(J[L],P,A);P-=R;A+=Q;}}}};mxParallelEdgeLayout.prototype.route=function(B,A,C){if(this.graph.isCellMovable(B)){this.setEdgePoints(B,[new mxPoint(A,C)]);}};function mxCompositeLayout(B,C,A){mxGraphLayout.call(this,B);this.layouts=C;this.master=A;}mxCompositeLayout.prototype=new mxGraphLayout();mxCompositeLayout.prototype.constructor=mxCompositeLayout;mxCompositeLayout.prototype.layouts=null;mxCompositeLayout.prototype.master=null;mxCompositeLayout.prototype.moveCell=function(B,A,C){if(this.master!=null){this.master.move.apply(this.master,arguments);}else{this.layouts[0].move.apply(this.layouts[0],arguments);}};mxCompositeLayout.prototype.execute=function(C){var A=this.graph.getModel();A.beginUpdate();try{for(var B=0;B<this.layouts.length;B++){this.layouts[B].execute.apply(this.layouts[B],arguments);}}finally{A.endUpdate();}};function mxEdgeLabelLayout(B,A){mxGraphLayout.call(this,B);}mxEdgeLabelLayout.prototype=new mxGraphLayout();mxEdgeLabelLayout.prototype.constructor=mxEdgeLabelLayout;mxEdgeLabelLayout.prototype.execute=function(H){var G=this.graph.view;var E=this.graph.getModel();var B=[];var F=[];var C=E.getChildCount(H);for(var D=0;D<C;D++){var I=E.getChildAt(H,D);var A=G.getState(I);if(A!=null){if(!this.isVertexIgnored(I)){F.push(A);}else{if(!this.isEdgeIgnored(I)){B.push(A);}}}}this.placeLabels(F,B);};mxEdgeLabelLayout.prototype.placeLabels=function(A,G){var C=this.graph.getModel();C.beginUpdate();try{for(var D=0;D<G.length;D++){var E=G[D];if(E!=null&&E.text!=null&&E.text.boundingBox!=null){for(var B=0;B<A.length;B++){var F=A[B];if(F!=null){this.avoid(E,F);}}}}}finally{C.endUpdate();}};mxEdgeLabelLayout.prototype.avoid=function(A,E){var B=this.graph.getModel();var G=A.text.boundingBox;if(mxUtils.intersects(G,E)){var F=-G.y-G.height+E.y;var C=-G.y+E.y+E.height;var J=(Math.abs(F)<Math.abs(C))?F:C;var I=-G.x-G.width+E.x;var H=-G.x+E.x+E.width;var K=(Math.abs(I)<Math.abs(H))?I:H;if(Math.abs(K)<Math.abs(J)){J=0;}else{K=0;}var D=B.getGeometry(A.cell);if(D!=null){D=D.clone();if(D.offset!=null){D.offset.x+=K;D.offset.y+=J;}else{D.offset=new mxPoint(K,J);}B.setGeometry(A.cell,D);}}};function mxGraphAbstractHierarchyCell(){this.x=[];this.y=[];this.temp=[];}mxGraphAbstractHierarchyCell.prototype.maxRank=-1;mxGraphAbstractHierarchyCell.prototype.minRank=-1;mxGraphAbstractHierarchyCell.prototype.x=null;mxGraphAbstractHierarchyCell.prototype.y=null;mxGraphAbstractHierarchyCell.prototype.width=0;mxGraphAbstractHierarchyCell.prototype.height=0;mxGraphAbstractHierarchyCell.prototype.nextLayerConnectedCells=null;mxGraphAbstractHierarchyCell.prototype.previousLayerConnectedCells=null;mxGraphAbstractHierarchyCell.prototype.temp=null;mxGraphAbstractHierarchyCell.prototype.getNextLayerConnectedCells=function(A){return null;};mxGraphAbstractHierarchyCell.prototype.getPreviousLayerConnectedCells=function(A){return null;};mxGraphAbstractHierarchyCell.prototype.isEdge=function(){return false;};mxGraphAbstractHierarchyCell.prototype.isVertex=function(){return false;};mxGraphAbstractHierarchyCell.prototype.getGeneralPurposeVariable=function(A){return null;};mxGraphAbstractHierarchyCell.prototype.setGeneralPurposeVariable=function(A,B){return null;};mxGraphAbstractHierarchyCell.prototype.setX=function(A,B){if(this.isVertex()){this.x[0]=B;}else{if(this.isEdge()){this.x[A-this.minRank-1]=B;}}};mxGraphAbstractHierarchyCell.prototype.getX=function(A){if(this.isVertex()){return this.x[0];}else{if(this.isEdge()){return this.x[A-this.minRank-1];}}return 0;};mxGraphAbstractHierarchyCell.prototype.setY=function(A,B){if(this.isVertex()){this.y[0]=B;}else{if(this.isEdge()){this.y[A-this.minRank-1]=B;}}};function mxGraphHierarchyNode(A){mxGraphAbstractHierarchyCell.apply(this,arguments);this.cell=A;}mxGraphHierarchyNode.prototype=new mxGraphAbstractHierarchyCell();mxGraphHierarchyNode.prototype.constructor=mxGraphHierarchyNode;mxGraphHierarchyNode.prototype.cell=null;mxGraphHierarchyNode.prototype.connectsAsTarget=[];mxGraphHierarchyNode.prototype.connectsAsSource=[];mxGraphHierarchyNode.prototype.hashCode=false;mxGraphHierarchyNode.prototype.getRankValue=function(A){return this.maxRank;};mxGraphHierarchyNode.prototype.getNextLayerConnectedCells=function(B){if(this.nextLayerConnectedCells==null){this.nextLayerConnectedCells=[];this.nextLayerConnectedCells[0]=[];for(var A=0;A<this.connectsAsTarget.length;A++){var C=this.connectsAsTarget[A];if(C.maxRank==-1||C.maxRank==B+1){this.nextLayerConnectedCells[0].push(C.source);}else{this.nextLayerConnectedCells[0].push(C);}}}return this.nextLayerConnectedCells[0];};mxGraphHierarchyNode.prototype.getPreviousLayerConnectedCells=function(B){if(this.previousLayerConnectedCells==null){this.previousLayerConnectedCells=[];this.previousLayerConnectedCells[0]=[];for(var A=0;A<this.connectsAsSource.length;A++){var C=this.connectsAsSource[A];if(C.minRank==-1||C.minRank==B-1){this.previousLayerConnectedCells[0].push(C.target);}else{this.previousLayerConnectedCells[0].push(C);}}}return this.previousLayerConnectedCells[0];};mxGraphHierarchyNode.prototype.isVertex=function(){return true;};mxGraphHierarchyNode.prototype.getGeneralPurposeVariable=function(A){return this.temp[0];};mxGraphHierarchyNode.prototype.setGeneralPurposeVariable=function(A,B){this.temp[0]=B;};mxGraphHierarchyNode.prototype.isAncestor=function(B){if(B!=null&&this.hashCode!=null&&B.hashCode!=null&&this.hashCode.length<B.hashCode.length){if(this.hashCode==B.hashCode){return true;}if(this.hashCode==null||this.hashCode==null){return false;}for(var A=0;A<this.hashCode.length;A++){if(this.hashCode[A]!=B.hashCode[A]){return false;}}return true;}return false;};function mxGraphHierarchyEdge(A){mxGraphAbstractHierarchyCell.apply(this,arguments);this.edges=A;}mxGraphHierarchyEdge.prototype=new mxGraphAbstractHierarchyCell();mxGraphHierarchyEdge.prototype.constructor=mxGraphHierarchyEdge;mxGraphHierarchyEdge.prototype.edges=null;mxGraphHierarchyEdge.prototype.source=null;mxGraphHierarchyEdge.prototype.target=null;mxGraphHierarchyEdge.prototype.isReversed=false;mxGraphHierarchyEdge.prototype.invert=function(B){var A=this.source;this.source=this.target;this.target=A;this.isReversed=!this.isReversed;};mxGraphHierarchyEdge.prototype.getNextLayerConnectedCells=function(B){if(this.nextLayerConnectedCells==null){this.nextLayerConnectedCells=[];for(var A=0;A<this.temp.length;A++){this.nextLayerConnectedCells[A]=[];if(A==this.nextLayerConnectedCells.length-1){this.nextLayerConnectedCells[A].push(this.source);}else{this.nextLayerConnectedCells[A].push(this);}}}return this.nextLayerConnectedCells[B-this.minRank-1];};mxGraphHierarchyEdge.prototype.getPreviousLayerConnectedCells=function(B){if(this.previousLayerConnectedCells==null){this.previousLayerConnectedCells=[];for(var A=0;A<this.temp.length;A++){this.previousLayerConnectedCells[A]=[];if(A==0){this.previousLayerConnectedCells[A].push(this.target);}else{this.previousLayerConnectedCells[A].push(this);}}}return this.previousLayerConnectedCells[B-this.minRank-1];};mxGraphHierarchyEdge.prototype.isEdge=function(){return true;};mxGraphHierarchyEdge.prototype.getGeneralPurposeVariable=function(A){return this.temp[A-this.minRank-1];};mxGraphHierarchyEdge.prototype.setGeneralPurposeVariable=function(A,B){this.temp[A-this.minRank-1]=B;};function mxGraphHierarchyModel(R,G,I,L,S,J,T,E){var B=R.getGraph();this.deterministic=J;this.tightenToSource=T;this.scanRanksFromSinks=E;this.roots=I;this.parent=L;this.vertexMapper=new Object();this.edgeMapper=new Object();this.maxRank=0;var F=[];if(G==null){G=this.graph.getChildVertices(L);}if(S){this.formOrderedHierarchy(R,G,L);}else{if(this.scanRanksFromSinks){this.maxRank=0;}else{this.maxRank=this.SOURCESCANSTARTRANK;}this.createInternalCells(R,G,F);for(var Q=0;Q<G.length;Q++){var C=F[Q].connectsAsSource;for(var P=0;P<C.length;P++){var A=C[P];var D=A.edges;for(var O=0;O<D.length;O++){var K=D[O];var M=B.getView().getVisibleTerminal(K,false);var N=mxCellPath.create(M);var H=this.vertexMapper[N];if(H!=null&&F[Q]!=H){A.target=H;if(H.connectsAsTarget.length==0){H.connectsAsTarget=[];}if(mxUtils.indexOf(H.connectsAsTarget,A)<0){H.connectsAsTarget.push(A);}}}}F[Q].temp[0]=1;}}}mxGraphHierarchyModel.prototype.scanRanksFromSinks=true;mxGraphHierarchyModel.prototype.maxRank=null;mxGraphHierarchyModel.prototype.vertexMapper=null;mxGraphHierarchyModel.prototype.edgeMapper=null;mxGraphHierarchyModel.prototype.ranks=null;mxGraphHierarchyModel.prototype.roots=null;mxGraphHierarchyModel.prototype.parent=null;mxGraphHierarchyModel.prototype.dfsCount=0;mxGraphHierarchyModel.prototype.SOURCESCANSTARTRANK=100000000;mxGraphHierarchyModel.prototype.deterministic;mxGraphHierarchyModel.prototype.tightenToSource=false;mxGraphHierarchyModel.prototype.formOrderedHierarchy=function(K,L,O){var P=K.getGraph();this.createInternalCells(K,L,internalVertices);var M=[];for(var I=0;I<L.length;I++){var G=internalVertices[I].connectsAsSource;for(var F=0;F<G.length;F++){var J=G[F];var A=J.edges;for(var E=0;E<A.length;E++){var B=A[E];var C=this.graph.getView().getVisibleTerminal(B,false);var N=mxCellPath.create(C);var D=vertexMapper[N];if(D!=null&&internalVertices[I]!=D){J.target=D;if(D.connectsAsTarget.length==0){D.connectsAsTarget=[];}if(D.temp[0]==1){J.invert();D.connectsAsSource.push(J);M.push(J);if(mxUtils.indexOf(internalVertices[I].connectsAsTarget,J)<0){internalVertices[I].connectsAsTarget.push(J);}}else{if(mxUtils.indexOf(D.connectsAsTarget,J)<0){D.connectsAsTarget.push(J);}}}}}for(var F=0;F<M.length;F++){var H=M[F];mxUtils.remove(H,internalVertices[I].connectsAsSource);}M=[];internalVertices[I].temp[0]=1;}};mxGraphHierarchyModel.prototype.createInternalCells=function(H,I,L){var N=H.getGraph();for(var F=0;F<I.length;F++){L[F]=new mxGraphHierarchyNode(I[F]);var J=mxCellPath.create(I[F]);this.vertexMapper[J]=L[F];var A=N.getConnections(I[F],this.parent);var O=N.getOpposites(A,I[F]);L[F].connectsAsSource=[];for(var E=0;E<O.length;E++){var M=O[E];if(M!=I[F]&&!H.isVertexIgnored(M)){var D=N.getEdgesBetween(I[F],M,true);if(D!=null&&D.length>0){var G=new mxGraphHierarchyEdge(D);for(var C=0;C<D.length;C++){var B=D[C];var K=mxCellPath.create(B);this.edgeMapper[K]=G;N.resetEdge(B);if(H.disableEdgeStyle){H.setEdgeStyleEnabled(B,false);}}G.source=L[F];if(mxUtils.indexOf(L[F].connectsAsSource,G)<0){L[F].connectsAsSource.push(G);}}}}L[F].temp[0]=0;}};mxGraphHierarchyModel.prototype.initialRank=function(){var G=[];if(!this.scanRanksFromSinks&&this.roots!=null){for(var H=0;H<this.roots.length;H++){var L=mxCellPath.create(this.roots[H]);var K=this.vertexMapper[L];if(K!=null){G.push(K);}}}if(this.scanRanksFromSinks){for(var N in this.vertexMapper){var K=this.vertexMapper[N];if(K.connectsAsSource==null||K.connectsAsSource.length==0){G.push(K);}}}if(G.length==0){for(var N in this.vertexMapper){var K=this.vertexMapper[N];if(K.connectsAsTarget==null||K.connectsAsTarget.length==0){G.push(K);this.scanRanksFromSinks=false;this.maxRank=this.SOURCESCANSTARTRANK;}}}for(var N in this.vertexMapper){var K=this.vertexMapper[N];K.temp[0]=-1;}var J=G.slice();while(G.length>0){var K=G[0];var O;var M;if(this.scanRanksFromSinks){O=K.connectsAsSource;M=K.connectsAsTarget;}else{O=K.connectsAsTarget;M=K.connectsAsSource;}var A=true;var C=0;if(!this.scanRanksFromSinks){C=this.SOURCESCANSTARTRANK;}for(var H=0;H<O.length;H++){var I=O[H];if(I.temp[0]==5270620){var F;if(this.scanRanksFromSinks){F=I.target;}else{F=I.source;}if(this.scanRanksFromSinks){C=Math.max(C,F.temp[0]+1);}else{C=Math.min(C,F.temp[0]-1);}}else{A=false;break;}}if(A){K.temp[0]=C;if(this.scanRanksFromSinks){this.maxRank=Math.max(this.maxRank,C);}else{this.maxRank=Math.min(this.maxRank,C);}if(M!=null){for(var H=0;H<M.length;H++){var I=M[H];I.temp[0]=5270620;var F;if(this.scanRanksFromSinks){F=I.source;}else{F=I.target;}if(F.temp[0]==-1){G.push(F);F.temp[0]=-2;}}}G.shift();}else{var D=G.shift();G.push(K);if(D==K&&G.length==1){break;}}}if(this.scanRanksFromSinks){if(this.tightenToSource){for(var H=0;H<J.length;H++){var K=J[H];var B=1000000;var O=K.connectsAsTarget;for(var E=0;E<K.connectsAsTarget.length;E++){var I=K.connectsAsTarget[E];var F=I.source;K.temp[0]=Math.min(B,F.temp[0]-1);B=K.temp[0];}}}}else{for(var N in this.vertexMapper){var K=this.vertexMapper[N];K.temp[0]-=this.maxRank;}this.maxRank=this.SOURCESCANSTARTRANK-this.maxRank;}};mxGraphHierarchyModel.prototype.fixRanks=function(){var C=[];this.ranks=[];for(var D=0;D<this.maxRank+1;D++){C[D]=[];this.ranks[D]=C[D];}var G=null;if(this.roots!=null){var B=this.roots;G=[];for(var D=0;D<B.length;D++){var A=B[D];var E=mxCellPath.create(A);var F=this.vertexMapper[E];G[D]=F;}}this.visit(function(L,N,M,K,I){if(I==0&&N.maxRank<0&&N.minRank<0){C[N.temp[0]].push(N);N.maxRank=N.temp[0];N.minRank=N.temp[0];N.temp[0]=C[N.maxRank].length-1;}if(L!=null&&M!=null){var H=L.maxRank-N.maxRank;if(H>1){M.maxRank=L.maxRank;M.minRank=N.maxRank;M.temp=[];M.x=[];M.y=[];for(var J=M.minRank+1;J<M.maxRank;J++){C[J].push(M);M.setGeneralPurposeVariable(J,C[J].length-1);}}}},G,false,null);};mxGraphHierarchyModel.prototype.visit=function(E,A,D,B){if(A!=null){for(var C=0;C<A.length;C++){var F=A[C];if(F!=null){if(B==null){B=new Object();}if(D){F.hashCode=[];F.hashCode[0]=this.dfsCount;F.hashCode[1]=C;this.extendedDfs(null,F,null,E,B,F.hashCode,C,0);}else{this.dfs(null,F,null,E,B,0);}}}this.dfsCount++;}};mxGraphHierarchyModel.prototype.dfs=function(I,H,K,F,A,E){if(H!=null){var J=mxCellPath.create(H.cell);if(A[J]==null){A[J]=H;F(I,H,K,E,0);var B=H.connectsAsSource.slice();for(var C=0;C<B.length;C++){var D=B[C];var G=D.target;this.dfs(H,G,D,F,A,E+1);}}else{F(I,H,K,E,1);}}};mxGraphHierarchyModel.prototype.extendedDfs=function(L,J,M,H,A,N,C,G){if(J!=null){if(L!=null){if(J.hashCode==null||J.hashCode[0]!=L.hashCode[0]){var B=L.hashCode.length+1;J.hashCode=L.hashCode.slice();J.hashCode[B-1]=C;}}var K=mxCellPath.create(J.cell);if(A[K]==null){A[K]=J;H(L,J,M,G,0);var D=J.connectsAsSource.slice();for(var E=0;E<D.length;E++){var F=D[E];var I=F.target;this.extendedDfs(J,I,F,H,A,J.hashCode,E,G+1);}}else{H(L,J,M,G,1);}}};function mxHierarchicalLayoutStage(){}mxHierarchicalLayoutStage.prototype.execute=function(A){};function mxMedianHybridCrossingReduction(A){this.layout=A;}mxMedianHybridCrossingReduction.prototype=new mxHierarchicalLayoutStage();mxMedianHybridCrossingReduction.prototype.constructor=mxMedianHybridCrossingReduction;mxMedianHybridCrossingReduction.prototype.layout=null;mxMedianHybridCrossingReduction.prototype.maxIterations=24;mxMedianHybridCrossingReduction.prototype.nestedBestRanks=null;mxMedianHybridCrossingReduction.prototype.currentBestCrossings=0;mxMedianHybridCrossingReduction.prototype.iterationsWithoutImprovement=0;mxMedianHybridCrossingReduction.prototype.maxNoImprovementIterations=2;mxMedianHybridCrossingReduction.prototype.execute=function(K){var G=this.layout.getModel();this.nestedBestRanks=[];for(var E=0;E<G.ranks.length;E++){this.nestedBestRanks[E]=G.ranks[E].slice();}var A=0;var H=this.calculateCrossings(G);for(var E=0;E<this.maxIterations&&A<this.maxNoImprovementIterations;E++){this.weightedMedian(E,G);this.transpose(E,G);var J=this.calculateCrossings(G);if(J<H){H=J;A=0;for(var C=0;C<this.nestedBestRanks.length;C++){var D=G.ranks[C];for(var B=0;B<D.length;B++){var L=D[B];this.nestedBestRanks[C][L.getGeneralPurposeVariable(C)]=L;}}}else{A++;for(var C=0;C<this.nestedBestRanks.length;C++){var D=G.ranks[C];for(var B=0;B<D.length;B++){var L=D[B];L.setGeneralPurposeVariable(C,B);}}}if(H==0){break;}}var F=[];var I=[];for(var E=0;E<G.maxRank+1;E++){I[E]=[];F[E]=I[E];}for(var E=0;E<this.nestedBestRanks.length;E++){for(var C=0;C<this.nestedBestRanks[E].length;C++){I[E].push(this.nestedBestRanks[E][C]);}}G.ranks=F;};mxMedianHybridCrossingReduction.prototype.calculateCrossings=function(B){var D=B.ranks.length;var A=0;for(var C=1;C<D;C++){A+=this.calculateRankCrossing(C,B);}return A;};mxMedianHybridCrossingReduction.prototype.calculateRankCrossing=function(I,J){var D=0;var H=J.ranks[I];var O=J.ranks[I-1];var N=H.length;var M=O.length;var Q=[];for(var F=0;F<N;F++){Q[F]=[];}for(var F=0;F<H.length;F++){var C=H[F];var A=C.getGeneralPurposeVariable(I);var L=C.getPreviousLayerConnectedCells(I);for(var E=0;E<L.length;E++){var B=L[E];var G=B.getGeneralPurposeVariable(I-1);Q[A][G]=201207;}}for(var F=0;F<N;F++){for(var E=0;E<M;E++){if(Q[F][E]==201207){for(var P=F+1;P<N;P++){for(var K=0;K<E;K++){if(Q[P][K]==201207){D++;}}}for(var P=0;P<F;P++){for(var K=E+1;K<M;K++){if(Q[P][K]==201207){D++;}}}}}}return D/2;};mxMedianHybridCrossingReduction.prototype.transpose=function(A,F){var B=true;var K=0;var N=10;while(B&&K++<N){var P=A%2==1&&K%2==1;B=false;for(var V=0;V<F.ranks.length;V++){var W=F.ranks[V];var Z=[];for(var U=0;U<W.length;U++){var D=W[U];var Y=D.getGeneralPurposeVariable(V);if(Y<0){Y=U;}Z[Y]=D;}var Q=null;var J=null;var G=null;var O=null;var E=null;var T=null;var a=null;var C=null;var I=null;var S=null;for(var U=0;U<(W.length-1);U++){if(U==0){I=Z[U];Q=I.getNextLayerConnectedCells(V);J=I.getPreviousLayerConnectedCells(V);E=[];T=[];for(var R=0;R<E.length;R++){E[R]=Q[R].getGeneralPurposeVariable(V+1);}for(var R=0;R<T.length;R++){T[R]=J[R].getGeneralPurposeVariable(V-1);}}else{Q=G;J=O;E=a;T=C;I=S;}S=Z[U+1];G=S.getNextLayerConnectedCells(V);O=S.getPreviousLayerConnectedCells(V);a=[];C=[];for(var R=0;R<a.length;R++){a[R]=G[R].getGeneralPurposeVariable(V+1);}for(var R=0;R<C.length;R++){C[R]=O[R].getGeneralPurposeVariable(V-1);}var H=0;var L=0;for(var R=0;R<E.length;R++){for(var M=0;M<a.length;M++){if(E[R]>a[M]){H++;}if(E[R]<a[M]){L++;}}}for(var R=0;R<T.length;R++){for(var M=0;M<C.length;M++){if(T[R]>C[M]){H++;}if(T[R]<C[M]){L++;}}}if((L<H)||(L==H&&P)){var X=I.getGeneralPurposeVariable(V);I.setGeneralPurposeVariable(V,S.getGeneralPurposeVariable(V));S.setGeneralPurposeVariable(V,X);G=Q;O=J;a=E;C=T;S=I;if(!P){B=true;}}}}}};mxMedianHybridCrossingReduction.prototype.weightedMedian=function(C,B){var D=(C%2==0);if(D){for(var A=B.maxRank-1;A>=0;A--){this.medianRank(A,D);}}else{for(var A=1;A<B.maxRank;A++){this.medianRank(A,D);}}};mxMedianHybridCrossingReduction.prototype.medianRank=function(E,G){var F=this.nestedBestRanks[E].length;var B=[];for(var C=0;C<F;C++){var A=this.nestedBestRanks[E][C];B[C]=new MedianCellSorter();B[C].cell=A;B[C].nudge=!G;var H;if(G){H=A.getNextLayerConnectedCells(E);}else{H=A.getPreviousLayerConnectedCells(E);}var D;if(G){D=E+1;}else{D=E-1;}if(H!=null&&H.length!=0){B[C].medianValue=this.medianValue(H,D);}else{B[C].medianValue=-1;}}B.sort(MedianCellSorter.prototype.compare);for(var C=0;C<F;C++){B[C].cell.setGeneralPurposeVariable(E,C);}};mxMedianHybridCrossingReduction.prototype.medianValue=function(E,I){var F=[];var G=0;for(var B=0;B<E.length;B++){var H=E[B];F[G++]=H.getGeneralPurposeVariable(I);}F.sort(MedianCellSorter.prototype.compare);if(G%2==1){return F[G/2];}else{if(G==2){return((F[0]+F[1])/2);}else{var C=G/2;var D=F[C-1]-F[0];var A=F[G-1]-F[C];return(F[C-1]*A+F[C]*D)/(D+A);}}};function MedianCellSorter(){}MedianCellSorter.prototype.medianValue=0;MedianCellSorter.prototype.nudge=false;MedianCellSorter.prototype.cell=false;MedianCellSorter.prototype.compare=function(B,A){if(B!=null&&A!=null){if(A.medianValue>B.medianValue){return -1;}else{if(A.medianValue<B.medianValue){return 1;}else{if(A.nudge){return -1;}else{return 1;}}}}else{return 0;}};function mxMinimumCycleRemover(A){this.layout=A;}mxMinimumCycleRemover.prototype=new mxHierarchicalLayoutStage();mxMinimumCycleRemover.prototype.constructor=mxMinimumCycleRemover;mxMinimumCycleRemover.prototype.layout=null;mxMinimumCycleRemover.prototype.execute=function(M){var K=this.layout.getModel();var A=new Object();var L=mxUtils.clone(K.vertexMapper,null,true);var J=null;if(K.roots!=null){var F=K.roots;J=[];for(var H=0;H<F.length;H++){var C=mxCellPath.create(F[H]);J[H]=K.vertexMapper[C];}}K.visit(function(S,T,P,R,Q){if(T.isAncestor(S)){P.invert();mxUtils.remove(P,S.connectsAsSource);S.connectsAsTarget.push(P);mxUtils.remove(P,T.connectsAsTarget);T.connectsAsSource.push(P);}var U=mxCellPath.create(T.cell);A[U]=T;delete L[U];},J,true,null);var I=null;if(L.lenth>0){I=mxUtils.clone(L,null,true);}var G=mxUtils.clone(A,null,true);K.visit(function(S,T,P,R,Q){if(T.isAncestor(S)){P.invert();mxUtils.remove(P,S.connectsAsSource);T.connectsAsSource.push(P);S.connectsAsTarget.push(P);mxUtils.remove(P,T.connectsAsTarget);}var U=mxCellPath.create(T.cell);A[U]=T;delete L[U];},L,true,G);var O=this.layout.getGraph();if(I!=null&&I.length>0){var N=K.roots;for(var H=0;H<I.length;H++){var E=I[H];var D=E.cell;var B=O.getIncomingEdges(D).length;if(B==0){N.push(D);}}}};function mxCoordinateAssignment(E,B,F,C,D,A){this.layout=E;this.intraCellSpacing=B;this.interRankCellSpacing=F;this.orientation=C;this.initialX=D;this.parallelEdgeSpacing=A;}mxCoordinateAssignment.prototype=new mxHierarchicalLayoutStage();mxCoordinateAssignment.prototype.constructor=mxCoordinateAssignment;mxCoordinateAssignment.prototype.layout=null;mxCoordinateAssignment.prototype.intraCellSpacing=30;mxCoordinateAssignment.prototype.interRankCellSpacing=10;mxCoordinateAssignment.prototype.parallelEdgeSpacing=10;mxCoordinateAssignment.prototype.maxIterations=8;mxCoordinateAssignment.prototype.orientation=mxConstants.DIRECTION_NORTH;mxCoordinateAssignment.prototype.initialX=null;mxCoordinateAssignment.prototype.limitX=null;mxCoordinateAssignment.prototype.currentXDelta=null;mxCoordinateAssignment.prototype.widestRank=null;mxCoordinateAssignment.prototype.widestRankValue=null;mxCoordinateAssignment.prototype.rankWidths=null;mxCoordinateAssignment.prototype.rankY=null;mxCoordinateAssignment.prototype.fineTuning=true;mxCoordinateAssignment.prototype.nextLayerConnectedCache=null;mxCoordinateAssignment.prototype.previousLayerConnectedCache=null;mxCoordinateAssignment.prototype.execute=function(G){var D=this.layout.getModel();this.currentXDelta=0;this.initialCoords(this.layout.getGraph(),D);if(this.fineTuning){this.minNode(D);}var F=100000000;if(this.fineTuning){for(var E=0;E<this.maxIterations;E++){if(E!=0){this.medianPos(E,D);this.minNode(D);}if(this.currentXDelta<F){for(var C=0;C<D.ranks.length;C++){var H=D.ranks[C];for(var B=0;B<H.length;B++){var A=H[B];A.setX(C,A.getGeneralPurposeVariable(C));}}F=this.currentXDelta;}else{for(var C=0;C<D.ranks.length;C++){var H=D.ranks[C];for(var B=0;B<H.length;B++){var A=H[B];A.setGeneralPurposeVariable(C,A.getX(C));}}}this.currentXDelta=0;}}this.setCellLocations(this.layout.getGraph(),D);};mxCoordinateAssignment.prototype.minNode=function(H){var g=[];var h=[];var f=[];for(var b=0;b<=H.maxRank;b++){f[b]=H.ranks[b];for(var a=0;a<f[b].length;a++){var V=f[b][a];var M=new WeightedCellSorter(V,b);M.rankIndex=a;M.visited=true;g.push(M);var k=mxCellPath.create(V.cell);h[k]=M;}}var Z=g.length*10;var K=0;var d=1;while(g.length>0&&K<=Z){var E=g.shift();var D=E.cell;var Y=E.weightedValue;var N=parseInt(E.rankIndex);var U=D.getNextLayerConnectedCells(Y);var B=D.getPreviousLayerConnectedCells(Y);var S=U.length;var P=B.length;var L=this.medianXValue(U,Y+1);var C=this.medianXValue(B,Y-1);var W=S+P;var Q=D.getGeneralPurposeVariable(Y);var e=Q;if(W>0){e=(L*S+C*P)/W;}var A=false;if(e<Q-d){if(N==0){D.setGeneralPurposeVariable(Y,e);A=true;}else{var J=f[Y][N-1];var G=J.getGeneralPurposeVariable(Y);G=G+J.width/2+this.intraCellSpacing+D.width/2;if(G<e){D.setGeneralPurposeVariable(Y,e);A=true;}else{if(G<D.getGeneralPurposeVariable(Y)-d){D.setGeneralPurposeVariable(Y,G);A=true;}}}}else{if(e>Q+d){var O=f[Y].length;if(N==O-1){D.setGeneralPurposeVariable(Y,e);A=true;}else{var X=f[Y][N+1];var I=X.getGeneralPurposeVariable(Y);I=I-X.width/2-this.intraCellSpacing-D.width/2;if(I>e){D.setGeneralPurposeVariable(Y,e);A=true;}else{if(I>D.getGeneralPurposeVariable(Y)+d){D.setGeneralPurposeVariable(Y,I);A=true;}}}}}if(A){for(var b=0;b<U.length;b++){var F=U[b];var R=mxCellPath.create(F.cell);var T=h[R];if(T!=null){if(T.visited==false){T.visited=true;g.push(T);}}}for(var b=0;b<B.length;b++){var F=B[b];var R=mxCellPath.create(F.cell);var T=h[R];if(T!=null){if(T.visited==false){T.visited=true;g.push(T);}}}}E.visited=false;K++;}};mxCoordinateAssignment.prototype.medianPos=function(C,B){var D=(C%2==0);if(D){for(var A=B.maxRank;A>0;A--){this.rankMedianPosition(A-1,B,A);}}else{for(var A=0;A<B.maxRank-1;A++){this.rankMedianPosition(A+1,B,A);}}};mxCoordinateAssignment.prototype.rankMedianPosition=function(P,D,M){var S=D.ranks[P];var H=[];var I=[];for(var R=0;R<S.length;R++){var L=S[R];H[R]=new WeightedCellSorter();H[R].cell=L;H[R].rankIndex=R;var K=mxCellPath.create(L.cell);I[K]=H[R];var N=null;if(M<P){N=L.getPreviousLayerConnectedCells(P);}else{N=L.getNextLayerConnectedCells(P);}H[R].weightedValue=this.calculatedWeightedValue(L,N);}H.sort(WeightedCellSorter.prototype.compare);for(var R=0;R<H.length;R++){var J=0;var A=H[R].cell;var N=null;var G=0;if(M<P){N=A.getPreviousLayerConnectedCells(P).slice();}else{N=A.getNextLayerConnectedCells(P).slice();}if(N!=null){J=N.length;if(J>0){G=this.medianXValue(N,M);}else{G=A.getGeneralPurposeVariable(P);}}var U=0;var C=-100000000;for(var Q=H[R].rankIndex-1;Q>=0;){var B=mxCellPath.create(S[Q].cell);var T=I[B];if(T!=null){var F=T.cell;if(T.visited){C=F.getGeneralPurposeVariable(P)+F.width/2+this.intraCellSpacing+U+A.width/2;Q=-1;}else{U+=F.width+this.intraCellSpacing;Q--;}}}var V=0;var E=100000000;for(var Q=H[R].rankIndex+1;Q<H.length;){var B=mxCellPath.create(S[Q].cell);var T=I[B];if(T!=null){var O=T.cell;if(T.visited){E=O.getGeneralPurposeVariable(P)-O.width/2-this.intraCellSpacing-V-A.width/2;Q=H.length;}else{V+=O.width+this.intraCellSpacing;Q++;}}}if(G>=C&&G<=E){A.setGeneralPurposeVariable(P,G);}else{if(G<C){A.setGeneralPurposeVariable(P,C);this.currentXDelta+=C-G;}else{if(G>E){A.setGeneralPurposeVariable(P,E);this.currentXDelta+=G-E;}}}H[R].visited=true;}};mxCoordinateAssignment.prototype.calculatedWeightedValue=function(E,D){var B=0;for(var C=0;C<D.length;C++){var A=D[C];if(E.isVertex()&&A.isVertex()){B++;}else{if(E.isEdge()&&A.isEdge()){B+=8;}else{B+=2;}}}return B;};mxCoordinateAssignment.prototype.medianXValue=function(C,G){if(C.length==0){return 0;}var A=[];for(var F=0;F<C.length;F++){A[F]=C[F].getGeneralPurposeVariable(G);}A.sort(MedianCellSorter.prototype.compare);if(C.length%2==1){return A[C.length/2];}else{var E=C.length/2;var B=A[E-1];var D=A[E];return((B+D)/2);}};mxCoordinateAssignment.prototype.initialCoords=function(C,A){this.calculateWidestRank(C,A);for(var B=this.widestRank;B>=0;B--){if(B<A.maxRank){this.rankCoordinates(B,C,A);}}for(var B=this.widestRank+1;B<=A.maxRank;B++){if(B>0){this.rankCoordinates(B,C,A);}}};mxCoordinateAssignment.prototype.rankCoordinates=function(K,J,I){var G=I.ranks[K];var B=0;var E=this.initialX+(this.widestRankValue-this.rankWidths[K])/2;var C=false;for(var H=0;H<G.length;H++){var D=G[H];if(D.isVertex()){var A=this.layout.getVertexBounds(D.cell);if(A!=null){if(this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH){D.width=A.width;D.height=A.height;}else{D.width=A.height;D.height=A.width;}}else{C=true;}B=Math.max(B,D.height);}else{if(D.isEdge()){var F=1;if(D.edges!=null){F=D.edges.length;}else{mxLog.warn("edge.edges is null");}D.width=(F-1)*this.parallelEdgeSpacing;}}E+=D.width/2;D.setX(K,E);D.setGeneralPurposeVariable(K,E);E+=D.width/2;E+=this.intraCellSpacing;}if(C==true){mxLog.warn("At least one cell has no bounds");}};mxCoordinateAssignment.prototype.calculateWidestRank=function(N,K){var L=-this.interRankCellSpacing;var E=0;this.rankWidths=[];this.rankY=[];for(var O=K.maxRank;O>=0;O--){var B=0;var J=K.ranks[O];var F=this.initialX;var C=false;for(var I=0;I<J.length;I++){var D=J[I];if(D.isVertex()){var A=this.layout.getVertexBounds(D.cell);if(A!=null){if(this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH){D.width=A.width;D.height=A.height;}else{D.width=A.height;D.height=A.width;}}else{C=true;}B=Math.max(B,D.height);}else{if(D.isEdge()){var H=1;if(D.edges!=null){H=D.edges.length;}else{mxLog.warn("edge.edges is null");}D.width=(H-1)*this.parallelEdgeSpacing;}}F+=D.width/2;D.setX(O,F);D.setGeneralPurposeVariable(O,F);F+=D.width/2;F+=this.intraCellSpacing;if(F>this.widestRankValue){this.widestRankValue=F;this.widestRank=O;}this.rankWidths[O]=F;}if(C==true){mxLog.warn("At least one cell has no bounds");}this.rankY[O]=L;var G=B/2+E/2+this.interRankCellSpacing;E=B;if(this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_WEST){L+=G;}else{L-=G;}for(var I=0;I<J.length;I++){var M=J[I];M.setY(O,L);}}};mxCoordinateAssignment.prototype.setCellLocations=function(M,I){for(var F=0;F<I.ranks.length;F++){var E=I.ranks[F];for(var H=0;H<E.length;H++){var B=E[H];if(B.isVertex()){var L=B.cell;var K=B.x[0]-B.width/2;var J=B.y[0]-B.height/2;if(this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH){this.layout.setVertexLocation(L,K,J);}else{this.layout.setVertexLocation(L,J,K);}limitX=Math.max(this.limitX,K+B.width);}else{if(B.isEdge()){var G=0;if(B.temp[0]!=101207){for(var D=0;D<B.edges.length;D++){var A=B.edges[D];var N=[];if(B.isReversed){for(var C=0;C<B.x.length;C++){var K=B.x[C]+G;if(this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH){N.push(new mxPoint(K,B.y[C]));}else{N.push(new mxPoint(B.y[C],K));}limitX=Math.max(limitX,K);}this.processReversedEdge(B,A);}else{for(var C=B.x.length-1;C>=0;C--){var K=B.x[C]+G;if(this.orientation==mxConstants.DIRECTION_NORTH||this.orientation==mxConstants.DIRECTION_SOUTH){N.push(new mxPoint(K,B.y[C]));}else{N.push(new mxPoint(B.y[C],K));}limitX=Math.max(limitX,K);}}this.layout.setEdgePoints(A,N);if(G==0){G=this.parallelEdgeSpacing;}else{if(G>0){G=-G;}else{G=-G+this.parallelEdgeSpacing;}}}B.temp[0]=101207;}}}}}};mxCoordinateAssignment.prototype.processReversedEdge=function(B,A){};function WeightedCellSorter(A,B){this.cell=A;this.weightedValue=B;}WeightedCellSorter.prototype.weightedValue=0;WeightedCellSorter.prototype.nudge=false;WeightedCellSorter.prototype.visited=false;WeightedCellSorter.prototype.rankIndex=null;WeightedCellSorter.prototype.cell=null;WeightedCellSorter.prototype.compare=function(B,A){if(B!=null&&A!=null){if(A.weightedValue>B.weightedValue){return -1;}else{if(A.weightedValue<B.weightedValue){return 1;}else{if(A.nudge){return -1;}else{return 1;}}}}else{return 0;}};function mxHierarchicalLayout(C,A,B){mxGraphLayout.call(this,C);this.orientation=(A!=null)?A:mxConstants.DIRECTION_NORTH;this.deterministic=(B!=null)?B:true;}mxHierarchicalLayout.prototype=new mxGraphLayout();mxHierarchicalLayout.prototype.constructor=mxHierarchicalLayout;mxHierarchicalLayout.prototype.roots=null;mxHierarchicalLayout.prototype.resizeParent=false;mxHierarchicalLayout.prototype.moveParent=false;mxHierarchicalLayout.prototype.parentBorder=0;mxHierarchicalLayout.prototype.intraCellSpacing=30;mxHierarchicalLayout.prototype.interRankCellSpacing=50;mxHierarchicalLayout.prototype.interHierarchySpacing=60;mxHierarchicalLayout.prototype.parallelEdgeSpacing=10;mxHierarchicalLayout.prototype.orientation=mxConstants.DIRECTION_NORTH;mxHierarchicalLayout.prototype.fineTuning=true;mxHierarchicalLayout.prototype.deterministic;mxHierarchicalLayout.prototype.fixRoots=false;mxHierarchicalLayout.prototype.layoutFromSinks=true;mxHierarchicalLayout.prototype.tightenToSource=true;mxHierarchicalLayout.prototype.disableEdgeStyle=true;mxHierarchicalLayout.prototype.model=null;mxHierarchicalLayout.prototype.getModel=function(){return this.model;};mxHierarchicalLayout.prototype.execute=function(C,A){if(A==null){A=this.graph.findTreeRoots(C);}this.roots=A;if(this.roots!=null){var B=this.graph.getModel();B.beginUpdate();try{this.run(C);if(this.resizeParent&&!this.graph.isCellCollapsed(C)){this.graph.updateGroupBounds([C],this.parentBorder,this.moveParent);}}finally{B.endUpdate();}}};mxHierarchicalLayout.prototype.run=function(F){var S=[];var G=null;var L=null;var W=null;if(this.fixRoots){G=[];L=[];W=[];}for(var U=0;U<this.roots.length;U++){var I=true;for(var T=0;I&&T<S.length;T++){var Y=mxCellPath.create(this.roots[U]);if(S[T][Y]!=null){I=false;}}if(I){var E=[];E.push(this.roots[U]);var C=null;if(this.fixRoots){G.push(this.roots[U]);var A=this.getVertexBounds(this.roots[U]).getPoint();L.push(A);C=[];}var M=new Object();while(E.length>0){var B=E.shift();var a=mxCellPath.create(B);if(M[a]==null){M[a]=B;if(this.fixRoots){var X=this.graph.getIncomingEdges(B,F);for(var R=0;R<X.length;R++){C.push(X[R]);}}var H=this.graph.getConnections(B,F);var D=this.graph.getOpposites(H,B);for(var R=0;R<D.length;R++){var J=mxCellPath.create(D[R]);if(M[J]==null){E.push(D[R]);}}}}S.push(M);if(this.fixRoots){W.push(C);}}}var Z=0;for(var U=0;U<S.length;U++){var M=S[U];var X=[];for(var b in M){X.push(M[b]);}this.model=new mxGraphHierarchyModel(this,X,this.roots,F,false,this.deterministic,this.tightenToSource,true);this.cycleStage(F);this.layeringStage();this.crossingStage(F);Z=this.placementStage(Z,F);if(this.fixRoots){var Q=G[U];var O=L[U];var P=this.getVertexBounds(Q).getPoint();var N=O.x-P.x;var K=O.y-P.y;this.graph.moveCells(M,N,K);var V=W[U+1];this.graph.moveCells(V,N,K);}}};mxHierarchicalLayout.prototype.cycleStage=function(B){var A=new mxMinimumCycleRemover(this);A.execute(B);};mxHierarchicalLayout.prototype.layeringStage=function(){this.model.initialRank();this.model.fixRanks();};mxHierarchicalLayout.prototype.crossingStage=function(A){var B=new mxMedianHybridCrossingReduction(this);B.execute(A);};mxHierarchicalLayout.prototype.placementStage=function(A,C){var B=new mxCoordinateAssignment(this,this.intraCellSpacing,this.interRankCellSpacing,this.orientation,A,this.parallelEdgeSpacing);B.fineTuning=this.fineTuning;B.execute(C);return B.limitX+this.interHierarchySpacing;};function mxGraphModel(A){this.currentEdit=this.createUndoableEdit();if(A!=null){this.setRoot(A);}else{this.clear();}}mxGraphModel.prototype=new mxEventSource();mxGraphModel.prototype.constructor=mxGraphModel;mxGraphModel.prototype.root=null;mxGraphModel.prototype.cells=null;mxGraphModel.prototype.maintainEdgeParent=true;mxGraphModel.prototype.createIds=true;mxGraphModel.prototype.prefix="";mxGraphModel.prototype.postfix="";mxGraphModel.prototype.nextId=0;mxGraphModel.prototype.currentEdit=null;mxGraphModel.prototype.updateLevel=0;mxGraphModel.prototype.endingUpdate=false;mxGraphModel.prototype.clear=function(){this.setRoot(this.createRoot());};mxGraphModel.prototype.isCreateIds=function(){return this.createIds;};mxGraphModel.prototype.setCreateIds=function(A){this.createIds=A;};mxGraphModel.prototype.createRoot=function(){var A=new mxCell();A.insert(new mxCell());return A;};mxGraphModel.prototype.getCell=function(A){return(this.cells!=null)?this.cells[A]:null;};mxGraphModel.prototype.filterCells=function(B,D){var A=null;if(B!=null){A=[];for(var C=0;C<B.length;C++){if(D(B[C])){A.push(B[C]);}}}return A;};mxGraphModel.prototype.getDescendants=function(A){return this.filterDescendants(null,A);};mxGraphModel.prototype.filterDescendants=function(E,D){var A=[];D=D||this.getRoot();if(E==null||E(D)){A.push(D);}var B=this.getChildCount(D);for(var C=0;C<B;C++){var F=this.getChildAt(D,C);A=A.concat(this.filterDescendants(E,F));}return A;};mxGraphModel.prototype.getRoot=function(A){var B=A||this.root;if(A!=null){while(A!=null){B=A;A=this.getParent(A);}}return B;};mxGraphModel.prototype.setRoot=function(A){this.execute(new mxRootChange(this,A));return A;};mxGraphModel.prototype.rootChanged=function(A){var B=this.root;this.root=A;this.nextId=0;this.cells=null;this.cellAdded(A);return B;};mxGraphModel.prototype.isRoot=function(A){return A!=null&&this.root==A;};mxGraphModel.prototype.isLayer=function(A){return this.isRoot(this.getParent(A));};mxGraphModel.prototype.isAncestor=function(A,B){while(B!=null&&B!=A){B=this.getParent(B);}return B==A;};mxGraphModel.prototype.contains=function(A){return this.isAncestor(this.root,A);};mxGraphModel.prototype.getParent=function(A){return(A!=null)?A.getParent():null;};mxGraphModel.prototype.add=function(B,D,A){if(D!=B&&B!=null&&D!=null){if(A==null){A=this.getChildCount(B);}var C=B!=this.getParent(D);this.execute(new mxChildChange(this,B,D,A));if(this.maintainEdgeParent&&C){this.updateEdgeParents(D);}}return D;};mxGraphModel.prototype.cellAdded=function(A){if(A!=null){if(A.getId()==null&&this.createIds){A.setId(this.createId(A));}if(A.getId()!=null){var D=this.getCell(A.getId());if(D!=A){while(D!=null){A.setId(this.createId(A));D=this.getCell(A.getId());}if(this.cells==null){this.cells=new Object();}this.cells[A.getId()]=A;}}if(mxUtils.isNumeric(A.getId())){this.nextId=Math.max(this.nextId,A.getId());}var B=this.getChildCount(A);for(var C=0;C<B;C++){this.cellAdded(this.getChildAt(A,C));}}};mxGraphModel.prototype.createId=function(A){var B=this.nextId;this.nextId++;return this.prefix+B+this.postfix;};mxGraphModel.prototype.updateEdgeParents=function(A,B){B=B||this.getRoot(A);var D=this.getChildCount(A);for(var E=0;E<D;E++){var H=this.getChildAt(A,E);this.updateEdgeParents(H,B);}var G=this.getEdgeCount(A);var C=[];for(var E=0;E<G;E++){C.push(this.getEdgeAt(A,E));}for(var E=0;E<C.length;E++){var F=C[E];if(this.isAncestor(B,F)){this.updateEdgeParent(F,B);}}};mxGraphModel.prototype.updateEdgeParent=function(B,G){var A=this.getTerminal(B,true);var D=this.getTerminal(B,false);var H=null;if(this.isAncestor(G,A)&&this.isAncestor(G,D)){if(A==D){H=this.getParent(A);}else{H=this.getNearestCommonAncestor(A,D);}if(H!=null&&(this.getParent(H)!=this.root||this.isAncestor(H,B))&&this.getParent(B)!=H){var C=this.getGeometry(B);if(C!=null){var F=this.getOrigin(this.getParent(B));var E=this.getOrigin(H);var J=E.x-F.x;var I=E.y-F.y;C=C.clone();C.translate(-J,-I);this.setGeometry(B,C);}this.add(H,B,this.getChildCount(H));}}};mxGraphModel.prototype.getOrigin=function(B){var A=null;if(B!=null){A=this.getOrigin(this.getParent(B));if(!this.isEdge(B)){var C=this.getGeometry(B);if(C!=null){A.x+=C.x;A.y+=C.y;}}}else{A=new mxPoint();}return A;};mxGraphModel.prototype.getNearestCommonAncestor=function(C,B){if(C!=null&&B!=null){var F=mxCellPath.create(B);if(F!=null&&F.length>0){var A=C;var E=mxCellPath.create(A);while(A!=null){var D=this.getParent(A);if(F.indexOf(E+mxCellPath.PATH_SEPARATOR)==0&&D!=null){return A;}E=mxCellPath.getParentPath(E);A=D;}}}return null;};mxGraphModel.prototype.remove=function(A){if(A==this.root){this.setRoot(null);}else{if(this.getParent(A)!=null){this.execute(new mxChildChange(this,null,A));}}return A;};mxGraphModel.prototype.cellRemoved=function(A){if(A!=null&&this.cells!=null){var B=this.getChildCount(A);for(var C=B-1;C>=0;C--){this.cellRemoved(this.getChildAt(A,C));}if(this.cells!=null&&A.getId()!=null){delete this.cells[A.getId()];}}};mxGraphModel.prototype.parentForCellChanged=function(A,C,B){var D=this.getParent(A);if(C!=null){if(C!=D||D.getIndex(A)!=B){C.insert(A,B);}}else{if(D!=null){var E=D.getIndex(A);D.remove(E);}}if(!this.contains(D)&&C!=null){this.cellAdded(A);}else{if(C==null){this.cellRemoved(A);}}return D;};mxGraphModel.prototype.getChildCount=function(A){return(A!=null)?A.getChildCount():0;};mxGraphModel.prototype.getChildAt=function(A,B){return(A!=null)?A.getChildAt(B):null;};mxGraphModel.prototype.getChildren=function(A){return(A!=null)?A.children:null;};mxGraphModel.prototype.getChildVertices=function(A){return this.getChildCells(A,true,false);};mxGraphModel.prototype.getChildEdges=function(A){return this.getChildCells(A,false,true);};mxGraphModel.prototype.getChildCells=function(F,D,C){D=(D!=null)?D:false;C=(C!=null)?C:false;var B=this.getChildCount(F);var A=[];for(var E=0;E<B;E++){var G=this.getChildAt(F,E);if((!C&&!D)||(C&&this.isEdge(G))||(D&&this.isVertex(G))){A.push(G);}}return A;};mxGraphModel.prototype.getTerminal=function(B,A){return(B!=null)?B.getTerminal(A):null;};mxGraphModel.prototype.setTerminal=function(D,C,B){var A=C!=this.getTerminal(D,B);this.execute(new mxTerminalChange(this,D,C,B));if(this.maintainEdgeParent&&A){this.updateEdgeParent(D,this.getRoot());}return C;};mxGraphModel.prototype.setTerminals=function(A,B,C){this.beginUpdate();try{this.setTerminal(A,B,true);this.setTerminal(A,C,false);}finally{this.endUpdate();}};mxGraphModel.prototype.terminalForCellChanged=function(D,B,A){var C=this.getTerminal(D,A);if(B!=null){B.insertEdge(D,A);}else{if(C!=null){C.removeEdge(D,A);}}return C;};mxGraphModel.prototype.getEdgeCount=function(A){return(A!=null)?A.getEdgeCount():0;};mxGraphModel.prototype.getEdgeAt=function(A,B){return(A!=null)?A.getEdgeAt(B):null;};mxGraphModel.prototype.getDirectedEdgeCount=function(A,B,F){var E=0;var G=this.getEdgeCount(A);for(var C=0;C<G;C++){var D=this.getEdgeAt(A,C);if(D!=F&&this.getTerminal(D,B)==A){E++;}}return E;};mxGraphModel.prototype.getConnections=function(A){return this.getEdges(A,true,true,false);};mxGraphModel.prototype.getIncomingEdges=function(A){return this.getEdges(A,true,false,false);};mxGraphModel.prototype.getOutgoingEdges=function(A){return this.getEdges(A,false,true,false);};mxGraphModel.prototype.getEdges=function(I,E,G,D){E=(E!=null)?E:true;G=(G!=null)?G:true;D=(D!=null)?D:true;var B=this.getEdgeCount(I);var J=[];for(var F=0;F<B;F++){var C=this.getEdgeAt(I,F);var A=this.getTerminal(C,true);var H=this.getTerminal(C,false);if(D||((A!=H)&&((E&&H==I)||(G&&A==I)))){J.push(C);}}return J;};mxGraphModel.prototype.getEdgesBetween=function(C,K,F){F=(F!=null)?F:false;var H=this.getEdgeCount(C);var G=this.getEdgeCount(K);var J=C;var B=H;if(G<H){B=G;J=K;}var M=[];for(var I=0;I<B;I++){var E=this.getEdgeAt(J,I);var A=this.getTerminal(E,true);var D=this.getTerminal(E,false);var L=A==C;if(L&&D==K||(!F&&this.getTerminal(E,!L)==K)){M.push(E);}}return M;};mxGraphModel.prototype.getOpposites=function(B,E,C,A){C=(C!=null)?C:true;A=(A!=null)?A:true;var H=[];if(B!=null){for(var D=0;D<B.length;D++){var F=this.getTerminal(B[D],true);var G=this.getTerminal(B[D],false);if(F==E&&G!=null&&G!=E&&A){H.push(G);}else{if(G==E&&F!=null&&F!=E&&C){H.push(F);}}}}return H;};mxGraphModel.prototype.getTopmostCells=function(C){var E=[];for(var D=0;D<C.length;D++){var A=C[D];var B=true;var F=this.getParent(A);while(F!=null){if(mxUtils.indexOf(C,F)>=0){B=false;break;}F=this.getParent(F);}if(B){E.push(A);}}return E;};mxGraphModel.prototype.isVertex=function(A){return(A!=null)?A.isVertex():false;};mxGraphModel.prototype.isEdge=function(A){return(A!=null)?A.isEdge():false;};mxGraphModel.prototype.isConnectable=function(A){return(A!=null)?A.isConnectable():false;};mxGraphModel.prototype.getValue=function(A){return(A!=null)?A.getValue():null;};mxGraphModel.prototype.setValue=function(A,B){this.execute(new mxValueChange(this,A,B));return B;};mxGraphModel.prototype.valueForCellChanged=function(A,B){return A.valueChanged(B);};mxGraphModel.prototype.getGeometry=function(A,B){return(A!=null)?A.getGeometry():null;};mxGraphModel.prototype.setGeometry=function(A,B){if(B!=this.getGeometry(A)){this.execute(new mxGeometryChange(this,A,B));}return B;};mxGraphModel.prototype.geometryForCellChanged=function(A,C){var B=this.getGeometry(A);A.setGeometry(C);return B;};mxGraphModel.prototype.getStyle=function(A){return(A!=null)?A.getStyle():null;};mxGraphModel.prototype.setStyle=function(A,B){if(B!=this.getStyle(A)){this.execute(new mxStyleChange(this,A,B));}return B;};mxGraphModel.prototype.styleForCellChanged=function(A,B){var C=this.getStyle(A);A.setStyle(B);return C;};mxGraphModel.prototype.isCollapsed=function(A){return(A!=null)?A.isCollapsed():false;};mxGraphModel.prototype.setCollapsed=function(A,B){if(B!=this.isCollapsed(A)){this.execute(new mxCollapseChange(this,A,B));}return B;};mxGraphModel.prototype.collapsedStateForCellChanged=function(A,C){var B=this.isCollapsed(A);A.setCollapsed(C);return B;};mxGraphModel.prototype.isVisible=function(A){return(A!=null)?A.isVisible():false;};mxGraphModel.prototype.setVisible=function(A,B){if(B!=this.isVisible(A)){this.execute(new mxVisibleChange(this,A,B));}return B;};mxGraphModel.prototype.visibleStateForCellChanged=function(A,C){var B=this.isVisible(A);A.setVisible(C);return B;};mxGraphModel.prototype.execute=function(A){A.execute();this.beginUpdate();this.currentEdit.add(A);this.fireEvent(new mxEventObject(mxEvent.EXECUTE,"change",A));this.endUpdate();};mxGraphModel.prototype.beginUpdate=function(){this.updateLevel++;this.fireEvent(new mxEventObject(mxEvent.BEGIN_UPDATE));};mxGraphModel.prototype.endUpdate=function(){this.updateLevel--;if(!this.endingUpdate){this.endingUpdate=this.updateLevel==0;this.fireEvent(new mxEventObject(mxEvent.END_UPDATE,"edit",this.currentEdit));try{if(this.endingUpdate&&!this.currentEdit.isEmpty()){this.fireEvent(new mxEventObject(mxEvent.BEFORE_UNDO,"edit",this.currentEdit));var A=this.currentEdit;this.currentEdit=this.createUndoableEdit();A.notify();this.fireEvent(new mxEventObject(mxEvent.UNDO,"edit",A));}}finally{this.endingUpdate=false;}}};mxGraphModel.prototype.createUndoableEdit=function(){var A=new mxUndoableEdit(this,true);A.notify=function(){A.source.fireEvent(new mxEventObject(mxEvent.CHANGE,"changes",A.changes));A.source.fireEvent(new mxEventObject(mxEvent.NOTIFY,"changes",A.changes));};return A;};mxGraphModel.prototype.mergeChildren=function(G,F,B){B=(B!=null)?B:true;this.beginUpdate();try{var C=new Object();this.mergeChildrenImpl(G,F,B,C);for(var E in C){var A=C[E];var D=this.getTerminal(A,true);if(D!=null){D=C[mxCellPath.create(D)];this.setTerminal(A,D,true);}D=this.getTerminal(A,false);if(D!=null){D=C[mxCellPath.create(D)];this.setTerminal(A,D,false);}}}finally{this.endUpdate();}};mxGraphModel.prototype.mergeChildrenImpl=function(H,I,D,A){this.beginUpdate();try{var C=H.getChildCount();for(var E=0;E<C;E++){var J=H.getChildAt(E);if(typeof (J.getId)=="function"){var B=J.getId();var F=(B!=null&&(!this.isEdge(J)||!D))?this.getCell(B):null;if(F==null){var G=J.clone();G.setId(B);G.setTerminal(J.getTerminal(true),true);G.setTerminal(J.getTerminal(false),false);F=I.insert(G);this.cellAdded(F);}A[mxCellPath.create(J)]=F;this.mergeChildrenImpl(J,F,D,A);}}}finally{this.endUpdate();}};mxGraphModel.prototype.getParents=function(B){var A=[];if(B!=null){var E=new Object();for(var C=0;C<B.length;C++){var D=this.getParent(B[C]);if(D!=null){var F=mxCellPath.create(D);if(E[F]==null){E[F]=D;A.push(D);}}}}return A;};mxGraphModel.prototype.cloneCell=function(A){if(A!=null){return this.cloneCells([A],true)[0];}return null;};mxGraphModel.prototype.cloneCells=function(C,A){var B=new Object();var E=[];for(var D=0;D<C.length;D++){if(C[D]!=null){E.push(this.cloneCellImpl(C[D],B,A));}else{E.push(null);}}for(var D=0;D<E.length;D++){if(E[D]!=null){this.restoreClone(E[D],C[D],B);}}return E;};mxGraphModel.prototype.cloneCellImpl=function(B,D,A){var G=this.cellCloned(B);D[mxObjectIdentity.get(B)]=G;if(A){var C=this.getChildCount(B);for(var E=0;E<C;E++){var F=this.cloneCellImpl(this.getChildAt(B,E),D,true);G.insert(F);}}return G;};mxGraphModel.prototype.cellCloned=function(A){return A.clone();};mxGraphModel.prototype.restoreClone=function(H,A,C){var F=this.getTerminal(A,true);if(F!=null){var E=C[mxObjectIdentity.get(F)];if(E!=null){E.insertEdge(H,true);}}var G=this.getTerminal(A,false);if(G!=null){var E=C[mxObjectIdentity.get(G)];if(E!=null){E.insertEdge(H,false);}}var B=this.getChildCount(H);for(var D=0;D<B;D++){this.restoreClone(this.getChildAt(H,D),this.getChildAt(A,D),C);}};function mxRootChange(B,A){this.model=B;this.root=A;this.previous=A;}mxRootChange.prototype.execute=function(){this.root=this.previous;this.previous=this.model.rootChanged(this.previous);};function mxChildChange(B,C,D,A){this.model=B;this.parent=C;this.previous=C;this.child=D;this.index=A;this.previousIndex=A;this.isAdded=(C==null);}mxChildChange.prototype.execute=function(){var A=this.model.getParent(this.child);var B=(A!=null)?A.getIndex(this.child):0;if(this.previous==null){this.connect(this.child,false);}A=this.model.parentForCellChanged(this.child,this.previous,this.previousIndex);if(this.previous!=null){this.connect(this.child,true);}this.parent=this.previous;this.previous=A;this.index=this.previousIndex;this.previousIndex=B;this.isAdded=!this.isAdded;};mxChildChange.prototype.connect=function(A,D){D=(D!=null)?D:true;var E=A.getTerminal(true);var F=A.getTerminal(false);if(E!=null){if(D){this.model.terminalForCellChanged(A,E,true);}else{this.model.terminalForCellChanged(A,null,true);}}if(F!=null){if(D){this.model.terminalForCellChanged(A,F,false);}else{this.model.terminalForCellChanged(A,null,false);}}A.setTerminal(E,true);A.setTerminal(F,false);var B=this.model.getChildCount(A);for(var C=0;C<B;C++){this.connect(this.model.getChildAt(A,C),D);}};function mxTerminalChange(B,A,D,C){this.model=B;this.cell=A;this.terminal=D;this.previous=D;this.isSource=C;}mxTerminalChange.prototype.execute=function(){this.terminal=this.previous;this.previous=this.model.terminalForCellChanged(this.cell,this.previous,this.isSource);};function mxValueChange(B,A,C){this.model=B;this.cell=A;this.value=C;this.previous=C;}mxValueChange.prototype.execute=function(){this.value=this.previous;this.previous=this.model.valueForCellChanged(this.cell,this.previous);};function mxStyleChange(B,A,C){this.model=B;this.cell=A;this.style=C;this.previous=C;}mxStyleChange.prototype.execute=function(){this.style=this.previous;this.previous=this.model.styleForCellChanged(this.cell,this.previous);};function mxGeometryChange(B,A,C){this.model=B;this.cell=A;this.geometry=C;this.previous=C;}mxGeometryChange.prototype.execute=function(){this.geometry=this.previous;this.previous=this.model.geometryForCellChanged(this.cell,this.previous);};function mxCollapseChange(B,A,C){this.model=B;this.cell=A;this.collapsed=C;this.previous=C;}mxCollapseChange.prototype.execute=function(){this.collapsed=this.previous;this.previous=this.model.collapsedStateForCellChanged(this.cell,this.previous);};function mxVisibleChange(B,A,C){this.model=B;this.cell=A;this.visible=C;this.previous=C;}mxVisibleChange.prototype.execute=function(){this.visible=this.previous;this.previous=this.model.visibleStateForCellChanged(this.cell,this.previous);};function mxCellAttributeChange(A,B,C){this.cell=A;this.attribute=B;this.value=C;this.previous=C;}mxCellAttributeChange.prototype.execute=function(){var A=this.cell.getAttribute(this.attribute);if(this.previous==null){this.cell.value.removeAttribute(this.attribute);}else{this.cell.setAttribute(this.attribute,this.previous);}this.previous=A;};function mxCell(B,C,A){this.value=B;this.setGeometry(C);this.setStyle(A);if(this.onInit!=null){this.onInit();}}mxCell.prototype.id=null;mxCell.prototype.value=null;mxCell.prototype.geometry=null;mxCell.prototype.style=null;mxCell.prototype.vertex=false;mxCell.prototype.edge=false;mxCell.prototype.connectable=true;mxCell.prototype.visible=true;mxCell.prototype.collapsed=false;mxCell.prototype.parent=null;mxCell.prototype.source=null;mxCell.prototype.target=null;mxCell.prototype.children=null;mxCell.prototype.edges=null;mxCell.prototype.mxTransient=["id","value","parent","source","target","children","edges"];mxCell.prototype.getId=function(){return this.id;};mxCell.prototype.setId=function(A){this.id=A;};mxCell.prototype.getValue=function(){return this.value;};mxCell.prototype.setValue=function(A){this.value=A;};mxCell.prototype.valueChanged=function(B){var A=this.getValue();this.setValue(B);return A;};mxCell.prototype.getGeometry=function(){return this.geometry;};mxCell.prototype.setGeometry=function(A){this.geometry=A;};mxCell.prototype.getStyle=function(){return this.style;};mxCell.prototype.setStyle=function(A){this.style=A;};mxCell.prototype.isVertex=function(){return this.vertex;};mxCell.prototype.setVertex=function(A){this.vertex=A;};mxCell.prototype.isEdge=function(){return this.edge;};mxCell.prototype.setEdge=function(A){this.edge=A;};mxCell.prototype.isConnectable=function(){return this.connectable;};mxCell.prototype.setConnectable=function(A){this.connectable=A;};mxCell.prototype.isVisible=function(){return this.visible;};mxCell.prototype.setVisible=function(A){this.visible=A;};mxCell.prototype.isCollapsed=function(){return this.collapsed;};mxCell.prototype.setCollapsed=function(A){this.collapsed=A;};mxCell.prototype.getParent=function(A){return this.parent;};mxCell.prototype.setParent=function(A){this.parent=A;};mxCell.prototype.getTerminal=function(A){return(A)?this.source:this.target;};mxCell.prototype.setTerminal=function(B,A){if(A){this.source=B;}else{this.target=B;}return B;};mxCell.prototype.getChildCount=function(){return(this.children==null)?0:this.children.length;};mxCell.prototype.getIndex=function(A){return mxUtils.indexOf(this.children,A);};mxCell.prototype.getChildAt=function(A){return(this.children==null)?null:this.children[A];};mxCell.prototype.insert=function(B,A){if(B!=null){if(A==null){A=this.getChildCount();if(B.getParent()==this&&this.getIndex(B)>=0){A--;}}B.removeFromParent();B.setParent(this);if(this.children==null){this.children=[];this.children.push(B);}else{this.children.splice(A,0,B);}}return B;};mxCell.prototype.remove=function(A){var B=null;if(this.children!=null&&A>=0){B=this.getChildAt(A);if(B!=null){this.children.splice(A,1);B.setParent(null);}}return B;};mxCell.prototype.removeFromParent=function(){if(this.parent!=null){var A=this.parent.getIndex(this);this.parent.remove(A);}};mxCell.prototype.getEdgeCount=function(){return(this.edges==null)?0:this.edges.length;};mxCell.prototype.getEdgeIndex=function(A){return mxUtils.indexOf(this.edges,A);};mxCell.prototype.getEdgeAt=function(A){return(this.edges==null)?null:this.edges[A];};mxCell.prototype.insertEdge=function(A,B){if(A!=null){A.removeFromTerminal(B);A.setTerminal(this,B);if(this.edges==null||A.getTerminal(!B)!=this||mxUtils.indexOf(this.edges,A)<0){if(this.edges==null){this.edges=[];}this.edges.push(A);}}return A;};mxCell.prototype.removeEdge=function(B,C){if(B!=null){if(B.getTerminal(!C)!=this&&this.edges!=null){var A=this.getEdgeIndex(B);if(A>=0){this.edges.splice(A,1);}}B.setTerminal(null,C);}return B;};mxCell.prototype.removeFromTerminal=function(B){var A=this.getTerminal(B);if(A!=null){A.removeEdge(this,B);}};mxCell.prototype.getAttribute=function(B,A){var C=this.getValue();var D=(C!=null&&C.nodeType==mxConstants.NODETYPE_ELEMENT)?C.getAttribute(B):null;return D||A;};mxCell.prototype.setAttribute=function(A,C){var B=this.getValue();if(B!=null&&B.nodeType==mxConstants.NODETYPE_ELEMENT){B.setAttribute(A,C);}};mxCell.prototype.clone=function(){var A=mxUtils.clone(this,this.mxTransient);A.setValue(this.cloneValue());return A;};mxCell.prototype.cloneValue=function(){var A=this.getValue();if(A!=null){if(typeof (A.clone)=="function"){A=A.clone();}else{if(!isNaN(A.nodeType)){A=A.cloneNode(true);}}}return A;};function mxGeometry(B,D,C,A){mxRectangle.call(this,B,D,C,A);}mxGeometry.prototype=new mxRectangle();mxGeometry.prototype.constructor=mxGeometry;mxGeometry.prototype.TRANSLATE_CONTROL_POINTS=true;mxGeometry.prototype.alternateBounds=null;mxGeometry.prototype.sourcePoint=null;mxGeometry.prototype.targetPoint=null;mxGeometry.prototype.points=null;mxGeometry.prototype.offset=null;mxGeometry.prototype.relative=false;mxGeometry.prototype.swap=function(){if(this.alternateBounds!=null){var A=new mxRectangle(this.x,this.y,this.width,this.height);this.x=this.alternateBounds.x;this.y=this.alternateBounds.y;this.width=this.alternateBounds.width;this.height=this.alternateBounds.height;this.alternateBounds=A;}};mxGeometry.prototype.getTerminalPoint=function(A){return(A)?this.sourcePoint:this.targetPoint;};mxGeometry.prototype.setTerminalPoint=function(A,B){if(B){this.sourcePoint=A;}else{this.targetPoint=A;}return A;};mxGeometry.prototype.translate=function(B,A){var F=this.clone();if(!this.relative){this.x+=B;this.y+=A;}if(this.sourcePoint!=null){this.sourcePoint.x+=B;this.sourcePoint.y+=A;}if(this.targetPoint!=null){this.targetPoint.x+=B;this.targetPoint.y+=A;}if(this.TRANSLATE_CONTROL_POINTS&&this.points!=null){var D=this.points.length;for(var C=0;C<D;C++){var E=this.points[C];if(E!=null){E.x+=B;E.y+=A;}}}};var mxCellPath={PATH_SEPARATOR:".",create:function(B){var A="";if(B!=null){var D=B.getParent();while(D!=null){var C=D.getIndex(B);A=C+mxCellPath.PATH_SEPARATOR+A;B=D;D=B.getParent();}}var E=A.length;if(E>1){A=A.substring(0,E-1);}return A;},getParentPath:function(B){if(B!=null){var A=B.lastIndexOf(mxCellPath.PATH_SEPARATOR);if(A>=0){return B.substring(0,A);}else{if(B.length>0){return"";}}}return null;},resolve:function(A,E){var C=A;if(E!=null){var D=E.split(mxCellPath.PATH_SEPARATOR);for(var B=0;B<D.length;B++){C=C.getChildAt(parseInt(D[B]));}}return C;},compare:function(G,F){var C=Math.min(G.length,F.length);var A=0;for(var B=0;B<C;B++){if(G[B]!=F[B]){if(G[B].length==0||F[B].length==0){A=(G[B]==F[B])?0:((G[B]>F[B])?1:-1);}else{var E=parseInt(G[B]);var D=parseInt(F[B]);A=(E==D)?0:((E>D)?1:-1);}break;}}if(A==0){var E=G.length;var D=F.length;if(E!=D){A=(E>D)?1:-1;}}return A;}};var mxPerimeter={RectanglePerimeter:function(A,I,H,C){var F=A.getCenterX();var D=A.getCenterY();var N=H.x-F;var M=H.y-D;var E=Math.atan2(M,N);var B=new mxPoint(0,0);var G=Math.PI;var J=Math.PI/2;var K=J-E;var L=Math.atan2(A.height,A.width);if(E<-G+L||E>G-L){B.x=A.x;B.y=D-A.width*Math.tan(E)/2;}else{if(E<-L){B.y=A.y;B.x=F-A.height*Math.tan(K)/2;}else{if(E<L){B.x=A.x+A.width;B.y=D+A.width*Math.tan(E)/2;}else{B.y=A.y+A.height;B.x=F+A.height*Math.tan(K)/2;}}}if(C){if(H.x>=A.x&&H.x<=A.x+A.width){B.x=H.x;}else{if(H.y>=A.y&&H.y<=A.y+A.height){B.y=H.y;}}if(H.x<A.x){B.x=A.x;}else{if(H.x>A.x+A.width){B.x=A.x+A.width;}}if(H.y<A.y){B.y=A.y;}else{if(H.y>A.y+A.height){B.y=A.y+A.height;}}}return B;},EllipsePerimeter:function(E,W,Q,D){var K=E.x;var J=E.y;var l=E.width/2;var j=E.height/2;var B=K+l;var A=J+j;var O=Q.x;var N=Q.y;var M=parseInt(O-B);var L=parseInt(N-A);if(M==0){return new mxPoint(B,A+j*L/Math.abs(L));}if(D){if(N>=J&&N<=J+E.height){var k=N-A;var m=Math.sqrt(l*l*(1-(k*k)/(j*j)))||0;if(O<=K){m=-m;}return new mxPoint(B+m,N);}if(O>=K&&O<=K+E.width){var m=O-B;var k=Math.sqrt(j*j*(1-(m*m)/(l*l)))||0;if(N<=J){k=-k;}return new mxPoint(O,A+k);}}var Z=L/M;var U=A-Z*B;var Y=l*l*Z*Z+j*j;var X=-2*B*Y;var V=l*l*Z*Z*B*B+j*j*B*B-l*l*j*j;var C=Math.sqrt(X*X-4*Y*V);var S=(-X+C)/(2*Y);var R=(-X-C)/(2*Y);var G=Z*S+U;var F=Z*R+U;var I=Math.sqrt(Math.pow((S-O),2)+Math.pow((G-N),2));var H=Math.sqrt(Math.pow((R-O),2)+Math.pow((F-N),2));var P=0;var T=0;if(I<H){P=S;T=G;}else{P=R;T=F;}return new mxPoint(P,T);},RhombusPerimeter:function(A,I,G,B){var L=A.x;var J=A.y;var N=A.width;var H=A.height;var D=L+N/2;var C=J+H/2;var M=G.x;var K=G.y;if(D==M){if(C>K){return new mxPoint(D,J);}else{return new mxPoint(D,J+H);}}else{if(C==K){if(D>M){return new mxPoint(L,C);}else{return new mxPoint(L+N,C);}}}var F=D;var E=C;if(B){if(M>=L&&M<=L+N){F=M;}else{if(K>=J&&K<=J+H){E=K;}}}if(M<D){if(K<C){return mxUtils.intersection(M,K,F,E,D,J,L,C);}else{return mxUtils.intersection(M,K,F,E,D,J+H,L,C);}}else{if(K<C){return mxUtils.intersection(M,K,F,E,D,J,L+N,C);}else{return mxUtils.intersection(M,K,F,E,D,J+H,L+N,C);}}},TrianglePerimeter:function(I,U,R,F){var V=(U!=null)?U.style[mxConstants.STYLE_DIRECTION]:null;var A=V==mxConstants.DIRECTION_NORTH||V==mxConstants.DIRECTION_SOUTH;var L=I.x;var K=I.y;var O=I.width;var T=I.height;var C=L+O/2;var B=K+T/2;var G=new mxPoint(L,K);var J=new mxPoint(L+O,B);var D=new mxPoint(L,K+T);if(V==mxConstants.DIRECTION_NORTH){G=D;J=new mxPoint(C,K);D=new mxPoint(L+O,K+T);}else{if(V==mxConstants.DIRECTION_SOUTH){J=new mxPoint(C,K+T);D=new mxPoint(L+O,K);}else{if(V==mxConstants.DIRECTION_WEST){G=new mxPoint(L+O,K);J=new mxPoint(L,B);D=new mxPoint(L+O,K+T);}}}var P=R.x-C;var N=R.y-B;var E=(A)?Math.atan2(P,N):Math.atan2(N,P);var Q=(A)?Math.atan2(O,T):Math.atan2(T,O);var H=false;if(V==mxConstants.DIRECTION_NORTH||V==mxConstants.DIRECTION_WEST){H=E>-Q&&E<Q;}else{H=E<-Math.PI+Q||E>Math.PI-Q;}var M=null;if(H){if(F&&((A&&R.x>=G.x&&R.x<=D.x)||(!A&&R.y>=G.y&&R.y<=D.y))){if(A){M=new mxPoint(R.x,G.y);}else{M=new mxPoint(G.x,R.y);}}else{if(V==mxConstants.DIRECTION_NORTH){M=new mxPoint(L+O/2+T*Math.tan(E)/2,K+T);}else{if(V==mxConstants.DIRECTION_SOUTH){M=new mxPoint(L+O/2-T*Math.tan(E)/2,K);}else{if(V==mxConstants.DIRECTION_WEST){M=new mxPoint(L+O,K+T/2+O*Math.tan(E)/2);}else{M=new mxPoint(L,K+T/2-O*Math.tan(E)/2);}}}}}else{if(F){var S=new mxPoint(C,B);if(R.y>=K&&R.y<=K+T){S.x=(A)?C:((V==mxConstants.DIRECTION_WEST)?L+O:L);S.y=R.y;}else{if(R.x>=L&&R.x<=L+O){S.x=R.x;S.y=(!A)?B:((V==mxConstants.DIRECTION_NORTH)?K+T:K);}}P=R.x-S.x;N=R.y-S.y;C=S.x;B=S.y;}if((A&&R.x<=L+O/2)||(!A&&R.y<=K+T/2)){M=mxUtils.intersection(R.x,R.y,C,B,G.x,G.y,J.x,J.y);}else{M=mxUtils.intersection(R.x,R.y,C,B,J.x,J.y,D.x,D.y);}}if(M==null){M=new mxPoint(C,B);}return M;}};function mxPrintPreview(I,D,C,E,A,H,B,G,F){this.graph=I;this.scale=(D!=null)?D:1/I.pageScale;this.border=(E!=null)?E:0;this.pageFormat=(C!=null)?C:I.pageFormat;this.title=(G!=null)?G:"Printer-friendly version";this.x0=(A!=null)?A:0;this.y0=(H!=null)?H:0;this.borderColor=B;this.pageSelector=(F!=null)?F:true;}mxPrintPreview.prototype.graph=null;mxPrintPreview.prototype.pageFormat=null;mxPrintPreview.prototype.scale=null;mxPrintPreview.prototype.border=null;mxPrintPreview.prototype.x0=null;mxPrintPreview.prototype.y0=null;mxPrintPreview.prototype.autoOrigin=true;mxPrintPreview.prototype.printOverlays=false;mxPrintPreview.prototype.borderColor=null;mxPrintPreview.prototype.title=null;mxPrintPreview.prototype.pageSelector=null;mxPrintPreview.prototype.wnd=null;mxPrintPreview.prototype.pageCount=null;mxPrintPreview.prototype.getWindow=function(){return this.wnd;};mxPrintPreview.prototype.open=function(I){var K=this.graph.cellRenderer.initializeOverlay;var L=null;try{if(this.printOverlays){this.graph.cellRenderer.initializeOverlay=function(V,U){U.init(V.view.getDrawPane());};}if(this.wnd==null){this.wnd=window.open();var T=this.wnd.document;T.writeln("<html>");T.writeln("<head>");this.writeHead(T,I);T.writeln("</head>");T.writeln("<body>");mxClient.link("stylesheet",mxClient.basePath+"/css/common.css",T);if(false){T.namespaces.add("v","urn:schemas-microsoft-com:vml");T.namespaces.add("o","urn:schemas-microsoft-com:office:office");mxClient.link("stylesheet",mxClient.basePath+"/css/explorer.css",T);}var F=this.graph.getGraphBounds().clone();var M=this.graph.getView().getScale();var A=M/this.scale;var C=this.graph.getView().getTranslate();if(!this.autoOrigin){this.x0=-C.x*this.scale;this.y0=-C.y*this.scale;F.width+=F.x;F.height+=F.y;F.x=0;F.y=0;this.border=0;}F.width/=A;F.height/=A;var B=this.pageFormat.width-(this.border*2);var D=this.pageFormat.height-(this.border*2);var E=Math.max(1,Math.ceil((F.width+this.y0)/B));var S=Math.max(1,Math.ceil((F.height+this.x0)/D));this.pageCount=E*S;for(var O=0;O<S;O++){var H=O*D/this.scale-this.y0/this.scale+(F.y-C.y*M)/M;for(var N=0;N<E;N++){if(this.wnd==null){return null;}var J=N*B/this.scale-this.x0/this.scale+(F.x-C.x*M)/M;var R=O*E+N+1;L=this.renderPage(this.pageFormat.width,this.pageFormat.height,-J,-H,this.scale,R);L.setAttribute("id","mxPage-"+R);if(this.borderColor!=null){L.style.borderColor=this.borderColor;L.style.borderStyle="solid";L.style.borderWidth="1px";}L.style.background="white";if(O<S-1||N<E-1){L.style.pageBreakAfter="always";}if(false){T.writeln(L.outerHTML);L.parentNode.removeChild(L);}else{L.parentNode.removeChild(L);T.body.appendChild(L);}if(O<S-1||N<E-1){T.body.appendChild(T.createElement("hr"));}}}T.writeln("</body>");T.writeln("</html>");T.close();mxEvent.release(T.body);if(this.pageSelector&&(S>1||E>1)){var Q=this.createPageSelector(S,E);T.body.appendChild(Q);if(false){Q.style.position="absolute";var G=function(){Q.style.top=(T.body.scrollTop+10)+"px";};mxEvent.addListener(this.wnd,"scroll",function(U){G();});mxEvent.addListener(this.wnd,"resize",function(U){G();});}}}this.wnd.focus();}catch(P){if(L!=null&&L.parentNode!=null){L.parentNode.removeChild(L);}}finally{this.graph.cellRenderer.initializeOverlay=K;}return this.wnd;};mxPrintPreview.prototype.writeHead=function(B,A){if(this.title!=null){B.writeln("<title>"+this.title+"</title>");}B.writeln('<style type="text/css">');B.writeln("@media print {");B.writeln("  table.mxPageSelector { display: none; }");B.writeln("  hr { display: none; }");B.writeln("}");B.writeln("@media screen {");B.writeln("  table.mxPageSelector { position: fixed; right: 10px; top: 10px;font-family: Arial; font-size:10pt; border: solid 1px darkgray;background: white;border-collapse:collapse; }");B.writeln("  table.mxPageSelector td { border: solid 1px gray; padding:4px; }");B.writeln("  body { background: gray; }");B.writeln("}");if(A!=null){B.writeln(A);}B.writeln("</style>");};mxPrintPreview.prototype.createPageSelector=function(B,A){var G=this.wnd.document;var I=G.createElement("table");I.className="mxPageSelector";I.setAttribute("border","0");var E=G.createElement("tbody");for(var D=0;D<B;D++){var J=G.createElement("tr");for(var C=0;C<A;C++){var H=G.createElement("td");H.style.cursor="pointer";var F=D*A+C+1;mxUtils.write(H,F,G);this.addPageClickListener(H,F);J.appendChild(H);}E.appendChild(J);}I.appendChild(E);return I;};mxPrintPreview.prototype.addPageClickListener=function(A,B){mxEvent.addListener(A,"click",mxUtils.bind(this,function(C){var D=this.wnd.document.getElementById("mxPage-"+B);if(D!=null){this.wnd.scrollTo(0,Math.max(0,D.offsetTop-8));}}));};mxPrintPreview.prototype.renderPage=function(G,P,H,F,W,U){var M=document.createElement("div");try{M.style.width=G+"px";M.style.height=P+"px";M.style.overflow="hidden";M.style.pageBreakInside="avoid";var V=document.createElement("div");V.style.top=this.border+"px";V.style.left=this.border+"px";V.style.width=(G-2*this.border)+"px";V.style.height=(P-2*this.border)+"px";V.style.overflow="hidden";if(false){V.style.position="absolute";}M.appendChild(V);document.body.appendChild(M);var L=this.graph.getView();var E=this.graph.container;this.graph.container=V;var A=L.getCanvas();var T=L.getBackgroundPane();var O=L.getDrawPane();var I=L.getOverlayPane();if(this.graph.dialect==mxConstants.DIALECT_SVG){L.createSvg();}else{if(this.graph.dialect==mxConstants.DIALECT_VML){L.createVml();}else{L.createHtml();}}var D=L.isEventsEnabled();L.setEventsEnabled(false);var J=this.graph.isEnabled();this.graph.setEnabled(false);var K=L.getTranslate();L.translate=new mxPoint(H,F);var R=null;try{var C=this.graph.getModel();var B=[C.getRoot()];R=new mxTemporaryCellStates(L,W,B);}finally{if(false){L.overlayPane.innerHTML="";}else{var S=V.firstChild;while(S!=null){var N=S.nextSibling;if(S.nodeName.toLowerCase()!="svg"&&S.style.cursor!="default"){S.parentNode.removeChild(S);}S=N;}}L.overlayPane.parentNode.removeChild(L.overlayPane);this.graph.setEnabled(J);this.graph.container=E;L.canvas=A;L.backgroundPane=T;L.drawPane=O;L.overlayPane=I;L.translate=K;R.destroy();L.setEventsEnabled(D);}}catch(Q){M.parentNode.removeChild(M);M=null;throw Q;}return M;};mxPrintPreview.prototype.print=function(){var A=this.open();if(A!=null){A.print();}};mxPrintPreview.prototype.close=function(){if(this.wnd!=null){this.wnd.close();this.wnd=null;}};function mxStylesheet(){this.styles=new Object();this.putDefaultVertexStyle(this.createDefaultVertexStyle());this.putDefaultEdgeStyle(this.createDefaultEdgeStyle());}mxStylesheet.prototype.styles;mxStylesheet.prototype.createDefaultVertexStyle=function(){var A=new Object();A[mxConstants.STYLE_SHAPE]=mxConstants.SHAPE_RECTANGLE;A[mxConstants.STYLE_PERIMETER]=mxPerimeter.RectanglePerimeter;A[mxConstants.STYLE_VERTICAL_ALIGN]=mxConstants.ALIGN_MIDDLE;A[mxConstants.STYLE_ALIGN]=mxConstants.ALIGN_CENTER;A[mxConstants.STYLE_FILLCOLOR]="#C3D9FF";A[mxConstants.STYLE_STROKECOLOR]="#6482B9";A[mxConstants.STYLE_FONTCOLOR]="#774400";return A;};mxStylesheet.prototype.createDefaultEdgeStyle=function(){var A=new Object();A[mxConstants.STYLE_SHAPE]=mxConstants.SHAPE_CONNECTOR;A[mxConstants.STYLE_ENDARROW]=mxConstants.ARROW_CLASSIC;A[mxConstants.STYLE_VERTICAL_ALIGN]=mxConstants.ALIGN_MIDDLE;A[mxConstants.STYLE_ALIGN]=mxConstants.ALIGN_CENTER;A[mxConstants.STYLE_STROKECOLOR]="#6482B9";A[mxConstants.STYLE_FONTCOLOR]="#446299";return A;};mxStylesheet.prototype.putDefaultVertexStyle=function(A){this.putCellStyle("defaultVertex",A);};mxStylesheet.prototype.putDefaultEdgeStyle=function(A){this.putCellStyle("defaultEdge",A);};mxStylesheet.prototype.getDefaultVertexStyle=function(){return this.styles.defaultVertex;};mxStylesheet.prototype.getDefaultEdgeStyle=function(){return this.styles.defaultEdge;};mxStylesheet.prototype.putCellStyle=function(A,B){this.styles[A]=B;};mxStylesheet.prototype.getCellStyle=function(B,J){var A=J;if(B!=null&&B.length>0){var C=B.split(";");if(A!=null&&B.charAt(0)!=";"){A=mxUtils.clone(A);}else{A=new Object();}for(var D=0;D<C.length;D++){var E=C[D];var G=E.indexOf("=");if(G>=0){var I=E.substring(0,G);var H=E.substring(G+1);if(H==mxConstants.NONE){delete A[I];}else{if(mxUtils.isNumeric(H)){A[I]=parseFloat(H);}else{A[I]=H;}}}else{var F=this.styles[E];if(F!=null){for(var I in F){A[I]=F[I];}}}}}return A;};function mxCellState(B,A,C){this.view=B;this.cell=A;this.style=C;this.origin=new mxPoint();this.absoluteOffset=new mxPoint();}mxCellState.prototype=new mxRectangle();mxCellState.prototype.constructor=mxCellState;mxCellState.prototype.view=null;mxCellState.prototype.cell=null;mxCellState.prototype.style=null;mxCellState.prototype.invalid=true;mxCellState.prototype.orderChanged=null;mxCellState.prototype.origin=null;mxCellState.prototype.absolutePoints=null;mxCellState.prototype.absoluteOffset=null;mxCellState.prototype.terminalDistance=0;mxCellState.prototype.length=0;mxCellState.prototype.segments=null;mxCellState.prototype.shape=null;mxCellState.prototype.text=null;mxCellState.prototype.getPerimeterBounds=function(A){A=A||0;var B=new mxRectangle(this.x,this.y,this.width,this.height);if(A!=0){B.grow(A);}return B;};mxCellState.prototype.setAbsoluteTerminalPoint=function(A,B){if(B){if(this.absolutePoints==null){this.absolutePoints=[];}if(this.absolutePoints.length==0){this.absolutePoints.push(A);}else{this.absolutePoints[0]=A;}}else{if(this.absolutePoints==null){this.absolutePoints=[];this.absolutePoints.push(null);this.absolutePoints.push(A);}else{if(this.absolutePoints.length==1){this.absolutePoints.push(A);}else{this.absolutePoints[this.absolutePoints.length-1]=A;}}}};mxCellState.prototype.setCursor=function(A){if(this.shape!=null){if(this.shape.innerNode!=null&&!this.view.graph.getModel().isEdge(this.cell)){this.shape.innerNode.style.cursor=A;}else{this.shape.node.style.cursor=A;}}if(this.text!=null){this.text.node.style.cursor=A;}};mxCellState.prototype.destroy=function(){this.view.graph.cellRenderer.destroy(this);};mxCellState.prototype.clone=function(){var A=new mxCellState(this.view,this.cell,this.style);if(this.absolutePoints!=null){A.absolutePoints=[];for(i=0;i<this.absolutePoints.length;i++){A.absolutePoints.push(this.absolutePoints[i].clone());}}if(this.origin!=null){A.origin=this.origin.clone();}if(this.absoluteOffset!=null){A.absoluteOffset=this.absoluteOffset.clone();}if(this.boundingBox!=null){A.boundingBox=this.boundingBox.clone();}A.terminalDistance=this.terminalDistance;A.segments=this.segments;A.length=this.length;A.x=this.x;A.y=this.y;A.width=this.width;A.height=this.height;return A;};function mxGraphSelectionModel(A){this.graph=A;this.cells=[];}mxGraphSelectionModel.prototype=new mxEventSource();mxGraphSelectionModel.prototype.constructor=mxGraphSelectionModel;mxGraphSelectionModel.prototype.doneResource=(mxClient.language!="none")?"done":"";mxGraphSelectionModel.prototype.updatingSelectionResource=(mxClient.language!="none")?"updatingSelection":"";mxGraphSelectionModel.prototype.graph=null;mxGraphSelectionModel.prototype.singleSelection=false;mxGraphSelectionModel.prototype.isSingleSelection=function(){return this.singleSelection;};mxGraphSelectionModel.prototype.setSingleSelection=function(A){this.singleSelection=A;};mxGraphSelectionModel.prototype.isSelected=function(A){if(A!=null){return mxUtils.indexOf(this.cells,A)>=0;}return false;};mxGraphSelectionModel.prototype.isEmpty=function(){return this.cells.length==0;};mxGraphSelectionModel.prototype.clear=function(){this.changeSelection(null,this.cells);};mxGraphSelectionModel.prototype.setCell=function(A){if(A!=null){this.setCells([A]);}};mxGraphSelectionModel.prototype.setCells=function(A){if(A!=null){if(this.singleSelection){A=[this.getFirstSelectableCell(A)];}var C=[];for(var B=0;B<A.length;B++){if(this.graph.isCellSelectable(A[B])){C.push(A[B]);}}this.changeSelection(C,this.cells);}};mxGraphSelectionModel.prototype.getFirstSelectableCell=function(A){if(A!=null){for(var B=0;B<A.length;B++){if(this.graph.isCellSelectable(A[B])){return A[B];}}}return null;};mxGraphSelectionModel.prototype.addCell=function(A){if(A!=null){this.addCells([A]);}};mxGraphSelectionModel.prototype.addCells=function(B){if(B!=null){var A=null;if(this.singleSelection){A=this.cells;B=[this.getFirstSelectableCell(B)];}var D=[];for(var C=0;C<B.length;C++){if(!this.isSelected(B[C])&&this.graph.isCellSelectable(B[C])){D.push(B[C]);}}this.changeSelection(D,A);}};mxGraphSelectionModel.prototype.removeCell=function(A){if(A!=null){this.removeCells([A]);}};mxGraphSelectionModel.prototype.removeCells=function(A){if(A!=null){var C=[];for(var B=0;B<A.length;B++){if(this.isSelected(A[B])){C.push(A[B]);}}this.changeSelection(null,C);}};mxGraphSelectionModel.prototype.changeSelection=function(A,C){if((A!=null&&A.length>0&&A[0]!=null)||(C!=null&&C.length>0&&C[0]!=null)){var D=new mxSelectionChange(this,A,C);D.execute();var B=new mxUndoableEdit(this,false);B.add(D);this.fireEvent(new mxEventObject(mxEvent.UNDO,"edit",B));}};mxGraphSelectionModel.prototype.cellAdded=function(A){if(A!=null&&!this.isSelected(A)){this.cells.push(A);}};mxGraphSelectionModel.prototype.cellRemoved=function(A){if(A!=null){var B=mxUtils.indexOf(this.cells,A);if(B>=0){this.cells.splice(B,1);}}};function mxSelectionChange(A,B,C){this.selectionModel=A;this.added=(B!=null)?B.slice():null;this.removed=(C!=null)?C.slice():null;}mxSelectionChange.prototype.execute=function(){var C=mxLog.enter("mxSelectionChange.execute");window.status=mxResources.get(this.selectionModel.updatingSelectionResource)||this.selectionModel.updatingSelectionResource;if(this.removed!=null){for(var B=0;B<this.removed.length;B++){this.selectionModel.cellRemoved(this.removed[B]);}}if(this.added!=null){for(var B=0;B<this.added.length;B++){this.selectionModel.cellAdded(this.added[B]);}}var A=this.added;this.added=this.removed;this.removed=A;window.status=mxResources.get(this.selectionModel.doneResource)||this.selectionModel.doneResource;mxLog.leave("mxSelectionChange.execute",C);this.selectionModel.fireEvent(new mxEventObject(mxEvent.CHANGE,"added",this.added,"removed",this.removed));};function mxCellEditor(A){this.graph=A;this.textarea=document.createElement("textarea");this.textarea.className="mxCellEditor";this.textarea.style.position="absolute";this.textarea.style.overflow="visible";this.textarea.setAttribute("cols","20");this.textarea.setAttribute("rows","4");if(false){this.textarea.style.resize="none";}this.init();}mxCellEditor.prototype.graph=null;mxCellEditor.prototype.textarea=null;mxCellEditor.prototype.editingCell=null;mxCellEditor.prototype.trigger=null;mxCellEditor.prototype.modified=false;mxCellEditor.prototype.emptyLabelText="";mxCellEditor.prototype.textNode="";mxCellEditor.prototype.init=function(){mxEvent.addListener(this.textarea,"blur",mxUtils.bind(this,function(A){this.stopEditing(!this.graph.isInvokesStopCellEditing());}));mxEvent.addListener(this.textarea,"keydown",mxUtils.bind(this,function(A){if(!mxEvent.isConsumed(A)){if(A.keyCode==113||(this.graph.isEnterStopsCellEditing()&&A.keyCode==13&&!mxEvent.isControlDown(A)&&!mxEvent.isShiftDown(A))){this.graph.stopEditing(false);mxEvent.consume(A);}else{if(A.keyCode==27){this.graph.stopEditing(true);mxEvent.consume(A);}else{if(this.clearOnChange){this.clearOnChange=false;this.textarea.value="";}this.setModified(true);}}}}));};mxCellEditor.prototype.isModified=function(){return this.modified;};mxCellEditor.prototype.setModified=function(A){this.modified=A;};mxCellEditor.prototype.startEditing=function(J,C){this.stopEditing(true);var B=this.graph.getView().getState(J);if(B!=null){this.editingCell=J;this.trigger=C;this.textNode=null;if(B.text!=null&&this.isHideLabel(B)){this.textNode=B.text.node;this.textNode.style.visibility="hidden";}var D=this.graph.getView().scale;var K=mxUtils.getValue(B.style,mxConstants.STYLE_FONTSIZE,mxConstants.DEFAULT_FONTSIZE)*D;var F=mxUtils.getValue(B.style,mxConstants.STYLE_FONTFAMILY,mxConstants.DEFAULT_FONTFAMILY);var E=mxUtils.getValue(B.style,mxConstants.STYLE_TEXTCOLOR,"black");var G=(this.graph.model.isEdge(B.cell))?mxConstants.ALIGN_LEFT:mxUtils.getValue(B.style,mxConstants.STYLE_ALIGN,mxConstants.ALIGN_LEFT);var H=(mxUtils.getValue(B.style,mxConstants.STYLE_FONTSTYLE,0)&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD;this.textarea.style.fontSize=K;this.textarea.style.fontFamily=F;this.textarea.style.textAlign=G;this.textarea.style.color=(E!="white")?E:"black";this.textarea.style.fontWeight=(H)?"bold":"normal";var A=this.getEditorBounds(B);this.textarea.style.left=A.x+"px";this.textarea.style.top=A.y+"px";this.textarea.style.width=A.width+"px";this.textarea.style.height=A.height+"px";this.textarea.style.zIndex=5;var I=this.getInitialValue(B,C);if(I==null||I.length==0){I=this.getEmptyLabelText();this.clearOnChange=true;}else{this.clearOnChange=false;}this.setModified(false);this.textarea.value=I;this.graph.container.appendChild(this.textarea);this.textarea.focus();this.textarea.select();}};mxCellEditor.prototype.stopEditing=function(A){A=A||false;if(this.editingCell!=null){if(this.textNode!=null){this.textNode.style.visibility="visible";this.textNode=null;}if(!A&&this.isModified()){this.graph.labelChanged(this.editingCell,this.getCurrentValue(),this.trigger);}this.editingCell=null;this.trigger=null;this.textarea.blur();this.textarea.parentNode.removeChild(this.textarea);}};mxCellEditor.prototype.getInitialValue=function(B,A){return this.graph.getEditingValue(B.cell,A);};mxCellEditor.prototype.getCurrentValue=function(){return this.textarea.value.replace(/\r/g,"");};mxCellEditor.prototype.isHideLabel=function(A){return true;};mxCellEditor.prototype.getEditorBounds=function(B){var K=this.graph.getModel().isEdge(B.cell);var F=this.graph.getView().scale;var L=(B.text==null)?30:B.text.size*F+20;var C=(this.textarea.style.textAlign=="left")?120:40;var J=parseInt(B.style[mxConstants.STYLE_SPACING]||2)*F;var I=(parseInt(B.style[mxConstants.STYLE_SPACING_TOP]||0))*F+J;var G=(parseInt(B.style[mxConstants.STYLE_SPACING_RIGHT]||0))*F+J;var D=(parseInt(B.style[mxConstants.STYLE_SPACING_BOTTOM]||0))*F+J;var H=(parseInt(B.style[mxConstants.STYLE_SPACING_LEFT]||0))*F+J;var M=new mxRectangle(B.x,B.y,Math.max(C,B.width-H-G),Math.max(L,B.height-I-D));if(K){M.x=B.absoluteOffset.x;M.y=B.absoluteOffset.y;if(B.text!=null&&B.text.boundingBox!=null){if(B.text.boundingBox.x>0){M.x=B.text.boundingBox.x;}if(B.text.boundingBox.y>0){M.y=B.text.boundingBox.y;}}}else{if(B.text!=null&&B.text.boundingBox!=null){M.x=Math.min(M.x,B.text.boundingBox.x);M.y=Math.min(M.y,B.text.boundingBox.y);}}M.x+=H;M.y+=I;if(B.text!=null&&B.text.boundingBox!=null){if(!K){M.width=Math.max(M.width,B.text.boundingBox.width);M.height=Math.max(M.height,B.text.boundingBox.height);}else{M.width=Math.max(C,B.text.boundingBox.width);M.height=Math.max(L,B.text.boundingBox.height);}}if(this.graph.getModel().isVertex(B.cell)){var A=mxUtils.getValue(B.style,mxConstants.STYLE_LABEL_POSITION,mxConstants.ALIGN_CENTER);if(A==mxConstants.ALIGN_LEFT){M.x-=B.width;}else{if(A==mxConstants.ALIGN_RIGHT){M.x+=B.width;}}var E=mxUtils.getValue(B.style,mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.ALIGN_MIDDLE);if(E==mxConstants.ALIGN_TOP){M.y-=B.height;}else{if(E==mxConstants.ALIGN_BOTTOM){M.y+=B.height;}}}return M;};mxCellEditor.prototype.getEmptyLabelText=function(A){return this.emptyLabelText;};mxCellEditor.prototype.getEditingCell=function(){return this.editingCell;};mxCellEditor.prototype.destroy=function(){mxEvent.release(this.textarea);if(this.textarea.parentNode!=null){this.textarea.parentNode.removeChild(this.textarea);}this.textarea=null;};function mxCellRenderer(){this.shapes=mxUtils.clone(this.defaultShapes);}mxCellRenderer.prototype.shapes=null;mxCellRenderer.prototype.defaultEdgeShape=mxPolyline;mxCellRenderer.prototype.defaultVertexShape=mxRectangleShape;mxCellRenderer.prototype.defaultShapes=new Object();mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_ARROW]=mxArrow;mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_RECTANGLE]=mxRectangleShape;mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_ELLIPSE]=mxEllipse;mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_DOUBLE_ELLIPSE]=mxDoubleEllipse;mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_RHOMBUS]=mxRhombus;mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_IMAGE]=mxImageShape;mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_LINE]=mxLine;mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_LABEL]=mxLabel;mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_CYLINDER]=mxCylinder;mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_SWIMLANE]=mxSwimlane;mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_CONNECTOR]=mxConnector;mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_ACTOR]=mxActor;mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_CLOUD]=mxCloud;mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_TRIANGLE]=mxTriangle;mxCellRenderer.prototype.defaultShapes[mxConstants.SHAPE_HEXAGON]=mxHexagon;mxCellRenderer.prototype.registerShape=function(B,A){this.shapes[B]=A;};mxCellRenderer.prototype.initialize=function(B){var A=B.view.graph.getModel();if(B.view.graph.container!=null&&B.shape==null&&B.cell!=B.view.currentRoot&&(A.isVertex(B.cell)||A.isEdge(B.cell))){this.createShape(B);if(B.shape!=null){this.initializeShape(B);if(B.view.graph.ordered){B.orderChanged=true;}else{if(A.isEdge(B.cell)){this.orderEdge(B);}else{if(B.view.graph.keepEdgesInForeground&&this.firstEdge!=null){if(this.firstEdge.parentNode==B.shape.node.parentNode){this.inserState(B,this.firstEdge);}else{this.firstEdge=null;}}}}B.shape.scale=B.view.scale;this.createCellOverlays(B);this.installListeners(B);}}};mxCellRenderer.prototype.initializeShape=function(A){A.shape.init(A.view.getDrawPane());};mxCellRenderer.prototype.getPreviousStateInContainer=function(E,B){var A=null;var D=E.view.graph;var C=D.getModel();var G=E.cell;var F=C.getParent(G);while(F!=null&&A==null){A=this.findPreviousStateInContainer(D,F,G,B);G=F;F=C.getParent(G);}return A;};mxCellRenderer.prototype.findPreviousStateInContainer=function(H,G,F,A){var I=null;var E=H.getModel();if(F!=null){var B=G.getIndex(F);for(var D=B-1;D>=0&&I==null;D--){I=this.findPreviousStateInContainer(H,E.getChildAt(G,D),null,A);}}else{var C=E.getChildCount(G);for(var D=C-1;D>=0&&I==null;D--){I=this.findPreviousStateInContainer(H,E.getChildAt(G,D),null,A);}}if(I==null){I=H.view.getState(G);if(I!=null&&(I.shape==null||I.shape.node==null||I.shape.node.parentNode!=A)){I=null;}}return I;};mxCellRenderer.prototype.order=function(D){var B=D.shape.node.parentNode;var C=this.getPreviousStateInContainer(D,B);var A=B.firstChild;if(C!=null){A=C.shape.node;if(C.text!=null&&C.text.node!=null&&C.text.node.parentNode==B){A=C.text.node;}A=A.nextSibling;}this.insertState(D,A);};mxCellRenderer.prototype.orderEdge=function(G){var B=G.view;var C=B.graph.getModel();if(B.graph.keepEdgesInForeground){var E=G.shape.node;if(this.firstEdge==null||this.firstEdge.parentNode==null||this.firstEdge.parentNode!=G.shape.node.parentNode){this.firstEdge=G.shape.node;}}else{if(B.graph.keepEdgesInBackground){var E=G.shape.node;var D=E.parentNode;var A=C.getParent(G.cell);var F=B.getState(A);if(F!=null&&F.shape!=null&&F.shape.node!=null){var H=F.shape.node.nextSibling;if(H!=null&&H!=E){this.insertState(G,H);}}else{var H=D.firstChild;if(H!=null&&H!=E){this.insertState(G,H);}}}}};mxCellRenderer.prototype.insertState=function(B,A){B.shape.node.parentNode.insertBefore(B.shape.node,A);if(B.text!=null&&B.text.node!=null&&B.text.node.parentNode==B.shape.node.parentNode){B.shape.node.parentNode.insertBefore(B.text.node,B.shape.node.nextSibling);}};mxCellRenderer.prototype.createShape=function(B){if(B.style!=null){var A=this.getShapeConstructor(B);B.shape=new A();B.shape.points=B.absolutePoints;B.shape.bounds=new mxRectangle(B.x,B.y,B.width,B.height);B.shape.dialect=B.view.graph.dialect;this.configureShape(B);}};mxCellRenderer.prototype.getShapeConstructor=function(C){var A=C.style[mxConstants.STYLE_SHAPE];var B=(A!=null)?this.shapes[A]:null;if(B==null){B=(C.view.graph.getModel().isEdge(C.cell))?this.defaultEdgeShape:this.defaultVertexShape;}return B;};mxCellRenderer.prototype.configureShape=function(D){D.shape.apply(D);var E=D.view.graph.getImage(D);if(E!=null){D.shape.image=E;}var A=D.view.graph.getIndicatorColor(D);var B=D.view.graph.getIndicatorShape(D);var C=(B!=null)?this.shapes[B]:null;if(A!=null){D.shape.indicatorShape=C;D.shape.indicatorColor=A;D.shape.indicatorGradientColor=D.view.graph.getIndicatorGradientColor(D);D.shape.indicatorDirection=D.style[mxConstants.STYLE_INDICATOR_DIRECTION];}else{var A=D.view.graph.getIndicatorImage(D);if(A!=null){D.shape.indicatorImage=A;}}this.postConfigureShape(D);};mxCellRenderer.prototype.postConfigureShape=function(A){if(A.shape!=null){this.resolveColor(A,"indicatorColor",mxConstants.STYLE_FILLCOLOR);this.resolveColor(A,"indicatorGradientColor",mxConstants.STYLE_GRADIENTCOLOR);this.resolveColor(A,"fill",mxConstants.STYLE_FILLCOLOR);this.resolveColor(A,"stroke",mxConstants.STYLE_STROKECOLOR);this.resolveColor(A,"gradient",mxConstants.STYLE_GRADIENTCOLOR);}};mxCellRenderer.prototype.resolveColor=function(E,G,A){var D=E.shape[G];var C=E.view.graph;var F=null;if(D=="inherit"){F=C.model.getParent(E.cell);}else{if(D=="swimlane"){if(C.model.getTerminal(E.cell,false)!=null){F=C.model.getTerminal(E.cell,false);}else{F=E.cell;}F=C.getSwimlane(F);A=C.swimlaneIndicatorColorAttribute;}else{if(D=="indicated"){E.shape[G]=E.shape.indicatorColor;}}}if(F!=null){var B=C.getView().getState(F);E.shape[G]=null;if(B!=null){if(B.shape!=null&&G!="indicatorColor"){E.shape[G]=B.shape[G];}else{E.shape[G]=B.style[A];}}}};mxCellRenderer.prototype.getLabelValue=function(C){var B=C.view.graph;var A=B.getLabel(C.cell);if(!B.isHtmlLabel(C.cell)&&!mxUtils.isNode(A)&&false&&A!=null){A=mxUtils.htmlEntities(A,false);}return A;};mxCellRenderer.prototype.createLabel=function(A,F){var H=A.view.graph;var D=H.getModel().isEdge(A.cell);if(A.style[mxConstants.STYLE_FONTSIZE]>0||A.style[mxConstants.STYLE_FONTSIZE]==null){var C=(H.isHtmlLabel(A.cell)||(F!=null&&mxUtils.isNode(F)))&&H.dialect==mxConstants.DIALECT_SVG;A.text=new mxText(F,new mxRectangle(),(A.style[mxConstants.STYLE_ALIGN]||mxConstants.ALIGN_CENTER),H.getVerticalAlign(A),A.style[mxConstants.STYLE_FONTCOLOR],A.style[mxConstants.STYLE_FONTFAMILY],A.style[mxConstants.STYLE_FONTSIZE],A.style[mxConstants.STYLE_FONTSTYLE],A.style[mxConstants.STYLE_SPACING],A.style[mxConstants.STYLE_SPACING_TOP],A.style[mxConstants.STYLE_SPACING_RIGHT],A.style[mxConstants.STYLE_SPACING_BOTTOM],A.style[mxConstants.STYLE_SPACING_LEFT],A.style[mxConstants.STYLE_HORIZONTAL],A.style[mxConstants.STYLE_LABEL_BACKGROUNDCOLOR],A.style[mxConstants.STYLE_LABEL_BORDERCOLOR],H.isWrapping(A.cell),H.isLabelClipped(A.cell),A.style[mxConstants.STYLE_OVERFLOW]);A.text.opacity=A.style[mxConstants.STYLE_TEXT_OPACITY];A.text.dialect=(C)?mxConstants.DIALECT_STRICTHTML:A.view.graph.dialect;this.initializeLabel(A);var E=(mxClient.IS_TOUCH)?"touchstart":"mousedown";var B=(mxClient.IS_TOUCH)?"touchmove":"mousemove";var I=(mxClient.IS_TOUCH)?"touchend":"mouseup";mxEvent.addListener(A.text.node,E,mxUtils.bind(this,function(J){if(this.isLabelEvent(A,J)){H.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(J,A));}}));mxEvent.addListener(A.text.node,B,mxUtils.bind(this,function(J){if(this.isLabelEvent(A,J)){H.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(J,A));}}));mxEvent.addListener(A.text.node,I,mxUtils.bind(this,function(J){if(this.isLabelEvent(A,J)){H.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(J,A));}}));var G=(mxClient.IS_TOUCH)?"gestureend":"dblclick";mxEvent.addListener(A.text.node,G,mxUtils.bind(this,function(J){if(G=="gestureend"&&(Math.abs(J.rotation)>4||Math.abs(1-J.scale)>0.8)){return ;}if(this.isLabelEvent(A,J)){H.dblClick(J,A.cell);mxEvent.consume(J);}}));}};mxCellRenderer.prototype.initializeLabel=function(B){var A=B.view.graph;if(B.text.dialect!=mxConstants.DIALECT_SVG){if(true&&mxClient.NO_FO){B.text.init(A.container);}else{if(mxUtils.isVml(B.view.getDrawPane())){if(B.shape.label!=null){B.text.init(B.shape.label);}else{B.text.init(B.shape.node);}}}}if(B.text.node==null){B.text.init(B.view.getDrawPane());if(B.shape!=null&&B.text!=null){B.shape.node.parentNode.insertBefore(B.text.node,B.shape.node.nextSibling);}}};mxCellRenderer.prototype.createCellOverlays=function(E){var D=E.view.graph;var C=D.getCellOverlays(E.cell);if(C!=null){E.overlays=[];for(var B=0;B<C.length;B++){var A=new mxImageShape(new mxRectangle(),C[B].image.src);A.dialect=E.view.graph.dialect;this.initializeOverlay(E,A);A.node.style.cursor="help";this.installCellOverlayListeners(E,C[B],A);E.overlays.push(A);}}};mxCellRenderer.prototype.initializeOverlay=function(B,A){A.init(B.view.getOverlayPane());};mxCellRenderer.prototype.installCellOverlayListeners=function(E,B,A){var D=E.view.graph;mxEvent.addListener(A.node,"click",function(G){B.fireEvent(new mxEventObject(mxEvent.CLICK,"event",G,"cell",E.cell));});var C=(mxClient.IS_TOUCH)?"touchstart":"mousedown";var F=(mxClient.IS_TOUCH)?"touchmove":"mousemove";mxEvent.addListener(A.node,C,function(G){mxEvent.consume(G);});mxEvent.addListener(A.node,F,function(G){D.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(G,E));});};mxCellRenderer.prototype.createControl=function(E){var D=E.view.graph;var F=D.getFoldingImage(E);if(D.foldingEnabled&&F!=null){if(E.control==null){var A=new mxRectangle(0,0,F.width,F.height);E.control=new mxImageShape(A,F.src);E.control.dialect=E.view.graph.dialect;var H=D.isHtmlLabel(E.cell)&&mxClient.NO_FO&&D.dialect==mxConstants.DIALECT_SVG;if(H){E.control.dialect=mxConstants.DIALECT_PREFERHTML;E.control.init(D.container);E.control.node.style.zIndex=1;}else{E.control.init(E.view.getOverlayPane());}var B=E.control.innerNode||E.control.node;if(D.isEnabled()){B.style.cursor="pointer";}mxEvent.addListener(B,"click",function(I){if(D.isEnabled()){var J=!D.isCellCollapsed(E.cell);D.foldCells(J,false,[E.cell]);mxEvent.consume(I);}});var C=(mxClient.IS_TOUCH)?"touchstart":"mousedown";var G=(mxClient.IS_TOUCH)?"touchmove":"mousemove";mxEvent.addListener(B,C,function(I){D.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(I,E));mxEvent.consume(I);});mxEvent.addListener(B,G,function(I){D.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(I,E));});}}else{if(E.control!=null){E.control.destroy();E.control=null;}}};mxCellRenderer.prototype.isShapeEvent=function(B,A){return true;};mxCellRenderer.prototype.isLabelEvent=function(B,A){return true;};mxCellRenderer.prototype.installListeners=function(F){var E=F.view.graph;if(E.dialect==mxConstants.DIALECT_SVG){var C="all";if(E.getModel().isEdge(F.cell)&&F.shape.stroke!=null&&F.shape.fill==null){C="visibleStroke";}if(F.shape.innerNode!=null){F.shape.innerNode.setAttribute("pointer-events",C);}else{F.shape.node.setAttribute("pointer-events",C);}}var D=(mxClient.IS_TOUCH)?"touchstart":"mousedown";var G=(mxClient.IS_TOUCH)?"touchmove":"mousemove";var B=(mxClient.IS_TOUCH)?"touchend":"mouseup";mxEvent.addListener(F.shape.node,D,mxUtils.bind(this,function(H){if(this.isShapeEvent(F,H)){E.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(H,(F.shape!=null&&mxEvent.getSource(H)==F.shape.content)?null:F));}}));mxEvent.addListener(F.shape.node,G,mxUtils.bind(this,function(H){if(this.isShapeEvent(F,H)){E.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(H,(F.shape!=null&&mxEvent.getSource(H)==F.shape.content)?null:F));}}));mxEvent.addListener(F.shape.node,B,mxUtils.bind(this,function(H){if(this.isShapeEvent(F,H)){E.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(H,(F.shape!=null&&mxEvent.getSource(H)==F.shape.content)?null:F));}}));var A=(mxClient.IS_TOUCH)?"gestureend":"dblclick";mxEvent.addListener(F.shape.node,A,mxUtils.bind(this,function(H){if(A=="gestureend"&&(Math.abs(H.rotation)>4||Math.abs(1-H.scale)>0.8)){return ;}if(this.isShapeEvent(F,H)){E.dblClick(H,(F.shape!=null&&mxEvent.getSource(H)==F.shape.content)?null:F.cell);mxEvent.consume(H);}}));};mxCellRenderer.prototype.redrawLabel=function(E){var D=this.getLabelValue(E);if(E.text==null&&D!=null&&D.length>0){this.createLabel(E,D);}else{if(E.text!=null&&(D==null||D.length==0)){E.text.destroy();E.text=null;}}if(E.text!=null){var C=E.view.graph;var B=C.isWrapping(E.cell);var F=C.isLabelClipped(E.cell);var A=this.getLabelBounds(E);if(E.text.value!=D||E.text.isWrapping!=B||E.text.isClipping!=F||E.text.scale!=E.view.scale||!E.text.bounds.equals(A)){E.text.value=D;E.text.bounds=A;E.text.scale=E.view.scale;E.text.isWrapping=B;E.text.isClipping=F;E.text.redraw();}}};mxCellRenderer.prototype.getLabelBounds=function(E){var D=E.view.graph;var C=D.getModel().isEdge(E.cell);var B=new mxRectangle(E.absoluteOffset.x,E.absoluteOffset.y);if(!C){B.x+=E.shape.bounds.x;B.y+=E.shape.bounds.y;B.width=Math.max(1,E.shape.bounds.width);B.height=Math.max(1,E.shape.bounds.height);if(D.isSwimlane(E.cell)){var F=D.view.scale;var A=D.getStartSize(E.cell);if(A.width>0){B.width=A.width*F;}else{if(A.height>0){B.height=A.height*F;}}}}return B;};mxCellRenderer.prototype.redrawCellOverlays=function(F){var C=F.view.graph.getCellOverlays(F.cell);var A=(F.overlays!=null)?F.overlays.length:0;var E=(C!=null)?C.length:0;if(A!=E){if(A>0){for(var B=0;B<F.overlays.length;B++){F.overlays[B].destroy();}F.overlays=null;}if(E>0){this.createCellOverlays(F);}}if(F.overlays!=null){for(var B=0;B<C.length;B++){var D=C[B].getBounds(F);if(F.overlays[B].bounds==null||F.overlays[B].scale!=F.view.scale||!F.overlays[B].bounds.equals(D)){F.overlays[B].bounds=D;F.overlays[B].scale=F.view.scale;F.overlays[B].redraw();}}}};mxCellRenderer.prototype.redrawControl=function(C){if(C.control!=null){var B=this.getControlBounds(C);var A=C.view.scale;if(C.control.scale!=A||!C.control.bounds.equals(B)){C.control.bounds=B;C.control.scale=A;C.control.redraw();}}};mxCellRenderer.prototype.getControlBounds=function(E){if(E.control!=null){var D=E.control.scale;var A=E.control.bounds.width/D;var C=E.control.bounds.height/D;var B=E.view.scale;return(E.view.graph.getModel().isEdge(E.cell))?new mxRectangle(E.x+E.width/2-A/2*B,E.y+E.height/2-C/2*B,A*B,C*B):new mxRectangle(E.x+A/2*B,E.y+C/2*B,A*B,C*B);}return null;};mxCellRenderer.prototype.redraw=function(D){if(D.shape!=null){var B=D.view.graph.getModel();var C=B.isEdge(D.cell);var A=false;this.createControl(D);if(D.shape.bounds==null||D.shape.scale!=D.view.scale||!D.shape.bounds.equals(D)||!mxUtils.equalPoints(D.shape.points,D.absolutePoints)){if(D.absolutePoints!=null){D.shape.points=D.absolutePoints.slice();}else{D.shape.points=null;}D.shape.bounds=new mxRectangle(D.x,D.y,D.width,D.height);D.shape.scale=D.view.scale;D.shape.redraw();}this.redrawLabel(D);this.redrawCellOverlays(D);this.redrawControl(D);if(D.orderChanged&&D.view.graph.ordered){this.order(D);A=true;}delete D.orderChanged;if(!mxUtils.equalEntries(D.shape.style,D.style)){D.shape.apply(D);A=true;}if(A){this.configureShape(D);D.shape.reconfigure();}}};mxCellRenderer.prototype.destroy=function(B){if(B.shape!=null){if(B.text!=null){B.text.destroy();B.text=null;}if(B.overlays!=null){for(var A=0;A<B.overlays.length;A++){B.overlays[A].destroy();}B.overlays=null;}if(B.control!=null){B.control.destroy();B.control=null;}B.shape.destroy();B.shape=null;}};var mxEdgeStyle={EntityRelation:function(I,Q,X,S,M){var O=I.view;var E=O.graph;var C=mxUtils.getValue(I.style,mxConstants.STYLE_SEGMENT,mxConstants.ENTITY_SEGMENT)*O.scale;var Y=I.absolutePoints;var D=Y[0];var W=Y[Y.length-1];var U=false;if(D!=null){Q=new mxCellState();Q.x=D.x;Q.y=D.y;}else{if(Q!=null){var P=E.getCellGeometry(Q.cell);if(P.relative){U=P.x<=0.5;}else{if(X!=null){U=X.x+X.width<Q.x;}}}else{return ;}}var H=true;if(W!=null){X=new mxCellState();X.x=W.x;X.y=W.y;}else{if(X!=null){var F=E.getCellGeometry(X.cell);if(F.relative){H=F.x<=0.5;}else{if(Q!=null){H=Q.x+Q.width<X.x;}}}}if(Q!=null&&X!=null){var V=(U)?Q.x:Q.x+Q.width;var G=O.getRoutingCenterY(Q);var R=(H)?X.x:X.x+X.width;var B=O.getRoutingCenterY(X);var T=C;var N=(U)?-T:T;var J=new mxPoint(V+N,G);N=(H)?-T:T;var A=new mxPoint(R+N,B);if(U==H){var K=(U)?Math.min(V,R)-C:Math.max(V,R)+C;M.push(new mxPoint(K,G));M.push(new mxPoint(K,B));}else{if((J.x<A.x)==U){var L=G+(B-G)/2;M.push(J);M.push(new mxPoint(J.x,L));M.push(new mxPoint(A.x,L));M.push(A);}else{M.push(J);M.push(A);}}}},Loop:function(B,A,E,I,N){if(A!=null){var G=B.view;var J=G.graph;var M=(I!=null&&I.length>0)?I[0]:null;if(M!=null){M=G.transformControlPoint(B,M);if(mxUtils.contains(A,M.x,M.y)){M=null;}}var H=0;var L=0;var F=0;var K=0;var D=mxUtils.getValue(B.style,mxConstants.STYLE_SEGMENT,J.gridSize)*G.scale;var C=mxUtils.getValue(B.style,mxConstants.STYLE_DIRECTION,mxConstants.DIRECTION_WEST);if(C==mxConstants.DIRECTION_NORTH||C==mxConstants.DIRECTION_SOUTH){H=G.getRoutingCenterX(A);L=D;}else{F=G.getRoutingCenterY(A);K=D;}if(M==null||M.x<A.x||M.x>A.x+A.width){if(M!=null){H=M.x;K=Math.max(Math.abs(F-M.y),K);}else{if(C==mxConstants.DIRECTION_NORTH){F=A.y-2*L;}else{if(C==mxConstants.DIRECTION_SOUTH){F=A.y+A.height+2*L;}else{if(C==mxConstants.DIRECTION_EAST){H=A.x-2*K;}else{H=A.x+A.width+2*K;}}}}}else{if(M!=null){H=G.getRoutingCenterX(A);L=Math.max(Math.abs(H-M.x),K);F=M.y;K=0;}}N.push(new mxPoint(H-L,F-K));N.push(new mxPoint(H+L,F+K));}},ElbowConnector:function(C,B,G,J,L){var K=(J!=null&&J.length>0)?J[0]:null;var F=false;var D=false;if(B!=null&&G!=null){if(K!=null){var E=Math.min(B.x,G.x);var I=Math.max(B.x+B.width,G.x+G.width);var H=Math.min(B.y,G.y);var A=Math.max(B.y+B.height,G.y+G.height);K=C.view.transformControlPoint(C,K);F=K.y<H||K.y>A;D=K.x<E||K.x>I;}else{var E=Math.max(B.x,G.x);var I=Math.min(B.x+B.width,G.x+G.width);F=E==I;if(!F){var H=Math.max(B.y,G.y);var A=Math.min(B.y+B.height,G.y+G.height);D=H==A;}}}if(!D&&(F||C.style[mxConstants.STYLE_ELBOW]==mxConstants.ELBOW_VERTICAL)){mxEdgeStyle.TopToBottom(C,B,G,J,L);}else{mxEdgeStyle.SideToSide(C,B,G,J,L);}},SideToSide:function(C,B,E,L,Q){var I=C.view;var P=(L!=null&&L.length>0)?L[0]:null;var O=C.absolutePoints;var N=O[0];var F=O[O.length-1];if(P!=null){P=I.transformControlPoint(C,P);}if(N!=null){B=new mxCellState();B.x=N.x;B.y=N.y;}if(F!=null){E=new mxCellState();E.x=F.x;E.y=F.y;}if(B!=null&&E!=null){var D=Math.max(B.x,E.x);var A=Math.min(B.x+B.width,E.x+E.width);var K=(P!=null)?P.x:A+(D-A)/2;var J=I.getRoutingCenterY(B);var H=I.getRoutingCenterY(E);if(P!=null){if(N!=null&&P.y>=B.y&&P.y<=B.y+B.height){J=P.y;}if(F!=null&&P.y>=E.y&&P.y<=E.y+E.height){H=P.y;}}if(!mxUtils.contains(E,K,J)&&!mxUtils.contains(B,K,J)){Q.push(new mxPoint(K,J));}if(!mxUtils.contains(E,K,H)&&!mxUtils.contains(B,K,H)){Q.push(new mxPoint(K,H));}if(Q.length==1){if(P!=null){if(!mxUtils.contains(E,K,P.y)&&!mxUtils.contains(B,K,P.y)){Q.push(new mxPoint(K,P.y));}}else{var M=Math.max(B.y,E.y);var G=Math.min(B.y+B.height,E.y+E.height);Q.push(new mxPoint(K,M+(G-M)/2));}}}},TopToBottom:function(C,B,E,K,P){var I=C.view;var O=(K!=null&&K.length>0)?K[0]:null;var N=C.absolutePoints;var M=N[0];var F=N[N.length-1];if(O!=null){O=I.transformControlPoint(C,O);}if(M!=null){B=new mxCellState();B.x=M.x;B.y=M.y;}if(F!=null){E=new mxCellState();E.x=F.x;E.y=F.y;}if(B!=null&&E!=null){var L=Math.max(B.y,E.y);var H=Math.min(B.y+B.height,E.y+E.height);var J=I.getRoutingCenterX(B);if(O!=null&&O.x>=B.x&&O.x<=B.x+B.width){J=O.x;}var G=(O!=null)?O.y:H+(L-H)/2;if(!mxUtils.contains(E,J,G)&&!mxUtils.contains(B,J,G)){P.push(new mxPoint(J,G));}if(O!=null&&O.x>=E.x&&O.x<=E.x+E.width){J=O.x;}else{J=I.getRoutingCenterX(E);}if(!mxUtils.contains(E,J,G)&&!mxUtils.contains(B,J,G)){P.push(new mxPoint(J,G));}if(P.length==1){if(O!=null&&P.length==1){if(!mxUtils.contains(E,O.x,G)&&!mxUtils.contains(B,O.x,G)){P.push(new mxPoint(O.x,G));}}else{var D=Math.max(B.x,E.x);var A=Math.min(B.x+B.width,E.x+E.width);P.push(new mxPoint(D+(A-D)/2,G));}}}}};var mxStyleRegistry={values:[],putValue:function(A,B){mxStyleRegistry.values[A]=B;},getValue:function(A){return mxStyleRegistry.values[A];},getName:function(B){for(var A in mxStyleRegistry.values){if(mxStyleRegistry.values[A]==B){return A;}}return null;}};mxStyleRegistry.putValue(mxConstants.EDGESTYLE_ELBOW,mxEdgeStyle.ElbowConnector);mxStyleRegistry.putValue(mxConstants.EDGESTYLE_ENTITY_RELATION,mxEdgeStyle.EntityRelation);mxStyleRegistry.putValue(mxConstants.EDGESTYLE_LOOP,mxEdgeStyle.Loop);mxStyleRegistry.putValue(mxConstants.EDGESTYLE_SIDETOSIDE,mxEdgeStyle.SideToSide);mxStyleRegistry.putValue(mxConstants.EDGESTYLE_TOPTOBOTTOM,mxEdgeStyle.TopToBottom);mxStyleRegistry.putValue(mxConstants.PERIMETER_ELLIPSE,mxPerimeter.EllipsePerimeter);mxStyleRegistry.putValue(mxConstants.PERIMETER_RECTANGLE,mxPerimeter.RectanglePerimeter);mxStyleRegistry.putValue(mxConstants.PERIMETER_RHOMBUS,mxPerimeter.RhombusPerimeter);mxStyleRegistry.putValue(mxConstants.PERIMETER_TRIANGLE,mxPerimeter.TrianglePerimeter);function mxGraphView(A){this.graph=A;this.translate=new mxPoint();this.graphBounds=new mxRectangle();this.states=new mxDictionary();}mxGraphView.prototype=new mxEventSource();mxGraphView.prototype.constructor=mxGraphView;mxGraphView.prototype.EMPTY_POINT=new mxPoint();mxGraphView.prototype.doneResource=(mxClient.language!="none")?"done":"";mxGraphView.prototype.updatingDocumentResource=(mxClient.language!="none")?"updatingDocument":"";mxGraphView.prototype.allowEval=false;mxGraphView.prototype.captureDocumentGesture=true;mxGraphView.prototype.rendering=true;mxGraphView.prototype.graph=null;mxGraphView.prototype.currentRoot=null;mxGraphView.prototype.graphBounds=null;mxGraphView.prototype.scale=1;mxGraphView.prototype.translate=null;mxGraphView.prototype.updateStyle=false;mxGraphView.prototype.getGraphBounds=function(){return this.graphBounds;};mxGraphView.prototype.setGraphBounds=function(A){this.graphBounds=A;};mxGraphView.prototype.getBounds=function(C){var A=null;if(C!=null&&C.length>0){var B=this.graph.getModel();for(var D=0;D<C.length;D++){if(B.isVertex(C[D])||B.isEdge(C[D])){var E=this.getState(C[D]);if(E!=null){if(A==null){A=new mxRectangle(E.x,E.y,E.width,E.height);}else{A.add(E);}}}}}return A;};mxGraphView.prototype.setCurrentRoot=function(A){if(this.currentRoot!=A){var C=new mxCurrentRootChange(this,A);C.execute();var B=new mxUndoableEdit(this,false);B.add(C);this.fireEvent(new mxEventObject(mxEvent.UNDO,"edit",B));this.graph.sizeDidChange();}return A;};mxGraphView.prototype.scaleAndTranslate=function(E,B,A){var C=this.scale;var D=new mxPoint(this.translate.x,this.translate.y);if(this.scale!=E||this.translate.x!=B||this.translate.y!=A){this.scale=E;this.translate.x=B;this.translate.y=A;if(this.isEventsEnabled()){this.revalidate();this.graph.sizeDidChange();}}this.fireEvent(new mxEventObject(mxEvent.SCALE_AND_TRANSLATE,"scale",E,"previousScale",C,"translate",this.translate,"previousTranslate",D));};mxGraphView.prototype.getScale=function(){return this.scale;};mxGraphView.prototype.setScale=function(B){var A=this.scale;if(this.scale!=B){this.scale=B;if(this.isEventsEnabled()){this.revalidate();this.graph.sizeDidChange();}}this.fireEvent(new mxEventObject(mxEvent.SCALE,"scale",B,"previousScale",A));};mxGraphView.prototype.getTranslate=function(){return this.translate;};mxGraphView.prototype.setTranslate=function(B,A){var C=new mxPoint(this.translate.x,this.translate.y);if(this.translate.x!=B||this.translate.y!=A){this.translate.x=B;this.translate.y=A;if(this.isEventsEnabled()){this.revalidate();this.graph.sizeDidChange();}}this.fireEvent(new mxEventObject(mxEvent.TRANSLATE,"translate",this.translate,"previousTranslate",C));};mxGraphView.prototype.refresh=function(){if(this.currentRoot!=null){this.clear();}this.revalidate();};mxGraphView.prototype.revalidate=function(){this.invalidate();this.validate();};mxGraphView.prototype.clear=function(A,F,E){var C=this.graph.getModel();A=A||C.getRoot();F=(F!=null)?F:false;E=(E!=null)?E:true;this.removeState(A);if(E&&(F||A!=this.currentRoot)){var B=C.getChildCount(A);for(var D=0;D<B;D++){this.clear(C.getChildAt(A,D),F);}}else{this.invalidate(A);}};mxGraphView.prototype.invalidate=function(J,C,I,H){var G=this.graph.getModel();J=J||G.getRoot();C=(C!=null)?C:true;I=(I!=null)?I:true;H=(H!=null)?H:false;var B=this.getState(J);if(B!=null){B.invalid=true;if(H){B.orderChanged=true;}}if(C){var E=G.getChildCount(J);for(var F=0;F<E;F++){var D=G.getChildAt(J,F);this.invalidate(D,C,I);}}if(I){var A=G.getEdgeCount(J);for(var F=0;F<A;F++){this.invalidate(G.getEdgeAt(J,F),C,false);}}};mxGraphView.prototype.validate=function(A){var B=mxLog.enter("mxGraphView.validate");window.status=mxResources.get(this.updatingDocumentResource)||this.updatingDocumentResource;A=A||((this.currentRoot!=null)?this.currentRoot:this.graph.getModel().getRoot());this.validateBounds(null,A);var C=this.validatePoints(null,A);if(C==null){C=new mxRectangle();}this.setGraphBounds(C);this.validateBackground();window.status=mxResources.get(this.doneResource)||this.doneResource;mxLog.leave("mxGraphView.validate",B);};mxGraphView.prototype.validateBackground=function(){var C=this.graph.getBackgroundImage();if(C!=null){if(this.backgroundImage==null||this.backgroundImage.image!=C.src){if(this.backgroundImage!=null){this.backgroundImage.destroy();}var D=new mxRectangle(0,0,1,1);this.backgroundImage=new mxImageShape(D,C.src);this.backgroundImage.dialect=this.graph.dialect;this.backgroundImage.init(this.backgroundPane);}this.redrawBackgroundImage(this.backgroundImage,C);}else{if(this.backgroundImage!=null){this.backgroundImage.destroy();this.backgroundImage=null;}}if(this.graph.pageVisible){var B=this.graph.pageFormat;var G=this.scale*this.graph.pageScale;var D=new mxRectangle(this.scale*this.translate.x,this.scale*this.translate.y,B.width*G,B.height*G);if(this.backgroundPageShape==null){this.backgroundPageShape=new mxRectangleShape(D,"white","black");this.backgroundPageShape.scale=this.scale;this.backgroundPageShape.isShadow=true;this.backgroundPageShape.dialect=this.graph.dialect;this.backgroundPageShape.init(this.backgroundPane);mxEvent.addListener(this.backgroundPageShape.node,"dblclick",mxUtils.bind(this,function(H){this.graph.dblClick(H);}));var E=(mxClient.IS_TOUCH)?"touchstart":"mousedown";var F=(mxClient.IS_TOUCH)?"touchmove":"mousemove";var A=(mxClient.IS_TOUCH)?"touchend":"mouseup";mxEvent.addListener(this.backgroundPageShape.node,E,mxUtils.bind(this,function(H){this.graph.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(H));}));mxEvent.addListener(this.backgroundPageShape.node,F,mxUtils.bind(this,function(H){if(this.graph.tooltipHandler!=null&&this.graph.tooltipHandler.isHideOnHover()){this.graph.tooltipHandler.hide();}if(this.graph.isMouseDown&&!mxEvent.isConsumed(H)){this.graph.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(H));}}));mxEvent.addListener(this.backgroundPageShape.node,A,mxUtils.bind(this,function(H){this.graph.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(H));}));}else{this.backgroundPageShape.scale=this.scale;this.backgroundPageShape.bounds=D;this.backgroundPageShape.redraw();}}else{if(this.backgroundPageShape!=null){this.backgroundPageShape.destroy();this.backgroundPageShape=null;}}};mxGraphView.prototype.redrawBackgroundImage=function(B,A){B.scale=this.scale;B.bounds.x=this.scale*this.translate.x;B.bounds.y=this.scale*this.translate.y;B.bounds.width=this.scale*A.width;B.bounds.height=this.scale*A.height;B.redraw();};mxGraphView.prototype.validateBounds=function(H,I){var G=this.graph.getModel();var A=this.getState(I,true);if(A!=null&&A.invalid){if(!this.graph.isCellVisible(I)){this.removeState(I);}else{if(I!=this.currentRoot&&H!=null){A.absoluteOffset.x=0;A.absoluteOffset.y=0;A.origin.x=H.origin.x;A.origin.y=H.origin.y;var E=this.graph.getCellGeometry(I);if(E!=null){if(!G.isEdge(I)){var C=E.offset||this.EMPTY_POINT;if(E.relative){A.origin.x+=E.x*H.width/this.scale+C.x;A.origin.y+=E.y*H.height/this.scale+C.y;}else{A.absoluteOffset.x=this.scale*C.x;A.absoluteOffset.y=this.scale*C.y;A.origin.x+=E.x;A.origin.y+=E.y;}}A.x=this.scale*(this.translate.x+A.origin.x);A.y=this.scale*(this.translate.y+A.origin.y);A.width=this.scale*E.width;A.height=this.scale*E.height;if(G.isVertex(I)){this.updateVertexLabelOffset(A);}}}}var C=this.graph.getChildOffsetForCell(I);if(C!=null){A.origin.x+=C.x;A.origin.y+=C.y;}}if(A!=null&&(!this.graph.isCellCollapsed(I)||I==this.currentRoot)){var D=G.getChildCount(I);for(var F=0;F<D;F++){var B=G.getChildAt(I,F);this.validateBounds(A,B);}}};mxGraphView.prototype.updateVertexLabelOffset=function(C){var A=mxUtils.getValue(C.style,mxConstants.STYLE_LABEL_POSITION,mxConstants.ALIGN_CENTER);if(A==mxConstants.ALIGN_LEFT){C.absoluteOffset.x-=C.width;}else{if(A==mxConstants.ALIGN_RIGHT){C.absoluteOffset.x+=C.width;}}var B=mxUtils.getValue(C.style,mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.ALIGN_MIDDLE);if(B==mxConstants.ALIGN_TOP){C.absoluteOffset.y-=C.height;}else{if(B==mxConstants.ALIGN_BOTTOM){C.absoluteOffset.y+=C.height;}}};mxGraphView.prototype.validatePoints=function(M,N){var J=this.graph.getModel();var C=this.getState(N);var O=null;if(C!=null){if(C.invalid){var G=this.graph.getCellGeometry(N);if(G!=null&&J.isEdge(N)){var B=this.getState(this.getVisibleTerminal(N,true));if(B!=null&&J.isEdge(B.cell)&&!J.isAncestor(B.cell,N)){var H=this.getState(J.getParent(B.cell));this.validatePoints(H,B.cell);}var K=this.getState(this.getVisibleTerminal(N,false));if(K!=null&&J.isEdge(K.cell)&&!J.isAncestor(K.cell,N)){var H=this.getState(J.getParent(K.cell));this.validatePoints(H,K.cell);}this.updateFixedTerminalPoints(C,B,K);this.updatePoints(C,G.points,B,K);this.updateFloatingTerminalPoints(C,B,K);this.updateEdgeBounds(C);this.updateEdgeLabelOffset(C);}else{if(G!=null&&G.relative&&M!=null&&J.isEdge(M.cell)){var L=this.getPoint(M,G);if(L!=null){C.x=L.x;C.y=L.y;L.x=(L.x/this.scale)-this.translate.x;L.y=(L.y/this.scale)-this.translate.y;C.origin=L;this.childMoved(M,C);}}}C.invalid=false;if(this.isRendering()&&N!=this.currentRoot){this.graph.cellRenderer.redraw(C);}}if(J.isEdge(N)||J.isVertex(N)){O=new mxRectangle(C.x,C.y,C.width,C.height);var I=(C.text!=null&&!this.graph.isLabelClipped(C.cell))?C.text.boundingBox:null;if(I!=null){O.add(I);}}}if(C!=null&&(!this.graph.isCellCollapsed(N)||N==this.currentRoot)){var E=J.getChildCount(N);for(var F=0;F<E;F++){var D=J.getChildAt(N,F);var A=this.validatePoints(C,D);if(A!=null){if(O==null){O=A;}else{O.add(A);}}}}return O;};mxGraphView.prototype.childMoved=function(E,F){var A=F.cell;if(!this.graph.isCellCollapsed(A)||A==this.currentRoot){var C=this.graph.getModel();var B=C.getChildCount(A);for(var D=0;D<B;D++){this.validateBounds(F,C.getChildAt(A,D));}}};mxGraphView.prototype.updateFixedTerminalPoints=function(A,B,C){this.updateFixedTerminalPoint(A,B,true,this.graph.getConnectionConstraint(A,B,true));this.updateFixedTerminalPoint(A,C,false,this.graph.getConnectionConstraint(A,C,false));};mxGraphView.prototype.updateFixedTerminalPoint=function(C,E,A,B){var H=null;if(B!=null){H=this.graph.getConnectionPoint(E,B);}if(H==null&&E==null){var I=this.scale;var F=this.translate;var G=C.origin;var D=this.graph.getCellGeometry(C.cell);H=D.getTerminalPoint(A);if(H!=null){H=new mxPoint(I*(F.x+H.x+G.x),I*(F.y+H.y+G.y));}}C.setAbsoluteTerminalPoint(H,A);};mxGraphView.prototype.updatePoints=function(D,I,B,H){if(D!=null){var K=[];K.push(D.absolutePoints[0]);var G=this.getEdgeStyle(D,I,B,H);if(G!=null){var A=this.getTerminalPort(D,B,true);var C=this.getTerminalPort(D,H,false);G(D,A,C,I,K);}else{if(I!=null){for(var F=0;F<I.length;F++){if(I[F]!=null){var J=mxUtils.clone(I[F]);K.push(this.transformControlPoint(D,J));}}}}var E=D.absolutePoints;K.push(E[E.length-1]);D.absolutePoints=K;}};mxGraphView.prototype.transformControlPoint=function(A,B){var C=A.origin;return new mxPoint(this.scale*(B.x+this.translate.x+C.x),this.scale*(B.y+this.translate.y+C.y));};mxGraphView.prototype.getEdgeStyle=function(edge,points,source,target){var edgeStyle=(source!=null&&source==target)?mxUtils.getValue(edge.style,mxConstants.STYLE_LOOP,this.graph.defaultLoopStyle):(!mxUtils.getValue(edge.style,mxConstants.STYLE_NOEDGESTYLE,false)?edge.style[mxConstants.STYLE_EDGE]:null);if(typeof (edgeStyle)=="string"){var tmp=mxStyleRegistry.getValue(edgeStyle);if(tmp==null&&this.isAllowEval()){tmp=mxUtils.eval(edgeStyle);}edgeStyle=tmp;}if(typeof (edgeStyle)=="function"){return edgeStyle;}return null;};mxGraphView.prototype.updateFloatingTerminalPoints=function(C,B,D){var E=C.absolutePoints;var F=E[0];var A=E[E.length-1];if(A==null&&D!=null){this.updateFloatingTerminalPoint(C,D,B,false);}if(F==null&&B!=null){this.updateFloatingTerminalPoint(C,B,D,true);}};mxGraphView.prototype.updateFloatingTerminalPoint=function(D,G,A,E){G=this.getTerminalPort(D,G,E);var C=this.getNextPoint(D,A,E);var B=parseFloat(D.style[mxConstants.STYLE_PERIMETER_SPACING]||0);B+=parseFloat(D.style[(E)?mxConstants.STYLE_SOURCE_PERIMETER_SPACING:mxConstants.STYLE_TARGET_PERIMETER_SPACING]||0);var F=this.getPerimeterPoint(G,C,this.graph.isOrthogonal(D),B);D.setAbsoluteTerminalPoint(F,E);};mxGraphView.prototype.getTerminalPort=function(E,C,D){var B=(D)?mxConstants.STYLE_SOURCE_PORT:mxConstants.STYLE_TARGET_PORT;var F=mxUtils.getValue(E.style,B);if(F!=null){var A=this.getState(this.graph.getModel().getCell(F));if(A!=null){C=A;}}return C;};mxGraphView.prototype.getPerimeterPoint=function(D,E,G,C){var A=null;if(D!=null){var B=this.getPerimeterFunction(D);if(B!=null&&E!=null){var F=this.getPerimeterBounds(D,C);if(F.width>0||F.height>0){A=B(F,D,E,G);}}if(A==null){A=this.getPoint(D);}}return A;};mxGraphView.prototype.getRoutingCenterX=function(B){var A=(B.style!=null)?parseFloat(B.style[mxConstants.STYLE_ROUTING_CENTER_X])||0:0;return B.getCenterX()+A*B.width;};mxGraphView.prototype.getRoutingCenterY=function(B){var A=(B.style!=null)?parseFloat(B.style[mxConstants.STYLE_ROUTING_CENTER_Y])||0:0;return B.getCenterY()+A*B.height;};mxGraphView.prototype.getPerimeterBounds=function(B,A){A=(A!=null)?A:0;if(B!=null){A+=parseFloat(B.style[mxConstants.STYLE_PERIMETER_SPACING]||0);}return B.getPerimeterBounds(A*this.scale);};mxGraphView.prototype.getPerimeterFunction=function(state){var perimeter=state.style[mxConstants.STYLE_PERIMETER];if(typeof (perimeter)=="string"){var tmp=mxStyleRegistry.getValue(perimeter);if(tmp==null&&this.isAllowEval()){tmp=mxUtils.eval(perimeter);}perimeter=tmp;}if(typeof (perimeter)=="function"){return perimeter;}return null;};mxGraphView.prototype.getNextPoint=function(C,E,D){var F=C.absolutePoints;var A=null;if(F!=null&&(D||F.length>2||E==null)){var B=F.length;A=F[(D)?Math.min(1,B-1):Math.max(0,B-2)];}if(A==null&&E!=null){A=new mxPoint(E.getCenterX(),E.getCenterY());}return A;};mxGraphView.prototype.getVisibleTerminal=function(C,D){var B=this.graph.getModel();var A=B.getTerminal(C,D);var E=A;while(A!=null&&A!=this.currentRoot){if(!this.graph.isCellVisible(E)||this.graph.isCellCollapsed(A)){E=A;}A=B.getParent(A);}if(B.getParent(E)==B.getRoot()){E=null;}return E;};mxGraphView.prototype.updateEdgeBounds=function(C){var M=C.absolutePoints;C.length=0;if(M!=null&&M.length>0){var N=M[0];var K=M[M.length-1];if(N==null||K==null){this.clear(C.cell,true);}else{if(N.x!=K.x||N.y!=K.y){var Q=K.x-N.x;var O=K.y-N.y;C.terminalDistance=Math.sqrt(Q*Q+O*O);}else{C.terminalDistance=0;}var D=0;var I=[];var P=N;if(P!=null){var F=P.x;var E=P.y;var B=F;var A=E;for(var H=1;H<M.length;H++){var G=M[H];if(G!=null){var Q=P.x-G.x;var O=P.y-G.y;var J=Math.sqrt(Q*Q+O*O);I.push(J);D+=J;P=G;F=Math.min(P.x,F);E=Math.min(P.y,E);B=Math.max(P.x,B);A=Math.max(P.y,A);}}C.length=D;C.segments=I;var L=1;C.x=F;C.y=E;C.width=Math.max(L,B-F);C.height=Math.max(L,A-E);}}}};mxGraphView.prototype.getPoint=function(D,E){var I=D.getCenterX();var H=D.getCenterY();if(D.segments!=null&&(E==null||E.relative)){var M=(E!=null)?E.x/2:0;var S=D.absolutePoints.length;var O=(M+0.5)*D.length;var A=D.segments[0];var C=0;var G=1;while(O>C+A&&G<S-1){C+=A;A=D.segments[G++];}if(A!=0){var N=(O-C)/A;var B=D.absolutePoints[G-1];var U=D.absolutePoints[G];if(B!=null&&U!=null){var L=0;var Q=0;var P=0;if(E!=null){L=E.y;var F=E.offset;if(F!=null){Q=F.x;P=F.y;}}var K=U.x-B.x;var J=U.y-B.y;var T=J/A;var R=K/A;I=B.x+K*N+(T*L+Q)*this.scale;H=B.y+J*N-(R*L-P)*this.scale;}}}else{if(E!=null){var F=E.offset;if(F!=null){I+=F.x;H+=F.y;}}}return new mxPoint(I,H);};mxGraphView.prototype.getRelativePoint=function(R,J,I){var E=this.graph.getModel();var G=E.getGeometry(R.cell);if(G!=null){var Y=R.absolutePoints.length;if(G.relative&&Y>1){var K=R.length;var S=R.segments;var B=R.absolutePoints[0];var d=R.absolutePoints[1];var A=mxUtils.ptSegDistSq(B.x,B.y,d.x,d.y,J,I);var H=0;var Z=0;var F=0;for(var T=2;T<Y;T++){Z+=S[T-2];d=R.absolutePoints[T];var Q=mxUtils.ptSegDistSq(B.x,B.y,d.x,d.y,J,I);if(Q<=A){A=Q;H=T-1;F=Z;}B=d;}var W=S[H];B=R.absolutePoints[H];d=R.absolutePoints[H+1];var U=B.x;var C=B.y;var V=d.x;var D=d.y;var O=J;var M=I;var L=U-V;var N=C-D;O-=V;M-=D;var e=0;O=L-O;M=N-M;var P=O*L+M*N;if(P<=0){e=0;}else{e=P*P/(L*L+N*N);}var X=Math.sqrt(e);if(X>W){X=W;}var b=Math.sqrt(mxUtils.ptSegDistSq(B.x,B.y,d.x,d.y,J,I));var a=mxUtils.relativeCcw(B.x,B.y,d.x,d.y,J,I);if(a==-1){b=-b;}return new mxPoint(((K/2-F-X)/K)*-2,b/this.scale);}}return new mxPoint();};mxGraphView.prototype.updateEdgeLabelOffset=function(A){var J=A.absolutePoints;A.absoluteOffset.x=A.getCenterX();A.absoluteOffset.y=A.getCenterY();if(J!=null&&J.length>0&&A.segments!=null){var G=this.graph.getCellGeometry(A.cell);if(G.relative){var D=this.getPoint(A,G);if(D!=null){A.absoluteOffset=D;}}else{var K=J[0];var E=J[J.length-1];if(K!=null&&E!=null){var M=E.x-K.x;var L=E.y-K.y;var B=0;var I=0;var C=G.offset;if(C!=null){B=C.x;I=C.y;}var H=K.x+M/2+B*this.scale;var F=K.y+L/2+I*this.scale;A.absoluteOffset.x=H;A.absoluteOffset.y=F;}}}};mxGraphView.prototype.getState=function(A,B){B=B||false;var C=null;if(A!=null){C=this.states.get(A);if(this.graph.isCellVisible(A)){if(C==null&&B&&this.graph.isCellVisible(A)){C=this.createState(A);this.states.put(A,C);}else{if(B&&C!=null&&this.updateStyle){C.style=this.graph.getCellStyle(A);}}}}return C;};mxGraphView.prototype.isRendering=function(){return this.rendering;};mxGraphView.prototype.setRendering=function(A){this.rendering=A;};mxGraphView.prototype.isAllowEval=function(){return this.allowEval;};mxGraphView.prototype.setAllowEval=function(A){this.allowEval=A;};mxGraphView.prototype.getStates=function(){return this.states;};mxGraphView.prototype.setStates=function(A){this.states=A;};mxGraphView.prototype.getCellStates=function(B){if(B==null){return this.states;}else{var A=[];for(var C=0;C<B.length;C++){var D=this.getState(B[C]);if(D!=null){A.push(D);}}return A;}};mxGraphView.prototype.removeState=function(A){var B=null;if(A!=null){B=this.states.remove(A);if(B!=null){this.graph.cellRenderer.destroy(B);B.destroy();}}return B;};mxGraphView.prototype.createState=function(A){var B=this.graph.getCellStyle(A);var C=new mxCellState(this,A,B);if(this.isRendering()){this.graph.cellRenderer.initialize(C);}return C;};mxGraphView.prototype.getCanvas=function(){return this.canvas;};mxGraphView.prototype.getBackgroundPane=function(){return this.backgroundPane;};mxGraphView.prototype.getDrawPane=function(){return this.drawPane;};mxGraphView.prototype.getOverlayPane=function(){return this.overlayPane;};mxGraphView.prototype.isContainerEvent=function(A){var B=mxEvent.getSource(A);return(B==this.graph.container||B.parentNode==this.backgroundPane||(B.parentNode!=null&&B.parentNode.parentNode==this.backgroundPane)||B==this.canvas.parentNode||B==this.canvas||B==this.backgroundPane||B==this.drawPane||B==this.overlayPane);};mxGraphView.prototype.isScrollEvent=function(C){var G=mxUtils.getOffset(this.graph.container);var F=new mxPoint(C.clientX-G.x,C.clientY-G.y);var A=this.graph.container.offsetWidth;var B=this.graph.container.clientWidth;if(A>B&&F.x>B+2&&F.x<=A){return true;}var E=this.graph.container.offsetHeight;var D=this.graph.container.clientHeight;if(E>D&&F.y>D+2&&F.y<=E){return true;}return false;};mxGraphView.prototype.init=function(){this.installListeners();var A=this.graph;if(A.dialect==mxConstants.DIALECT_SVG){this.createSvg();}else{if(A.dialect==mxConstants.DIALECT_VML){this.createVml();}else{this.createHtml();}}};mxGraphView.prototype.installListeners=function(){var D=this.graph;var B=D.container;if(B!=null){var C=(mxClient.IS_TOUCH)?"touchstart":"mousedown";var E=(mxClient.IS_TOUCH)?"touchmove":"mousemove";var A=(mxClient.IS_TOUCH)?"touchend":"mouseup";mxEvent.addListener(B,C,mxUtils.bind(this,function(F){if(this.isContainerEvent(F)&&((!false&&!false&&!false&&!false)||!this.isScrollEvent(F))){D.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(F));}}));mxEvent.addListener(B,E,mxUtils.bind(this,function(F){if(this.isContainerEvent(F)){D.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(F));}}));mxEvent.addListener(B,A,mxUtils.bind(this,function(F){if(this.isContainerEvent(F)){D.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(F));}}));mxEvent.addListener(B,"dblclick",mxUtils.bind(this,function(F){D.dblClick(F);}));mxEvent.addListener(document,C,mxUtils.bind(this,function(F){if(this.isContainerEvent(F)){D.panningHandler.hideMenu();}}));mxEvent.addListener(document,E,mxUtils.bind(this,function(F){if(D.tooltipHandler!=null&&D.tooltipHandler.isHideOnHover()){D.tooltipHandler.hide();}if(this.captureDocumentGesture&&D.isMouseDown&&!mxEvent.isConsumed(F)){D.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(F));}}));mxEvent.addListener(document,A,mxUtils.bind(this,function(F){if(this.captureDocumentGesture){D.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(F));}}));}};mxGraphView.prototype.createHtml=function(){var A=this.graph.container;if(A!=null){this.canvas=this.createHtmlPane();this.backgroundPane=this.createHtmlPane(1,1);this.drawPane=this.createHtmlPane(1,1);this.overlayPane=this.createHtmlPane(1,1);this.canvas.appendChild(this.backgroundPane);this.canvas.appendChild(this.drawPane);this.canvas.appendChild(this.overlayPane);A.appendChild(this.canvas);}};mxGraphView.prototype.createHtmlPane=function(B,A){var C=document.createElement("DIV");if(B!=null&&A!=null){C.style.position="absolute";C.style.left="0px";C.style.top="0px";C.style.width=B+"px";C.style.height=A+"px";}else{C.style.position="relative";}return C;};mxGraphView.prototype.createVml=function(){var B=this.graph.container;if(B!=null){var C=B.offsetWidth;var A=B.offsetHeight;this.canvas=this.createVmlPane(C,A);this.backgroundPane=this.createVmlPane(C,A);this.drawPane=this.createVmlPane(C,A);this.overlayPane=this.createVmlPane(C,A);this.canvas.appendChild(this.backgroundPane);this.canvas.appendChild(this.drawPane);this.canvas.appendChild(this.overlayPane);B.appendChild(this.canvas);}};mxGraphView.prototype.createVmlPane=function(B,A){var C=document.createElement("v:group");C.style.position="absolute";C.style.left="0px";C.style.top="0px";C.style.width=B+"px";C.style.height=A+"px";C.setAttribute("coordsize",B+","+A);C.setAttribute("coordorigin","0,0");return C;};mxGraphView.prototype.createSvg=function(){var B=this.graph.container;this.canvas=document.createElementNS(mxConstants.NS_SVG,"g");this.backgroundPane=document.createElementNS(mxConstants.NS_SVG,"g");this.canvas.appendChild(this.backgroundPane);this.drawPane=document.createElementNS(mxConstants.NS_SVG,"g");this.canvas.appendChild(this.drawPane);this.overlayPane=document.createElementNS(mxConstants.NS_SVG,"g");this.canvas.appendChild(this.overlayPane);var A=document.createElementNS(mxConstants.NS_SVG,"svg");var D=mxUtils.bind(this,function(F){if(this.graph.container!=null){var G=this.graph.container.offsetWidth;var E=this.graph.container.offsetHeight;var H=this.getGraphBounds();A.setAttribute("width",Math.max(G,H.width));A.setAttribute("height",Math.max(E,H.height));}});mxEvent.addListener(window,"resize",D);if(false){D();}A.appendChild(this.canvas);if(B!=null){B.appendChild(A);var C=mxUtils.getCurrentStyle(B);if(C.position=="static"){B.style.position="relative";}}};mxGraphView.prototype.destroy=function(){var A=(this.canvas!=null)?this.canvas.ownerSVGElement:null;if(A==null){A=this.canvas;}if(A!=null&&A.parentNode!=null){this.clear(this.currentRoot,true);mxEvent.removeAllListeners(document);mxEvent.release(this.graph.container);A.parentNode.removeChild(A);this.canvas=null;this.backgroundPane=null;this.drawPane=null;this.overlayPane=null;}};function mxCurrentRootChange(B,A){this.view=B;this.root=A;this.previous=A;this.isUp=A==null;if(!this.isUp){var D=this.view.currentRoot;var C=this.view.graph.getModel();while(D!=null){if(D==A){this.isUp=true;break;}D=C.getParent(D);}}}mxCurrentRootChange.prototype.execute=function(){var B=this.view.currentRoot;this.view.currentRoot=this.previous;this.previous=B;var C=this.view.graph.getTranslateForRoot(this.view.currentRoot);if(C!=null){this.view.translate=new mxPoint(-C.x,-C.y);}var A=(this.isUp)?mxEvent.UP:mxEvent.DOWN;this.view.fireEvent(new mxEventObject(A,"root",this.view.currentRoot,"previous",this.previous));if(this.isUp){this.view.clear(this.view.currentRoot,true);this.view.validate();}else{this.view.refresh();}this.isUp=!this.isUp;};function mxGraph(A,B,C){this.renderHint=C;if(true){this.dialect=mxConstants.DIALECT_SVG;}else{if(C==mxConstants.RENDERING_HINT_EXACT&&false){this.dialect=mxConstants.DIALECT_VML;}else{if(C==mxConstants.RENDERING_HINT_FASTEST){this.dialect=mxConstants.DIALECT_STRICTHTML;}else{if(C==mxConstants.RENDERING_HINT_FASTER){this.dialect=mxConstants.DIALECT_PREFERHTML;}else{this.dialect=mxConstants.DIALECT_MIXEDHTML;}}}}this.model=(B!=null)?B:new mxGraphModel();this.multiplicities=[];this.cellRenderer=this.createCellRenderer();this.setSelectionModel(this.createSelectionModel());this.setStylesheet(this.createStylesheet());this.view=this.createGraphView();this.model.addListener(mxEvent.CHANGE,mxUtils.bind(this,function(E,D){this.graphModelChanged(D.getProperty("changes"));}));this.createHandlers();if(A!=null){this.init(A);}this.view.revalidate();}mxResources.add(mxClient.basePath+"/resources/graph");mxGraph.prototype=new mxEventSource();mxGraph.prototype.constructor=mxGraph;mxGraph.prototype.EMPTY_ARRAY=[];mxGraph.prototype.mouseListeners=null;mxGraph.prototype.isMouseDown=false;mxGraph.prototype.model=null;mxGraph.prototype.view=null;mxGraph.prototype.stylesheet=null;mxGraph.prototype.selectionModel=null;mxGraph.prototype.cellEditor=null;mxGraph.prototype.cellRenderer=null;mxGraph.prototype.multiplicities=null;mxGraph.prototype.renderHint=null;mxGraph.prototype.dialect=null;mxGraph.prototype.gridSize=10;mxGraph.prototype.gridEnabled=true;mxGraph.prototype.tolerance=4;mxGraph.prototype.defaultOverlap=0.5;mxGraph.prototype.defaultParent=null;mxGraph.prototype.alternateEdgeStyle=null;mxGraph.prototype.backgroundImage=null;mxGraph.prototype.pageVisible=false;mxGraph.prototype.pageBreaksVisible=false;mxGraph.prototype.pageBreakColor="gray";mxGraph.prototype.pageBreakDashed=true;mxGraph.prototype.minPageBreakDist=20;mxGraph.prototype.preferPageSize=false;mxGraph.prototype.pageFormat=mxConstants.PAGE_FORMAT_A4_PORTRAIT;mxGraph.prototype.pageScale=1.5;mxGraph.prototype.enabled=true;mxGraph.prototype.escapeEnabled=true;mxGraph.prototype.invokesStopCellEditing=true;mxGraph.prototype.enterStopsCellEditing=false;mxGraph.prototype.useScrollbarsForPanning=true;mxGraph.prototype.exportEnabled=true;mxGraph.prototype.importEnabled=true;mxGraph.prototype.cellsLocked=false;mxGraph.prototype.cellsCloneable=true;mxGraph.prototype.foldingEnabled=true;mxGraph.prototype.cellsEditable=true;mxGraph.prototype.cellsDeletable=true;mxGraph.prototype.cellsMovable=true;mxGraph.prototype.edgeLabelsMovable=true;mxGraph.prototype.vertexLabelsMovable=false;mxGraph.prototype.dropEnabled=false;mxGraph.prototype.splitEnabled=true;mxGraph.prototype.cellsResizable=true;mxGraph.prototype.cellsBendable=true;mxGraph.prototype.cellsSelectable=true;mxGraph.prototype.cellsDisconnectable=true;mxGraph.prototype.autoSizeCells=false;mxGraph.prototype.autoScroll=true;mxGraph.prototype.autoExtend=true;mxGraph.prototype.maximumGraphBounds=null;mxGraph.prototype.minimumGraphSize=null;mxGraph.prototype.minimumContainerSize=null;mxGraph.prototype.maximumContainerSize=null;mxGraph.prototype.resizeContainer=false;mxGraph.prototype.border=0;mxGraph.prototype.ordered=true;mxGraph.prototype.keepEdgesInForeground=false;mxGraph.prototype.keepEdgesInBackground=true;mxGraph.prototype.allowNegativeCoordinates=true;mxGraph.prototype.constrainChildren=true;mxGraph.prototype.extendParents=true;mxGraph.prototype.extendParentsOnAdd=true;mxGraph.prototype.collapseToPreferredSize=true;mxGraph.prototype.zoomFactor=1.2;mxGraph.prototype.keepSelectionVisibleOnZoom=false;mxGraph.prototype.centerZoom=true;mxGraph.prototype.resetViewOnRootChange=true;mxGraph.prototype.resetEdgesOnResize=false;mxGraph.prototype.resetEdgesOnMove=false;mxGraph.prototype.resetEdgesOnConnect=true;mxGraph.prototype.allowLoops=false;mxGraph.prototype.defaultLoopStyle=mxEdgeStyle.Loop;mxGraph.prototype.multigraph=true;mxGraph.prototype.connectableEdges=false;mxGraph.prototype.allowDanglingEdges=true;mxGraph.prototype.cloneInvalidEdges=false;mxGraph.prototype.disconnectOnMove=true;mxGraph.prototype.labelsVisible=true;mxGraph.prototype.htmlLabels=false;mxGraph.prototype.swimlaneSelectionEnabled=true;mxGraph.prototype.swimlaneNesting=true;mxGraph.prototype.swimlaneIndicatorColorAttribute=mxConstants.STYLE_FILLCOLOR;mxGraph.prototype.collapsedImage=new mxImage(mxClient.imageBasePath+"/collapsed.gif",9,9);mxGraph.prototype.expandedImage=new mxImage(mxClient.imageBasePath+"/expanded.gif",9,9);mxGraph.prototype.warningImage=new mxImage(mxClient.imageBasePath+"/warning"+((mxClient.IS_MAC)?".png":".gif"),16,16);mxGraph.prototype.alreadyConnectedResource=(mxClient.language!="none")?"alreadyConnected":"";mxGraph.prototype.containsValidationErrorsResource=(mxClient.language!="none")?"containsValidationErrors":"";mxGraph.prototype.collapseExpandResource=(mxClient.language!="none")?"collapse-expand":"";mxGraph.prototype.init=function(A){this.container=A;this.cellEditor=this.createCellEditor();this.view.init();this.sizeDidChange();if(false){mxEvent.addListener(window,"unload",mxUtils.bind(this,function(){this.destroy();}));mxEvent.addListener(A,"selectstart",mxUtils.bind(this,function(){return this.isEditing();}));}};mxGraph.prototype.createHandlers=function(A){this.tooltipHandler=new mxTooltipHandler(this);this.tooltipHandler.setEnabled(false);this.panningHandler=new mxPanningHandler(this);this.panningHandler.panningEnabled=false;this.selectionCellsHandler=new mxSelectionCellsHandler(this);this.connectionHandler=new mxConnectionHandler(this);this.connectionHandler.setEnabled(false);this.graphHandler=new mxGraphHandler(this);};mxGraph.prototype.createSelectionModel=function(){return new mxGraphSelectionModel(this);};mxGraph.prototype.createStylesheet=function(){return new mxStylesheet();};mxGraph.prototype.createGraphView=function(){return new mxGraphView(this);};mxGraph.prototype.createCellRenderer=function(){return new mxCellRenderer();};mxGraph.prototype.createCellEditor=function(){return new mxCellEditor(this);};mxGraph.prototype.getModel=function(){return this.model;};mxGraph.prototype.getView=function(){return this.view;};mxGraph.prototype.getStylesheet=function(){return this.stylesheet;};mxGraph.prototype.setStylesheet=function(A){this.stylesheet=A;};mxGraph.prototype.getSelectionModel=function(){return this.selectionModel;};mxGraph.prototype.setSelectionModel=function(A){this.selectionModel=A;};mxGraph.prototype.getSelectionCellsForChanges=function(D){var B=[];for(var C=0;C<D.length;C++){var E=D[C];if(E.constructor!=mxRootChange){var A=null;if(E.constructor==mxChildChange&&E.isAdded){A=E.child;}else{if(E.cell!=null&&E.cell.constructor==mxCell){A=E.cell;}}if(A!=null&&mxUtils.indexOf(B,A)<0){B.push(A);}}}return this.getModel().getTopmostCells(B);};mxGraph.prototype.graphModelChanged=function(B){for(var A=0;A<B.length;A++){this.processChange(B[A]);}this.removeSelectionCells(this.getRemovedCellsForChanges(B));this.view.validate();this.sizeDidChange();};mxGraph.prototype.getRemovedCellsForChanges=function(C){var A=[];for(var B=0;B<C.length;B++){var D=C[B];if(D.constructor==mxRootChange){break;}else{if(D.constructor==mxChildChange){if(!D.isAdded){A=A.concat(this.model.getDescendants(D.child));}}else{if(D.constructor==mxVisibleChange){A=A.concat(this.model.getDescendants(D.cell));}}}}return A;};mxGraph.prototype.processChange=function(B){if(B.constructor==mxRootChange){this.clearSelection();this.removeStateForCell(B.previous);if(this.resetViewOnRootChange){this.view.scale=1;this.view.translate.x=0;this.view.translate.y=0;}this.fireEvent(new mxEventObject(mxEvent.ROOT));}else{if(B.constructor==mxChildChange){var A=this.model.getParent(B.child);if(A!=null){this.view.invalidate(B.child,true,false,true);}else{this.removeStateForCell(B.child);}if(A!=B.previous){if(A!=null){this.view.invalidate(A,false,false);}if(B.previous!=null){this.view.invalidate(B.previous,false,false);}}}else{if(B.constructor==mxTerminalChange||B.constructor==mxGeometryChange){this.view.invalidate(B.cell);}else{if(B.constructor==mxValueChange){this.view.invalidate(B.cell,false,false);}else{if(B.constructor==mxStyleChange){this.view.removeState(B.cell);}else{if(B.cell!=null&&B.cell.constructor==mxCell){this.removeStateForCell(B.cell);}}}}}}};mxGraph.prototype.removeStateForCell=function(A){var B=this.model.getChildCount(A);for(var C=0;C<B;C++){this.removeStateForCell(this.model.getChildAt(A,C));}this.view.removeState(A);};mxGraph.prototype.addCellOverlay=function(A,B){if(A.overlays==null){A.overlays=[];}A.overlays.push(B);var C=this.view.getState(A);if(C!=null){this.cellRenderer.redraw(C);}this.fireEvent(new mxEventObject(mxEvent.ADD_OVERLAY,"cell",A,"overlay",B));return B;};mxGraph.prototype.getCellOverlays=function(A){return A.overlays;};mxGraph.prototype.removeCellOverlay=function(A,C){if(C==null){this.removeCellOverlays(A);}else{var B=mxUtils.indexOf(A.overlays,C);if(B>=0){A.overlays.splice(B,1);if(A.overlays.length==0){A.overlays=null;}var D=this.view.getState(A);if(D!=null){this.cellRenderer.redraw(D);}this.fireEvent(new mxEventObject(mxEvent.REMOVE_OVERLAY,"cell",A,"overlay",C));}else{C=null;}}return C;};mxGraph.prototype.removeCellOverlays=function(A){var C=A.overlays;if(C!=null){A.overlays=null;var D=this.view.getState(A);if(D!=null){this.cellRenderer.redraw(D);}for(var B=0;B<C.length;B++){this.fireEvent(new mxEventObject(mxEvent.REMOVE_OVERLAY,"cell",A,"overlay",C[B]));}}return C;};mxGraph.prototype.clearCellOverlays=function(A){A=(A!=null)?A:this.model.getRoot();this.removeCellOverlays(A);var B=this.model.getChildCount(A);for(var C=0;C<B;C++){var D=this.model.getChildAt(A,C);this.clearCellOverlays(D);}};mxGraph.prototype.setCellWarning=function(A,D,B,E){if(D!=null&&D.length>0){B=(B!=null)?B:this.warningImage;var C=new mxCellOverlay(B,"<font color=red>"+D+"</font>");if(E){C.addListener(mxEvent.CLICK,mxUtils.bind(this,function(G,F){if(this.isEnabled()){this.setSelectionCell(A);}}));}return this.addCellOverlay(A,C);}else{this.removeCellOverlays(A);}return null;};mxGraph.prototype.startEditing=function(A){this.startEditingAtCell(null,A);};mxGraph.prototype.startEditingAtCell=function(A,B){if(A==null){A=this.getSelectionCell();if(A!=null&&!this.isCellEditable(A)){A=null;}}if(A!=null){this.fireEvent(new mxEventObject(mxEvent.START_EDITING,"cell",A,"event",B));this.cellEditor.startEditing(A,B);}};mxGraph.prototype.getEditingValue=function(A,B){return this.convertValueToString(A);};mxGraph.prototype.stopEditing=function(A){this.cellEditor.stopEditing(A);};mxGraph.prototype.labelChanged=function(A,C,B){this.model.beginUpdate();try{this.cellLabelChanged(A,C,this.isAutoSizeCell(A));this.fireEvent(new mxEventObject(mxEvent.LABEL_CHANGED,"cell",A,"value",C,"event",B));}finally{this.model.endUpdate();}return A;};mxGraph.prototype.cellLabelChanged=function(B,C,A){this.model.beginUpdate();try{this.model.setValue(B,C);if(A){this.cellSizeUpdated(B,false);}}finally{this.model.endUpdate();}};mxGraph.prototype.escape=function(A){this.stopEditing(true);this.connectionHandler.reset();this.graphHandler.reset();var B=this.getSelectionCells();for(var C=0;C<B.length;C++){var D=this.view.getState(B[C]);if(D!=null&&D.handler!=null){D.handler.reset();}}};mxGraph.prototype.click=function(C){var B=C.getEvent();var A=C.getCell();var F=new mxEventObject(mxEvent.CLICK,"event",B,"cell",A);if(C.isConsumed()){F.consume();}this.fireEvent(F);if(this.isEnabled()&&!mxEvent.isConsumed(B)&&!F.isConsumed()){if(A!=null){this.selectCellForEvent(A,B);}else{var D=null;if(this.isSwimlaneSelectionEnabled()){var E=mxUtils.convertPoint(this.container,B.clientX,B.clientY);D=this.getSwimlaneAt(E.x,E.y);}if(D!=null){this.selectCellForEvent(D,B);}else{if(!this.isToggleEvent(B)){this.clearSelection();}}}}};mxGraph.prototype.dblClick=function(B,A){var C=new mxEventObject(mxEvent.DOUBLE_CLICK,"event",B,"cell",A);this.fireEvent(C);if(this.isEnabled()&&!mxEvent.isConsumed(B)&&!C.isConsumed()&&A!=null&&this.isCellEditable(A)){this.startEditingAtCell(A,B);}};mxGraph.prototype.scrollPointToVisible=function(I,G,E,D){if(mxUtils.hasScrollbars(this.container)){var F=this.container;D=(D!=null)?D:20;if(I>=F.scrollLeft&&G>=F.scrollTop&&I<=F.scrollLeft+F.clientWidth&&G<=F.scrollTop+F.clientHeight){var L=F.scrollLeft+F.clientWidth-I;if(L<D){var C=F.scrollLeft;F.scrollLeft+=D-L;if(E&&C==F.scrollLeft){if(this.dialect==mxConstants.DIALECT_SVG){var H=this.view.getDrawPane().ownerSVGElement;var A=parseInt(H.getAttribute("width"))+D-L;H.setAttribute("width",A);}else{var A=Math.max(F.clientWidth,F.scrollWidth)+D-L;var B=this.view.getCanvas();B.style.width=A+"px";}F.scrollLeft+=D-L;}}else{L=I-F.scrollLeft;if(L<D){F.scrollLeft-=D-L;}}var K=F.scrollTop+F.clientHeight-G;if(K<D){var C=F.scrollTop;F.scrollTop+=D-K;if(C==F.scrollTop&&E){if(this.dialect==mxConstants.DIALECT_SVG){var H=this.view.getDrawPane().ownerSVGElement;var J=parseInt(H.getAttribute("height"))+D-K;H.setAttribute("height",J);}else{var J=Math.max(F.clientHeight,F.scrollHeight)+D-K;var B=this.view.getCanvas();B.style.height=J+"px";}F.scrollTop+=D-K;}}else{K=G-F.scrollTop;if(K<D){F.scrollTop-=D-K;}}}}};mxGraph.prototype.sizeDidChange=function(){var B=this.getGraphBounds();if(this.container!=null){var H=this.getBorder();var C=B.x+B.width+1+H;var Q=B.y+B.height+1+H;if(this.minimumContainerSize!=null){C=Math.max(C,this.minimumContainerSize.width);Q=Math.max(Q,this.minimumContainerSize.height);}if(this.resizeContainer){var P=C;var I=Q;if(this.maximumContainerSize!=null){P=Math.min(this.maximumContainerSize.width,P);I=Math.min(this.maximumContainerSize.height,I);}this.container.style.width=P+"px";this.container.style.height=I+"px";}if(this.preferPageSize||(!false&&this.pageVisible)){var G=this.view.scale;var M=this.view.translate;var E=this.pageFormat;var A=G*this.pageScale;var L=new mxRectangle(G*M.x,G*M.y,E.width*A,E.height*A);var F=(this.pageBreaksVisible)?Math.ceil(C/L.width):1;var J=(this.pageBreaksVisible)?Math.ceil(Q/L.height):1;C=F*L.width+2;Q=J*L.height+2;}C=Math.max(C,this.container.offsetWidth);Q=Math.max(Q,this.container.offsetHeight);if(this.dialect==mxConstants.DIALECT_SVG){var N=this.view.getDrawPane().ownerSVGElement;if(this.minimumGraphSize!=null){C=Math.max(C,this.minimumGraphSize.width*this.view.scale);Q=Math.max(Q,this.minimumGraphSize.height*this.view.scale);}N.setAttribute("width",C);N.setAttribute("height",Q);if(C<=this.container.offsetWidth&&this.container.clientWidth<this.container.offsetWidth){var K=this.container.style.overflow;this.container.style.overflow="hidden";this.container.scrollLeft=1;this.container.style.overflow=K;}}else{var O=this.view.getDrawPane();var D=this.view.getCanvas();O.style.width=C+"px";O.style.height=Q+"px";D.style.width=C+"px";D.style.height=Q+"px";if(this.minimumGraphSize!=null){C=Math.max(C,this.minimumGraphSize.width*this.view.scale);Q=Math.max(Q,this.minimumGraphSize.height*this.view.scale);D.style.width=C+"px";D.style.height=Q+"px";}}this.updatePageBreaks(this.pageBreaksVisible,C-1,Q-1);}this.fireEvent(new mxEventObject(mxEvent.SIZE,"bounds",B));};mxGraph.prototype.updatePageBreaks=function(H,E,M){var I=this.view.scale;var K=this.view.translate;var G=this.pageFormat;var B=I*this.pageScale;var C=new mxRectangle(I*K.x,I*K.y,G.width*B,G.height*B);H=H&&Math.min(C.width,C.height)>this.minPageBreakDist;C.x=mxUtils.mod(C.x,C.width);C.y=mxUtils.mod(C.y,C.height);var D=(H)?Math.ceil((E-C.x)/C.width):0;var F=(H)?Math.ceil((M-C.y)/C.height):0;var L=E;var A=M;if(this.horizontalPageBreaks==null&&D>0){this.horizontalPageBreaks=[];}if(this.horizontalPageBreaks!=null){for(var J=0;J<=D;J++){var O=[new mxPoint(C.x+J*C.width,1),new mxPoint(C.x+J*C.width,A)];if(this.horizontalPageBreaks[J]!=null){this.horizontalPageBreaks[J].scale=I;this.horizontalPageBreaks[J].points=O;this.horizontalPageBreaks[J].redraw();}else{var N=new mxPolyline(O,this.pageBreakColor,this.scale);N.dialect=this.dialect;N.isDashed=this.pageBreakDashed;N.scale=I;N.crisp=true;N.init(this.view.backgroundPane);this.horizontalPageBreaks[J]=N;}}for(var J=D;J<this.horizontalPageBreaks.length;J++){this.horizontalPageBreaks[J].destroy();}this.horizontalPageBreaks.splice(D,this.horizontalPageBreaks.length-D);}if(this.verticalPageBreaks==null&&F>0){this.verticalPageBreaks=[];}if(this.verticalPageBreaks!=null){for(var J=0;J<=F;J++){var O=[new mxPoint(1,C.y+J*C.height),new mxPoint(L,C.y+J*C.height)];if(this.verticalPageBreaks[J]!=null){this.verticalPageBreaks[J].scale=I;this.verticalPageBreaks[J].points=O;this.verticalPageBreaks[J].redraw();}else{var N=new mxPolyline(O,this.pageBreakColor,I);N.dialect=this.dialect;N.isDashed=this.pageBreakDashed;N.scale=I;N.crisp=true;N.init(this.view.backgroundPane);this.verticalPageBreaks[J]=N;}}for(var J=F;J<this.verticalPageBreaks.length;J++){this.verticalPageBreaks[J].destroy();}this.verticalPageBreaks.splice(F,this.verticalPageBreaks.length-F);}};mxGraph.prototype.getCellStyle=function(A){var C=this.model.getStyle(A);var B=null;if(this.model.isEdge(A)){B=this.stylesheet.getDefaultEdgeStyle();}else{B=this.stylesheet.getDefaultVertexStyle();}if(C!=null){B=this.stylesheet.getCellStyle(C,B);}if(B==null){B=mxGraph.prototype.EMPTY_ARRAY;}return B;};mxGraph.prototype.setCellStyle=function(C,A){A=A||this.getSelectionCells();if(A!=null){this.model.beginUpdate();try{for(var B=0;B<A.length;B++){this.model.setStyle(A[B],C);}}finally{this.model.endUpdate();}}};mxGraph.prototype.toggleCellStyle=function(C,B,A){A=A||this.getSelectionCell();this.toggleCellStyles(C,B,[A]);};mxGraph.prototype.toggleCellStyles=function(C,A,B){A=(A!=null)?A:false;B=B||this.getSelectionCells();if(B!=null&&B.length>0){var E=this.view.getState(B[0]);var D=(E!=null)?E.style:this.getCellStyle(B[0]);if(D!=null){var F=(mxUtils.getValue(D,C,A))?0:1;this.setCellStyles(C,F,B);}}};mxGraph.prototype.setCellStyles=function(B,C,A){A=A||this.getSelectionCells();mxUtils.setCellStyles(this.model,A,B,C);};mxGraph.prototype.toggleCellStyleFlags=function(C,A,B){this.setCellStyleFlags(C,A,null,B);};mxGraph.prototype.setCellStyleFlags=function(C,A,F,B){B=B||this.getSelectionCells();if(B!=null&&B.length>0){if(F==null){var E=this.view.getState(B[0]);var D=(E!=null)?E.style:this.getCellStyle(B[0]);if(D!=null){var G=parseInt(D[C]||0);F=!((G&A)==A);}}mxUtils.setCellStyleFlags(this.model,B,C,A,F);}};mxGraph.prototype.alignCells=function(E,A,D){if(A==null){A=this.getSelectionCells();}if(A!=null&&A.length>1){if(D==null){for(var B=0;B<A.length;B++){var C=this.getCellGeometry(A[B]);if(C!=null&&!this.model.isEdge(A[B])){if(D==null){if(E==mxConstants.ALIGN_CENTER){D=C.x+C.width/2;break;}else{if(E==mxConstants.ALIGN_RIGHT){D=C.x+C.width;}else{if(E==mxConstants.ALIGN_TOP){D=C.y;}else{if(E==mxConstants.ALIGN_MIDDLE){D=C.y+C.height/2;break;}else{if(E==mxConstants.ALIGN_BOTTOM){D=C.y+C.height;}else{D=C.x;}}}}}}else{if(E==mxConstants.ALIGN_RIGHT){D=Math.max(D,C.x+C.width);}else{if(E==mxConstants.ALIGN_TOP){D=Math.min(D,C.y);}else{if(E==mxConstants.ALIGN_BOTTOM){D=Math.max(D,C.y+C.height);}else{D=Math.min(D,C.x);}}}}}}}this.model.beginUpdate();try{for(var B=0;B<A.length;B++){var C=this.getCellGeometry(A[B]);if(C!=null&&!this.model.isEdge(A[B])){C=C.clone();if(E==mxConstants.ALIGN_CENTER){C.x=D-C.width/2;}else{if(E==mxConstants.ALIGN_RIGHT){C.x=D-C.width;}else{if(E==mxConstants.ALIGN_TOP){C.y=D;}else{if(E==mxConstants.ALIGN_MIDDLE){C.y=D-C.height/2;}else{if(E==mxConstants.ALIGN_BOTTOM){C.y=D-C.height;}else{C.x=D;}}}}}this.model.setGeometry(A[B],C);}}this.fireEvent(new mxEventObject(mxEvent.ALIGN_CELLS,"align",E,"cells",A));}finally{this.model.endUpdate();}}return A;};mxGraph.prototype.flipEdge=function(B){if(B!=null&&this.alternateEdgeStyle!=null){this.model.beginUpdate();try{var A=this.model.getStyle(B);if(A==null||A.length==0){this.model.setStyle(B,this.alternateEdgeStyle);}else{this.model.setStyle(B,null);}this.resetEdge(B);this.fireEvent(new mxEventObject(mxEvent.FLIP_EDGE,"edge",B));}finally{this.model.endUpdate();}}return B;};mxGraph.prototype.orderCells=function(A,B){if(B==null){B=mxUtils.sortCells(this.getSelectionCells(),true);}this.model.beginUpdate();try{this.cellsOrdered(B,A);this.fireEvent(new mxEventObject(mxEvent.ORDER_CELLS,"back",A,"cells",B));}finally{this.model.endUpdate();}return B;};mxGraph.prototype.cellsOrdered=function(B,A){if(B!=null){this.model.beginUpdate();try{for(var C=0;C<B.length;C++){var D=this.model.getParent(B[C]);if(A){this.model.add(D,B[C],C);}else{this.model.add(D,B[C],this.model.getChildCount(D)-1);}}this.fireEvent(new mxEventObject(mxEvent.CELLS_ORDERED,"back",A,"cells",B));}finally{this.model.endUpdate();}}};mxGraph.prototype.groupCells=function(F,C,B){if(B==null){B=mxUtils.sortCells(this.getSelectionCells(),true);}B=this.getCellsForGroup(B);if(F==null){F=this.createGroupCell(B);}var E=this.getBoundsForGroup(F,B,C);if(B.length>0&&E!=null){var D=this.model.getParent(B[0]);this.model.beginUpdate();try{if(this.getCellGeometry(F)==null){this.model.setGeometry(F,new mxGeometry());}var A=this.model.getChildCount(F);this.cellsAdded(B,F,A,null,null,false);this.cellsMoved(B,-E.x,-E.y,false,true);A=this.model.getChildCount(D);this.cellsAdded([F],D,A,null,null,false);this.cellsResized([F],[E]);this.fireEvent(new mxEventObject(mxEvent.GROUP_CELLS,"group",F,"border",C,"cells",B));}finally{this.model.endUpdate();}}return F;};mxGraph.prototype.getCellsForGroup=function(B){var A=[];if(B!=null&&B.length>0){var D=this.model.getParent(B[0]);A.push(B[0]);for(var C=1;C<B.length;C++){if(this.model.getParent(B[C])==D){A.push(B[C]);}}}return A;};mxGraph.prototype.getBoundsForGroup=function(E,D,B){var A=this.getBoundingBoxFromGeometry(D);if(A!=null){if(this.isSwimlane(E)){var C=this.getStartSize(E);A.x-=C.width;A.y-=C.height;A.width+=C.width;A.height+=C.height;}A.x-=B;A.y-=B;A.width+=2*B;A.height+=2*B;}return A;};mxGraph.prototype.createGroupCell=function(A){var B=new mxCell("");B.setVertex(true);B.setConnectable(false);return B;};mxGraph.prototype.ungroupCells=function(C){var A=[];if(C==null){C=this.getSelectionCells();var F=[];for(var E=0;E<C.length;E++){if(this.model.getChildCount(C[E])>0){F.push(C[E]);}}C=F;}if(C!=null&&C.length>0){this.model.beginUpdate();try{for(var E=0;E<C.length;E++){var D=this.model.getChildren(C[E]);if(D!=null&&D.length>0){D=D.slice();var G=this.model.getParent(C[E]);var B=this.model.getChildCount(G);this.cellsAdded(D,G,B,null,null,true);A=A.concat(D);}}this.cellsRemoved(this.addAllEdges(C));this.fireEvent(new mxEventObject(mxEvent.UNGROUP_CELLS,"cells",C));}finally{this.model.endUpdate();}}return A;};mxGraph.prototype.removeCellsFromParent=function(B){if(B==null){B=this.getSelectionCells();}this.model.beginUpdate();try{var C=this.getDefaultParent();var A=this.model.getChildCount(C);this.cellsAdded(B,C,A,null,null,true);this.fireEvent(new mxEventObject(mxEvent.REMOVE_CELLS_FROM_PARENT,"cells",B));}finally{this.model.endUpdate();}return B;};mxGraph.prototype.updateGroupBounds=function(C,B,A){if(C==null){C=this.getSelectionCells();}B=(B!=null)?B:0;A=(A!=null)?A:false;this.model.beginUpdate();try{for(var F=0;F<C.length;F++){var H=this.getCellGeometry(C[F]);if(H!=null){var E=this.getChildCells(C[F]);if(E!=null&&E.length>0){var G=this.getBoundingBoxFromGeometry(E);if(G.width>0&&G.height>0){var D=(this.isSwimlane(C[F]))?this.getStartSize(C[F]):new mxRectangle();H=H.clone();if(A){H.x+=G.x-D.width-B;H.y+=G.y-D.height-B;}H.width=G.width+D.width+2*B;H.height=G.height+D.height+2*B;this.model.setGeometry(C[F],H);this.moveCells(E,-G.x+D.width+B,-G.y+D.height+B);}}}}}finally{this.model.endUpdate();}return C;};mxGraph.prototype.cloneCells=function(C,R){R=(R!=null)?R:true;var A=null;if(C!=null){var B=new Object();var S=[];for(var O=0;O<C.length;O++){var K=mxCellPath.create(C[O]);B[K]=C[O];S.push(C[O]);}if(S.length>0){var U=this.view.scale;var D=this.view.translate;A=this.model.cloneCells(C,true);for(var O=0;O<C.length;O++){if(!R&&this.model.isEdge(A[O])&&this.getEdgeValidationError(A[O],this.model.getTerminal(A[O],true),this.model.getTerminal(A[O],false))!=null){A[O]=null;}else{var Q=this.model.getGeometry(A[O]);if(Q!=null){var E=this.view.getState(C[O]);var T=this.view.getState(this.model.getParent(C[O]));if(E!=null&&T!=null){var J=T.origin.x;var I=T.origin.y;if(this.model.isEdge(A[O])){var V=E.absolutePoints;var G=this.model.getTerminal(C[O],true);var H=mxCellPath.create(G);while(G!=null&&B[H]==null){G=this.model.getParent(G);H=mxCellPath.create(G);}if(G==null){Q.setTerminalPoint(new mxPoint(V[0].x/U-D.x,V[0].y/U-D.y),true);}var P=this.model.getTerminal(C[O],false);var F=mxCellPath.create(P);while(P!=null&&B[F]==null){P=this.model.getParent(P);F=mxCellPath.create(P);}if(P==null){var L=V.length-1;Q.setTerminalPoint(new mxPoint(V[L].x/U-D.x,V[L].y/U-D.y),false);}var N=Q.points;if(N!=null){for(var M=0;M<N.length;M++){N[M].x+=J;N[M].y+=I;}}}else{Q.x+=J;Q.y+=I;}}}}}}else{A=[];}}return A;};mxGraph.prototype.insertVertex=function(H,B,G,F,E,C,I,A){var D=this.createVertex(H,B,G,F,E,C,I,A);return this.addCell(D,H);};mxGraph.prototype.createVertex=function(I,B,H,G,F,C,J,A){var E=new mxGeometry(G,F,C,J);var D=new mxCell(H,E,A);D.setId(B);D.setVertex(true);D.setConnectable(true);return D;};mxGraph.prototype.insertEdge=function(B,G,E,D,F,A){var C=this.createEdge(B,G,E,D,F,A);return this.addEdge(C,B,D,F);};mxGraph.prototype.createEdge=function(B,G,E,D,F,A){var C=new mxCell(E,new mxGeometry(),A);C.setId(G);C.setEdge(true);C.geometry.relative=true;return C;};mxGraph.prototype.addEdge=function(C,B,D,E,A){return this.addCell(C,B,A,D,E);};mxGraph.prototype.addCell=function(A,C,B,D,E){return this.addCells([A],C,B,D,E)[0];};mxGraph.prototype.addCells=function(B,C,A,D,E){if(C==null){C=this.getDefaultParent();}if(A==null){A=this.model.getChildCount(C);}this.model.beginUpdate();try{this.cellsAdded(B,C,A,D,E,false);this.fireEvent(new mxEventObject(mxEvent.ADD_CELLS,"cells",B,"parent",C,"index",A,"source",D,"target",E));}finally{this.model.endUpdate();}return B;};mxGraph.prototype.cellsAdded=function(O,L,H,A,I,K){if(O!=null&&L!=null&&H!=null){this.model.beginUpdate();try{var M=(K)?this.view.getState(L):null;var C=(M!=null)?M.origin:null;var J=new mxPoint(0,0);for(var F=0;F<O.length;F++){var G=this.model.getParent(O[F]);if(C!=null&&O[F]!=L&&L!=G){var D=this.view.getState(G);var B=(D!=null)?D.origin:J;var E=this.model.getGeometry(O[F]);if(E!=null){var P=B.x-C.x;var N=B.y-C.y;E=E.clone();E.translate(P,N);if(!E.relative&&this.model.isVertex(O[F])&&!this.isAllowNegativeCoordinates()){E.x=Math.max(0,E.x);E.y=Math.max(0,E.y);}this.model.setGeometry(O[F],E);}}if(L==G){H--;}this.model.add(L,O[F],H+F);if(this.isExtendParentsOnAdd()&&this.isExtendParent(O[F])){this.extendParent(O[F]);}this.constrainChild(O[F]);if(A!=null){this.cellConnected(O[F],A,true);}if(I!=null){this.cellConnected(O[F],I,false);}}this.fireEvent(new mxEventObject(mxEvent.CELLS_ADDED,"cells",O,"parent",L,"index",H,"source",A,"target",I,"absolute",K));}finally{this.model.endUpdate();}}};mxGraph.prototype.removeCells=function(A,B){B=(B!=null)?B:true;if(A==null){A=this.getDeletableCells(this.getSelectionCells());}if(B){A=this.getDeletableCells(this.addAllEdges(A));}this.model.beginUpdate();try{this.cellsRemoved(A);this.fireEvent(new mxEventObject(mxEvent.REMOVE_CELLS,"cells",A,"includeEdges",B));}finally{this.model.endUpdate();}return A;};mxGraph.prototype.cellsRemoved=function(L){if(L!=null&&L.length>0){var E=this.view.scale;var K=this.view.translate;this.model.beginUpdate();try{var I=new Object();for(var J=0;J<L.length;J++){var C=mxCellPath.create(L[J]);I[C]=L[J];}for(var J=0;J<L.length;J++){var G=this.getConnections(L[J]);for(var F=0;F<G.length;F++){var C=mxCellPath.create(G[F]);if(I[C]==null){var H=this.model.getGeometry(G[F]);if(H!=null){var B=this.view.getState(G[F]);if(B!=null){H=H.clone();var A=this.view.getVisibleTerminal(G[F],true)==L[J];var M=B.absolutePoints;var D=(A)?0:M.length-1;H.setTerminalPoint(new mxPoint(M[D].x/E-K.x,M[D].y/E-K.y),A);this.model.setTerminal(G[F],null,A);this.model.setGeometry(G[F],H);}}}}this.model.remove(L[J]);}this.fireEvent(new mxEventObject(mxEvent.CELLS_REMOVED,"cells",L));}finally{this.model.endUpdate();}}};mxGraph.prototype.splitEdge=function(F,C,D,B,A){B=B||0;A=A||0;if(D==null){D=this.cloneCells([F])[0];}var E=this.model.getParent(F);var G=this.model.getTerminal(F,true);this.model.beginUpdate();try{this.cellsMoved(C,B,A,false,false);this.cellsAdded(C,E,this.model.getChildCount(E),null,null,true);this.cellsAdded([D],E,this.model.getChildCount(E),G,C[0],false);this.cellConnected(F,C[0],true);this.fireEvent(new mxEventObject(mxEvent.SPLIT_EDGE,"edge",F,"cells",C,"newEdge",D,"dx",B,"dy",A));}finally{this.model.endUpdate();}return D;};mxGraph.prototype.toggleCells=function(A,B,C){if(B==null){B=this.getSelectionCells();}if(C){B=this.addAllEdges(B);}this.model.beginUpdate();try{this.cellsToggled(B,A);this.fireEvent(new mxEventObject(mxEvent.TOGGLE_CELLS,"show",A,"cells",B,"includeEdges",C));}finally{this.model.endUpdate();}return B;};mxGraph.prototype.cellsToggled=function(B,A){if(B!=null&&B.length>0){this.model.beginUpdate();try{for(var C=0;C<B.length;C++){this.model.setVisible(B[C],A);}}finally{this.model.endUpdate();}}};mxGraph.prototype.foldCells=function(C,B,A){B=(B!=null)?B:false;if(A==null){A=this.getFoldableCells(this.getSelectionCells(),C);}this.stopEditing(false);this.model.beginUpdate();try{this.cellsFolded(A,C,B);this.fireEvent(new mxEventObject(mxEvent.FOLD_CELLS,"collapse",C,"recurse",B,"cells",A));}finally{this.model.endUpdate();}return A;};mxGraph.prototype.cellsFolded=function(A,E,D){if(A!=null&&A.length>0){this.model.beginUpdate();try{for(var C=0;C<A.length;C++){if(E!=this.isCellCollapsed(A[C])){this.model.setCollapsed(A[C],E);this.swapBounds(A[C],E);if(this.isExtendParent(A[C])){this.extendParent(A[C]);}if(D){var B=this.model.getChildren(A[C]);this.foldCells(B,E,D);}}}this.fireEvent(new mxEventObject(mxEvent.CELLS_FOLDED,"cells",A,"collapse",E,"recurse",D));}finally{this.model.endUpdate();}}};mxGraph.prototype.swapBounds=function(A,B){if(A!=null){var C=this.model.getGeometry(A);if(C!=null){C=C.clone();this.updateAlternateBounds(A,C,B);C.swap();this.model.setGeometry(A,C);}}};mxGraph.prototype.updateAlternateBounds=function(A,H,G){if(A!=null&&H!=null){if(H.alternateBounds==null){var E=H;if(this.collapseToPreferredSize){var C=this.getPreferredSizeForCell(A);if(C!=null){E=C;var F=this.view.getState(A);var D=(F!=null)?F.style:this.getCellStyle(A);var B=mxUtils.getValue(D,mxConstants.STYLE_STARTSIZE);if(B>0){E.height=Math.max(E.height,B);}}}H.alternateBounds=new mxRectangle(H.x,H.y,E.width,E.height);}else{H.alternateBounds.x=H.x;H.alternateBounds.y=H.y;}}};mxGraph.prototype.addAllEdges=function(A){var B=A.slice();B=B.concat(this.getAllEdges(A));return B;};mxGraph.prototype.getAllEdges=function(C){var A=[];if(C!=null){for(var E=0;E<C.length;E++){var F=this.model.getEdgeCount(C[E]);for(var B=0;B<F;B++){A.push(this.model.getEdgeAt(C[E],B));}var D=this.model.getChildren(C[E]);A=A.concat(this.getAllEdges(D));}}return A;};mxGraph.prototype.updateCellSize=function(B,A){A=(A!=null)?A:false;this.model.beginUpdate();try{this.cellSizeUpdated(B,A);this.fireEvent(new mxEventObject(mxEvent.UPDATE_CELL_SIZE,"cell",B,"ignoreChildren",A));}finally{this.model.endUpdate();}return B;};mxGraph.prototype.cellSizeUpdated=function(K,F){if(K!=null){this.model.beginUpdate();try{var M=this.getPreferredSizeForCell(K);var I=this.model.getGeometry(K);if(M!=null&&I!=null){var H=this.isCellCollapsed(K);I=I.clone();if(this.isSwimlane(K)){var B=this.view.getState(K);var C=(B!=null)?B.style:this.getCellStyle(K);var E=this.model.getStyle(K);if(E==null){E="";}if(mxUtils.getValue(C,mxConstants.STYLE_HORIZONTAL,true)){E=mxUtils.setStyle(E,mxConstants.STYLE_STARTSIZE,M.height+8);if(H){I.height=M.height+8;}I.width=M.width;}else{E=mxUtils.setStyle(E,mxConstants.STYLE_STARTSIZE,M.width+8);if(H){I.width=M.width+8;}I.height=M.height;}this.model.setStyle(K,E);}else{I.width=M.width;I.height=M.height;}if(!F&&!H){var A=this.view.getBounds(this.model.getChildren(K));if(A!=null){var J=this.view.translate;var G=this.view.scale;var D=(A.x+A.width)/G-I.x-J.x;var L=(A.y+A.height)/G-I.y-J.y;I.width=Math.max(I.width,D);I.height=Math.max(I.height,L);}}this.cellsResized([K],[I]);}}finally{this.model.endUpdate();}}};mxGraph.prototype.getPreferredSizeForCell=function(H){var N=null;if(H!=null){var A=this.view.getState(H);var B=(A!=null)?A.style:this.getCellStyle(H);if(B!=null&&!this.model.isEdge(H)){var L=B[mxConstants.STYLE_FONTSIZE]||mxConstants.DEFAULT_FONTSIZE;var M=0;var J=0;if(this.getImage(A)!=null||B[mxConstants.STYLE_IMAGE]!=null){if(B[mxConstants.STYLE_SHAPE]==mxConstants.SHAPE_LABEL){if(B[mxConstants.STYLE_VERTICAL_ALIGN]==mxConstants.ALIGN_MIDDLE){M+=B[mxConstants.STYLE_IMAGE_WIDTH]||mxLabel.prototype.imageSize;}if(B[mxConstants.STYLE_ALIGN]!=mxConstants.ALIGN_CENTER){J+=B[mxConstants.STYLE_IMAGE_HEIGHT]||mxLabel.prototype.imageSize;}}}M+=2*(B[mxConstants.STYLE_SPACING]||0);M+=B[mxConstants.STYLE_SPACING_LEFT]||0;M+=B[mxConstants.STYLE_SPACING_RIGHT]||0;J+=2*(B[mxConstants.STYLE_SPACING]||0);J+=B[mxConstants.STYLE_SPACING_TOP]||0;J+=B[mxConstants.STYLE_SPACING_BOTTOM]||0;var E=this.getFoldingImage(A);if(E!=null){M+=E.width+8;}var G=this.getLabel(H);if(G!=null&&G.length>0){if(!this.isHtmlLabel(H)){G=G.replace(/\n/g,"<br>");}var K=mxUtils.getSizeForString(G,L,B[mxConstants.STYLE_FONTFAMILY]);var C=K.width+M;var I=K.height+J;if(!mxUtils.getValue(B,mxConstants.STYLE_HORIZONTAL,true)){var F=I;I=C;C=F;}if(this.gridEnabled){C=this.snap(C+this.gridSize/2);I=this.snap(I+this.gridSize/2);}N=new mxRectangle(0,0,C,I);}else{var D=4*this.gridSize;N=new mxRectangle(0,0,D,D);}}}return N;};mxGraph.prototype.resizeCell=function(A,B){return this.resizeCells([A],[B])[0];};mxGraph.prototype.resizeCells=function(A,B){this.model.beginUpdate();try{this.cellsResized(A,B);this.fireEvent(new mxEventObject(mxEvent.RESIZE_CELLS,"cells",A,"bounds",B));}finally{this.model.endUpdate();}return A;};mxGraph.prototype.cellsResized=function(A,D){if(A!=null&&D!=null&&A.length==D.length){this.model.beginUpdate();try{for(var C=0;C<A.length;C++){var B=D[C];var E=this.model.getGeometry(A[C]);if(E!=null&&(E.x!=B.x||E.y!=B.y||E.width!=B.width||E.height!=B.height)){E=E.clone();if(E.relative){var F=E.offset;if(F!=null){F.x+=B.x-E.x;F.y+=B.y-E.y;}}else{E.x=B.x;E.y=B.y;}E.width=B.width;E.height=B.height;if(!E.relative&&this.model.isVertex(A[C])&&!this.isAllowNegativeCoordinates()){E.x=Math.max(0,E.x);E.y=Math.max(0,E.y);}this.model.setGeometry(A[C],E);if(this.isExtendParent(A[C])){this.extendParent(A[C]);}}}if(this.resetEdgesOnResize){this.resetEdges(A);}this.fireEvent(new mxEventObject(mxEvent.CELLS_RESIZED,"cells",A,"bounds",D));}finally{this.model.endUpdate();}}};mxGraph.prototype.extendParent=function(A){if(A!=null){var B=this.model.getParent(A);var D=this.model.getGeometry(B);if(B!=null&&D!=null&&!this.isCellCollapsed(B)){var C=this.model.getGeometry(A);if(C!=null&&(D.width<C.x+C.width||D.height<C.y+C.height)){D=D.clone();D.width=Math.max(D.width,C.x+C.width);D.height=Math.max(D.height,C.y+C.height);this.cellsResized([B],[D]);}}}};mxGraph.prototype.importCells=function(D,C,B,E,A){return this.moveCells(D,C,B,true,E,A);};mxGraph.prototype.moveCells=function(E,C,B,G,F,A){if(E!=null&&(C!=0||B!=0||G||F!=null)){this.model.beginUpdate();try{if(G){E=this.cloneCells(E,this.isCloneInvalidEdges());if(F==null){F=this.getDefaultParent();}}this.cellsMoved(E,C,B,!G&&this.isDisconnectOnMove()&&this.isAllowDanglingEdges(),F==null);if(F!=null){var D=this.model.getChildCount(F);this.cellsAdded(E,F,D,null,null,true);}this.fireEvent(new mxEventObject(mxEvent.MOVE_CELLS,"cells",E,"dx",C,"dy",B,"clone",G,"target",F,"event",A));}finally{this.model.endUpdate();}}return E;};mxGraph.prototype.cellsMoved=function(D,C,A,B,F){if(D!=null&&(C!=0||A!=0)){this.model.beginUpdate();try{if(B){this.disconnectGraph(D);}for(var E=0;E<D.length;E++){this.translateCell(D[E],C,A);if(F){this.constrainChild(D[E]);}}if(this.resetEdgesOnMove){this.resetEdges(D);}this.fireEvent(new mxEventObject(mxEvent.CELLS_MOVED,"cells",D,"dx",A,"dy",A,"disconnect",B));}finally{this.model.endUpdate();}}};mxGraph.prototype.translateCell=function(A,C,B){var D=this.model.getGeometry(A);if(D!=null){D=D.clone();D.translate(C,B);if(!D.relative&&this.model.isVertex(A)&&!this.isAllowNegativeCoordinates()){D.x=Math.max(0,D.x);D.y=Math.max(0,D.y);}if(D.relative&&!this.model.isEdge(A)){if(D.offset==null){D.offset=new mxPoint(C,B);}else{D.offset.X+=C;D.offset.Y+=B;}}this.model.setGeometry(A,D);}};mxGraph.prototype.getCellContainmentArea=function(B){if(B!=null&&!this.model.isEdge(B)){var F=this.model.getParent(B);if(F==this.getDefaultParent()||F==this.getCurrentRoot()){return this.getMaximumGraphBounds();}else{if(F!=null&&F!=this.getDefaultParent()){var G=this.model.getGeometry(F);if(G!=null){var A=0;var H=0;var C=G.width;var E=G.height;if(this.isSwimlane(F)){var D=this.getStartSize(F);A=D.width;C-=D.width;H=D.height;E-=D.height;}return new mxRectangle(A,H,C,E);}}}}return null;};mxGraph.prototype.getMaximumGraphBounds=function(){return this.maximumGraphBounds;};mxGraph.prototype.constrainChild=function(A){if(A!=null){var D=this.model.getGeometry(A);var C=(this.isConstrainChild(A))?this.getCellContainmentArea(A):this.getMaximumGraphBounds();if(D!=null&&C!=null){if(!D.relative&&(D.x<C.x||D.y<C.y||C.width<D.x+D.width||C.height<D.y+D.height)){var B=this.getOverlap(A);if(C.width>0){D.x=Math.min(D.x,C.x+C.width-(1-B)*D.width);}if(C.height>0){D.y=Math.min(D.y,C.y+C.height-(1-B)*D.height);}D.x=Math.max(D.x,C.x-D.width*B);D.y=Math.max(D.y,C.y-D.height*B);}}}};mxGraph.prototype.resetEdges=function(J){if(J!=null){var E=new Object();for(var F=0;F<J.length;F++){var B=mxCellPath.create(J[F]);E[B]=J[F];}this.model.beginUpdate();try{for(var F=0;F<J.length;F++){var D=this.model.getEdges(J[F]);if(D!=null){for(var C=0;C<D.length;C++){var A=this.view.getVisibleTerminal(D[C],true);var I=mxCellPath.create(A);var G=this.view.getVisibleTerminal(D[C],false);var H=mxCellPath.create(G);if(E[I]==null||E[H]==null){this.resetEdge(D[C]);}}}this.resetEdges(this.model.getChildren(J[F]));}}finally{this.model.endUpdate();}}};mxGraph.prototype.resetEdge=function(A){var B=this.model.getGeometry(A);if(B!=null&&B.points!=null&&B.points.length>0){B=B.clone();B.points=[];this.model.setGeometry(A,B);}return A;};mxGraph.prototype.getAllConnectionConstraints=function(A,B){return null;};mxGraph.prototype.getConnectionConstraint=function(E,D,F){var B=null;var A=E.style[(F)?mxConstants.STYLE_EXIT_X:mxConstants.STYLE_ENTRY_X];if(A!=null){var G=E.style[(F)?mxConstants.STYLE_EXIT_Y:mxConstants.STYLE_ENTRY_Y];if(G!=null){B=new mxPoint(parseFloat(A),parseFloat(G));}}var C=false;if(B!=null){C=mxUtils.getValue(E.style,(F)?mxConstants.STYLE_EXIT_PERIMETER:mxConstants.STYLE_ENTRY_PERIMETER,true);}return new mxConnectionConstraint(B,C);};mxGraph.prototype.setConnectionConstraint=function(B,A,C,D){if(D!=null){this.model.beginUpdate();try{if(D==null||D.point==null){this.setCellStyles((C)?mxConstants.STYLE_EXIT_X:mxConstants.STYLE_ENTRY_X,null,[B]);this.setCellStyles((C)?mxConstants.STYLE_EXIT_Y:mxConstants.STYLE_ENTRY_Y,null,[B]);this.setCellStyles((C)?mxConstants.STYLE_EXIT_PERIMETER:mxConstants.STYLE_ENTRY_PERIMETER,null,[B]);}else{if(D.point!=null){this.setCellStyles((C)?mxConstants.STYLE_EXIT_X:mxConstants.STYLE_ENTRY_X,D.point.x,[B]);this.setCellStyles((C)?mxConstants.STYLE_EXIT_Y:mxConstants.STYLE_ENTRY_Y,D.point.y,[B]);if(!D.perimeter){this.setCellStyles((C)?mxConstants.STYLE_EXIT_PERIMETER:mxConstants.STYLE_ENTRY_PERIMETER,"0",[B]);}else{this.setCellStyles((C)?mxConstants.STYLE_EXIT_PERIMETER:mxConstants.STYLE_ENTRY_PERIMETER,null,[B]);}}}}finally{this.model.endUpdate();}}};mxGraph.prototype.getConnectionPoint=function(B,C){var A=null;if(B!=null&&C.point!=null){A=new mxPoint(B.x+C.point.x*B.width,B.y+C.point.y*B.height);}if(A!=null&&C.perimeter){A=this.view.getPerimeterPoint(B,A,false);}return A;};mxGraph.prototype.connectCell=function(C,A,D,E){this.model.beginUpdate();try{var B=this.model.getTerminal(C,D);this.cellConnected(C,A,D,E);this.fireEvent(new mxEventObject(mxEvent.CONNECT_CELL,"edge",C,"terminal",A,"source",D,"previous",B));}finally{this.model.endUpdate();}return C;};mxGraph.prototype.cellConnected=function(D,B,E,F){if(D!=null){this.model.beginUpdate();try{var C=this.model.getTerminal(D,E);this.setConnectionConstraint(D,B,E,F);var G=null;if(this.isPort(B)){G=B.getId();B=this.getTerminalForPort(B,E);}var A=(E)?mxConstants.STYLE_SOURCE_PORT:mxConstants.STYLE_TARGET_PORT;this.setCellStyles(A,G,[D]);this.model.setTerminal(D,B,E);if(this.resetEdgesOnConnect){this.resetEdge(D);}this.fireEvent(new mxEventObject(mxEvent.CELL_CONNECTED,"edge",D,"terminal",B,"source",E,"previous",C));}finally{this.model.endUpdate();}}};mxGraph.prototype.disconnectGraph=function(O){if(O!=null){this.model.beginUpdate();try{var G=this.view.scale;var L=this.view.translate;var I=new Object();for(var K=0;K<O.length;K++){var E=mxCellPath.create(O[K]);I[E]=O[K];}for(var K=0;K<O.length;K++){if(this.model.isEdge(O[K])){var J=this.model.getGeometry(O[K]);if(J!=null){var D=this.view.getState(O[K]);var H=this.view.getState(this.model.getParent(O[K]));if(D!=null&&H!=null){J=J.clone();var Q=-H.origin.x;var N=-H.origin.y;var P=D.absolutePoints;var B=this.model.getTerminal(O[K],true);if(B!=null&&this.isCellDisconnectable(O[K],B,true)){var A=mxCellPath.create(B);while(B!=null&&I[A]==null){B=this.model.getParent(B);A=mxCellPath.create(B);}if(B==null){J.setTerminalPoint(new mxPoint(P[0].x/G-L.x+Q,P[0].y/G-L.y+N),true);this.model.setTerminal(O[K],null,true);}}var C=this.model.getTerminal(O[K],false);if(C!=null&&this.isCellDisconnectable(O[K],C,false)){var M=mxCellPath.create(C);while(C!=null&&I[M]==null){C=this.model.getParent(C);M=mxCellPath.create(C);}if(C==null){var F=P.length-1;J.setTerminalPoint(new mxPoint(P[F].x/G-L.x+Q,P[F].y/G-L.y+N),false);this.model.setTerminal(O[K],null,false);}}this.model.setGeometry(O[K],J);}}}}}finally{this.model.endUpdate();}}};mxGraph.prototype.getCurrentRoot=function(){return this.view.currentRoot;};mxGraph.prototype.getTranslateForRoot=function(A){return null;};mxGraph.prototype.isPort=function(A){return false;};mxGraph.prototype.getTerminalForPort=function(A,B){return this.model.getParent(A);};mxGraph.prototype.getChildOffsetForCell=function(A){return null;};mxGraph.prototype.enterGroup=function(A){A=A||this.getSelectionCell();if(A!=null&&this.isValidRoot(A)){this.view.setCurrentRoot(A);this.clearSelection();}};mxGraph.prototype.exitGroup=function(){var A=this.model.getRoot();var D=this.getCurrentRoot();if(D!=null){var B=this.model.getParent(D);while(B!=A&&!this.isValidRoot(B)&&this.model.getParent(B)!=A){B=this.model.getParent(B);}if(B==A||this.model.getParent(B)==A){this.view.setCurrentRoot(null);}else{this.view.setCurrentRoot(B);}var C=this.view.getState(D);if(C!=null){this.setSelectionCell(D);}}};mxGraph.prototype.home=function(){var B=this.getCurrentRoot();if(B!=null){this.view.setCurrentRoot(null);var A=this.view.getState(B);if(A!=null){this.setSelectionCell(B);}}};mxGraph.prototype.isValidRoot=function(A){return(A!=null);};mxGraph.prototype.getGraphBounds=function(){return this.view.getGraphBounds();};mxGraph.prototype.getCellBounds=function(B,H,G){var D=[B];if(H){D=D.concat(this.model.getEdges(B));}var A=this.view.getBounds(D);if(G){var C=this.model.getChildCount(B);for(var F=0;F<C;F++){var E=this.getCellBounds(this.model.getChildAt(B,F),H,true);if(A!=null){A.add(E);}else{A=E;}}}};mxGraph.prototype.getBoundingBoxFromGeometry=function(B){var A=null;if(B!=null){for(var C=0;C<B.length;C++){if(this.model.isVertex(B[C])){var D=this.getCellGeometry(B[C]);if(A==null){A=new mxRectangle(D.x,D.y,D.width,D.height);}else{A.add(D);}}}}return A;};mxGraph.prototype.refresh=function(A){this.view.clear(A,A==null);this.view.validate();this.sizeDidChange();this.fireEvent(new mxEventObject(mxEvent.REFRESH));};mxGraph.prototype.snap=function(A){if(this.gridEnabled){A=Math.round(A/this.gridSize)*this.gridSize;}return A;};mxGraph.prototype.panGraph=function(B,A){var E=mxUtils.getCurrentStyle(this.container);if(this.useScrollbarsForPanning&&mxUtils.hasScrollbars(this.container)){this.container.scrollLeft=-B;this.container.scrollTop=-A;}else{var C=this.view.getCanvas();if(this.dialect==mxConstants.DIALECT_SVG){C.setAttribute("transform","translate("+B+","+A+")");if(B==0&&A==0){if(this.shiftPreview!=null){this.shiftPreview.parentNode.removeChild(this.shiftPreview);this.shiftPreview=null;var G=this.container.firstChild;while(G!=null){if(G!=C.parentNode){if(G.style!=null){G.style.visibility="visible";}}G=G.nextSibling;}}}else{if(this.shiftPreview==null){this.shiftPreview=document.createElement("div");var D=[];var G=this.container.firstChild;while(G!=null){if(G!=C.parentNode){D.push(mxUtils.getInnerHtml(G));if(G.style!=null){G.style.visibility="hidden";}}G=G.nextSibling;}this.shiftPreview.innerHTML=D.join("");this.shiftPreview.style.position="absolute";this.shiftPreview.style.overflow="visible";var F=mxUtils.getOffset(this.container);this.shiftPreview.style.left=F.x+"px";this.shiftPreview.style.top=F.y+"px";this.container.appendChild(this.shiftPreview);}this.shiftPreview.style.left=B+"px";this.shiftPreview.style.top=A+"px";}}else{if(this.dialect==mxConstants.DIALECT_VML){C.setAttribute("coordorigin",(-B)+","+(-A));}else{if(B==0&&A==0){if(this.shiftPreview!=null){this.shiftPreview.parentNode.removeChild(this.shiftPreview);C.style.visibility="visible";this.shiftPreview=null;}}else{if(this.shiftPreview==null){this.shiftPreview=this.view.getDrawPane().cloneNode(false);var D=mxUtils.getInnerHtml(this.view.getBackgroundPane());D+=mxUtils.getInnerHtml(this.view.getDrawPane());this.shiftPreview.innerHTML=D;var F=mxUtils.getOffset(this.container);this.shiftPreview.style.position="absolute";this.shiftPreview.style.left=F.x+"px";this.shiftPreview.style.top=F.y+"px";C.style.visibility="hidden";this.container.appendChild(this.shiftPreview);}this.shiftPreview.style.left=B+"px";this.shiftPreview.style.top=A+"px";}}}}};mxGraph.prototype.zoomIn=function(){this.zoom(this.zoomFactor);};mxGraph.prototype.zoomOut=function(){this.zoom(1/this.zoomFactor);};mxGraph.prototype.zoomActual=function(){this.view.translate.x=0;this.view.translate.y=0;this.view.setScale(1);};mxGraph.prototype.zoom=function(C){var G=this.view.scale*C;var F=this.view.getState(this.getSelectionCell());if(this.keepSelectionVisibleOnZoom&&F!=null){var D=new mxRectangle(F.x*C,F.y*C,F.width*C,F.height*C);this.view.scale=G;if(!this.scrollRectToVisible(D)){this.view.revalidate();this.view.setScale(G);}}else{if(this.centerZoom&&!mxUtils.hasScrollbars(this.container)){var B=this.container.offsetWidth;var A=this.container.offsetHeight;if(C>1){var E=(C-1)/(G*2);B*=-E;A*=-E;}else{var E=(1/C-1)/(this.view.scale*2);B*=E;A*=E;}this.view.scaleAndTranslate(G,this.view.translate.x+B,this.view.translate.y+A);}else{this.view.setScale(G);}}};mxGraph.prototype.fit=function(C,B){if(this.container!=null){C=(C!=null)?C:0;B=(B!=null)?B:false;var E=this.container.offsetWidth;var G=this.container.offsetHeight;var A=this.view.getGraphBounds();if(B&&A.x!=null&&A.y!=null){A.width+=A.x;A.height+=A.y;A.x=0;A.y=0;}var J=this.view.scale;var D=(A.width/J)+1;var F=(A.height/J)+1;if(this.backgroundImage!=null){D=Math.max(D,this.backgroundImage.width-A.x/J);F=Math.max(F,this.backgroundImage.height-A.y/J);}var H=(B)?C:2*C;var I=Math.min(E/(D+H),G/(F+H));if(I>0.1&&I<8){if(!B){this.view.translate.x=(A.x!=null)?this.view.translate.x-A.x/J+C:C;this.view.translate.y=(A.y!=null)?this.view.translate.y-A.y/J+C:C;}this.view.setScale(I);}}return this.view.scale;};mxGraph.prototype.scrollCellToVisible=function(C,B){var A=-this.view.translate.x;var H=-this.view.translate.y;var G=this.view.getState(C);if(G!=null){var F=new mxRectangle(A+G.x,H+G.y,G.width,G.height);if(B&&this.container!=null){var D=this.container.clientWidth;var E=this.container.clientHeight;F.x=F.getCenterX()-D/2;F.width=D;F.y=F.getCenterY()-E/2;F.height=E;}if(this.scrollRectToVisible(F)){this.view.setTranslate(this.view.translate.x,this.view.translate.y);}}};mxGraph.prototype.scrollRectToVisible=function(I){if(I!=null){var L=false;var K=this.container.offsetWidth;var C=this.container.offsetHeight;var B=Math.min(K,I.width);var A=Math.min(C,I.height);if(mxUtils.hasScrollbars(this.container)){var F=this.container;var O=F.scrollLeft-I.x;var H=Math.max(O-F.scrollLeft,0);if(O>0){F.scrollLeft-=O+2;}else{O=I.x+B-F.scrollLeft-F.clientWidth;if(O>0){F.scrollLeft+=O+2;}}var M=F.scrollTop-I.y;var E=Math.max(0,M-F.scrollTop);if(M>0){F.scrollTop-=M+2;}else{M=I.y+A-F.scrollTop-F.clientHeight;if(M>0){F.scrollTop+=M+2;}}var D=this.view.translate;if(!this.useScrollbarsForPanning&&(H!=0||E!=0)){this.view.setTranslate(H,E);}}else{var J=-this.view.translate.x;var G=-this.view.translate.y;var N=this.view.scale;if(I.x+B>J+K){this.view.translate.x-=(I.x+B-K-J)/N;L=true;}if(I.y+A>G+C){this.view.translate.y-=(I.y+A-C-G)/N;L=true;}if(I.x<J){this.view.translate.x+=(J-I.x)/N;L=true;}if(I.y<G){this.view.translate.y+=(G-I.y)/N;L=true;}if(L){this.view.refresh();}}}return L;};mxGraph.prototype.getCellGeometry=function(A){return this.model.getGeometry(A);};mxGraph.prototype.isCellVisible=function(A){return this.model.isVisible(A);};mxGraph.prototype.isCellCollapsed=function(A){return this.model.isCollapsed(A);};mxGraph.prototype.isCellConnectable=function(A){return this.model.isConnectable(A);};mxGraph.prototype.isOrthogonal=function(B){var C=B.style[mxConstants.STYLE_ORTHOGONAL];if(C!=null){return C;}var A=this.view.getEdgeStyle(B);return A==mxEdgeStyle.ElbowConnector||A==mxEdgeStyle.SideToSide||A==mxEdgeStyle.TopToBottom||A==mxEdgeStyle.EntityRelation;};mxGraph.prototype.isLoop=function(B){var C=this.view.getVisibleTerminal(B.cell,true);var A=this.view.getVisibleTerminal(B.cell,false);return(C!=null&&C==A);};mxGraph.prototype.isCloneEvent=function(A){return mxEvent.isControlDown(A);};mxGraph.prototype.isToggleEvent=function(A){return mxEvent.isControlDown(A);};mxGraph.prototype.isGridEnabledEvent=function(A){return A!=null&&!mxEvent.isAltDown(A);};mxGraph.prototype.isConstrainedEvent=function(A){return mxEvent.isShiftDown(A);};mxGraph.prototype.isForceMarqueeEvent=function(A){return mxEvent.isAltDown(A)||mxEvent.isMetaDown(A);};mxGraph.prototype.validationAlert=function(A){mxUtils.alert(A);};mxGraph.prototype.isEdgeValid=function(A,B,C){return this.getEdgeValidationError(A,B,C)==null;};mxGraph.prototype.getEdgeValidationError=function(B,A,G){if(B!=null&&this.model.getTerminal(B,true)==null&&this.model.getTerminal(B,false)==null){return null;}if(!this.allowLoops&&A==G&&A!=null){return"";}if(!this.isValidConnection(A,G)){return"";}if(A!=null&&G!=null){var H="";if(!this.multigraph){var D=this.model.getEdgesBetween(A,G,true);if(D.length>1||(D.length==1&&D[0]!=B)){H+=(mxResources.get(this.alreadyConnectedResource)||this.alreadyConnectedResource)+"\n";}}var I=this.model.getDirectedEdgeCount(A,true,B);var E=this.model.getDirectedEdgeCount(G,false,B);for(var F=0;F<this.multiplicities.length;F++){var C=this.multiplicities[F].check(this,B,A,G,I,E);if(C!=null){H+=C;}}var C=this.validateEdge(B,A,G);if(C!=null){H+=C;}return(H.length>0)?H:null;}return(this.allowDanglingEdges)?null:"";};mxGraph.prototype.validateEdge=function(A,B,C){return null;};mxGraph.prototype.validateGraph=function(J,A){J=(J!=null)?J:this.model.getRoot();A=(A!=null)?A:new Object();var K=true;var C=this.model.getChildCount(J);for(var D=0;D<C;D++){var E=this.model.getChildAt(J,D);var L=A;if(this.isValidRoot(E)){L=new Object();}var H=this.validateGraph(E,L);if(H!=null){var F=H.replace(/\n/g,"<br>");var G=F.length;this.setCellWarning(E,F.substring(0,Math.max(0,G-4)));}else{this.setCellWarning(E,null);}K=K&&H==null;}var I="";if(this.isCellCollapsed(J)&&!K){I+=(mxResources.get(this.containsValidationErrorsResource)||this.containsValidationErrorsResource)+"\n";}if(this.model.isEdge(J)){I+=this.getEdgeValidationError(J,this.model.getTerminal(J,true),this.model.getTerminal(J,false))||"";}else{I+=this.getCellValidationError(J)||"";}var B=this.validateCell(J,A);if(B!=null){I+=B;}if(this.model.getParent(J)==null){this.view.validate();}return(I.length>0||!K)?I:null;};mxGraph.prototype.getCellValidationError=function(A){var B=this.model.getDirectedEdgeCount(A,true);var C=this.model.getDirectedEdgeCount(A,false);var F=this.model.getValue(A);var D="";for(var E=0;E<this.multiplicities.length;E++){var G=this.multiplicities[E];if(G.source&&mxUtils.isNode(F,G.type,G.attr,G.value)&&((G.max==0&&B>0)||(G.min==1&&B==0)||(G.max==1&&B>1))){D+=G.countError+"\n";}else{if(!G.source&&mxUtils.isNode(F,G.type,G.attr,G.value)&&((G.max==0&&C>0)||(G.min==1&&C==0)||(G.max==1&&C>1))){D+=G.countError+"\n";}}}return(D.length>0)?D:null;};mxGraph.prototype.validateCell=function(A,B){return null;};mxGraph.prototype.getBackgroundImage=function(){return this.backgroundImage;};mxGraph.prototype.setBackgroundImage=function(A){this.backgroundImage=A;};mxGraph.prototype.getFoldingImage=function(B){if(B!=null){var A=this.isCellCollapsed(B.cell);if(this.isCellFoldable(B.cell,!A)){return(A)?this.collapsedImage:this.expandedImage;}}return null;};mxGraph.prototype.convertValueToString=function(A){var B=this.model.getValue(A);if(B!=null){if(mxUtils.isNode(B)){return B.nodeName;}else{if(typeof (B.toString)=="function"){return B.toString();}}}return"";};mxGraph.prototype.getLabel=function(B){var A="";if(B!=null){var D=this.view.getState(B);var C=(D!=null)?D.style:this.getCellStyle(B);if(this.labelsVisible&&!mxUtils.getValue(C,mxConstants.STYLE_NOLABEL,false)){A=this.convertValueToString(B);}}return A;};mxGraph.prototype.isHtmlLabel=function(A){return this.isHtmlLabels();};mxGraph.prototype.isHtmlLabels=function(){return this.htmlLabels;};mxGraph.prototype.setHtmlLabels=function(A){this.htmlLabels=A;};mxGraph.prototype.isWrapping=function(A){var C=this.view.getState(A);var B=(C!=null)?C.style:this.getCellStyle(A);return(B!=null)?B[mxConstants.STYLE_WHITE_SPACE]=="wrap":false;};mxGraph.prototype.isLabelClipped=function(A){var C=this.view.getState(A);var B=(C!=null)?C.style:this.getCellStyle(A);return(B!=null)?B[mxConstants.STYLE_OVERFLOW]=="hidden":false;};mxGraph.prototype.getTooltip=function(F,D,A,G){var E=null;if(F!=null){if(F.control!=null&&(D==F.control.node||D.parentNode==F.control.node)){E=this.collapseExpandResource;E=mxResources.get(E)||E;}if(E==null&&F.overlays!=null){for(var B=0;B<F.overlays.length;B++){if(D==F.overlays[B].node||D.parentNode==F.overlays[B].node){E=this.getCellOverlays(F.cell)[B].toString();break;}}}if(E==null){var C=this.selectionCellsHandler.getHandler(F.cell);if(C!=null&&typeof (C.getTooltipForNode)=="function"){E=C.getTooltipForNode(D);}}if(E==null){E=this.getTooltipForCell(F.cell);}}return E;};mxGraph.prototype.getTooltipForCell=function(A){var B=null;if(A.getTooltip!=null){B=A.getTooltip();}else{B=this.convertValueToString(A);}return B;};mxGraph.prototype.getCursorForCell=function(A){return null;};mxGraph.prototype.getStartSize=function(E){var A=new mxRectangle();var D=this.view.getState(E);var C=(D!=null)?D.style:this.getCellStyle(E);if(C!=null){var B=parseInt(mxUtils.getValue(C,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_STARTSIZE));if(mxUtils.getValue(C,mxConstants.STYLE_HORIZONTAL,true)){A.height=B;}else{A.width=B;}}return A;};mxGraph.prototype.getImage=function(A){return(A!=null&&A.style!=null)?A.style[mxConstants.STYLE_IMAGE]:null;};mxGraph.prototype.getVerticalAlign=function(A){return(A!=null&&A.style!=null)?(A.style[mxConstants.STYLE_VERTICAL_ALIGN]||mxConstants.ALIGN_MIDDLE):null;};mxGraph.prototype.getIndicatorColor=function(A){return(A!=null&&A.style!=null)?A.style[mxConstants.STYLE_INDICATOR_COLOR]:null;};mxGraph.prototype.getIndicatorGradientColor=function(A){return(A!=null&&A.style!=null)?A.style[mxConstants.STYLE_INDICATOR_GRADIENTCOLOR]:null;};mxGraph.prototype.getIndicatorShape=function(A){return(A!=null&&A.style!=null)?A.style[mxConstants.STYLE_INDICATOR_SHAPE]:null;};mxGraph.prototype.getIndicatorImage=function(A){return(A!=null&&A.style!=null)?A.style[mxConstants.STYLE_INDICATOR_IMAGE]:null;};mxGraph.prototype.getBorder=function(){return this.border;};mxGraph.prototype.setBorder=function(A){this.border=A;};mxGraph.prototype.isSwimlane=function(A){if(A!=null){if(this.model.getParent(A)!=this.model.getRoot()){var C=this.view.getState(A);var B=(C!=null)?C.style:this.getCellStyle(A);if(B!=null&&!this.model.isEdge(A)){return B[mxConstants.STYLE_SHAPE]==mxConstants.SHAPE_SWIMLANE;}}}return false;};mxGraph.prototype.isResizeContainer=function(){return this.resizeContainer;};mxGraph.prototype.setResizeContainer=function(A){this.resizeContainer=A;};mxGraph.prototype.isEnabled=function(){return this.enabled;};mxGraph.prototype.setEnabled=function(A){this.enabled=A;};mxGraph.prototype.isEscapeEnabled=function(){return this.escapeEnabled;};mxGraph.prototype.setEscapeEnabled=function(A){this.escapeEnabled=A;};mxGraph.prototype.isInvokesStopCellEditing=function(){return this.invokesStopCellEditing;};mxGraph.prototype.setInvokesStopCellEditing=function(A){this.invokesStopCellEditing=A;};mxGraph.prototype.isEnterStopsCellEditing=function(){return this.enterStopsCellEditing;};mxGraph.prototype.setEnterStopsCellEditing=function(A){this.enterStopsCellEditing=A;};mxGraph.prototype.isCellLocked=function(A){var B=this.model.getGeometry(A);return this.isCellsLocked()||(B!=null&&this.model.isVertex(A)&&B.relative);};mxGraph.prototype.isCellsLocked=function(){return this.cellsLocked;};mxGraph.prototype.setCellsLocked=function(A){this.cellsLocked=A;};mxGraph.prototype.getCloneableCells=function(A){return this.model.filterCells(A,mxUtils.bind(this,function(B){return this.isCellCloneable(B);}));};mxGraph.prototype.isCellCloneable=function(A){return this.isCellsCloneable();};mxGraph.prototype.isCellsCloneable=function(){return this.cellsCloneable;};mxGraph.prototype.setCellsCloneable=function(A){this.cellsCloneable=A;};mxGraph.prototype.getExportableCells=function(A){return this.model.filterCells(A,mxUtils.bind(this,function(B){return this.canExportCell(B);}));};mxGraph.prototype.canExportCell=function(A){return this.exportEnabled;};mxGraph.prototype.getImportableCells=function(A){return this.model.filterCells(A,mxUtils.bind(this,function(B){return this.canImportCell(B);}));};mxGraph.prototype.canImportCell=function(A){return this.importEnabled;};mxGraph.prototype.isCellSelectable=function(A){return this.isCellsSelectable();};mxGraph.prototype.isCellsSelectable=function(){return this.cellsSelectable;};mxGraph.prototype.setCellsSelectable=function(A){this.cellsSelectable=A;};mxGraph.prototype.getDeletableCells=function(A){return this.model.filterCells(A,mxUtils.bind(this,function(B){return this.isCellDeletable(B);}));};mxGraph.prototype.isCellDeletable=function(A){return this.isCellsDeletable();};mxGraph.prototype.isCellsDeletable=function(){return this.cellsDeletable;};mxGraph.prototype.setCellsDeletable=function(A){this.cellsDeletable=A;};mxGraph.prototype.isLabelMovable=function(A){return !this.isCellLocked(A)&&((this.model.isEdge(A)&&this.edgeLabelsMovable)||(this.model.isVertex(A)&&this.vertexLabelsMovable));};mxGraph.prototype.getMovableCells=function(A){return this.model.filterCells(A,mxUtils.bind(this,function(B){return this.isCellMovable(B);}));};mxGraph.prototype.isCellMovable=function(A){return this.isCellsMovable()&&!this.isCellLocked(A);};mxGraph.prototype.isCellsMovable=function(){return this.cellsMovable;};mxGraph.prototype.setCellsMovable=function(A){this.cellsMovable=A;};mxGraph.prototype.isGridEnabled=function(){return this.gridEnabled;};mxGraph.prototype.setGridEnabled=function(A){this.gridEnabled=A;};mxGraph.prototype.getGridSize=function(){return this.gridSize;};mxGraph.prototype.setGridSize=function(A){this.gridSize=A;};mxGraph.prototype.getTolerance=function(){return this.tolerance;};mxGraph.prototype.setTolerance=function(A){this.tolerance=A;};mxGraph.prototype.isVertexLabelsMovable=function(){return this.vertexLabelsMovable;};mxGraph.prototype.setVertexLabelsMovable=function(A){this.vertexLabelsMovable=A;};mxGraph.prototype.isEdgeLabelsMovable=function(){return this.edgeLabelsMovable;};mxGraph.prototype.setEdgeLabelsMovable=function(A){this.edgeLabelsMovable=A;};mxGraph.prototype.isSwimlaneNesting=function(){return this.swimlaneNesting;};mxGraph.prototype.setSwimlaneNesting=function(A){this.swimlaneNesting=A;};mxGraph.prototype.isSwimlaneSelectionEnabled=function(){return this.swimlaneSelectionEnabled;};mxGraph.prototype.setSwimlaneSelectionEnabled=function(A){this.swimlaneSelectionEnabled=A;};mxGraph.prototype.isMultigraph=function(){return this.multigraph;};mxGraph.prototype.setMultigraph=function(A){this.multigraph=A;};mxGraph.prototype.isAllowLoops=function(){return this.allowLoops;};mxGraph.prototype.setAllowDanglingEdges=function(A){this.allowDanglingEdges=A;};mxGraph.prototype.isAllowDanglingEdges=function(){return this.allowDanglingEdges;};mxGraph.prototype.setConnectableEdges=function(A){this.connectableEdges=A;};mxGraph.prototype.isConnectableEdges=function(){return this.connectableEdges;};mxGraph.prototype.setCloneInvalidEdges=function(A){this.cloneInvalidEdges=A;};mxGraph.prototype.isCloneInvalidEdges=function(){return this.cloneInvalidEdges;};mxGraph.prototype.setAllowLoops=function(A){this.allowLoops=A;};mxGraph.prototype.isDisconnectOnMove=function(){return this.disconnectOnMove;};mxGraph.prototype.setDisconnectOnMove=function(A){this.disconnectOnMove=A;};mxGraph.prototype.isDropEnabled=function(){return this.dropEnabled;};mxGraph.prototype.setDropEnabled=function(A){this.dropEnabled=A;};mxGraph.prototype.isSplitEnabled=function(){return this.splitEnabled;};mxGraph.prototype.setSplitEnabled=function(A){this.splitEnabled=A;};mxGraph.prototype.isCellResizable=function(A){return this.isCellsResizable()&&!this.isCellLocked(A);};mxGraph.prototype.isCellsResizable=function(){return this.cellsResizable;};mxGraph.prototype.setCellsResizable=function(A){this.cellsResizable=A;};mxGraph.prototype.isCellBendable=function(A){return this.isCellsBendable()&&!this.isCellLocked(A);};mxGraph.prototype.isCellsBendable=function(){return this.cellsBendable;};mxGraph.prototype.setCellsBendable=function(A){this.cellsBendable=A;};mxGraph.prototype.isCellEditable=function(A){return this.isCellsEditable()&&!this.isCellLocked(A);};mxGraph.prototype.isCellsEditable=function(){return this.cellsEditable;};mxGraph.prototype.setCellsEditable=function(A){this.cellsEditable=A;};mxGraph.prototype.isCellDisconnectable=function(A,B,C){return this.isCellsDisconnectable()&&!this.isCellLocked(A);};mxGraph.prototype.isCellsDisconnectable=function(){return this.cellsDisconnectable;};mxGraph.prototype.setCellsDisconnectable=function(A){this.cellsDisconnectable=A;};mxGraph.prototype.isValidSource=function(A){return(A==null&&this.allowDanglingEdges)||(A!=null&&(!this.model.isEdge(A)||this.connectableEdges)&&this.isCellConnectable(A));};mxGraph.prototype.isValidTarget=function(A){return this.isValidSource(A);};mxGraph.prototype.isValidConnection=function(A,B){return this.isValidSource(A)&&this.isValidTarget(B);};mxGraph.prototype.setConnectable=function(A){this.connectionHandler.setEnabled(A);};mxGraph.prototype.isConnectable=function(A){return this.connectionHandler.isEnabled();};mxGraph.prototype.setTooltips=function(A){this.tooltipHandler.setEnabled(A);};mxGraph.prototype.setPanning=function(A){this.panningHandler.panningEnabled=A;};mxGraph.prototype.isEditing=function(A){if(this.cellEditor!=null){var B=this.cellEditor.getEditingCell();return(A==null)?B!=null:A==B;}return false;};mxGraph.prototype.isAutoSizeCell=function(A){return this.isAutoSizeCells();};mxGraph.prototype.isAutoSizeCells=function(){return this.autoSizeCells;};mxGraph.prototype.setAutoSizeCells=function(A){this.autoSizeCells=A;};mxGraph.prototype.isExtendParent=function(A){return !this.getModel().isEdge(A)&&this.isExtendParents();};mxGraph.prototype.isExtendParents=function(){return this.extendParents;};mxGraph.prototype.setExtendParents=function(A){this.extendParents=A;};mxGraph.prototype.isExtendParentsOnAdd=function(){return this.extendParentsOnAdd;};mxGraph.prototype.setExtendParentsOnAdd=function(A){this.extendParentsOnAdd=A;};mxGraph.prototype.isConstrainChild=function(A){return this.isConstrainChildren();};mxGraph.prototype.isConstrainChildren=function(){return this.constrainChildren;};mxGraph.prototype.setConstrainChildren=function(A){this.constrainChildren=A;};mxGraph.prototype.isAllowNegativeCoordinates=function(){return this.allowNegativeCoordinates;};mxGraph.prototype.setAllowNegativeCoordinates=function(A){this.allowNegativeCoordinates=A;};mxGraph.prototype.getOverlap=function(A){return(this.isAllowOverlapParent(A))?this.defaultOverlap:0;};mxGraph.prototype.isAllowOverlapParent=function(A){return false;};mxGraph.prototype.getFoldableCells=function(A,B){return this.model.filterCells(A,mxUtils.bind(this,function(C){return this.isCellFoldable(C,B);}));};mxGraph.prototype.isCellFoldable=function(A,B){return this.model.getChildCount(A)>0;};mxGraph.prototype.isValidDropTarget=function(A,C,B){return A!=null&&((this.isSplitEnabled()&&this.isSplitTarget(A,C,B))||(!this.model.isEdge(A)&&(this.isSwimlane(A)||(this.model.getChildCount(A)>0&&!this.isCellCollapsed(A)))));};mxGraph.prototype.isSplitTarget=function(D,C,B){if(this.model.isEdge(D)&&C!=null&&C.length==1&&this.isCellConnectable(C[0])&&this.getEdgeValidationError(D,this.model.getTerminal(D,true),C[0])==null){var E=this.model.getTerminal(D,true);var A=this.model.getTerminal(D,false);return(!this.model.isAncestor(C[0],E)&&!this.model.isAncestor(C[0],A));}return false;};mxGraph.prototype.getDropTarget=function(C,B,A){if(!this.isSwimlaneNesting()){for(var E=0;E<C.length;E++){if(this.isSwimlane(C[E])){return null;}}}var G=mxUtils.convertPoint(this.container,B.clientX,B.clientY);var F=this.getSwimlaneAt(G.x,G.y);if(A==null){A=F;}else{if(F!=null){var D=this.model.getParent(F);while(D!=null&&this.isSwimlane(D)&&D!=A){D=this.model.getParent(D);}if(D==A){A=F;}}}while(A!=null&&!this.isValidDropTarget(A,C,B)&&!this.model.isLayer(A)){A=this.model.getParent(A);}return(!this.model.isLayer(A)&&mxUtils.indexOf(C,A)<0)?A:null;};mxGraph.prototype.getDefaultParent=function(){var B=this.defaultParent;if(B==null){B=this.getCurrentRoot();if(B==null){var A=this.model.getRoot();B=this.model.getChildAt(A,0);}}return B;};mxGraph.prototype.setDefaultParent=function(A){this.defaultParent=A;};mxGraph.prototype.getSwimlane=function(A){while(A!=null&&!this.isSwimlane(A)){A=this.model.getParent(A);}return A;};mxGraph.prototype.getSwimlaneAt=function(B,H,E){E=E||this.getDefaultParent();if(E!=null){var C=this.model.getChildCount(E);for(var D=0;D<C;D++){var G=this.model.getChildAt(E,D);var A=this.getSwimlaneAt(B,H,G);if(A!=null){return A;}else{if(this.isSwimlane(G)){var F=this.view.getState(G);if(this.intersects(F,B,H)){return G;}}}}}return null;};mxGraph.prototype.getCellAt=function(G,F,H,E,B){E=E||true;B=B||true;H=H||this.getDefaultParent();if(H!=null){var C=this.model.getChildCount(H);for(var D=C-1;D>=0;D--){var I=this.model.getChildAt(H,D);var J=this.getCellAt(G,F,I,E,B);if(J!=null){return J;}else{if(this.isCellVisible(I)&&(B&&this.model.isEdge(I)||E&&this.model.isVertex(I))){var A=this.view.getState(I);if(this.intersects(A,G,F)){return I;}}}}}return null;};mxGraph.prototype.intersects=function(A,G,F){if(A!=null){var H=A.absolutePoints;if(H!=null){var C=this.tolerance*this.tolerance;var I=H[0];for(var B=1;B<H.length;B++){var D=H[B];var E=mxUtils.ptSegDistSq(I.x,I.y,D.x,D.y,G,F);if(E<=C){return true;}I=D;}}else{if(mxUtils.contains(A,G,F)){return true;}}}return false;};mxGraph.prototype.hitsSwimlaneContent=function(D,A,F){var C=this.getView().getState(D);var B=this.getStartSize(D);if(C!=null){var E=this.getView().getScale();A-=C.x;F-=C.y;if(B.width>0&&A>0&&A>B.width*E){return true;}else{if(B.height>0&&F>0&&F>B.height*E){return true;}}}return false;};mxGraph.prototype.getChildVertices=function(A){return this.getChildCells(A,true,false);};mxGraph.prototype.getChildEdges=function(A){return this.getChildCells(A,false,true);};mxGraph.prototype.getChildCells=function(F,D,B){F=(F!=null)?F:this.getDefaultParent();D=(D!=null)?D:false;B=(B!=null)?B:false;var C=this.model.getChildCells(F,D,B);var A=[];for(var E=0;E<C.length;E++){if(this.isCellVisible(C[E])){A.push(C[E]);}}return A;};mxGraph.prototype.getConnections=function(A,B){return this.getEdges(A,B,true,true,false);};mxGraph.prototype.getIncomingEdges=function(A,B){return this.getEdges(A,B,true,false,false);};mxGraph.prototype.getOutgoingEdges=function(A,B){return this.getEdges(A,B,false,true,false);};mxGraph.prototype.getEdges=function(L,K,D,H,C){D=(D!=null)?D:true;H=(H!=null)?H:true;C=(C!=null)?C:true;var E=[];var I=this.isCellCollapsed(L);var F=this.model.getChildCount(L);for(var G=0;G<F;G++){var B=this.model.getChildAt(L,G);if(I||!this.isCellVisible(B)){E=E.concat(this.model.getEdges(B,D,H));}}E=E.concat(this.model.getEdges(L,D,H));var M=[];for(var G=0;G<E.length;G++){var A=this.view.getVisibleTerminal(E[G],true);var J=this.view.getVisibleTerminal(E[G],false);if(C||((A!=J)&&((D&&J==L&&(K==null||this.model.getParent(A)==K))||(H&&A==L&&(K==null||this.model.getParent(J)==K))))){M.push(E[G]);}}return M;};mxGraph.prototype.getOpposites=function(D,G,B,H){B=(B!=null)?B:true;H=(H!=null)?H:true;var J=[];var E=new Object();if(D!=null){for(var F=0;F<D.length;F++){var A=this.view.getVisibleTerminal(D[F],true);var I=this.view.getVisibleTerminal(D[F],false);if(A==G&&I!=null&&I!=G&&H){var C=mxCellPath.create(I);if(E[C]==null){E[C]=I;J.push(I);}}else{if(I==G&&A!=null&&A!=G&&B){var C=mxCellPath.create(A);if(E[C]==null){E[C]=A;J.push(A);}}}}}return J;};mxGraph.prototype.getEdgesBetween=function(F,G,E){E=(E!=null)?E:false;var C=this.getEdges(F);var A=[];for(var D=0;D<C.length;D++){var H=this.view.getVisibleTerminal(C[D],true);var B=this.view.getVisibleTerminal(C[D],false);if((H==F&&B==G)||(!E&&H==G&&B==F)){A.push(C[D]);}}return A;};mxGraph.prototype.getPointForEvent=function(A){var D=mxUtils.convertPoint(this.container,A.clientX,A.clientY);var B=this.view.scale;var C=this.view.translate;D.x=this.snap(D.x/B-C.x-this.gridSize/2);D.y=this.snap(D.y/B-C.y-this.gridSize/2);return D;};mxGraph.prototype.getCells=function(G,F,C,K,H,L){var L=L||[];if(C>0||K>0){var J=G+C;var A=F+K;H=H||this.getDefaultParent();if(H!=null){var D=this.model.getChildCount(H);for(var E=0;E<D;E++){var I=this.model.getChildAt(H,E);var B=this.view.getState(I);if(this.isCellVisible(I)&&B!=null){if(B.x>=G&&B.y>=F&&B.x+B.width<=J&&B.y+B.height<=A){L.push(I);}else{this.getCells(G,F,C,K,I,L);}}}}}return L;};mxGraph.prototype.getCellsBeyond=function(C,G,H,F,I){var J=[];if(F||I){if(H==null){H=this.getDefaultParent();}if(H!=null){var D=this.model.getChildCount(H);for(var E=0;E<D;E++){var B=this.model.getChildAt(H,E);var A=this.view.getState(B);if(this.isCellVisible(B)&&A!=null){if((!F||A.x>=C)&&(!I||A.y>=G)){J.push(B);}}}}}return J;};mxGraph.prototype.findTreeRoots=function(N,K,C){K=(K!=null)?K:false;C=(C!=null)?C:false;var P=[];if(N!=null){var H=this.getModel();var F=H.getChildCount(N);var D=null;var L=0;for(var G=0;G<F;G++){var O=H.getChildAt(N,G);if(this.model.isVertex(O)&&this.isCellVisible(O)){var B=this.getConnections(O,(K)?N:null);var J=0;var I=0;for(var E=0;E<B.length;E++){var A=this.view.getVisibleTerminal(B[E],true);if(A==O){J++;}else{I++;}}if((C&&J==0&&I>0)||(!C&&I==0&&J>0)){P.push(O);}var M=(C)?I-J:J-I;if(M>L){L=M;D=O;}}}if(P.length==0&&D!=null){P.push(D);}}return P;};mxGraph.prototype.traverse=function(H,D,E,C,K){if(E!=null&&H!=null){D=(D!=null)?D:true;K=K||[];var B=mxCellPath.create(H);if(K[B]==null){K[B]=H;var L=E(H,C);if(L==null||L){var A=this.model.getEdgeCount(H);if(A>0){for(var F=0;F<A;F++){var I=this.model.getEdgeAt(H,F);var J=this.model.getTerminal(I,true)==H;if(!D||J){var G=this.model.getTerminal(I,!J);this.traverse(G,D,E,I,K);}}}}}}};mxGraph.prototype.isCellSelected=function(A){return this.getSelectionModel().isSelected(A);};mxGraph.prototype.isSelectionEmpty=function(){return this.getSelectionModel().isEmpty();};mxGraph.prototype.clearSelection=function(){return this.getSelectionModel().clear();};mxGraph.prototype.getSelectionCount=function(){return this.getSelectionModel().cells.length;};mxGraph.prototype.getSelectionCell=function(){return this.getSelectionModel().cells[0];};mxGraph.prototype.getSelectionCells=function(){return this.getSelectionModel().cells.slice();};mxGraph.prototype.setSelectionCell=function(A){this.getSelectionModel().setCell(A);};mxGraph.prototype.setSelectionCells=function(A){this.getSelectionModel().setCells(A);};mxGraph.prototype.addSelectionCell=function(A){this.getSelectionModel().addCell(A);};mxGraph.prototype.addSelectionCells=function(A){this.getSelectionModel().addCells(A);};mxGraph.prototype.removeSelectionCell=function(A){this.getSelectionModel().removeCell(A);};mxGraph.prototype.removeSelectionCells=function(A){this.getSelectionModel().removeCells(A);};mxGraph.prototype.selectRegion=function(C,A){var B=this.getCells(C.x,C.y,C.width,C.height);this.selectCellsForEvent(B,A);return B;};mxGraph.prototype.selectNextCell=function(){this.selectCell(true);};mxGraph.prototype.selectPreviousCell=function(){this.selectCell();};mxGraph.prototype.selectParentCell=function(){this.selectCell(false,true);};mxGraph.prototype.selectChildCell=function(){this.selectCell(false,false,true);};mxGraph.prototype.selectCell=function(A,H,B){var D=this.selectionModel;var K=(D.cells.length>0)?D.cells[0]:null;if(D.cells.length>1){D.clear();}var J=(K!=null)?this.model.getParent(K):this.getDefaultParent();var E=this.model.getChildCount(J);if(K==null&&E>0){var C=this.model.getChildAt(J,0);this.setSelectionCell(C);}else{if((K==null||H)&&this.view.getState(J)!=null&&this.model.getGeometry(J)!=null){if(this.getCurrentRoot()!=J){this.setSelectionCell(J);}}else{if(K!=null&&B){var G=this.model.getChildCount(K);if(G>0){var C=this.model.getChildAt(K,0);this.setSelectionCell(C);}}else{if(E>0){var F=J.getIndex(K);if(A){F++;var C=this.model.getChildAt(J,F%E);this.setSelectionCell(C);}else{F--;var I=(F<0)?E-1:F;var C=this.model.getChildAt(J,I);this.setSelectionCell(C);}}}}}};mxGraph.prototype.selectAll=function(B){B=B||this.getDefaultParent();var A=this.model.getChildren(B);if(A!=null){this.setSelectionCells(A);}};mxGraph.prototype.selectVertices=function(A){this.selectCells(true,false,A);};mxGraph.prototype.selectEdges=function(A){this.selectCells(false,true,A);};mxGraph.prototype.selectCells=function(C,A,E){E=E||this.getDefaultParent();var D=mxUtils.bind(this,function(F){return this.view.getState(F)!=null&&this.model.getChildCount(F)==0&&((this.model.isVertex(F)&&C)||(this.model.isEdge(F)&&A));});var B=this.model.filterDescendants(D,E);this.setSelectionCells(B);};mxGraph.prototype.selectCellForEvent=function(A,B){var C=this.isCellSelected(A);if(this.isToggleEvent(B)){if(C){this.removeSelectionCell(A);}else{this.addSelectionCell(A);}}else{if(!C||this.getSelectionCount()!=1){this.setSelectionCell(A);}}};mxGraph.prototype.selectCellsForEvent=function(B,A){if(this.isToggleEvent(A)){this.addSelectionCells(B);}else{this.setSelectionCells(B);}};mxGraph.prototype.createHandler=function(C){var A=null;if(C!=null){if(this.model.isEdge(C.cell)){var B=this.view.getEdgeStyle(C);if(this.isLoop(C)||B==mxEdgeStyle.ElbowConnector||B==mxEdgeStyle.SideToSide||B==mxEdgeStyle.TopToBottom){A=new mxElbowEdgeHandler(C);}else{A=new mxEdgeHandler(C);}}else{A=new mxVertexHandler(C);}}return A;};mxGraph.prototype.addMouseListener=function(A){if(this.mouseListeners==null){this.mouseListeners=[];}this.mouseListeners.push(A);};mxGraph.prototype.removeMouseListener=function(B){if(this.mouseListeners!=null){for(var A=0;A<this.mouseListeners.length;A++){if(this.mouseListeners[A]==B){this.mouseListeners.splice(A,1);break;}}}};mxGraph.prototype.fireMouseEvent=function(G,E,D){if(D==null){D=this;}if(G==mxEvent.MOUSE_DOWN){this.isMouseDown=true;}if((G!=mxEvent.MOUSE_UP||this.isMouseDown)&&E.getEvent().detail!=2){if(G==mxEvent.MOUSE_UP){this.isMouseDown=false;}if(!this.isEditing()&&(false||false||false||E.getEvent().target!=this.container)){if(G==mxEvent.MOUSE_MOVE&&this.isMouseDown&&this.autoScroll){var F=mxUtils.convertPoint(this.container,E.getX(),E.getY());this.scrollPointToVisible(F.x,F.y,this.autoExtend);}if(this.mouseListeners!=null){var B=[D,E];E.getEvent().returnValue=true;for(var C=0;C<this.mouseListeners.length;C++){var A=this.mouseListeners[C];if(G==mxEvent.MOUSE_DOWN){A.mouseDown.apply(A,B);}else{if(G==mxEvent.MOUSE_MOVE){A.mouseMove.apply(A,B);}else{if(G==mxEvent.MOUSE_UP){A.mouseUp.apply(A,B);}}}}}if(G==mxEvent.MOUSE_UP){this.click(E);}}}else{if(G==mxEvent.MOUSE_UP){this.isMouseDown=false;}}};mxGraph.prototype.destroy=function(){if(!this.destroyed){this.destroyed=true;if(this.tooltipHandler!=null){this.tooltipHandler.destroy();}if(this.selectionCellsHandler!=null){this.selectionCellsHandler.destroy();}if(this.panningHandler!=null){this.panningHandler.destroy();}if(this.connectionHandler!=null){this.connectionHandler.destroy();}if(this.graphHandler!=null){this.graphHandler.destroy();}if(this.cellEditor!=null){this.cellEditor.destroy();}if(this.view!=null){this.view.destroy();}if(this.focusHandler!=null){mxEvent.removeListener(document.body,"focus",this.focusHandler);this.focusHandler=null;}if(this.blurHandler!=null){mxEvent.removeListener(document.body,"blur",this.blurHandler);this.blurHandler=null;}this.container=null;}};function mxCellOverlay(B,A,D,C){this.image=B;this.tooltip=A;this.align=D;this.verticalAlign=C;}mxCellOverlay.prototype=new mxEventSource();mxCellOverlay.prototype.constructor=mxCellOverlay;mxCellOverlay.prototype.image=null;mxCellOverlay.prototype.tooltip=null;mxCellOverlay.prototype.align=null;mxCellOverlay.prototype.verticalAlign=null;mxCellOverlay.prototype.defaultOverlap=0.5;mxCellOverlay.prototype.getBounds=function(A){var C=A.view.graph.getModel().isEdge(A.cell);var J=A.view.scale;var I=null;var D=this.image.width;var B=this.image.height;if(C){var H=A.absolutePoints;if(H.length%2==1){I=H[Math.floor(H.length/2)];}else{var E=H.length/2;var G=H[E-1];var F=H[E];I=new mxPoint(G.x+(F.x-G.x)/2,G.y+(F.y-G.y)/2);}}else{I=new mxPoint();if(this.align==mxConstants.ALIGN_LEFT){I.x=A.x;}else{if(this.align==mxConstants.ALIGN_CENTER){I.x=A.x+A.width/2;}else{I.x=A.x+A.width;}}if(this.verticalAlign==mxConstants.ALIGN_TOP){I.y=A.y;}else{if(this.verticalAlign==mxConstants.ALIGN_MIDDLE){I.y=A.y+A.height/2;}else{I.y=A.y+A.height;}}}return new mxRectangle(I.x-D*this.defaultOverlap*J,I.y-B*this.defaultOverlap*J,D*J,B*J);};mxCellOverlay.prototype.toString=function(){return this.tooltip;};function mxOutline(E,C){this.source=E;this.outline=new mxGraph(C,E.getModel(),this.graphRenderHint);if(true){var D=this.outline.getView().getCanvas().parentNode;D.setAttribute("shape-rendering","optimizeSpeed");D.setAttribute("image-rendering","optimizeSpeed");}this.outline.setStylesheet(E.getStylesheet());this.outline.setEnabled(false);this.outline.labelsVisible=false;E.getModel().addListener(mxEvent.CHANGE,mxUtils.bind(this,function(G,F){this.update();}));this.outline.addMouseListener(this);var B=mxUtils.bind(this,function(F){if(!this.active){this.update();}});this.source.getModel().addListener(mxEvent.CHANGE,B);var A=this.source.getView();A.addListener(mxEvent.SCALE,B);A.addListener(mxEvent.TRANSLATE,B);A.addListener(mxEvent.SCALE_AND_TRANSLATE,B);A.addListener(mxEvent.DOWN,B);A.addListener(mxEvent.UP,B);mxEvent.addListener(E.container,"scroll",B);E.addListener(mxEvent.REFRESH,mxUtils.bind(this,function(F){this.outline.setStylesheet(E.getStylesheet());this.outline.refresh();}));this.bounds=new mxRectangle(0,0,0,0);this.selectionBorder=new mxRectangleShape(this.bounds,null,mxConstants.OUTLINE_COLOR,mxConstants.OUTLINE_STROKEWIDTH);this.selectionBorder.dialect=(this.outline.dialect!=mxConstants.DIALECT_SVG)?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG;this.selectionBorder.init(this.outline.getView().getOverlayPane());mxEvent.redirectMouseEvents(this.selectionBorder.node,this.outline);this.selectionBorder.node.style.background="";this.sizer=new mxRectangleShape(this.bounds,mxConstants.OUTLINE_HANDLE_FILLCOLOR,mxConstants.OUTLINE_HANDLE_STROKECOLOR);this.sizer.dialect=this.outline.dialect;this.sizer.init(this.outline.getView().getOverlayPane());if(this.enabled){this.sizer.node.style.cursor="pointer";}mxEvent.addListener(this.sizer.node,"mousedown",mxUtils.bind(this,function(F){this.outline.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(F));}));this.selectionBorder.node.style.display=(this.showViewport)?"":"none";this.sizer.node.style.display=this.selectionBorder.node.style.display;this.selectionBorder.node.style.cursor="move";this.refresh();}mxOutline.prototype.source=null;mxOutline.prototype.outline=null;mxOutline.prototype.graphRenderHint=mxConstants.RENDERING_HINT_FASTER;mxOutline.prototype.enabled=true;mxOutline.prototype.showViewport=true;mxOutline.prototype.border=10;mxOutline.prototype.sizerSize=4;mxOutline.prototype.isEnabled=function(){return this.enabled;};mxOutline.prototype.setEnabled=function(A){this.enabled=A;};mxOutline.prototype.setZoomEnabled=function(A){this.sizer.node.style.visibility=(A)?"visible":"hidden";};mxOutline.prototype.refresh=function(){this.update();this.outline.refresh();};mxOutline.prototype.update=function(F){var T=this.source.view.scale;var I=this.source.getGraphBounds();var H=new mxRectangle(I.x/T,I.y/T,I.width/T,I.height/T);var S=Math.min(0,H.x);var D=Math.min(0,H.y);var N=new mxRectangle(-S,-D,this.source.container.clientWidth/T,this.source.container.clientHeight/T);var B=H;B.add(N);var J=Math.max(this.source.container.scrollWidth/T,B.width+B.x);var Q=Math.max(this.source.container.scrollHeight/T,B.height+B.y);var A=Math.max(0,this.outline.container.clientWidth-this.border);var C=Math.max(0,this.outline.container.clientHeight-this.border);var E=Math.min(A/J,C/Q);var W=E;if(W>0){if(this.outline.getView().scale!=W){this.outline.getView().scale=W;F=true;}var R=this.outline.getView();if(R.currentRoot!=this.source.getView().currentRoot){R.setCurrentRoot(this.source.getView().currentRoot);}var L=this.source.view.translate;var V=L.x;var U=L.y;if(H.x<0){V=L.x-H.x;}if(H.y<0){U=L.y-H.y;}if(R.translate.x!=V||R.translate.y!=U){R.translate.x=V;R.translate.y=U;F=true;}var G=R.translate;var W=this.source.getView().scale;var P=W/R.scale;var O=1/R.scale;var K=this.source.container;this.bounds=new mxRectangle((G.x-L.x)/O,(G.y-L.y)/O,(K.clientWidth/P),(K.clientHeight/P));this.bounds.x+=this.source.container.scrollLeft*R.scale/W;this.bounds.y+=this.source.container.scrollTop*R.scale/W;this.selectionBorder.bounds=this.bounds;this.selectionBorder.redraw();var M=this.sizerSize;this.sizer.bounds=new mxRectangle(this.bounds.x+this.bounds.width-M,this.bounds.y+this.bounds.height-M,2*M,2*M);this.sizer.redraw();if(F){this.outline.view.revalidate();}}};mxOutline.prototype.mouseDown=function(A,B){if(this.enabled&&this.showViewport){this.zoom=B.isSource(this.sizer);this.startX=B.getX();this.startY=B.getY();this.active=true;if(this.source.useScrollbarsForPanning&&mxUtils.hasScrollbars(this.source.container)){this.dx0=this.source.container.scrollLeft;this.dy0=this.source.container.scrollTop;}else{this.dx0=0;this.dy0=0;}}B.consume();};mxOutline.prototype.mouseMove=function(D,E){if(this.active){this.selectionBorder.node.style.display=(this.showViewport)?"":"none";this.sizer.node.style.display=this.selectionBorder.node.style.display;var I=E.getX()-this.startX;var F=E.getY()-this.startY;var A=null;if(!this.zoom){var C=this.outline.getView().scale;A=new mxRectangle(this.bounds.x+I,this.bounds.y+F,this.bounds.width,this.bounds.height);this.selectionBorder.bounds=A;this.selectionBorder.redraw();I/=C;I*=this.source.getView().scale;F/=C;F*=this.source.getView().scale;this.source.panGraph(-I-this.dx0,-F-this.dy0);}else{var B=this.source.container;var H=B.clientWidth/B.clientHeight;F=I/H;A=new mxRectangle(this.bounds.x,this.bounds.y,Math.max(1,this.bounds.width+I),Math.max(1,this.bounds.height+F));this.selectionBorder.bounds=A;this.selectionBorder.redraw();}var G=this.sizerSize;this.sizer.bounds=new mxRectangle(A.x+A.width-G,A.y+A.height-G,2*G,2*G);this.sizer.redraw();E.consume();}};mxOutline.prototype.mouseUp=function(E,G){if(this.active){var C=G.getX()-this.startX;var B=G.getY()-this.startY;if(Math.abs(C)>0||Math.abs(B)>0){if(!this.zoom){if(!this.source.useScrollbarsForPanning||!mxUtils.hasScrollbars(this.source.container)){this.source.panGraph(0,0);C/=this.outline.getView().scale;B/=this.outline.getView().scale;var D=this.source.getView().translate;this.source.getView().setTranslate(D.x-C,D.y-B);}}else{var A=this.selectionBorder.bounds.width;var F=this.selectionBorder.bounds.height;var H=this.source.getView().scale;this.source.getView().setScale(H-(C*H)/A);}this.update();G.consume();}this.index=null;this.active=false;}};function mxMultiplicity(A,G,E,J,C,I,B,D,H,F){this.source=A;this.type=G;this.attr=E;this.value=J;this.min=(C!=null)?C:0;this.max=(I!=null)?I:"n";this.validNeighbors=B;this.countError=mxResources.get(D)||D;this.typeError=mxResources.get(H)||H;this.validNeighborsAllowed=(F!=null)?F:true;}mxMultiplicity.prototype.type=null;mxMultiplicity.prototype.attr=null;mxMultiplicity.prototype.value=null;mxMultiplicity.prototype.source=null;mxMultiplicity.prototype.min=null;mxMultiplicity.prototype.max=null;mxMultiplicity.prototype.validNeighbors=null;mxMultiplicity.prototype.validNeighborsAllowed=true;mxMultiplicity.prototype.countError=null;mxMultiplicity.prototype.typeError=null;mxMultiplicity.prototype.check=function(K,C,B,G,I,F){var J=K.model.getValue(B);var E=K.model.getValue(G);var H="";if((this.source&&this.checkType(K,J,this.type,this.attr,this.value))||(!this.source&&this.checkType(K,E,this.type,this.attr,this.value))){if(this.countError!=null&&((this.source&&(this.max==0||(I>=this.max)))||(!this.source&&(this.max==0||(F>=this.max))))){H+=this.countError+"\n";}var A=this.validNeighbors;if(A!=null&&A.length>0){var L=!this.validNeighborsAllowed;for(var D=0;D<A.length;D++){if(this.source&&this.checkType(K,E,A[D])){L=this.validNeighborsAllowed;break;}else{if(!this.source&&this.checkType(K,J,A[D])){L=this.validNeighborsAllowed;break;}}}if(!L&&this.typeError!=null){H+=this.typeError+"\n";}}}return(H.length>0)?H:null;};mxMultiplicity.prototype.checkType=function(D,C,B,A,E){if(C!=null){if(!isNaN(C.nodeType)){return mxUtils.isNode(C,B,A,E);}else{return C==B;}}return false;};function mxLayoutManager(A){this.undoHandler=mxUtils.bind(this,function(C,B){if(this.isEnabled()){this.beforeUndo(B.getProperty("edit"));}});this.moveHandler=mxUtils.bind(this,function(C,B){if(this.isEnabled()){this.cellsMoved(B.getProperty("cells"),B.getProperty("event"));}});this.setGraph(A);}mxLayoutManager.prototype=new mxEventSource();mxLayoutManager.prototype.constructor=mxLayoutManager;mxLayoutManager.prototype.graph=null;mxLayoutManager.prototype.bubbling=true;mxLayoutManager.prototype.enabled=true;mxLayoutManager.prototype.updateHandler=null;mxLayoutManager.prototype.moveHandler=null;mxLayoutManager.prototype.isEnabled=function(){return this.enabled;};mxLayoutManager.prototype.setEnabled=function(A){this.enabled=A;};mxLayoutManager.prototype.isBubbling=function(){return this.bubbling;};mxLayoutManager.prototype.setBubbling=function(A){this.bubbling=A;};mxLayoutManager.prototype.getGraph=function(){return this.graph;};mxLayoutManager.prototype.setGraph=function(B){if(this.graph!=null){var A=this.graph.getModel();A.removeListener(this.undoHandler);this.graph.removeListener(this.moveHandler);}this.graph=B;if(this.graph!=null){var A=this.graph.getModel();A.addListener(mxEvent.BEFORE_UNDO,this.undoHandler);this.graph.addListener(mxEvent.MOVE_CELLS,this.moveHandler);}};mxLayoutManager.prototype.getLayout=function(A){return null;};mxLayoutManager.prototype.beforeUndo=function(C){var B=this.getCellsForChanges(C.changes);var A=this.getGraph().getModel();if(this.isBubbling()){var D=A.getParents(B);while(D.length>0){B=B.concat(D);D=A.getParents(D);}}this.layoutCells(mxUtils.sortCells(B,false));};mxLayoutManager.prototype.cellsMoved=function(D,B){if(D!=null&&B!=null){var A=mxUtils.convertPoint(this.getGraph().container,B.clientX,B.clientY);var C=this.getGraph().getModel();for(var E=0;E<D.length;E++){var F=this.getLayout(C.getParent(D[E]));if(F!=null){F.moveCell(D[E],A.x,A.y);}}}};mxLayoutManager.prototype.getCellsForChanges=function(E){var A=[];var F=new Object();for(var D=0;D<E.length;D++){var H=E[D];if(H instanceof mxRootChange){return[];}else{var C=this.getCellsForChange(H);for(var B=0;B<C.length;B++){if(C[B]!=null){var G=mxCellPath.create(C[B]);if(F[G]==null){F[G]=C[B];A.push(C[B]);}}}}}return A;};mxLayoutManager.prototype.getCellsForChange=function(B){var A=this.getGraph().getModel();if(B.constructor==mxChildChange){return[B.child,B.previous,A.getParent(B.child)];}else{if(B.constructor==mxTerminalChange||B.constructor==mxGeometryChange){return[B.cell,A.getParent(B.cell)];}}return[];};mxLayoutManager.prototype.layoutCells=function(B){if(B.length>0){var A=this.getGraph().getModel();A.beginUpdate();try{var D=null;for(var C=0;C<B.length;C++){if(B[C]!=A.getRoot()&&B[C]!=D){D=B[C];this.executeLayout(this.getLayout(D),D);}}this.fireEvent(new mxEventObject(mxEvent.LAYOUT_CELLS,"cells",B));}finally{A.endUpdate();}}};mxLayoutManager.prototype.executeLayout=function(B,A){if(B!=null&&A!=null){B.execute(A);}};mxLayoutManager.prototype.destroy=function(){this.setGraph(null);};function mxSpaceManager(C,B,D,A){this.resizeHandler=mxUtils.bind(this,function(F,E){if(this.isEnabled()){this.cellsResized(E.getProperty("cells"));}});this.foldHandler=mxUtils.bind(this,function(F,E){if(this.isEnabled()){this.cellsResized(E.getProperty("cells"));}});this.shiftRightwards=(B!=null)?B:true;this.shiftDownwards=(D!=null)?D:true;this.extendParents=(A!=null)?A:true;this.setGraph(C);}mxSpaceManager.prototype=new mxEventSource();mxSpaceManager.prototype.constructor=mxSpaceManager;mxSpaceManager.prototype.graph=null;mxSpaceManager.prototype.enabled=true;mxSpaceManager.prototype.shiftRightwards=true;mxSpaceManager.prototype.shiftDownwards=true;mxSpaceManager.prototype.extendParents=true;mxSpaceManager.prototype.resizeHandler=null;mxSpaceManager.prototype.foldHandler=null;mxSpaceManager.prototype.isCellIgnored=function(A){return !this.getGraph().getModel().isVertex(A);};mxSpaceManager.prototype.isCellShiftable=function(A){return this.getGraph().getModel().isVertex(A)&&this.getGraph().isCellMovable(A);};mxSpaceManager.prototype.isEnabled=function(){return this.enabled;};mxSpaceManager.prototype.setEnabled=function(A){this.enabled=A;};mxSpaceManager.prototype.isShiftRightwards=function(){return this.shiftRightwards;};mxSpaceManager.prototype.setShiftRightwards=function(A){this.shiftRightwards=A;};mxSpaceManager.prototype.isShiftDownwards=function(){return this.shiftDownwards;};mxSpaceManager.prototype.setShiftDownwards=function(A){this.shiftDownwards=A;};mxSpaceManager.prototype.isExtendParents=function(){return this.extendParents;};mxSpaceManager.prototype.setExtendParents=function(A){this.extendParents=A;};mxSpaceManager.prototype.getGraph=function(){return this.graph;};mxSpaceManager.prototype.setGraph=function(A){if(this.graph!=null){this.graph.removeListener(this.resizeHandler);this.graph.removeListener(this.foldHandler);}this.graph=A;if(this.graph!=null){this.graph.addListener(mxEvent.RESIZE_CELLS,this.resizeHandler);this.graph.addListener(mxEvent.FOLD_CELLS,this.foldHandler);}};mxSpaceManager.prototype.cellsResized=function(B){if(B!=null){var A=this.graph.getModel();A.beginUpdate();try{for(var C=0;C<B.length;C++){if(!this.isCellIgnored(B[C])){this.cellResized(B[C]);break;}}}finally{A.endUpdate();}}};mxSpaceManager.prototype.cellResized=function(B){var C=this.getGraph();var M=C.getView();var H=C.getModel();var I=M.getState(B);var Q=M.getState(H.getParent(B));if(I!=null&&Q!=null){var G=this.getCellsToShift(I);var S=H.getGeometry(B);if(G!=null&&S!=null){var A=M.translate;var R=M.scale;var O=I.x-Q.origin.x-A.x*R;var E=I.y-Q.origin.y-A.y*R;var P=I.x+I.width;var J=I.y+I.height;var L=I.width-S.width*R+O-S.x*R;var K=I.height-S.height*R+E-S.y*R;var F=1-S.width*R/I.width;var D=1-S.height*R/I.height;H.beginUpdate();try{for(var N=0;N<G.length;N++){if(G[N]!=B&&this.isCellShiftable(G[N])){this.shiftCell(G[N],L,K,O,E,P,J,F,D,this.isExtendParents()&&C.isExtendParent(G[N]));}}}finally{H.endUpdate();}}}};mxSpaceManager.prototype.shiftCell=function(K,P,O,E,I,J,A,D,C,H){var M=this.getGraph();var B=M.getView().getState(K);if(B!=null){var G=M.getModel();var F=G.getGeometry(K);if(F!=null){G.beginUpdate();try{if(this.isShiftRightwards()){if(B.x>=J){F=F.clone();F.translate(-P,0);}else{var N=Math.max(0,B.x-x0);F=F.clone();F.translate(-D*N,0);}}if(this.isShiftDownwards()){if(B.y>=A){F=F.clone();F.translate(0,-O);}else{var L=Math.max(0,B.y-I);F=F.clone();F.translate(0,-C*L);}}if(F!=G.getGeometry(K)){G.setGeometry(K,F);if(H){M.extendParent(K);}}}finally{G.endUpdate();}}}};mxSpaceManager.prototype.getCellsToShift=function(D){var C=this.getGraph();var B=C.getModel().getParent(D.cell);var E=this.isShiftDownwards();var A=this.isShiftRightwards();return C.getCellsBeyond(D.x+((E)?0:D.width),D.y+((E&&A)?0:D.height),B,A,E);};mxSpaceManager.prototype.destroy=function(){this.setGraph(null);};function mxSwimlaneManager(C,A,D,B){this.addHandler=mxUtils.bind(this,function(F,E){if(this.isEnabled()){this.cellsAdded(E.getProperty("cells"));}});this.resizeHandler=mxUtils.bind(this,function(F,E){if(this.isEnabled()){this.cellsResized(E.getProperty("cells"));}});this.horizontal=(A!=null)?A:true;this.siblings=(D!=null)?D:true;this.bubbling=(B!=null)?B:true;this.setGraph(C);}mxSwimlaneManager.prototype=new mxEventSource();mxSwimlaneManager.prototype.constructor=mxSwimlaneManager;mxSwimlaneManager.prototype.graph=null;mxSwimlaneManager.prototype.enabled=true;mxSwimlaneManager.prototype.horizontal=true;mxSwimlaneManager.prototype.siblings=true;mxSwimlaneManager.prototype.bubbling=true;mxSwimlaneManager.prototype.addHandler=null;mxSwimlaneManager.prototype.resizeHandler=null;mxSwimlaneManager.prototype.isSwimlaneIgnored=function(A){return !this.getGraph().isSwimlane(A);};mxSwimlaneManager.prototype.isEnabled=function(){return this.enabled;};mxSwimlaneManager.prototype.setEnabled=function(A){this.enabled=A;};mxSwimlaneManager.prototype.isHorizontal=function(){return this.horizontal;};mxSwimlaneManager.prototype.setHorizontal=function(A){this.horizontal=A;};mxSwimlaneManager.prototype.isSiblings=function(){return this.siblings;};mxSwimlaneManager.prototype.setSiblings=function(A){this.siblings=A;};mxSwimlaneManager.prototype.isBubbling=function(){return this.bubbling;};mxSwimlaneManager.prototype.setBubbling=function(A){this.bubbling=A;};mxSwimlaneManager.prototype.getGraph=function(){return this.graph;};mxSwimlaneManager.prototype.setGraph=function(A){if(this.graph!=null){this.graph.removeListener(this.addHandler);this.graph.removeListener(this.resizeHandler);}this.graph=A;if(this.graph!=null){this.graph.addListener(mxEvent.ADD_CELLS,this.addHandler);this.graph.addListener(mxEvent.CELLS_RESIZED,this.resizeHandler);}};mxSwimlaneManager.prototype.cellsAdded=function(B){if(B!=null){var A=this.getGraph().getModel();A.beginUpdate();try{for(var C=0;C<B.length;C++){if(!this.isSwimlaneIgnored(B[C])){this.swimlaneAdded(B[C]);}}}finally{A.endUpdate();}}};mxSwimlaneManager.prototype.swimlaneAdded=function(E){var B=this.getGraph().getModel();var F=null;var D=B.getParent(E);var A=B.getChildCount(D);for(var C=0;C<A;C++){var G=B.getChildAt(D,C);if(G!=E&&!this.isSwimlaneIgnored(G)){F=B.getGeometry(G);break;}}if(F!=null){this.resizeSwimlane(E,F.width,F.height);}};mxSwimlaneManager.prototype.cellsResized=function(B){if(B!=null){var A=this.getGraph().getModel();A.beginUpdate();try{for(var C=0;C<B.length;C++){if(!this.isSwimlaneIgnored(B[C])){this.swimlaneResized(B[C]);}}}finally{A.endUpdate();}}};mxSwimlaneManager.prototype.swimlaneResized=function(G){var F=this.getGraph().getModel();var C=F.getGeometry(G);if(C!=null){var I=C.width;var E=C.height;F.beginUpdate();try{var H=F.getParent(G);if(this.isSiblings()){var B=F.getChildCount(H);for(var D=0;D<B;D++){var A=F.getChildAt(H,D);if(A!=G&&!this.isSwimlaneIgnored(A)){this.resizeSwimlane(A,I,E);}}}if(this.isBubbling()&&!this.isSwimlaneIgnored(H)){this.resizeParent(H,I,E);this.swimlaneResized(H);}}finally{F.endUpdate();}}};mxSwimlaneManager.prototype.resizeSwimlane=function(D,A,C){var B=this.getGraph().getModel();var E=B.getGeometry(D);if(E!=null){E=E.clone();if(this.isHorizontal()){E.width=A;}else{E.height=C;}B.setGeometry(D,E);}};mxSwimlaneManager.prototype.resizeParent=function(E,A,D){var F=this.getGraph();var B=F.getModel();var G=B.getGeometry(E);if(G!=null){G=G.clone();var C=(this.graph.isSwimlane(E))?this.graph.getStartSize(E):new mxRectangle();if(this.isHorizontal()){G.width=A+C.width;}else{G.height=D+C.height;}B.setGeometry(E,G);}};mxSwimlaneManager.prototype.destroy=function(){this.setGraph(null);};function mxTemporaryCellStates(A,G,B){this.view=A;G=(G!=null)?G:1;this.oldBounds=A.getGraphBounds();this.oldStates=A.getStates();this.oldScale=A.getScale();A.setStates(new mxDictionary());A.setScale(G);if(B!=null){var E=A.createState(new mxCell());for(var C=0;C<B.length;C++){A.validateBounds(E,B[C]);}var F=null;for(var C=0;C<B.length;C++){var D=A.validatePoints(E,B[C]);if(F==null){F=D;}else{F.add(D);}}if(F==null){F=new mxRectangle();}A.setGraphBounds(F);}}mxTemporaryCellStates.prototype.view=null;mxTemporaryCellStates.prototype.oldStates=null;mxTemporaryCellStates.prototype.oldBounds=null;mxTemporaryCellStates.prototype.oldScale=null;mxTemporaryCellStates.prototype.destroy=function(){this.view.setScale(this.oldScale);this.view.setStates(this.oldStates);this.view.setGraphBounds(this.oldBounds);};function mxCellStatePreview(A){this.graph=A;this.deltas=new Object();}mxCellStatePreview.prototype.graph=null;mxCellStatePreview.prototype.deltas=null;mxCellStatePreview.prototype.count=0;mxCellStatePreview.prototype.isEmpty=function(){return this.count==0;};mxCellStatePreview.prototype.moveState=function(D,B,A,E,C){E=(E!=null)?E:true;C=(C!=null)?C:true;var G=mxCellPath.create(D.cell);var F=this.deltas[G];if(F==null){F=new mxPoint(B,A);this.deltas[G]=F;this.count++;}else{if(E){F.X+=B;F.Y+=A;}else{F.X=B;F.Y=A;}}if(C){this.addEdges(D);}return F;};mxCellStatePreview.prototype.show=function(F){var C=this.graph.getModel();var B=C.getRoot();for(var H in this.deltas){var A=mxCellPath.resolve(B,H);var E=this.graph.view.getState(A);var G=this.deltas[H];var D=this.graph.view.getState(C.getParent(A));this.translateState(D,E,G.x,G.y);}for(var H in this.deltas){var A=mxCellPath.resolve(B,H);var E=this.graph.view.getState(A);var G=this.deltas[H];var D=this.graph.view.getState(C.getParent(A));this.revalidateState(D,E,G.x,G.y,F);}};mxCellStatePreview.prototype.translateState=function(G,A,I,H){if(A!=null){var F=this.graph.getModel();if(F.isVertex(A.cell)){A.invalid=true;this.graph.view.validateBounds(G,A.cell);var E=F.getGeometry(A.cell);var B=mxCellPath.create(A.cell);if(E!=null&&(I!=0||H!=0)&&(!E.relative||this.deltas[B]!=null)){A.x+=I;A.y+=H;}}var C=F.getChildCount(A.cell);for(var D=0;D<C;D++){this.translateState(A,this.graph.view.getState(F.getChildAt(A.cell,D)),I,H);}}};mxCellStatePreview.prototype.revalidateState=function(H,A,J,I,G){if(A!=null){A.invalid=true;this.graph.view.validatePoints(H,A.cell);var B=mxCellPath.create(A.cell);var F=this.graph.getModel();var E=F.getGeometry(A.cell);if(E!=null&&J!=0&&I!=0&&F.isVertex(A.cell)&&E.relative&&this.deltas[B]!=null){A.x+=J;A.y+=I;this.graph.view.updateLabelBounds(A);this.graph.cellRenderer.redraw(A);}if(G!=null){G(A);}var C=F.getChildCount(A.cell);for(var D=0;D<C;D++){this.revalidateState(A,this.graph.view.getState(F.getChildAt(A.cell,D)),J,I,G);}}};mxCellStatePreview.prototype.addEdges=function(D){var A=this.graph.getModel();var E=A.getEdgeCount(D.cell);for(var B=0;B<E;B++){var C=this.graph.view.getState(A.getEdgeAt(D.cell,B));if(C!=null){this.moveState(C,0,0);}}};function mxConnectionConstraint(A,B){this.point=A;this.perimeter=(B!=null)?B:true;}mxConnectionConstraint.prototype.point=null;mxConnectionConstraint.prototype.perimeter=null;function mxGraphHandler(A){this.graph=A;this.graph.addMouseListener(this);}mxGraphHandler.prototype.graph=null;mxGraphHandler.prototype.maxCells=(false)?20:50;mxGraphHandler.prototype.enabled=true;mxGraphHandler.prototype.highlightEnabled=true;mxGraphHandler.prototype.cloneEnabled=true;mxGraphHandler.prototype.moveEnabled=true;mxGraphHandler.prototype.updateCursor=true;mxGraphHandler.prototype.selectEnabled=true;mxGraphHandler.prototype.removeCellsFromParent=true;mxGraphHandler.prototype.connectOnDrop=false;mxGraphHandler.prototype.scrollOnMove=true;mxGraphHandler.prototype.minimumSize=6;mxGraphHandler.prototype.previewColor="black";mxGraphHandler.prototype.htmlPreview=false;mxGraphHandler.prototype.shape=null;mxGraphHandler.prototype.isEnabled=function(){return this.enabled;};mxGraphHandler.prototype.setEnabled=function(A){this.enabled=A;};mxGraphHandler.prototype.isCloneEnabled=function(){return this.cloneEnabled;};mxGraphHandler.prototype.setCloneEnabled=function(A){this.cloneEnabled=A;};mxGraphHandler.prototype.isMoveEnabled=function(){return this.moveEnabled;};mxGraphHandler.prototype.setMoveEnabled=function(A){this.moveEnabled=A;};mxGraphHandler.prototype.isSelectEnabled=function(){return this.selectEnabled;};mxGraphHandler.prototype.setSelectEnabled=function(A){this.selectEnabled=A;};mxGraphHandler.prototype.isRemoveCellsFromParent=function(){return this.removeCellsFromParent;};mxGraphHandler.prototype.setRemoveCellsFromParent=function(A){this.removeCellsFromParent=A;};mxGraphHandler.prototype.mouseDown=function(C,D){if(!D.isConsumed()&&this.isEnabled()&&this.graph.isEnabled()&&!this.graph.isForceMarqueeEvent(D.getEvent())&&D.getState()!=null){var A=D.getCell();this.cell=null;this.delayedSelection=this.graph.isCellSelected(A);if(this.isSelectEnabled()&&!this.delayedSelection){this.graph.selectCellForEvent(A,D.getEvent());}if(this.isMoveEnabled()){var B=this.graph.model;var E=B.getGeometry(A);if(this.graph.isCellMovable(A)&&((!B.isEdge(A)||this.graph.getSelectionCount()>1||(E.points!=null&&E.points.length>0)||B.getTerminal(A,true)==null||B.getTerminal(A,false)==null)||this.graph.allowDanglingEdges||(this.graph.isCloneEvent(D.getEvent())&&this.graph.isCellsCloneable()))){this.start(A,D.getX(),D.getY());}this.cellWasClicked=true;D.consume();}}};mxGraphHandler.prototype.getCells=function(A){return this.graph.getMovableCells(this.graph.getSelectionCells());};mxGraphHandler.prototype.getPreviewBounds=function(C){var D=this.graph.getView().getBounds(C);if(D!=null){if(D.width<this.minimumSize){var B=this.minimumSize-D.width;D.x-=B/2;D.width=this.minimumSize;}if(D.height<this.minimumSize){var A=this.minimumSize-D.height;D.y-=A/2;D.height=this.minimumSize;}}return D;};mxGraphHandler.prototype.createPreviewShape=function(B){var A=new mxRectangleShape(B,null,this.previewColor);A.isDashed=true;if(this.htmlPreview){A.dialect=mxConstants.DIALECT_STRICTHTML;A.init(this.graph.container);}else{A.dialect=(this.graph.dialect!=mxConstants.DIALECT_SVG)?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG;A.init(this.graph.getView().getOverlayPane());if(A.dialect==mxConstants.DIALECT_SVG){A.node.setAttribute("style","pointer-events:none;");}else{A.node.style.background="";}}return A;};mxGraphHandler.prototype.start=function(B,A,C){this.cell=B;this.first=mxUtils.convertPoint(this.graph.container,A,C);this.cells=this.getCells(this.cell);this.bounds=this.getPreviewBounds(this.cells);};mxGraphHandler.prototype.mouseMove=function(C,S){var B=this.graph;if(!S.isConsumed()&&B.isMouseDown&&this.cell!=null&&this.first!=null&&this.bounds!=null){var M=mxUtils.convertPoint(B.container,S.getX(),S.getY());var K=M.x-this.first.x;var J=M.y-this.first.y;var L=B.tolerance;if(this.shape!=null||Math.abs(K)>L||Math.abs(J)>L){if(this.highlight==null){this.highlight=new mxCellHighlight(this.graph,mxConstants.DROP_TARGET_COLOR,3);}if(this.shape==null){this.shape=this.createPreviewShape(this.bounds);}var I=B.getView().translate;var U=B.getView().scale;if(B.isGridEnabledEvent(S.getEvent())){var R=this.bounds.x-(this.graph.snap(this.bounds.x/U-I.x)+I.x)*U;var Q=this.bounds.y-(this.graph.snap(this.bounds.y/U-I.y)+I.y)*U;K=this.graph.snap(K/U)*U-R;J=this.graph.snap(J/U)*U-Q;}if(B.isConstrainedEvent(S.getEvent())){if(Math.abs(K)>Math.abs(J)){J=0;}else{K=0;}}this.shape.bounds=new mxRectangle(this.bounds.x+K,this.bounds.y+J,this.bounds.width,this.bounds.height);this.shape.redraw();var T=null;var A=S.getCell();if(B.isDropEnabled()&&this.highlightEnabled){T=B.getDropTarget(this.cells,S.getEvent(),A);}var H=T;var D=B.getModel();while(H!=null&&H!=this.cell){H=D.getParent(H);}var P=B.isCloneEvent(S.getEvent())&&B.isCellsCloneable()&&this.isCloneEnabled();var G=B.getView().getState(T);var F=false;if(G!=null&&H==null&&(D.getParent(this.cell)!=T||P)){if(this.target!=T){this.target=T;this.setHighlightColor(mxConstants.DROP_TARGET_COLOR);}F=true;}else{this.target=null;if(this.connectOnDrop&&A!=null&&this.cells.length==1&&B.getModel().isVertex(A)&&B.isCellConnectable(A)){var G=B.getView().getState(A);if(G!=null){var O=B.getEdgeValidationError(null,this.cell,A);var N=(O==null)?mxConstants.VALID_COLOR:mxConstants.INVALID_CONNECT_TARGET_COLOR;this.setHighlightColor(N);F=true;}}}if(G!=null&&F){this.highlight.highlight(G);}else{this.highlight.hide();}}S.consume();}else{if((this.isMoveEnabled()||this.isCloneEnabled())&&this.updateCursor&&!S.isConsumed()&&S.getState()!=null&&!B.isMouseDown){var E=B.getCursorForCell(S.getCell());if(E==null&&B.isEnabled()&&B.isCellMovable(S.getCell())){if(B.getModel().isEdge(S.getCell())){E=mxConstants.CURSOR_MOVABLE_EDGE;}else{E=mxConstants.CURSOR_MOVABLE_VERTEX;}}S.getState().setCursor(E);S.consume();}}};mxGraphHandler.prototype.setHighlightColor=function(A){if(this.highlight!=null){this.highlight.setHighlightColor(A);}};mxGraphHandler.prototype.mouseUp=function(E,H){if(!H.isConsumed()){var K=this.graph;if(this.cell!=null&&this.first!=null&&this.shape!=null){var I=mxUtils.convertPoint(K.container,H.getX(),H.getY());var B=K.getView().translate;var A=K.getView().scale;var G=K.isCloneEvent(H.getEvent())&&K.isCellsCloneable()&&this.isCloneEnabled();var N=(I.x-this.first.x)/A;var M=(I.y-this.first.y)/A;if(K.isGridEnabledEvent(H.getEvent())){var D=this.bounds.x-(K.snap(this.bounds.x/A-B.x)+B.x)*A;var C=this.bounds.y-(K.snap(this.bounds.y/A-B.y)+B.y)*A;N=K.snap(N)-D/A;M=K.snap(M)-C/A;}if(K.isConstrainedEvent(H.getEvent())){if(Math.abs(N)>Math.abs(M)){M=0;}else{N=0;}}var J=H.getCell();if(this.connectOnDrop&&this.target==null&&J!=null&&K.getModel().isVertex(J)&&K.isCellConnectable(J)&&K.isEdgeValid(null,this.cell,J)){K.connectionHandler.connect(this.cell,J,H.getEvent());}else{var L=K.getSelectionCells();var F=this.target;if(K.isSplitEnabled()&&K.isSplitTarget(F,L,H.getEvent())){K.splitEdge(F,L,null,N,M);}else{this.moveCells(K.getSelectionCells(),N,M,G,this.target,H.getEvent());}}}else{if(this.isSelectEnabled()&&this.delayedSelection&&this.cell!=null){K.selectCellForEvent(this.cell,H.getEvent());}}}if(this.cellWasClicked){H.consume();}this.reset();};mxGraphHandler.prototype.reset=function(){this.destroyShapes();this.cellWasClicked=false;this.delayedSelection=false;this.first=null;this.cell=null;this.target=null;};mxGraphHandler.prototype.shouldRemoveCellsFromParent=function(D,C,A){if(this.graph.getModel().isVertex(D)){var B=this.graph.getView().getState(D);var E=mxUtils.convertPoint(this.graph.container,A.clientX,A.clientY);return B!=null&&!mxUtils.contains(B,E.x,E.y);}return false;};mxGraphHandler.prototype.moveCells=function(D,C,B,F,E,A){if(F){D=this.graph.getCloneableCells(D);}if(E==null&&this.isRemoveCellsFromParent()&&this.shouldRemoveCellsFromParent(this.graph.getModel().getParent(this.cell),D,A)){E=this.graph.getDefaultParent();}var D=this.graph.moveCells(D,C,B,F,E,A);if(this.isSelectEnabled()&&this.scrollOnMove){this.graph.scrollCellToVisible(D[0]);}if(F){this.graph.setSelectionCells(D);}};mxGraphHandler.prototype.destroyShapes=function(){if(this.shape!=null){this.shape.destroy();this.shape=null;}if(this.highlight!=null){this.highlight.destroy();this.highlight=null;}};mxGraphHandler.prototype.destroy=function(){this.graph.removeMouseListener(this);this.destroyShapes();};function mxPanningHandler(B,A){if(B!=null){this.graph=B;this.factoryMethod=A;this.graph.addMouseListener(this);this.init();}}mxPanningHandler.prototype=new mxPopupMenu();mxPanningHandler.prototype.constructor=mxPanningHandler;mxPanningHandler.prototype.graph=null;mxPanningHandler.prototype.usePopupTrigger=true;mxPanningHandler.prototype.useLeftButtonForPanning=false;mxPanningHandler.prototype.selectOnPopup=true;mxPanningHandler.prototype.clearSelectionOnBackground=true;mxPanningHandler.prototype.ignoreCell=false;mxPanningHandler.prototype.previewEnabled=true;mxPanningHandler.prototype.useGrid=false;mxPanningHandler.prototype.panningEnabled=true;mxPanningHandler.prototype.isPanningEnabled=function(){return this.panningEnabled;};mxPanningHandler.prototype.setPanningEnabled=function(A){this.panningEnabled=A;};mxPanningHandler.prototype.init=function(){mxPopupMenu.prototype.init.apply(this);mxEvent.addListener(this.div,(mxClient.IS_TOUCH)?"touchmove":"mousemove",mxUtils.bind(this,function(A){this.graph.tooltipHandler.hide();}));};mxPanningHandler.prototype.isPanningTrigger=function(B){var A=B.getEvent();return(this.useLeftButtonForPanning&&(this.ignoreCell||B.getState()==null)&&mxEvent.isLeftMouseButton(A))||(mxEvent.isControlDown(A)&&mxEvent.isShiftDown(A))||(this.usePopupTrigger&&mxEvent.isPopupTrigger(A));};mxPanningHandler.prototype.mouseDown=function(A,B){if(!B.isConsumed()&&this.isEnabled()){this.hideMenu();this.dx0=-this.graph.container.scrollLeft;this.dy0=-this.graph.container.scrollTop;this.popupTrigger=this.isPopupTrigger(B);this.panningTrigger=this.isPanningEnabled()&&this.isPanningTrigger(B);this.startX=B.getX();this.startY=B.getY();if(this.popupTrigger&&mxEvent.isRightMouseButton(B.getEvent())&&mxClient.IS_MAC&&false){this.mouseUp(A,B);}else{if(this.panningTrigger){B.consume();}}}};mxPanningHandler.prototype.mouseMove=function(C,D){var B=D.getX()-this.startX;var A=D.getY()-this.startY;if(this.active){if(this.previewEnabled){if(this.useGrid){B=this.graph.snap(B);A=this.graph.snap(A);}this.graph.panGraph(B+this.dx0,A+this.dy0);}D.consume();}else{if(this.panningTrigger){this.active=Math.abs(B)>this.graph.tolerance||Math.abs(A)>this.graph.tolerance;}}};mxPanningHandler.prototype.mouseUp=function(C,D){var J=Math.abs(D.getX()-this.startX);var I=Math.abs(D.getY()-this.startY);if(this.active){var A=mxUtils.getCurrentStyle(this.graph.container);if(!this.graph.useScrollbarsForPanning||!mxUtils.hasScrollbars(this.graph.container)){var J=D.getX()-this.startX;var I=D.getY()-this.startY;var B=this.graph.getView().scale;var H=this.graph.getView().translate;this.graph.panGraph(0,0);this.panGraph(H.x+J/B,H.y+I/B);}D.consume();}else{if(this.popupTrigger){if(J<this.graph.tolerance&&I<this.graph.tolerance){var G=D.getCell();if(this.graph.isEnabled()&&this.selectOnPopup&&G!=null&&!this.graph.isCellSelected(G)){this.graph.setSelectionCell(G);}if(this.clearSelectionOnBackground&&!this.graph.isCellSelected(G)){this.graph.clearSelection();}this.graph.tooltipHandler.hide();var F=mxUtils.getScrollOrigin();var E=new mxPoint(D.getX()+F.x,D.getY()+F.y);this.popup(E.x,E.y,G,D.getEvent());D.consume();}}}this.panningTrigger=false;this.popupTrigger=false;this.active=false;};mxPanningHandler.prototype.panGraph=function(B,A){this.graph.getView().setTranslate(B,A);};mxPanningHandler.prototype.destroy=function(){this.graph.removeMouseListener(this);mxPopupMenu.prototype.destroy.apply(this);};function mxCellMarker(C,D,A,B){if(C!=null){this.graph=C;this.validColor=(D!=null)?D:mxConstants.DEFAULT_VALID_COLOR;this.invalidColor=(D!=null)?A:mxConstants.DEFAULT_INVALID_COLOR;this.hotspot=(B!=null)?B:mxConstants.DEFAULT_HOTSPOT;this.highlight=new mxCellHighlight(C);}}mxCellMarker.prototype=new mxEventSource();mxCellMarker.prototype.constructor=mxCellMarker;mxCellMarker.prototype.graph=null;mxCellMarker.prototype.enabled=true;mxCellMarker.prototype.hotspot=mxConstants.DEFAULT_HOTSPOT;mxCellMarker.prototype.hotspotEnabled=false;mxCellMarker.prototype.validColor=null;mxCellMarker.prototype.invalidColor=null;mxCellMarker.prototype.currentColor=null;mxCellMarker.prototype.validState=null;mxCellMarker.prototype.markedState=null;mxCellMarker.prototype.setEnabled=function(A){this.enabled=A;};mxCellMarker.prototype.isEnabled=function(){return this.enabled;};mxCellMarker.prototype.setHotspot=function(A){this.hotspot=A;};mxCellMarker.prototype.getHotspot=function(){return this.hotspot;};mxCellMarker.prototype.setHotspotEnabled=function(A){this.hotspotEnabled=A;};mxCellMarker.prototype.isHotspotEnabled=function(){return this.hotspotEnabled;};mxCellMarker.prototype.hasValidState=function(){return this.validState!=null;};mxCellMarker.prototype.getValidState=function(){return this.validState;};mxCellMarker.prototype.getMarkedState=function(){return this.markedState;};mxCellMarker.prototype.reset=function(){this.validState=null;if(this.markedState!=null){this.markedState=null;this.unmark();}};mxCellMarker.prototype.process=function(B){var C=null;if(this.isEnabled()){C=this.getState(B);var D=(C!=null)?this.isValidState(C):false;var A=this.getMarkerColor(B.getEvent(),C,D);if(D){this.validState=C;}else{this.validState=null;}if(C!=this.markedState||A!=this.currentColor){this.currentColor=A;if(C!=null&&this.currentColor!=null){this.markedState=C;this.mark();}else{if(this.markedState!=null){this.markedState=null;this.unmark();}}}}return C;};mxCellMarker.prototype.mark=function(){this.highlight.setHighlightColor(this.currentColor);this.highlight.highlight(this.markedState);this.fireEvent(new mxEventObject(mxEvent.MARK,"state",this.markedState));};mxCellMarker.prototype.unmark=function(){this.mark();};mxCellMarker.prototype.isValidState=function(A){return true;};mxCellMarker.prototype.getMarkerColor=function(A,B,C){return(C)?this.validColor:this.invalidColor;};mxCellMarker.prototype.getState=function(B){var A=this.graph.getView();cell=this.getCell(B);var C=this.getStateToMark(A.getState(cell));return(C!=null&&this.intersects(C,B))?C:null;};mxCellMarker.prototype.getCell=function(A){return A.getCell();};mxCellMarker.prototype.getStateToMark=function(A){return A;};mxCellMarker.prototype.intersects=function(C,B){if(this.hotspotEnabled){var A=mxUtils.convertPoint(this.graph.container,B.getX(),B.getY());return mxUtils.intersectsHotspot(C,A.x,A.y,this.hotspot,mxConstants.MIN_HOTSPOT_SIZE,mxConstants.MAX_HOTSPOT_SIZE);}return true;};mxCellMarker.prototype.destroy=function(){this.graph.getView().removeListener(this.resetHandler);this.graph.getModel().removeListener(this.resetHandler);this.highlight.destroy();};function mxSelectionCellsHandler(A){this.graph=A;this.handlers=new mxDictionary();this.graph.addMouseListener(this);this.refreshHandler=mxUtils.bind(this,function(C,B){this.refresh();});this.graph.getSelectionModel().addListener(mxEvent.CHANGE,this.refreshHandler);this.graph.getModel().addListener(mxEvent.CHANGE,this.refreshHandler);this.graph.getView().addListener(mxEvent.SCALE,this.refreshHandler);this.graph.getView().addListener(mxEvent.TRANSLATE,this.refreshHandler);this.graph.getView().addListener(mxEvent.SCALE_AND_TRANSLATE,this.refreshHandler);this.graph.getView().addListener(mxEvent.DOWN,this.refreshHandler);this.graph.getView().addListener(mxEvent.UP,this.refreshHandler);}mxSelectionCellsHandler.prototype.graph=null;mxSelectionCellsHandler.prototype.enabled=true;mxSelectionCellsHandler.prototype.refreshHandler=null;mxSelectionCellsHandler.prototype.maxHandlers=100;mxSelectionCellsHandler.prototype.handlers=null;mxSelectionCellsHandler.prototype.isEnabled=function(){return this.enabled;};mxSelectionCellsHandler.prototype.setEnabled=function(A){this.enabled=A;};mxSelectionCellsHandler.prototype.getHandler=function(A){return this.handlers.get(A);};mxSelectionCellsHandler.prototype.reset=function(){this.handlers.visit(function(A,B){B.reset.apply(B);});};mxSelectionCellsHandler.prototype.refresh=function(){var E=this.handlers;this.handlers=new mxDictionary();var B=this.graph.getSelectionCells();for(var A=0;A<B.length;A++){var D=this.graph.view.getState(B[A]);if(D!=null){var C=E.remove(B[A]);if(C!=null){if(C.state!=D){C.destroy();C=null;}else{C.redraw();}}if(C==null){C=this.graph.createHandler(D);}if(C!=null){this.handlers.put(B[A],C);}}}E.visit(function(F,G){G.destroy();});};mxSelectionCellsHandler.prototype.mouseDown=function(B,C){if(this.graph.isEnabled()&&this.isEnabled()){var A=[B,C];this.handlers.visit(function(D,E){E.mouseDown.apply(E,A);});}};mxSelectionCellsHandler.prototype.mouseMove=function(B,C){if(this.graph.isEnabled()&&this.isEnabled()){var A=[B,C];this.handlers.visit(function(D,E){E.mouseMove.apply(E,A);});}};mxSelectionCellsHandler.prototype.mouseUp=function(B,C){if(this.graph.isEnabled()&&this.isEnabled()){var A=[B,C];this.handlers.visit(function(D,E){E.mouseUp.apply(E,A);});}};mxSelectionCellsHandler.prototype.destroy=function(){this.graph.removeMouseListener(this);if(this.refreshHandler!=null){this.graph.getSelectionModel().removeListener(this.refreshHandler);this.graph.getModel().removeListener(this.refreshHandler);this.graph.getView().removeListener(this.refreshHandler);this.refreshHandler=null;}};function mxConnectionHandler(B,A){if(B!=null){this.graph=B;this.factoryMethod=A;this.init();}}mxConnectionHandler.prototype.graph=null;mxConnectionHandler.prototype.factoryMethod=true;mxConnectionHandler.prototype.moveIconFront=false;mxConnectionHandler.prototype.moveIconBack=false;mxConnectionHandler.prototype.connectImage=null;mxConnectionHandler.prototype.targetConnectImage=false;mxConnectionHandler.prototype.enabled=true;mxConnectionHandler.prototype.select=true;mxConnectionHandler.prototype.createTarget=false;mxConnectionHandler.prototype.marker=null;mxConnectionHandler.prototype.constraintHandler=null;mxConnectionHandler.prototype.error=null;mxConnectionHandler.prototype.ignoreMouseDown=false;mxConnectionHandler.prototype.start=null;mxConnectionHandler.prototype.edgeState=null;mxConnectionHandler.prototype.changeHandler=null;mxConnectionHandler.prototype.drillHandler=null;mxConnectionHandler.prototype.isEnabled=function(){return this.enabled;};mxConnectionHandler.prototype.setEnabled=function(A){this.enabled=A;};mxConnectionHandler.prototype.isCreateTarget=function(){return this.createTarget;};mxConnectionHandler.prototype.setCreateTarget=function(A){this.createTarget=A;};mxConnectionHandler.prototype.createShape=function(){var A=new mxPolyline([],mxConstants.INVALID_COLOR);A.isDashed=true;A.dialect=(this.graph.dialect!=mxConstants.DIALECT_SVG)?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG;A.init(this.graph.getView().getOverlayPane());if(this.graph.dialect==mxConstants.DIALECT_SVG){A.pipe.setAttribute("style","pointer-events:none;");A.innerNode.setAttribute("style","pointer-events:none;");}return A;};mxConnectionHandler.prototype.init=function(){this.graph.addMouseListener(this);this.marker=this.createMarker();this.constraintHandler=new mxConstraintHandler(this.graph);this.changeHandler=mxUtils.bind(this,function(A){if(this.iconState!=null){this.iconState=this.graph.getView().getState(this.iconState.cell);}if(this.iconState!=null){this.redrawIcons(this.icons,this.iconState);}else{this.destroyIcons(this.icons);this.previous=null;}this.constraintHandler.reset();});this.graph.getModel().addListener(mxEvent.CHANGE,this.changeHandler);this.graph.getView().addListener(mxEvent.SCALE,this.changeHandler);this.graph.getView().addListener(mxEvent.TRANSLATE,this.changeHandler);this.graph.getView().addListener(mxEvent.SCALE_AND_TRANSLATE,this.changeHandler);this.drillHandler=mxUtils.bind(this,function(A){this.destroyIcons(this.icons);});this.graph.addListener(mxEvent.START_EDITING,this.drillHandler);this.graph.getView().addListener(mxEvent.DOWN,this.drillHandler);this.graph.getView().addListener(mxEvent.UP,this.drillHandler);};mxConnectionHandler.prototype.createMarker=function(){var A=new mxCellMarker(this.graph);A.hotspotEnabled=true;A.getCell=mxUtils.bind(this,function(C,B){var B=mxCellMarker.prototype.getCell.apply(this,arguments);this.error=null;if(B!=null){if(this.isConnecting()){if(this.previous!=null){this.error=this.validateConnection(this.previous.cell,B);if(this.error!=null&&this.error.length==0){B=null;if(this.isCreateTarget()){this.error=null;}}}}else{if(!this.isValidSource(B)){B=null;}}}else{if(this.isConnecting()&&!this.isCreateTarget()&&!this.graph.allowDanglingEdges){this.error="";}}return B;});A.isValidState=mxUtils.bind(this,function(B){if(this.isConnecting()){return this.error==null;}else{return mxCellMarker.prototype.isValidState.apply(A,arguments);}});A.getMarkerColor=mxUtils.bind(this,function(B,C,D){return(this.connectImage==null||this.isConnecting())?mxCellMarker.prototype.getMarkerColor.apply(A,arguments):null;});A.intersects=mxUtils.bind(this,function(C,B){if(this.connectImage!=null||this.isConnecting()){return true;}return mxCellMarker.prototype.intersects.apply(A,arguments);});return A;};mxConnectionHandler.prototype.isConnecting=function(){return this.start!=null&&this.shape!=null;};mxConnectionHandler.prototype.isValidSource=function(A){return this.graph.isValidSource(A);};mxConnectionHandler.prototype.isValidTarget=function(A){return true;};mxConnectionHandler.prototype.validateConnection=function(A,B){if(!this.isValidTarget(B)){return"";}return this.graph.getEdgeValidationError(null,A,B);};mxConnectionHandler.prototype.getConnectImage=function(A){return this.connectImage;};mxConnectionHandler.prototype.createIcons=function(F){var G=this.getConnectImage(F);if(G!=null&&F!=null){this.iconState=F;var C=[];var E=new mxRectangle(0,0,G.width,G.height);var D=new mxImageShape(E,G.src);if(this.moveIconFront){D.dialect=mxConstants.DIALECT_STRICTHTML;D.init(this.graph.container);}else{D.dialect=(this.graph.dialect==mxConstants.DIALECT_SVG)?mxConstants.DIALECT_SVG:mxConstants.DIALECT_VML;D.init(this.graph.getView().getOverlayPane());if(this.moveIconBack&&D.node.previousSibling!=null){D.node.parentNode.insertBefore(D.node,D.node.parentNode.firstChild);}}D.node.style.cursor=mxConstants.CURSOR_CONNECT;var B=mxUtils.bind(this,function(){return(this.currentState!=null)?this.currentState:F;});var A=mxUtils.bind(this,function(H){if(!mxEvent.isConsumed(H)){this.icon=D;this.graph.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(H,B()));}});mxEvent.redirectMouseEvents(D.node,this.graph,B,A);C.push(D);this.redrawIcons(C,this.iconState);return C;}return null;};mxConnectionHandler.prototype.redrawIcons=function(A,B){if(A!=null&&A[0]!=null&&B!=null){var C=this.getIconPosition(A[0],B);A[0].bounds.x=C.x;A[0].bounds.y=C.y;A[0].redraw();}};mxConnectionHandler.prototype.getIconPosition=function(C,D){var E=this.graph.getView().scale;var A=D.getCenterX();var F=D.getCenterY();if(this.graph.isSwimlane(D.cell)){var B=this.graph.getStartSize(D.cell);A=(B.width!=0)?D.x+B.width*E/2:A;F=(B.height!=0)?D.y+B.height*E/2:F;}return new mxPoint(A-C.bounds.width/2,F-C.bounds.height/2);};mxConnectionHandler.prototype.destroyIcons=function(B){if(B!=null){this.iconState=null;for(var A=0;A<B.length;A++){B[A].destroy();}}};mxConnectionHandler.prototype.mouseDown=function(A,B){if(this.isEnabled()&&this.graph.isEnabled()&&!B.isConsumed()&&!this.graph.isForceMarqueeEvent(B.getEvent())&&this.constraintHandler.currentFocus!=null&&this.constraintHandler.currentConstraint!=null){this.sourceConstraint=this.constraintHandler.currentConstraint;this.previous=this.constraintHandler.currentFocus;this.start=this.constraintHandler.currentPoint;this.edgeState=this.createEdgeState(B);B.consume();}else{if(this.isEnabled()&&this.graph.isEnabled()&&!B.isConsumed()&&!this.graph.isForceMarqueeEvent(B.getEvent())&&this.previous!=null&&this.error==null&&(this.icons==null||(this.icons!=null&&this.icon!=null))){this.start=mxUtils.convertPoint(this.graph.container,B.getX(),B.getY());this.edgeState=this.createEdgeState(B);B.consume();}}this.selectedIcon=this.icon;this.icon=null;};mxConnectionHandler.prototype.createEdgeState=function(A){return null;};mxConnectionHandler.prototype.mouseMove=function(A,U){if(!U.isConsumed()&&this.isEnabled()&&this.graph.isEnabled()&&(this.ignoreMouseDown||this.start!=null||!this.graph.isMouseDown)){var N=mxUtils.convertPoint(this.graph.container,U.getX(),U.getY());var B=this.marker.process(U);this.constraintHandler.update(U,this.start==null);this.currentState=B;if(this.previous!=null&&this.start!=null){var K=this.graph.getView();var W=K.scale;var P=new mxPoint(this.graph.snap(N.x/W)*W,this.graph.snap(N.y/W)*W);var O=P;if(B!=null){if(this.constraintHandler.currentConstraint==null){var M=K.getPerimeterFunction(B);if(M!=null){var L=new mxPoint(this.previous.getCenterX(),this.previous.getCenterY());var T=M(K.getPerimeterBounds(B),this.edgeState,L,false);if(T!=null){O=T;}}else{O=new mxPoint(B.getCenterX(),B.getCenterY());}}else{O=this.constraintHandler.currentPoint;}}if(this.selectedIcon!=null){var H=this.selectedIcon.bounds.width;var S=this.selectedIcon.bounds.height;if(B!=null&&this.targetConnectImage){var C=this.getIconPosition(this.selectedIcon,B);this.selectedIcon.bounds.x=C.x;this.selectedIcon.bounds.y=C.y;}else{var G=mxConstants.TOOLTIP_VERTICAL_OFFSET;var D=new mxRectangle(N.x,N.y+G,H,S);this.selectedIcon.bounds=D;}this.selectedIcon.redraw();}var E=this.start;if(this.sourceConstraint==null){var J=K.getPerimeterFunction(this.previous);if(J!=null){var T=J(K.getPerimeterBounds(this.previous),this.previous,O,false);if(T!=null){E=T;}}else{E=new mxPoint(this.previous.getCenterX(),this.previous.getCenterY());}}if(B==null){var I=O.x-E.x;var G=O.y-E.y;var R=Math.sqrt(I*I+G*G);O.x-=I*4/R;O.y-=G*4/R;}if(this.shape==null){var I=Math.abs(P.x-this.start.x);var G=Math.abs(P.y-this.start.y);if(I>this.graph.tolerance||G>this.graph.tolerance){this.shape=this.createShape();}}if(this.shape!=null){this.shape.points=[E,O];this.drawPreview();}mxEvent.consume(U.getEvent());U.consume();}else{if(this.previous!=B){this.destroyIcons(this.icons);this.icons=null;if(B!=null&&this.error==null){this.icons=this.createIcons(B);if(this.icons==null){B.setCursor(mxConstants.CURSOR_CONNECT);U.consume();}}this.previous=B;}else{if(this.previous==B&&B!=null&&this.icons==null&&!this.graph.isMouseDown){U.consume();}}}if(this.constraintHandler.currentConstraint!=null){this.marker.reset();}if(!this.graph.isMouseDown&&B!=null&&this.icons!=null){var X=B.text!=null&&B.text.node.parentNode==this.graph.container;var F=false;var V=U.getSource();for(var Q=0;Q<this.icons.length&&!F;Q++){F=V==this.icons[Q].node||V.parentNode==this.icons[Q].node;}if(!F){this.updateIcons(B,this.icons,U);}}}else{this.constraintHandler.reset();}};mxConnectionHandler.prototype.updateIcons=function(C,A,B){};mxConnectionHandler.prototype.mouseUp=function(A,B){if(!B.isConsumed()&&this.isConnecting()){if(this.error==null){var C=this.previous.cell;var D=null;if(this.constraintHandler.currentFocus!=null){D=this.constraintHandler.currentFocus.cell;}if(D==null&&this.marker.hasValidState()){D=this.marker.validState.cell;}this.connect(C,D,B.getEvent(),B.getCell());}else{if(this.previous!=null&&this.marker.validState!=null&&this.previous.cell==this.marker.validState.cell){this.graph.selectCellForEvent(this.marker.source,evt);}if(this.error.length>0){this.graph.validationAlert(this.error);}}this.destroyIcons(this.icons);B.consume();}if(this.start!=null){this.reset();}};mxConnectionHandler.prototype.reset=function(){if(this.shape!=null){this.shape.destroy();this.shape=null;}this.destroyIcons(this.icons);this.icons=null;this.marker.reset();this.constraintHandler.reset();this.selectedIcon=null;this.edgeState=null;this.previous=null;this.error=null;this.sourceConstraint=null;this.start=null;this.icon=null;};mxConnectionHandler.prototype.drawPreview=function(){var B=this.error==null;var A=this.getEdgeColor(B);if(this.shape.dialect==mxConstants.DIALECT_SVG){this.shape.innerNode.setAttribute("stroke",A);}else{this.shape.node.setAttribute("strokecolor",A);}this.shape.strokewidth=this.getEdgeWidth(B);this.shape.redraw();mxUtils.repaintGraph(this.graph,this.shape.points[1]);};mxConnectionHandler.prototype.getEdgeColor=function(A){return(A)?mxConstants.VALID_COLOR:mxConstants.INVALID_COLOR;};mxConnectionHandler.prototype.getEdgeWidth=function(A){return(A)?3:1;};mxConnectionHandler.prototype.connect=function(B,H,K,A){if(B!=null&&(H!=null||this.isCreateTarget()||this.graph.allowDanglingEdges)){var G=this.graph.getModel();var C=null;G.beginUpdate();try{if(H==null&&this.isCreateTarget()){H=this.createTargetVertex(K,B);if(H!=null){A=this.graph.getDropTarget([H],K,A);if(A==null||!this.graph.getModel().isEdge(A)){var E=this.graph.getView().getState(A);if(E!=null){var F=G.getGeometry(H);F.x-=E.origin.x;F.y-=E.origin.y;}}else{A=this.graph.getDefaultParent();}this.graph.addCell(H,A);}}var J=this.graph.getDefaultParent();if(G.getParent(B)==G.getParent(H)){J=G.getParent(B);}var I=null;if(this.edgeState!=null){I=this.edgeState.cell.value;}C=this.insertEdge(J,null,I,B,H);if(C!=null){this.graph.setConnectionConstraint(C,B,true,this.sourceConstraint);this.graph.setConnectionConstraint(C,H,false,this.constraintHandler.currentConstraint);var D=G.getGeometry(C);if(D==null){D=new mxGeometry();D.relative=true;G.setGeometry(C,D);}if(H==null){var L=this.graph.getPointForEvent(K);D.setTerminalPoint(L,false);}}}finally{G.endUpdate();}if(this.select){this.graph.setSelectionCell(C);}}};mxConnectionHandler.prototype.insertEdge=function(A,F,D,C,E){if(this.factoryMethod==null){return this.graph.insertEdge(A,F,D,C,E);}else{var B=this.createEdge(D,C,E);B=this.graph.addEdge(B,A,C,E);return B;}};mxConnectionHandler.prototype.createTargetVertex=function(C,E){var G=this.graph.cloneCells([E])[0];var F=this.graph.getModel().getGeometry(G);if(F!=null){var A=this.graph.getPointForEvent(C);F.x=this.graph.snap(A.x-F.width/2);F.y=this.graph.snap(A.y-F.height/2);if(this.start!=null){var D=this.graph.view.getState(E);if(D!=null){var B=(this.graph.isGridEnabled())?this.graph.gridSize:this.graph.tolerance;if(Math.abs(this.graph.snap(this.start.x)-this.graph.snap(A.x))<=B){F.x=D.x;}else{if(Math.abs(this.graph.snap(this.start.y)-this.graph.snap(A.y))<=B){F.y=D.y;}}}}}return G;};mxConnectionHandler.prototype.createEdge=function(C,B,E){var A=null;if(this.factoryMethod!=null){A=this.factoryMethod(B,E);}if(A==null){A=new mxCell(C||"");A.setEdge(true);var D=new mxGeometry();D.relative=true;A.setGeometry(D);}return A;};mxConnectionHandler.prototype.destroy=function(){this.graph.removeMouseListener(this);if(this.shape!=null){this.shape.destroy();this.shape=null;}if(this.marker!=null){this.marker.destroy();this.marker=null;}if(this.constraintHandler!=null){this.constraintHandler.destroy();this.constraintHandler=null;}if(this.changeHandler!=null){this.graph.getModel().removeListener(this.changeHandler);this.graph.getView().removeListener(this.changeHandler);this.changeHandler=null;}if(this.drillHandler!=null){this.graph.removeListener(this.drillHandler);this.graph.getView().removeListener(this.drillHandler);this.drillHandler=null;}};function mxConstraintHandler(A){this.graph=A;}mxConstraintHandler.prototype.pointImage=new mxImage(mxClient.imageBasePath+"/point.gif",5,5);mxConstraintHandler.prototype.graph=null;mxConstraintHandler.prototype.enabled=true;mxConstraintHandler.prototype.highlightColor=mxConstants.DEFAULT_VALID_COLOR;mxConstraintHandler.prototype.isEnabled=function(){return this.enabled;};mxConstraintHandler.prototype.setEnabled=function(A){this.enabled=A;};mxConstraintHandler.prototype.reset=function(){if(this.focusIcons!=null){for(var A=0;A<this.focusIcons.length;A++){this.focusIcons[A].destroy();}this.focusIcons=null;}if(this.focusHighlight!=null){this.focusHighlight.destroy();this.focusHighlight=null;}this.currentConstraint=null;this.currentFocusArea=null;this.currentPoint=null;this.currentFocus=null;this.focusPoints=null;};mxConstraintHandler.prototype.getTolerance=function(){return this.graph.getTolerance();};mxConstraintHandler.prototype.getImageForConstraint=function(B,C,A){return this.pointImage;};mxConstraintHandler.prototype.update=function(K,C){if(this.isEnabled()){var M=this.getTolerance();var N=mxUtils.convertPoint(this.graph.container,K.getX(),K.getY());var H=new mxRectangle(N.x-M,N.y-M,2*M,2*M);if(this.currentFocusArea==null||!mxUtils.intersects(this.currentFocusArea,H)){this.currentFocusArea=null;if(K.getState()!=this.currentFocus){this.currentFocus=null;if(K.getState()!=null){this.constraints=this.graph.getAllConnectionConstraints(K.getState(),C);if(this.constraints!=null){this.currentFocus=K.getState();this.currentFocusArea=new mxRectangle(K.getState().x,K.getState().y,K.getState().width,K.getState().height);if(this.focusIcons!=null){for(var F=0;F<this.focusIcons.length;F++){this.focusIcons[F].destroy();}this.focusIcons=null;this.focusPoints=null;}this.focusIcons=[];this.focusPoints=[];for(var F=0;F<this.constraints.length;F++){var J=this.graph.getConnectionPoint(K.getState(),this.constraints[F]);var G=this.getImageForConstraint(K.getState(),this.constraints[F],J);var B=G.src;var A=new mxRectangle(J.x-G.width/2,J.y-G.height/2,G.width,G.height);var L=new mxImageShape(A,B);L.dialect=(this.graph.dialect==mxConstants.DIALECT_SVG)?mxConstants.DIALECT_SVG:mxConstants.DIALECT_VML;L.init(this.graph.getView().getOverlayPane());if(L.node.previousSibling!=null){L.node.parentNode.insertBefore(L.node,L.node.parentNode.firstChild);}var I=mxUtils.bind(this,function(){return(this.currentFocus!=null)?this.currentFocus:K.getState();});mxEvent.redirectMouseEvents(L.node,this.graph,I);this.currentFocusArea.add(L.bounds);this.focusIcons.push(L);this.focusPoints.push(J);}this.currentFocusArea.grow(M);}}else{if(this.focusIcons!=null){if(this.focusHighlight!=null){this.focusHighlight.destroy();this.focusHighlight=null;}for(var F=0;F<this.focusIcons.length;F++){this.focusIcons[F].destroy();}this.focusIcons=null;this.focusPoints=null;}}}}this.currentConstraint=null;this.currentPoint=null;if(this.focusIcons!=null&&this.constraints!=null&&(K.getState()==null||this.currentFocus==K.getState())){for(var F=0;F<this.focusIcons.length;F++){if(mxUtils.intersects(this.focusIcons[F].bounds,H)){this.currentConstraint=this.constraints[F];this.currentPoint=this.focusPoints[F];var E=this.focusIcons[F].bounds.clone();E.grow((false)?3:2);if(false){E.width-=1;E.height-=1;}if(this.focusHighlight==null){var D=new mxRectangleShape(E,null,this.highlightColor,3);D.dialect=(this.graph.dialect==mxConstants.DIALECT_SVG)?mxConstants.DIALECT_SVG:mxConstants.DIALECT_VML;D.init(this.graph.getView().getOverlayPane());this.focusHighlight=D;var I=mxUtils.bind(this,function(){return(this.currentFocus!=null)?this.currentFocus:K.getState();});mxEvent.redirectMouseEvents(D.node,this.graph,I);}else{this.focusHighlight.bounds=E;this.focusHighlight.redraw();}break;}}}if(this.currentConstraint==null&&this.focusHighlight!=null){this.focusHighlight.destroy();this.focusHighlight=null;}}};mxConstraintHandler.prototype.destroy=function(){this.reset();};function mxRubberband(A){if(A!=null){this.graph=A;this.graph.addMouseListener(this);if(false){mxEvent.addListener(window,"unload",mxUtils.bind(this,function(){this.destroy();}));}}}mxRubberband.prototype.defaultOpacity=20;mxRubberband.prototype.enabled=true;mxRubberband.prototype.isEnabled=function(){return this.enabled;};mxRubberband.prototype.setEnabled=function(A){this.enabled=A;};mxRubberband.prototype.mouseDown=function(B,C){if(!C.isConsumed()&&this.isEnabled()&&this.graph.isEnabled()&&(this.graph.isForceMarqueeEvent(C.getEvent())||C.getState()==null)){var D=mxUtils.getOffset(this.graph.container);var A=mxUtils.getScrollOrigin(this.graph.container);A.x-=D.x;A.y-=D.y;this.start(C.getX()+A.x,C.getY()+A.y);C.consume(false);}};mxRubberband.prototype.start=function(A,B){this.first=new mxPoint(A,B);};mxRubberband.prototype.mouseMove=function(B,C){if(!C.isConsumed()&&this.first!=null){var F=mxUtils.getScrollOrigin(this.graph.container);var A=mxUtils.getOffset(this.graph.container);F.x-=A.x;F.y-=A.y;var E=C.getX()+F.x;var D=C.getY()+F.y;var I=this.first.x-E;var H=this.first.y-D;var G=this.graph.tolerance;if(this.div!=null||Math.abs(I)>G||Math.abs(H)>G){if(this.div==null){this.div=this.createShape();}mxUtils.clearSelection();this.update(E,D);C.consume();}}};mxRubberband.prototype.createShape=function(){var A=document.createElement("div");A.className="mxRubberband";mxUtils.setOpacity(A,this.defaultOpacity);this.graph.container.appendChild(A);return A;};mxRubberband.prototype.mouseUp=function(A,C){var D=this.div!=null;this.reset();if(D){var B=new mxRectangle(this.x,this.y,this.width,this.height);this.graph.selectRegion(B,C.getEvent());C.consume();}};mxRubberband.prototype.reset=function(){if(this.div!=null){this.div.parentNode.removeChild(this.div);}this.div=null;this.first=null;};mxRubberband.prototype.update=function(A,B){this.x=Math.min(this.first.x,A);this.y=Math.min(this.first.y,B);this.width=Math.max(this.first.x,A)-this.x;this.height=Math.max(this.first.y,B)-this.y;this.div.style.left=this.x+"px";this.div.style.top=this.y+"px";this.div.style.width=Math.max(1,this.width)+"px";this.div.style.height=Math.max(1,this.height)+"px";};mxRubberband.prototype.destroy=function(){if(!this.destroyed){this.graph.removeMouseListener(this);this.reset();this.destroyed=true;}};function mxVertexHandler(A){if(A!=null){this.state=A;this.init();}}mxVertexHandler.prototype.graph=null;mxVertexHandler.prototype.state=null;mxVertexHandler.prototype.singleSizer=false;mxVertexHandler.prototype.index=null;mxVertexHandler.prototype.init=function(){this.graph=this.state.view.graph;this.bounds=this.getSelectionBounds(this.state);this.selectionBorder=this.createSelectionShape(this.bounds);this.selectionBorder.dialect=(this.graph.dialect!=mxConstants.DIALECT_SVG)?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG;this.selectionBorder.init(this.graph.getView().getOverlayPane());if(this.selectionBorder.dialect==mxConstants.DIALECT_SVG){this.selectionBorder.node.setAttribute("pointer-events","none");}else{this.selectionBorder.node.style.background="";}if(this.graph.isCellMovable(this.state.cell)){this.selectionBorder.node.style.cursor=mxConstants.CURSOR_MOVABLE_VERTEX;}mxEvent.redirectMouseEvents(this.selectionBorder.node,this.graph,this.state);if(mxGraphHandler.prototype.maxCells<=0||this.graph.getSelectionCount()<mxGraphHandler.prototype.maxCells){this.sizers=[];if(this.graph.isCellResizable(this.state.cell)){var A=0;if(!this.singleSizer){this.sizers.push(this.createSizer("nw-resize",A++));this.sizers.push(this.createSizer("n-resize",A++));this.sizers.push(this.createSizer("ne-resize",A++));this.sizers.push(this.createSizer("w-resize",A++));this.sizers.push(this.createSizer("e-resize",A++));this.sizers.push(this.createSizer("sw-resize",A++));this.sizers.push(this.createSizer("s-resize",A++));}this.sizers.push(this.createSizer("se-resize",A++));var B=this.graph.model.getGeometry(this.state.cell);if(B!=null&&!B.relative&&!this.graph.isSwimlane(this.state.cell)&&this.graph.isLabelMovable(this.state.cell)){this.labelShape=this.createSizer(mxConstants.CURSOR_LABEL_HANDLE,mxEvent.LABEL_HANDLE,mxConstants.LABEL_HANDLE_SIZE,mxConstants.LABEL_HANDLE_FILLCOLOR);this.sizers.push(this.labelShape);}}else{if(this.graph.isCellMovable(this.state.cell)&&!this.graph.isCellResizable(this.state.cell)&&this.state.width<2&&this.state.height<2){this.labelShape=this.createSizer(mxConstants.CURSOR_MOVABLE_VERTEX,null,null,mxConstants.LABEL_HANDLE_FILLCOLOR);this.sizers.push(this.labelShape);}}}this.redraw();};mxVertexHandler.prototype.getSelectionBounds=function(A){return new mxRectangle(A.x,A.y,A.width,A.height);};mxVertexHandler.prototype.createSelectionShape=function(B){var A=new mxRectangleShape(B,null,this.getSelectionColor());A.strokewidth=this.getSelectionStrokeWidth();A.isDashed=this.isSelectionDashed();return A;};mxVertexHandler.prototype.getSelectionColor=function(){return mxConstants.VERTEX_SELECTION_COLOR;};mxVertexHandler.prototype.getSelectionStrokeWidth=function(){return mxConstants.VERTEX_SELECTION_STROKEWIDTH;};mxVertexHandler.prototype.isSelectionDashed=function(){return mxConstants.VERTEX_SELECTION_DASHED;};mxVertexHandler.prototype.createSizer=function(E,A,B,F){B=B||mxConstants.HANDLE_SIZE;var C=new mxRectangle(0,0,B,B);var D=this.createSizerShape(C,A,F);if(this.state.text!=null&&this.state.text.node.parentNode==this.graph.container){D.bounds.height-=1;D.bounds.width-=1;D.dialect=mxConstants.DIALECT_STRICTHTML;D.init(this.graph.container);}else{D.dialect=(this.graph.dialect!=mxConstants.DIALECT_SVG)?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG;D.init(this.graph.getView().getOverlayPane());}D.node.style.cursor=E;mxEvent.redirectMouseEvents(D.node,this.graph,this.state);if(!this.isSizerVisible(A)){D.node.style.visibility="hidden";}return D;};mxVertexHandler.prototype.isSizerVisible=function(A){return true;};mxVertexHandler.prototype.createSizerShape=function(B,A,C){return new mxRectangleShape(B,C||mxConstants.HANDLE_FILLCOLOR,mxConstants.HANDLE_STROKECOLOR);};mxVertexHandler.prototype.moveSizerTo=function(B,A,C){if(B!=null){B.bounds.x=A-B.bounds.width/2;B.bounds.y=C-B.bounds.height/2;B.redraw();}};mxVertexHandler.prototype.getHandleForEvent=function(B){if(B.isSource(this.labelShape)){return mxEvent.LABEL_HANDLE;}if(this.sizers!=null){for(var A=0;A<this.sizers.length;A++){if(B.isSource(this.sizers[A])){return A;}}}return null;};mxVertexHandler.prototype.mouseDown=function(A,B){if(!B.isConsumed()&&this.graph.isEnabled()&&!this.graph.isForceMarqueeEvent(B.getEvent())&&B.getState()==this.state){var C=this.getHandleForEvent(B);if(C!=null){this.start(B.getX(),B.getY(),C);B.consume();}}};mxVertexHandler.prototype.start=function(A,D,B){var C=mxUtils.convertPoint(this.graph.container,A,D);this.startX=C.x;this.startY=C.y;this.index=B;this.selectionBorder.node.style.visibility="hidden";this.preview=this.createSelectionShape(this.bounds);if(this.state.text!=null&&this.state.text.node.parentNode==this.graph.container){this.preview.dialect=mxConstants.DIALECT_STRICTHTML;this.preview.init(this.graph.container);}else{this.preview.dialect=(this.graph.dialect!=mxConstants.DIALECT_SVG)?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG;this.preview.init(this.graph.view.getOverlayPane());}};mxVertexHandler.prototype.mouseMove=function(D,E){if(!E.isConsumed()&&this.index!=null){var A=mxUtils.convertPoint(this.graph.container,E.getX(),E.getY());var F=this.graph.isGridEnabledEvent(E.getEvent());var G=this.graph.getView().scale;if(this.index==mxEvent.LABEL_HANDLE){if(F){A.x=this.graph.snap(A.x/G)*G;A.y=this.graph.snap(A.y/G)*G;}this.moveSizerTo(this.sizers[8],A.x,A.y);E.consume();}else{if(this.index!=null){var C=A.x-this.startX;var B=A.y-this.startY;if(F){C=this.graph.snap(C/G)*G;B=this.graph.snap(B/G)*G;}this.bounds=this.union(this.state,C,B,this.index);this.drawPreview();E.consume();}}}};mxVertexHandler.prototype.mouseUp=function(D,E){if(!E.isConsumed()&&this.index!=null&&this.state!=null){var A=mxUtils.convertPoint(this.graph.container,E.getX(),E.getY());var F=this.graph.getView().scale;var C=(A.x-this.startX)/F;var B=(A.y-this.startY)/F;if(this.graph.isGridEnabledEvent(E.getEvent())){C=this.graph.snap(C);B=this.graph.snap(B);}this.resizeCell(this.state.cell,C,B,this.index);this.reset();E.consume();}};mxVertexHandler.prototype.reset=function(){this.index=null;if(this.preview!=null){this.preview.destroy();this.preview=null;}this.selectionBorder.node.style.visibility="visible";this.bounds=new mxRectangle(this.state.x,this.state.y,this.state.width,this.state.height);this.drawPreview();};mxVertexHandler.prototype.resizeCell=function(A,C,B,D){var F=this.graph.model.getGeometry(A);if(D==mxEvent.LABEL_HANDLE){F=F.clone();if(F.offset==null){F.offset=new mxPoint(C,B);}else{F.offset.x+=C;F.offset.y+=B;}this.graph.model.setGeometry(A,F);}else{var E=this.union(F,C,B,D);this.graph.resizeCell(A,E);}};mxVertexHandler.prototype.union=function(A,J,I,E){if(this.singleSizer){return new mxRectangle(A.x,A.y,Math.max(0,A.width+J),Math.max(0,A.height+I));}else{var D=A.x;var G=D+A.width;var F=A.y;var B=F+A.height;if(E>4){B=B+I;}else{if(E<3){F=F+I;}}if(E==0||E==3||E==5){D+=J;}else{if(E==2||E==4||E==7){G+=J;}}var C=G-D;var H=B-F;if(C<0){D+=C;C=Math.abs(C);}if(H<0){F+=H;H=Math.abs(H);}return new mxRectangle(D,F,C,H);}};mxVertexHandler.prototype.redraw=function(){this.bounds=new mxRectangle(this.state.x,this.state.y,this.state.width,this.state.height);if(this.sizers!=null){var C=this.state;var D=C.x+C.width;var B=C.y+C.height;if(this.singleSizer){this.moveSizerTo(this.sizers[0],D,B);}else{var A=C.x+C.width/2;var E=C.y+C.height/2;this.moveSizerTo(this.sizers[0],C.x,C.y);if(this.sizers.length>1){this.moveSizerTo(this.sizers[1],A,C.y);this.moveSizerTo(this.sizers[2],D,C.y);this.moveSizerTo(this.sizers[3],C.x,E);this.moveSizerTo(this.sizers[4],D,E);this.moveSizerTo(this.sizers[5],C.x,B);this.moveSizerTo(this.sizers[6],A,B);this.moveSizerTo(this.sizers[7],D,B);this.moveSizerTo(this.sizers[8],A+C.absoluteOffset.x,E+C.absoluteOffset.y);}}}this.drawPreview();};mxVertexHandler.prototype.drawPreview=function(){if(this.preview!=null){this.preview.bounds=this.bounds;if(this.preview.node.parentNode==this.graph.container){this.preview.bounds.width-=1;this.preview.bounds.height-=1;}this.preview.redraw();}this.selectionBorder.bounds=this.bounds;this.selectionBorder.redraw();};mxVertexHandler.prototype.destroy=function(){if(this.preview!=null){this.preview.destroy();this.preview=null;}this.selectionBorder.destroy();this.selectionBorder=null;this.labelShape=null;if(this.sizers!=null){for(var A=0;A<this.sizers.length;A++){this.sizers[A].destroy();this.sizers[A]=null;}}};function mxEdgeHandler(A){if(A!=null){this.state=A;this.init();}}mxEdgeHandler.prototype.graph=null;mxEdgeHandler.prototype.state=null;mxEdgeHandler.prototype.marker=null;mxEdgeHandler.prototype.constraintHandler=null;mxEdgeHandler.prototype.error=null;mxEdgeHandler.prototype.shape=null;mxEdgeHandler.prototype.bends=null;mxEdgeHandler.prototype.labelShape=null;mxEdgeHandler.prototype.cloneEnabled=true;mxEdgeHandler.prototype.addEnabled=false;mxEdgeHandler.prototype.removeEnabled=false;mxEdgeHandler.prototype.preferHtml=false;mxEdgeHandler.prototype.init=function(){this.graph=this.state.view.graph;this.marker=this.createMarker();this.constraintHandler=new mxConstraintHandler(this.graph);this.points=[];this.abspoints=this.getSelectionPoints(this.state);this.shape=this.createSelectionShape(this.abspoints);this.shape.dialect=(this.graph.dialect!=mxConstants.DIALECT_SVG)?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG;this.shape.init(this.graph.getView().getOverlayPane());this.shape.node.style.cursor=mxConstants.CURSOR_MOVABLE_EDGE;var D=(mxClient.IS_TOUCH)?"touchstart":"mousedown";var E=(mxClient.IS_TOUCH)?"touchmove":"mousemove";var A=(mxClient.IS_TOUCH)?"touchend":"mouseup";mxEvent.addListener(this.shape.node,"dblclick",mxUtils.bind(this,function(F){this.graph.dblClick(F,this.state.cell);}));mxEvent.addListener(this.shape.node,D,mxUtils.bind(this,function(F){if(this.addEnabled&&this.isAddPointEvent(F)){this.addPoint(this.state,F);}else{this.graph.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(F,this.state));}}));mxEvent.addListener(this.shape.node,E,mxUtils.bind(this,function(G){var F=this.state.cell;if(this.index!=null){var I=this.graph.isGridEnabledEvent(G);var H=mxUtils.convertPoint(this.graph.container,G.clientX,G.clientY,I);F=this.graph.getCellAt(H.x,H.y);if(this.graph.isSwimlane(F)&&this.graph.hitsSwimlaneContent(F,H.x,H.y)){F=null;}}this.graph.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(G,this.graph.getView().getState(F)));}));mxEvent.addListener(this.shape.node,A,mxUtils.bind(this,function(F){this.graph.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(F,this.state));}));this.preferHtml=this.state.text!=null&&this.state.text.node.parentNode==this.graph.container;if(!this.preferHtml){var B=this.graph.view.getState(this.graph.view.getVisibleTerminal(this.state.cell,true));if(B!=null){this.preferHtml=B.text!=null&&B.text.node.parentNode==this.graph.container;}if(!this.preferHtml){var C=this.graph.view.getState(this.graph.view.getVisibleTerminal(this.state.cell,false));if(C!=null){this.preferHtml=C.text!=null&&C.text.node.parentNode==this.graph.container;}}}if(this.graph.getSelectionCount()<mxGraphHandler.prototype.maxCells||mxGraphHandler.prototype.maxCells<=0){this.bends=this.createBends();}this.label=new mxPoint(this.state.absoluteOffset.x,this.state.absoluteOffset.y);this.labelShape=new mxRectangleShape(new mxRectangle(),mxConstants.LABEL_HANDLE_FILLCOLOR,mxConstants.HANDLE_STROKECOLOR);this.initBend(this.labelShape);this.labelShape.node.style.cursor=mxConstants.CURSOR_LABEL_HANDLE;mxEvent.redirectMouseEvents(this.labelShape.node,this.graph,this.state);this.redraw();};mxEdgeHandler.prototype.isAddPointEvent=function(A){return mxEvent.isShiftDown(A);};mxEdgeHandler.prototype.isRemovePointEvent=function(A){return mxEvent.isShiftDown(A);};mxEdgeHandler.prototype.getSelectionPoints=function(A){return A.absolutePoints;};mxEdgeHandler.prototype.createSelectionShape=function(B){var A=new mxPolyline(B,this.getSelectionColor());A.strokewidth=this.getSelectionStrokeWidth();A.isDashed=this.isSelectionDashed();return A;};mxEdgeHandler.prototype.getSelectionColor=function(){return mxConstants.EDGE_SELECTION_COLOR;};mxEdgeHandler.prototype.getSelectionStrokeWidth=function(){return mxConstants.EDGE_SELECTION_STROKEWIDTH;};mxEdgeHandler.prototype.isSelectionDashed=function(){return mxConstants.EDGE_SELECTION_DASHED;};mxEdgeHandler.prototype.createMarker=function(){var A=new mxCellMarker(this.graph);var B=this;A.getCell=function(E){var C=mxCellMarker.prototype.getCell.apply(this,arguments);var D=B.graph.getModel();if(C==B.state.cell||(C!=null&&!B.graph.connectableEdges&&D.isEdge(C))){C=null;}return C;};A.isValidState=function(F){var D=B.graph.getModel();var C=D.getTerminal(B.state.cell,!B.isSource);var E=(B.isSource)?F.cell:C;var G=(B.isSource)?C:F.cell;B.error=B.validateConnection(E,G);return B.error==null;};return A;};mxEdgeHandler.prototype.validateConnection=function(A,B){return this.graph.getEdgeValidationError(this.state.cell,A,B);};mxEdgeHandler.prototype.createBends=function(){var A=this.state.cell;var E=[];for(var D=0;D<this.abspoints.length;D++){if(this.isHandleVisible(D)){var F=D==0;var G=D==this.abspoints.length-1;var C=F||G;if(C||this.graph.isCellBendable(A)){var B=this.createHandleShape(D);this.initBend(B);if(this.isHandleEnabled(D)){B.node.style.cursor=mxConstants.CURSOR_BEND_HANDLE;mxEvent.redirectMouseEvents(B.node,this.graph,this.state);}E.push(B);if(!C){this.points.push(new mxPoint(0,0));B.node.style.visibility="hidden";}}}}return E;};mxEdgeHandler.prototype.isHandleEnabled=function(A){return true;};mxEdgeHandler.prototype.isHandleVisible=function(A){return !this.abspoints[A].isRouted;};mxEdgeHandler.prototype.createHandleShape=function(A){return new mxRectangleShape(new mxRectangle(),mxConstants.HANDLE_FILLCOLOR,mxConstants.HANDLE_STROKECOLOR);};mxEdgeHandler.prototype.initBend=function(A){if(this.preferHtml){A.dialect=mxConstants.DIALECT_STRICTHTML;A.init(this.graph.container);}else{A.dialect=(this.graph.dialect!=mxConstants.DIALECT_SVG)?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG;A.init(this.graph.getView().getOverlayPane());}};mxEdgeHandler.prototype.getHandleForEvent=function(B){if(this.bends!=null){for(var A=0;A<this.bends.length;A++){if(B.isSource(this.bends[A])){return A;}}}if(B.isSource(this.labelShape)||B.isSource(this.state.text)){return mxEvent.LABEL_HANDLE;}return null;};mxEdgeHandler.prototype.mouseDown=function(A,B){var C=null;if(true||B.getState()==this.state){C=this.getHandleForEvent(B);}if(!B.isConsumed()&&this.graph.isEnabled()&&!this.graph.isForceMarqueeEvent(B.getEvent())&&C!=null){if(this.removeEnabled&&this.isRemovePointEvent(B.getEvent())){this.removePoint(this.state,C);}else{if(C!=mxEvent.LABEL_HANDLE||this.graph.isLabelMovable(B.getCell())){this.start(B.getX(),B.getY(),C);}}B.consume();}};mxEdgeHandler.prototype.start=function(B,G,D){this.startX=B;this.startY=G;this.isSource=(this.bends==null)?false:D==0;this.isTarget=(this.bends==null)?false:D==this.bends.length-1;this.isLabel=D==mxEvent.LABEL_HANDLE;if(this.isSource||this.isTarget){var A=this.state.cell;var E=this.graph.model.getTerminal(A,this.isSource);if(E==null||this.graph.isCellDisconnectable(A,E,this.isSource)){var F=this.abspoints[0];var C=this.abspoints[this.abspoints.length-1];this.abspoints=[];this.abspoints.push(F);this.abspoints.push(C);this.index=D;}}else{this.index=D;}};mxEdgeHandler.prototype.mouseMove=function(C,P){if(this.index!=null&&this.marker!=null){var N=this.graph.isGridEnabledEvent(P.getEvent());var I=mxUtils.convertPoint(this.graph.container,P.getX(),P.getY(),N);if(N){var F=this.graph.getView();var R=F.scale;I.x=this.graph.snap(I.x/R)*R;I.y=this.graph.snap(I.y/R)*R;}if(this.isLabel){this.label.x=I.x;this.label.y=I.y;}else{var M=this.state.clone();var E=this.graph.getCellGeometry(this.state.cell);var K=E.points;var H=null;var Q=null;if(this.isSource||this.isTarget){this.constraintHandler.update(P,this.isSource);this.marker.process(P);var S=this.marker.getValidState();Q=this.graph.getView().getVisibleTerminal(this.state.cell,!this.isSource);if(this.constraintHandler.currentFocus!=null&&this.constraintHandler.currentConstraint!=null){this.marker.reset();}if(S!=null){H=S.cell;}else{if(this.constraintHandler.currentFocus!=null){H=this.constraintHandler.currentFocus.cell;}else{M.setAbsoluteTerminalPoint(I,this.isSource);if(this.marker.getMarkedState()==null){this.error=(this.graph.allowDanglingEdges)?null:"";}}}if(!this.isSource){var O=H;H=Q;Q=O;}}else{this.convertPoint(I,N);if(K==null){K=[I];}else{K[this.index-1]=I;}this.points=K;this.active=true;H=M.view.getVisibleTerminal(this.state.cell,true);Q=M.view.getVisibleTerminal(this.state.cell,false);}var D=M.view.getState(H);var L=M.view.getState(Q);var B=this.graph.getConnectionConstraint(M,D,true);var G=this.graph.getConnectionConstraint(M,L,false);var A=this.constraintHandler.currentConstraint;if(A==null){A=new mxConnectionConstraint();}if(this.isSource){B=A;}else{if(this.isTarget){G=A;}}if(!this.isSource||D!=null){M.view.updateFixedTerminalPoint(M,D,true,B);}if(!this.isTarget||L!=null){M.view.updateFixedTerminalPoint(M,L,false,G);}M.view.updatePoints(M,K,D,L);M.view.updateFloatingTerminalPoints(M,D,L);var J=(this.error==null)?this.marker.validColor:this.marker.invalidColor;this.setPreviewColor(J);this.abspoints=M.absolutePoints;}this.drawPreview();mxEvent.consume(P.getEvent());P.consume();}};mxEdgeHandler.prototype.mouseUp=function(B,D){if(this.index!=null&&this.marker!=null){var C=this.state.cell;if(D.getX()!=this.startX||D.getY()!=this.startY){if(this.error!=null){if(this.error.length>0){this.graph.validationAlert(this.error);}}else{if(this.isLabel){this.moveLabel(this.state,this.label.x,this.label.y);}else{if(this.isSource||this.isTarget){var A=null;if(this.constraintHandler.currentFocus!=null){A=this.constraintHandler.currentFocus.cell;}if(A==null&&this.marker.hasValidState()){A=this.marker.validState.cell;}if(A!=null){var C=this.connect(C,A,this.isSource,this.graph.isCloneEvent(D.getEvent())&&this.cloneEnabled&&this.graph.isCellsCloneable(),D);}else{if(this.graph.isAllowDanglingEdges()){var F=this.graph.getPointForEvent(D.getEvent());var E=this.graph.getView().getState(this.graph.getModel().getParent(C));if(E!=null){F.x-=E.origin.x;F.y-=E.origin.y;}this.changeTerminalPoint(C,F,this.isSource);}}}else{if(this.active){this.changePoints(C,this.points);}else{this.graph.getView().invalidate(this.state.cell);this.graph.getView().revalidate(this.state.cell);}}}}this.abspoints=this.state.absolutePoints;}if(this.marker!=null){this.reset();if(C!=this.state.cell){this.graph.setSelectionCell(C);}}D.consume();}};mxEdgeHandler.prototype.reset=function(){this.error=null;this.index=null;this.label=null;this.active=false;this.isLabel=false;this.isSource=false;this.isTarget=false;this.marker.reset();this.constraintHandler.reset();this.setPreviewColor(mxConstants.EDGE_SELECTION_COLOR);this.redraw();};mxEdgeHandler.prototype.setPreviewColor=function(A){if(this.shape!=null&&this.shape.node!=null){if(this.shape.dialect==mxConstants.DIALECT_SVG){this.shape.innerNode.setAttribute("stroke",A);}else{this.shape.node.setAttribute("strokecolor",A);}}};mxEdgeHandler.prototype.convertPoint=function(A,D){var E=this.graph.getView().getScale();var C=this.graph.getView().getTranslate();if(D){A.x=this.graph.snap(A.x);A.y=this.graph.snap(A.y);}A.x=A.x/E-C.x;A.y=A.y/E-C.y;var B=this.graph.getView().getState(this.graph.getModel().getParent(this.state.cell));if(B!=null){A.x-=B.origin.x;A.y-=B.origin.y;}return A;};mxEdgeHandler.prototype.moveLabel=function(B,A,G){var C=this.graph.getModel();var F=C.getGeometry(B.cell);if(F!=null){F=F.clone();var D=this.graph.getView().getRelativePoint(B,A,G);F.x=D.x;F.y=D.y;var E=this.graph.getView().scale;F.offset=new mxPoint(0,0);var D=this.graph.view.getPoint(B,F);F.offset=new mxPoint((A-D.x)/E,(G-D.y)/E);C.setGeometry(B.cell,F);}};mxEdgeHandler.prototype.connect=function(B,D,G,F,I){var C=this.graph.getModel();var J=C.getParent(B);C.beginUpdate();try{if(F){var H=B.clone();C.add(J,H,C.getChildCount(J));var E=C.getTerminal(B,!G);this.graph.connectCell(H,E,!G);B=H;}var A=this.constraintHandler.currentConstraint;if(A==null){A=new mxConnectionConstraint();}this.graph.connectCell(B,D,G,A);}finally{C.endUpdate();}return B;};mxEdgeHandler.prototype.changeTerminalPoint=function(D,A,C){var B=this.graph.getModel();var E=B.getGeometry(D);if(E!=null){B.beginUpdate();try{E=E.clone();E.setTerminalPoint(A,C);B.setGeometry(D,E);this.graph.connectCell(D,null,C,new mxConnectionConstraint());}finally{B.endUpdate();}}};mxEdgeHandler.prototype.changePoints=function(C,B){var A=this.graph.getModel();var D=A.getGeometry(C);if(D!=null){D=D.clone();D.points=B;A.setGeometry(C,D);}};mxEdgeHandler.prototype.addPoint=function(C,A){var F=this.graph.getCellGeometry(C.cell);if(F!=null){F=F.clone();var E=mxUtils.convertPoint(this.graph.container,A.clientX,A.clientY);var B=mxUtils.findNearestSegment(C,E.x,E.y);var D=this.graph.isGridEnabledEvent(A);this.convertPoint(E,D);if(F.points==null){F.points=[E];}else{F.points.splice(B,0,E);}this.graph.getModel().setGeometry(C.cell,F);this.destroy();this.init();mxEvent.consume(A);}};mxEdgeHandler.prototype.removePoint=function(B,A){if(A>0&&A<this.abspoints.length-1){var C=this.graph.getCellGeometry(this.state.cell);if(C!=null&&C.points!=null){C=C.clone();C.points.splice(A-1,1);this.graph.getModel().setGeometry(B.cell,C);this.destroy();this.init();}}};mxEdgeHandler.prototype.getHandleFillColor=function(C){var E=C==0;var A=this.state.cell;var D=this.graph.getModel().getTerminal(A,E);var B=mxConstants.HANDLE_FILLCOLOR;if(D!=null){if(this.graph.isCellDisconnectable(A,D,E)){B=mxConstants.CONNECT_HANDLE_FILLCOLOR;}else{B=mxConstants.LOCKED_HANDLE_FILLCOLOR;}}return B;};mxEdgeHandler.prototype.redraw=function(){this.abspoints=this.state.absolutePoints;var J=this.state.cell;var L=mxConstants.LABEL_HANDLE_SIZE;this.label=new mxPoint(this.state.absoluteOffset.x,this.state.absoluteOffset.y);this.labelShape.bounds=new mxRectangle(this.label.x-L/2,this.label.y-L/2,L,L);this.labelShape.redraw();var F=this.graph.getLabel(J);if(F!=null&&F.length>0&&this.graph.isLabelMovable(J)){this.labelShape.node.style.visibility="visible";}else{this.labelShape.node.style.visibility="hidden";}if(this.bends!=null&&this.bends.length>0){var G=this.graph.getModel();L=mxConstants.HANDLE_SIZE;if(this.preferHtml){L-=1;}var D=this.abspoints.length-1;var K=this.abspoints[0];var C=this.abspoints[0].x;var I=this.abspoints[0].y;this.bends[0].bounds=new mxRectangle(C-L/2,I-L/2,L,L);this.bends[0].fill=this.getHandleFillColor(0);this.bends[0].reconfigure();this.bends[0].redraw();var H=this.abspoints[D];var E=this.abspoints[D].x;var B=this.abspoints[D].y;var A=this.bends.length-1;this.bends[A].bounds=new mxRectangle(E-L/2,B-L/2,L,L);this.bends[A].fill=this.getHandleFillColor(A);this.bends[A].reconfigure();this.bends[A].redraw();this.redrawInnerBends(K,H);}this.drawPreview();};mxEdgeHandler.prototype.redrawInnerBends=function(H,B){var D=mxConstants.HANDLE_SIZE;var E=this.graph.getModel().getGeometry(this.state.cell);var F=E.points;if(F!=null){for(var C=1;C<this.bends.length-1;C++){if(this.abspoints[C]!=null){var A=this.abspoints[C].x;var G=this.abspoints[C].y;this.bends[C].node.style.visibility="visible";this.bends[C].bounds=new mxRectangle(A-D/2,G-D/2,D,D);this.bends[C].redraw();this.points[C-1]=F[C-1];}else{if(this.bends[C]!=null){this.bends[C].destroy();this.bends[C]=null;}}}}};mxEdgeHandler.prototype.drawPreview=function(){if(this.isLabel){var A=mxConstants.LABEL_HANDLE_SIZE;var B=new mxRectangle(this.label.x-A/2,this.label.y-A/2,A,A);this.labelShape.bounds=B;this.labelShape.redraw();}else{this.shape.points=this.abspoints;this.shape.redraw();}mxUtils.repaintGraph(this.graph,this.shape.points[this.shape.points.length-1]);};mxEdgeHandler.prototype.destroy=function(){this.marker.destroy();this.marker=null;this.shape.destroy();this.shape=null;this.labelShape.destroy();this.labelShape=null;if(this.constraintHandler!=null){this.constraintHandler.destroy();this.constraintHandler=null;}if(this.bends!=null){for(var A=0;A<this.bends.length;A++){if(this.bends[A]!=null){this.bends[A].destroy();this.bends[A]=null;}}}};function mxElbowEdgeHandler(A){if(A!=null){this.state=A;this.init();}}mxElbowEdgeHandler.prototype=new mxEdgeHandler();mxElbowEdgeHandler.prototype.constructor=mxElbowEdgeHandler;mxElbowEdgeHandler.prototype.flipEnabled=true;mxElbowEdgeHandler.prototype.doubleClickOrientationResource=(mxClient.language!="none")?"doubleClickOrientation":"";mxElbowEdgeHandler.prototype.createBends=function(){var B=[];var A=new mxRectangleShape(new mxRectangle(),mxConstants.HANDLE_FILLCOLOR,mxConstants.HANDLE_STROKECOLOR);this.initBend(A);A.node.style.cursor=mxConstants.CURSOR_BEND_HANDLE;mxEvent.redirectMouseEvents(A.node,this.graph,this.state);B.push(A);B.push(this.createVirtualBend());this.points.push(new mxPoint(0,0));A=new mxRectangleShape(new mxRectangle(),mxConstants.HANDLE_FILLCOLOR,mxConstants.HANDLE_STROKECOLOR);this.initBend(A);A.node.style.cursor=mxConstants.CURSOR_BEND_HANDLE;mxEvent.redirectMouseEvents(A.node,this.graph,this.state);B.push(A);return B;};mxElbowEdgeHandler.prototype.createVirtualBend=function(){var C=new mxRectangleShape(new mxRectangle(0,0,1,1),mxConstants.HANDLE_FILLCOLOR,mxConstants.HANDLE_STROKECOLOR);this.initBend(C);var A=this.getCursorForBend();C.node.style.cursor=A;var B=mxUtils.bind(this,function(D){if(!mxEvent.isConsumed(D)&&this.flipEnabled){this.graph.flipEdge(this.state.cell,D);mxEvent.consume(D);}});mxEvent.redirectMouseEvents(C.node,this.graph,this.state,null,null,null,B);if(!this.graph.isCellBendable(this.state.cell)){C.node.style.visibility="hidden";}return C;};mxElbowEdgeHandler.prototype.getCursorForBend=function(){return(this.state.style[mxConstants.STYLE_EDGE]==mxEdgeStyle.TopToBottom||this.state.style[mxConstants.STYLE_EDGE]==mxConstants.EDGESTYLE_TOPTOBOTTOM||((this.state.style[mxConstants.STYLE_EDGE]==mxEdgeStyle.ElbowConnector||this.state.style[mxConstants.STYLE_EDGE]==mxConstants.EDGESTYLE_ELBOW)&&this.state.style[mxConstants.STYLE_ELBOW]==mxConstants.ELBOW_VERTICAL))?"row-resize":"col-resize";};mxElbowEdgeHandler.prototype.getTooltipForNode=function(A){var B=null;if(this.bends!=null&&this.bends[1]!=null&&(A==this.bends[1].node||A.parentNode==this.bends[1].node)){B=this.doubleClickOrientationResource;B=mxResources.get(B)||B;}return B;};mxElbowEdgeHandler.prototype.convertPoint=function(A,D){var E=this.graph.getView().getScale();var C=this.graph.getView().getTranslate();var B=this.state.origin;if(D){A.x=this.graph.snap(A.x);A.y=this.graph.snap(A.y);}A.x=A.x/E-C.x-B.x;A.y=A.y/E-C.y-B.y;};mxElbowEdgeHandler.prototype.redrawInnerBends=function(G,A){var B=mxConstants.HANDLE_SIZE;var D=this.graph.getModel().getGeometry(this.state.cell);var F=D.points;var E=(F!=null)?F[0]:null;if(E==null){E=new mxPoint(G.x+(A.x-G.x)/2,G.y+(A.y-G.y)/2);}else{E=new mxPoint(this.graph.getView().scale*(E.x+this.graph.getView().translate.x+this.state.origin.x),this.graph.getView().scale*(E.y+this.graph.getView().translate.y+this.state.origin.y));}var C=new mxRectangle(E.x-B/2,E.y-B/2,B,B);if(this.labelShape.node.style.visibility!="hidden"&&mxUtils.intersects(C,this.labelShape.bounds)){B+=3;C=new mxRectangle(E.x-B/2,E.y-B/2,B,B);}this.bends[1].bounds=C;this.bends[1].reconfigure();this.bends[1].redraw();};function mxKeyHandler(A,B){if(A!=null){this.graph=A;this.target=B||document.documentElement;this.normalKeys=[];this.controlKeys=[];mxEvent.addListener(this.target,"keydown",mxUtils.bind(this,function(C){this.keyDown(C);}));if(false){mxEvent.addListener(window,"unload",mxUtils.bind(this,function(){this.destroy();}));}}}mxKeyHandler.prototype.graph=null;mxKeyHandler.prototype.target=null;mxKeyHandler.prototype.normalKeys=null;mxKeyHandler.prototype.controlKeys=null;mxKeyHandler.prototype.enabled=true;mxKeyHandler.prototype.isEnabled=function(){return this.enabled;};mxKeyHandler.prototype.setEnabled=function(A){this.enabled=A;};mxKeyHandler.prototype.bindKey=function(B,A){this.normalKeys[B]=A;};mxKeyHandler.prototype.bindControlKey=function(B,A){this.controlKeys[B]=A;};mxKeyHandler.prototype.getFunction=function(A){if(A!=null){return(mxEvent.isControlDown(A))?this.controlKeys[A.keyCode]:this.normalKeys[A.keyCode];}return null;};mxKeyHandler.prototype.isGraphEvent=function(A){var C=mxEvent.getSource(A);if((C==this.target||C.parentNode==this.target)||(this.graph.cellEditor!=null&&C==this.graph.cellEditor.textarea)){return true;}var B=C;while(B!=null){if(B==this.graph.container){return true;}B=B.parentNode;}return false;};mxKeyHandler.prototype.keyDown=function(A){if(this.graph.isEnabled()&&!mxEvent.isConsumed(A)&&this.isGraphEvent(A)&&this.isEnabled()){if(A.keyCode==27){this.escape(A);}else{if(!this.graph.isEditing()){var B=this.getFunction(A);if(B!=null){B(A);mxEvent.consume(A);}}}}};mxKeyHandler.prototype.escape=function(A){if(this.graph.isEscapeEnabled()){this.graph.escape(A);}};mxKeyHandler.prototype.destroy=function(){this.target=null;};function mxTooltipHandler(B,A){if(B!=null){this.graph=B;this.delay=A||500;this.graph.addMouseListener(this);}}mxTooltipHandler.prototype.zIndex=10005;mxTooltipHandler.prototype.graph=null;mxTooltipHandler.prototype.delay=null;mxTooltipHandler.prototype.hideOnHover=false;mxTooltipHandler.prototype.enabled=true;mxTooltipHandler.prototype.isEnabled=function(){return this.enabled;};mxTooltipHandler.prototype.setEnabled=function(A){this.enabled=A;};mxTooltipHandler.prototype.isHideOnHover=function(){return this.hideOnHover;};mxTooltipHandler.prototype.setHideOnHover=function(A){this.hideOnHover=A;};mxTooltipHandler.prototype.init=function(){if(document.body!=null){this.div=document.createElement("div");this.div.className="mxTooltip";this.div.style.visibility="hidden";this.div.style.zIndex=this.zIndex;if(!false&&mxClient.TOOLTIP_SHADOWS){this.shadow=document.createElement("div");this.shadow.className="mxTooltipShadow";this.shadow.style.visibility="hidden";this.shadow.style.zIndex=this.zIndex;mxUtils.setOpacity(this.shadow,70);document.body.appendChild(this.shadow);}else{if(false&&!mxClient.TOOLTIP_SHADOWS){this.div.style.filter="";}}document.body.appendChild(this.div);mxEvent.addListener(this.div,"mousedown",mxUtils.bind(this,function(A){this.hide();}));}};mxTooltipHandler.prototype.mouseDown=function(A,B){this.reset(B,false);this.hide();};mxTooltipHandler.prototype.mouseMove=function(A,B){if(B.getX()!=this.lastX||B.getY()!=this.lastY){this.reset(B,true);if(this.isHideOnHover()||B.getState()!=this.state||(B.getSource()!=this.node&&(!this.stateSource||(B.getState()!=null&&this.stateSource==(B.isSource(B.getState().shape)||!B.isSource(B.getState().text)))))){this.hide();}}this.lastX=B.getX();this.lastY=B.getY();};mxTooltipHandler.prototype.mouseUp=function(A,B){this.reset(B,true);this.hide();};mxTooltipHandler.prototype.reset=function(D,B){if(this.thread!=null){window.clearTimeout(this.thread);this.thread=null;}if(B&&this.isEnabled()&&D.getState()!=null&&(this.div==null||this.div.style.visibility=="hidden")){var E=D.getState();var C=D.getSource();var A=D.getX();var G=D.getY();var F=D.isSource(E.shape)||D.isSource(E.text);this.thread=window.setTimeout(mxUtils.bind(this,function(){if(!this.graph.isEditing()&&!this.graph.panningHandler.isMenuShowing()){var H=this.graph.getTooltip(E,C,A,G);this.show(H,A,G);this.state=E;this.node=C;this.stateSource=F;}}),this.delay);}};mxTooltipHandler.prototype.hide=function(){if(this.shadow!=null){this.shadow.style.visibility="hidden";}if(this.div!=null){this.div.style.visibility="hidden";}};mxTooltipHandler.prototype.show=function(C,A,D){if(C!=null&&C.length>0){if(this.div==null){this.init();}var B=mxUtils.getScrollOrigin();this.div.style.left=(A+B.x)+"px";this.div.style.top=(D+mxConstants.TOOLTIP_VERTICAL_OFFSET+B.y)+"px";if(!mxUtils.isNode(C)){this.div.innerHTML=C.replace(/\n/g,"<br>");}else{this.div.innerHTML="";this.div.appendChild(C);}this.div.style.visibility="";mxUtils.fit(this.div);if(this.shadow!=null){this.shadow.style.width=this.div.offsetWidth+"px";this.shadow.style.height=this.div.offsetHeight+"px";this.shadow.style.left=(parseInt(this.div.style.left)+3)+"px";this.shadow.style.top=(parseInt(this.div.style.top)+3)+"px";this.shadow.style.visibility="";}}};mxTooltipHandler.prototype.destroy=function(){this.graph.removeMouseListener(this);mxEvent.release(this.div);if(this.div!=null&&this.div.parentNode!=null){this.div.parentNode.removeChild(this.div);}this.div=null;if(this.shadow!=null){mxEvent.release(this.shadow);if(this.shadow.parentNode!=null){this.shadow.parentNode.removeChild(this.shadow);}this.shadow=null;}};function mxCellTracker(C,B,A){mxCellMarker.call(this,C,B);this.graph.addMouseListener(this);if(A!=null){this.getCell=A;}if(false){mxEvent.addListener(window,"unload",mxUtils.bind(this,function(){this.destroy();}));}}mxCellTracker.prototype=new mxCellMarker();mxCellTracker.prototype.constructor=mxCellTracker;mxCellTracker.prototype.mouseDown=function(A,B){};mxCellTracker.prototype.mouseMove=function(A,B){if(this.isEnabled()){this.process(B);}};mxCellTracker.prototype.mouseUp=function(A,B){this.reset();};mxCellTracker.prototype.destroy=function(){if(!this.destroyed){this.destroyed=true;this.graph.removeMouseListener(this);mxCellMarker.prototype.destroy.apply(this);}};function mxCellHighlight(A,C,B){if(A!=null){this.graph=A;this.highlightColor=(C!=null)?C:mxConstants.DEFAULT_VALID_COLOR;this.strokeWidth=(B!=null)?B:mxConstants.HIGHLIGHT_STROKEWIDTH;this.resetHandler=mxUtils.bind(this,function(D){this.hide();});this.graph.getView().addListener(mxEvent.SCALE,this.resetHandler);this.graph.getView().addListener(mxEvent.TRANSLATE,this.resetHandler);this.graph.getView().addListener(mxEvent.SCALE_AND_TRANSLATE,this.resetHandler);this.graph.getView().addListener(mxEvent.DOWN,this.resetHandler);this.graph.getView().addListener(mxEvent.UP,this.resetHandler);this.graph.getModel().addListener(mxEvent.CHANGE,this.resetHandler);}}mxCellHighlight.prototype.keepOnTop=false;mxCellHighlight.prototype.graph=true;mxCellHighlight.prototype.state=null;mxCellHighlight.prototype.resetHandler=null;mxCellHighlight.prototype.setHighlightColor=function(A){this.highlightColor=A;if(this.shape!=null){if(this.shape.dialect==mxConstants.DIALECT_SVG){this.shape.innerNode.setAttribute("stroke",A);}else{if(this.shape.dialect==mxConstants.DIALECT_VML){this.shape.node.setAttribute("strokecolor",A);}}}};mxCellHighlight.prototype.createShape=function(B){var A=null;if(this.graph.model.isEdge(B.cell)){A=new mxPolyline(B.absolutePoints,this.highlightColor,this.strokeWidth);}else{A=new mxRectangleShape(new mxRectangle(B.x-2,B.y-2,B.width+4,B.height+4),null,this.highlightColor,this.strokeWidth);}A.dialect=(this.graph.dialect!=mxConstants.DIALECT_SVG)?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG;A.init(this.graph.getView().getOverlayPane());mxEvent.redirectMouseEvents(A.node,this.graph,B);if(A.dialect==mxConstants.DIALECT_SVG){A.node.setAttribute("style","pointer-events:none;");}else{A.node.style.background="";}if(!this.keepOnTop&&A.node.parentNode.firstChild!=A.node){A.node.parentNode.insertBefore(A.node,A.node.parentNode.firstChild);}if(this.graph.model.isEdge(B.cell)){mxUtils.repaintGraph(this.graph,A.points[0]);}return A;};mxCellHighlight.prototype.hide=function(){this.highlight(null);};mxCellHighlight.prototype.highlight=function(A){if(this.state!=A){if(this.shape!=null){this.shape.destroy();this.shape=null;}if(A!=null){this.shape=this.createShape(A);}this.state=A;}};mxCellHighlight.prototype.destroy=function(){this.graph.getView().removeListener(this.resetHandler);this.graph.getModel().removeListener(this.resetHandler);if(this.shape!=null){this.shape.destroy();this.shape=null;}};function mxDefaultKeyHandler(B){if(B!=null){this.editor=B;this.handler=new mxKeyHandler(B.graph);var A=this.handler.escape;this.handler.escape=function(C){A.apply(this,arguments);B.hideProperties();B.fireEvent(new mxEventObject(mxEvent.ESCAPE,"event",C));};}}mxDefaultKeyHandler.prototype.editor=null;mxDefaultKeyHandler.prototype.handler=null;mxDefaultKeyHandler.prototype.bindAction=function(A,B,D){var C=mxUtils.bind(this,function(){this.editor.execute(B);});if(D){this.handler.bindControlKey(A,C);}else{this.handler.bindKey(A,C);}};mxDefaultKeyHandler.prototype.destroy=function(){this.handler.destroy();this.handler=null;};function mxDefaultPopupMenu(A){this.config=A;}mxDefaultPopupMenu.prototype.imageBasePath=null;mxDefaultPopupMenu.prototype.config=null;mxDefaultPopupMenu.prototype.createMenu=function(C,F,A,B){if(this.config!=null){var E=this.createConditions(C,A,B);var D=this.config.firstChild;this.addItems(C,F,A,B,E,D,null);}};mxDefaultPopupMenu.prototype.addItems=function(editor,menu,cell,evt,conditions,item,parent){var addSeparator=false;while(item!=null){if(item.nodeName=="add"){var condition=item.getAttribute("if");if(condition==null||conditions[condition]){var as=item.getAttribute("as");as=mxResources.get(as)||as;var funct=mxUtils.eval(mxUtils.getTextContent(item));var action=item.getAttribute("action");var icon=item.getAttribute("icon");if(addSeparator){menu.addSeparator(parent);addSeparator=false;}if(icon!=null&&this.imageBasePath){icon=this.imageBasePath+icon;}var row=this.addAction(menu,editor,as,icon,funct,action,cell,parent);this.addItems(editor,menu,cell,evt,conditions,item.firstChild,row);}}else{if(item.nodeName=="separator"){addSeparator=true;}}item=item.nextSibling;}};mxDefaultPopupMenu.prototype.addAction=function(B,E,D,G,A,C,I,H){var F=function(J){if(typeof (A)=="function"){A.call(E,E,I,J);}if(C!=null){E.execute(C,I,J);}};return B.addItem(D,G,F,H);};mxDefaultPopupMenu.prototype.createConditions=function(editor,cell,evt){var model=editor.graph.getModel();var childCount=model.getChildCount(cell);var conditions=[];conditions.nocell=cell==null;conditions.ncells=editor.graph.getSelectionCount()>1;conditions.notRoot=model.getRoot()!=model.getParent(editor.graph.getDefaultParent());conditions.cell=cell!=null;var isCell=cell!=null&&editor.graph.getSelectionCount()==1;conditions.oneCell=isCell;conditions.nonEmpty=isCell&&childCount>0;conditions.expandable=isCell&&editor.graph.isCellFoldable(cell,false);conditions.collapsable=isCell&&editor.graph.isCellFoldable(cell,true);conditions.validRoot=isCell&&editor.graph.isValidRoot(cell);conditions.emptyValidRoot=conditions.validRoot&&childCount==0;conditions.swimlane=isCell&&editor.graph.isSwimlane(cell);var condNodes=this.config.getElementsByTagName("condition");for(var i=0;i<condNodes.length;i++){var funct=mxUtils.eval(mxUtils.getTextContent(condNodes[i]));var name=condNodes[i].getAttribute("name");if(name!=null&&typeof (funct)=="function"){conditions[name]=funct(editor,cell,evt);}}return conditions;};function mxDefaultToolbar(A,B){this.editor=B;if(A!=null&&B!=null){this.init(A);}}mxDefaultToolbar.prototype.editor=null;mxDefaultToolbar.prototype.toolbar=null;mxDefaultToolbar.prototype.resetHandler=null;mxDefaultToolbar.prototype.spacing=4;mxDefaultToolbar.prototype.connectOnDrop=false;mxDefaultToolbar.prototype.init=function(A){if(A!=null){this.toolbar=new mxToolbar(A);this.toolbar.addListener(mxEvent.SELECT,mxUtils.bind(this,function(D,C){var B=C.getProperty("function");if(B!=null){this.editor.insertFunction=mxUtils.bind(this,function(){B.apply(this,arguments);this.toolbar.resetMode();});}else{this.editor.insertFunction=null;}}));this.resetHandler=mxUtils.bind(this,function(){if(this.toolbar!=null){this.toolbar.resetMode(true);}});this.editor.graph.addListener(mxEvent.DOUBLE_CLICK,this.resetHandler);this.editor.addListener(mxEvent.ESCAPE,this.resetHandler);}};mxDefaultToolbar.prototype.addItem=function(D,A,C,B){var E=mxUtils.bind(this,function(){this.editor.execute(C);});return this.toolbar.addItem(D,A,E,B);};mxDefaultToolbar.prototype.addSeparator=function(A){A=A||mxClient.imageBasePath+"/separator.gif";this.toolbar.addSeparator(A);};mxDefaultToolbar.prototype.addCombo=function(){return this.toolbar.addCombo();};mxDefaultToolbar.prototype.addActionCombo=function(A){return this.toolbar.addActionCombo(A);};mxDefaultToolbar.prototype.addActionOption=function(B,C,A){var D=mxUtils.bind(this,function(){this.editor.execute(A);});this.addOption(B,C,D);};mxDefaultToolbar.prototype.addOption=function(B,C,A){return this.toolbar.addOption(B,C,A);};mxDefaultToolbar.prototype.addMode=function(E,B,D,C,A){var F=mxUtils.bind(this,function(){this.editor.setMode(D);if(A!=null){A(this.editor);}});return this.toolbar.addSwitchMode(E,B,F,C);};mxDefaultToolbar.prototype.addPrototype=function(G,F,I,B,H){var C=null;if(I==null){C=this.toolbar.addMode(G,F,null,B);}else{var D=function(){if(typeof (I)=="function"){return I();}else{return I.clone();}};var E=mxUtils.bind(this,function(K,J){if(typeof (H)=="function"){H(this.editor,D(),K,J);}else{this.drop(D(),K,J);}this.toolbar.resetMode();mxEvent.consume(K);});C=this.toolbar.addMode(G,F,E,B);var A=function(L,K,J){};this.installDropHandler(C,A);}return C;};mxDefaultToolbar.prototype.drop=function(D,A,E){var C=this.editor.graph;var B=C.getModel();if(E==null||B.isEdge(E)||!this.connectOnDrop||!C.isCellConnectable(E)){while(E!=null&&!C.isValidDropTarget(E,[D],A)){E=B.getParent(E);}this.insert(D,A,E);}else{this.connect(D,A,E);}};mxDefaultToolbar.prototype.insert=function(D,B,F){var C=this.editor.graph;if(C.canImportCell(D)){var A=mxEvent.getClientX(B);var G=mxEvent.getClientY(B);var E=mxUtils.convertPoint(C.container,A,G);if(C.isSplitEnabled()&&C.isSplitTarget(F,[D],B)){return C.splitEdge(F,[D],null,E.x,E.y);}else{return this.editor.addVertex(F,D,E.x,E.y);}}return null;};mxDefaultToolbar.prototype.connect=function(F,K,A){var L=this.editor.graph;var E=L.getModel();if(A!=null&&L.isCellConnectable(F)&&L.isEdgeValid(null,A,F)){var B=null;E.beginUpdate();try{var D=E.getGeometry(A);var G=E.getGeometry(F).clone();G.x=D.x+(D.width-G.width)/2;G.y=D.y+(D.height-G.height)/2;var C=this.spacing*L.gridSize;var H=E.getDirectedEdgeCount(A,true)*20;if(this.editor.horizontalFlow){G.x+=(G.width+D.width)/2+C+H;}else{G.y+=(G.height+D.height)/2+C+H;}F.setGeometry(G);var J=E.getParent(A);L.addCell(F,J);L.constrainChild(F);B=this.editor.createEdge(A,F);if(E.getGeometry(B)==null){var I=new mxGeometry();I.relative=true;E.setGeometry(B,I);}L.addEdge(B,J,A,F);}finally{E.endUpdate();}L.setSelectionCells([F,B]);L.scrollCellToVisible(F);}};mxDefaultToolbar.prototype.installDropHandler=function(C,B){var D=document.createElement("img");D.setAttribute("src",C.getAttribute("src"));var A=mxUtils.bind(this,function(E){D.style.width=(2*C.offsetWidth)+"px";D.style.height=(2*C.offsetHeight)+"px";mxUtils.makeDraggable(C,this.editor.graph,B,D);mxEvent.removeListener(D,"load",A);});if(false){A();}else{mxEvent.addListener(D,"load",A);}};mxDefaultToolbar.prototype.destroy=function(){if(this.resetHandler!=null){this.editor.graph.removeListener("dblclick",this.resetHandler);this.editor.removeListener("escape",this.resetHandler);this.resetHandler=null;}if(this.toolbar!=null){this.toolbar.destroy();this.toolbar=null;}};function mxEditor(B){this.actions=[];this.addActions();if(document.body!=null){this.cycleAttributeValues=[];this.popupHandler=new mxDefaultPopupMenu();this.undoManager=new mxUndoManager();this.graph=this.createGraph();this.toolbar=this.createToolbar();this.keyHandler=new mxDefaultKeyHandler(this);this.configure(B);this.graph.swimlaneIndicatorColorAttribute=this.cycleAttributeName;if(!mxClient.IS_LOCAL&&this.urlInit!=null){this.createSession();}if(this.onInit!=null){var C=document.cookie;var A=C.indexOf("mxgraph=seen")<0;if(A){document.cookie="mxgraph=seen; expires=Fri, 27 Jul 2199 02:47:11 UTC; path=/";}this.onInit(A);}if(false){mxEvent.addListener(window,"unload",mxUtils.bind(this,function(){this.destroy();}));}}}mxResources.add(mxClient.basePath+"/resources/editor");mxEditor.prototype=new mxEventSource();mxEditor.prototype.constructor=mxEditor;mxEditor.prototype.askZoomResource=(mxClient.language!="none")?"askZoom":"";mxEditor.prototype.lastSavedResource=(mxClient.language!="none")?"lastSaved":"";mxEditor.prototype.currentFileResource=(mxClient.language!="none")?"currentFile":"";mxEditor.prototype.propertiesResource=(mxClient.language!="none")?"properties":"";mxEditor.prototype.tasksResource=(mxClient.language!="none")?"tasks":"";mxEditor.prototype.helpResource=(mxClient.language!="none")?"help":"";mxEditor.prototype.outlineResource=(mxClient.language!="none")?"outline":"";mxEditor.prototype.outline=null;mxEditor.prototype.graph=null;mxEditor.prototype.graphRenderHint=null;mxEditor.prototype.toolbar=null;mxEditor.prototype.status=null;mxEditor.prototype.popupHandler=null;mxEditor.prototype.undoManager=null;mxEditor.prototype.keyHandler=null;mxEditor.prototype.actions=null;mxEditor.prototype.dblClickAction="edit";mxEditor.prototype.swimlaneRequired=false;mxEditor.prototype.disableContextMenu=true;mxEditor.prototype.insertFunction=null;mxEditor.prototype.forcedInserting=false;mxEditor.prototype.templates=null;mxEditor.prototype.defaultEdge=null;mxEditor.prototype.defaultEdgeStyle=null;mxEditor.prototype.defaultGroup=null;mxEditor.prototype.groupBorderSize=null;mxEditor.prototype.filename=null;mxEditor.prototype.linefeed="&#xa;";mxEditor.prototype.postParameterName="xml";mxEditor.prototype.escapePostData=true;mxEditor.prototype.urlPost=null;mxEditor.prototype.urlImage=null;mxEditor.prototype.urlInit=null;mxEditor.prototype.urlNotify=null;mxEditor.prototype.urlPoll=null;mxEditor.prototype.horizontalFlow=false;mxEditor.prototype.layoutDiagram=false;mxEditor.prototype.swimlaneSpacing=0;mxEditor.prototype.maintainSwimlanes=false;mxEditor.prototype.layoutSwimlanes=false;mxEditor.prototype.cycleAttributeValues=null;mxEditor.prototype.cycleAttributeIndex=0;mxEditor.prototype.cycleAttributeName="fillColor";mxEditor.prototype.helpWindowImage=null;mxEditor.prototype.urlHelp=null;mxEditor.prototype.tasksWindowImage=null;mxEditor.prototype.tasksTop=20;mxEditor.prototype.helpWidth=300;mxEditor.prototype.helpHeight=260;mxEditor.prototype.propertiesWidth=240;mxEditor.prototype.propertiesHeight=null;mxEditor.prototype.movePropertiesDialog=false;mxEditor.prototype.validating=false;mxEditor.prototype.modified=false;mxEditor.prototype.isModified=function(){return this.modified;};mxEditor.prototype.setModified=function(A){this.modified=A;};mxEditor.prototype.addActions=function(){this.addAction("save",function(A){A.save();});this.addAction("print",function(A){var B=new mxPrintPreview(A.graph,1);B.open();});this.addAction("show",function(A){mxUtils.show(A.graph,null,10,10);});this.addAction("exportImage",function(C){var B=C.getUrlImage();if(B==null||mxClient.IS_LOCAL){C.execute("show");}else{var D=mxUtils.getViewXml(C.graph,1);var A=mxUtils.getXml(D,"\n");mxUtils.submit(B,C.postParameterName+"="+A);}});this.addAction("refresh",function(A){A.graph.refresh();});this.addAction("cut",function(A){if(A.graph.isEnabled()){mxClipboard.cut(A.graph);}});this.addAction("copy",function(A){if(A.graph.isEnabled()){mxClipboard.copy(A.graph);}});this.addAction("paste",function(A){if(A.graph.isEnabled()){mxClipboard.paste(A.graph);}});this.addAction("delete",function(A){if(A.graph.isEnabled()){A.graph.removeCells();}});this.addAction("group",function(A){if(A.graph.isEnabled()){A.graph.setSelectionCell(A.groupCells());}});this.addAction("ungroup",function(A){if(A.graph.isEnabled()){A.graph.setSelectionCells(A.graph.ungroupCells());}});this.addAction("removeFromParent",function(A){if(A.graph.isEnabled()){A.graph.removeCellsFromParent();}});this.addAction("undo",function(A){if(A.graph.isEnabled()){A.undo();}});this.addAction("redo",function(A){if(A.graph.isEnabled()){A.redo();}});this.addAction("zoomIn",function(A){A.graph.zoomIn();});this.addAction("zoomOut",function(A){A.graph.zoomOut();});this.addAction("actualSize",function(A){A.graph.zoomActual();});this.addAction("fit",function(A){A.graph.fit();});this.addAction("showProperties",function(B,A){B.showProperties(A);});this.addAction("selectAll",function(A){if(A.graph.isEnabled()){A.graph.selectAll();}});this.addAction("selectNone",function(A){if(A.graph.isEnabled()){A.graph.clearSelection();}});this.addAction("selectVertices",function(A){if(A.graph.isEnabled()){A.graph.selectVertices();}});this.addAction("selectEdges",function(A){if(A.graph.isEnabled()){A.graph.selectEdges();}});this.addAction("edit",function(B,A){if(B.graph.isEnabled()&&B.graph.isCellEditable(A)){B.graph.startEditingAtCell(A);}});this.addAction("toBack",function(B,A){if(B.graph.isEnabled()){B.graph.orderCells(true);}});this.addAction("toFront",function(B,A){if(B.graph.isEnabled()){B.graph.orderCells(false);}});this.addAction("enterGroup",function(B,A){B.graph.enterGroup(A);});this.addAction("exitGroup",function(A){A.graph.exitGroup();});this.addAction("home",function(A){A.graph.home();});this.addAction("selectPrevious",function(A){if(A.graph.isEnabled()){A.graph.selectPreviousCell();}});this.addAction("selectNext",function(A){if(A.graph.isEnabled()){A.graph.selectNextCell();}});this.addAction("selectParent",function(A){if(A.graph.isEnabled()){A.graph.selectParentCell();}});this.addAction("selectChild",function(A){if(A.graph.isEnabled()){A.graph.selectChildCell();}});this.addAction("collapse",function(A){if(A.graph.isEnabled()){A.graph.foldCells(true);}});this.addAction("collapseAll",function(B){if(B.graph.isEnabled()){var A=B.graph.getChildVertices();B.graph.foldCells(true,false,A);}});this.addAction("expand",function(A){if(A.graph.isEnabled()){A.graph.foldCells(false);}});this.addAction("expandAll",function(B){if(B.graph.isEnabled()){var A=B.graph.getChildVertices();B.graph.foldCells(false,false,A);}});this.addAction("bold",function(A){if(A.graph.isEnabled()){A.graph.toggleCellStyleFlags(mxConstants.STYLE_FONTSTYLE,mxConstants.FONT_BOLD);}});this.addAction("italic",function(A){if(A.graph.isEnabled()){A.graph.toggleCellStyleFlags(mxConstants.STYLE_FONTSTYLE,mxConstants.FONT_ITALIC);}});this.addAction("underline",function(A){if(A.graph.isEnabled()){A.graph.toggleCellStyleFlags(mxConstants.STYLE_FONTSTYLE,mxConstants.FONT_UNDERLINE);}});this.addAction("shadow",function(A){if(A.graph.isEnabled()){A.graph.toggleCellStyleFlags(mxConstants.STYLE_FONTSTYLE,mxConstants.FONT_SHADOW);}});this.addAction("alignCellsLeft",function(A){if(A.graph.isEnabled()){A.graph.alignCells(mxConstants.ALIGN_LEFT);}});this.addAction("alignCellsCenter",function(A){if(A.graph.isEnabled()){A.graph.alignCells(mxConstants.ALIGN_CENTER);}});this.addAction("alignCellsRight",function(A){if(A.graph.isEnabled()){A.graph.alignCells(mxConstants.ALIGN_RIGHT);}});this.addAction("alignCellsTop",function(A){if(A.graph.isEnabled()){A.graph.alignCells(mxConstants.ALIGN_TOP);}});this.addAction("alignCellsMiddle",function(A){if(A.graph.isEnabled()){A.graph.alignCells(mxConstants.ALIGN_MIDDLE);}});this.addAction("alignCellsBottom",function(A){if(A.graph.isEnabled()){A.graph.alignCells(mxConstants.ALIGN_BOTTOM);}});this.addAction("alignFontLeft",function(A){A.graph.setCellStyles(mxConstants.STYLE_ALIGN,mxConstants.ALIGN_LEFT);});this.addAction("alignFontCenter",function(A){if(A.graph.isEnabled()){A.graph.setCellStyles(mxConstants.STYLE_ALIGN,mxConstants.ALIGN_CENTER);}});this.addAction("alignFontRight",function(A){if(A.graph.isEnabled()){A.graph.setCellStyles(mxConstants.STYLE_ALIGN,mxConstants.ALIGN_RIGHT);}});this.addAction("alignFontTop",function(A){if(A.graph.isEnabled()){A.graph.setCellStyles(mxConstants.STYLE_VERTICAL_ALIGN,mxConstants.ALIGN_TOP);}});this.addAction("alignFontMiddle",function(A){if(A.graph.isEnabled()){A.graph.setCellStyles(mxConstants.STYLE_VERTICAL_ALIGN,mxConstants.ALIGN_MIDDLE);}});this.addAction("alignFontBottom",function(A){if(A.graph.isEnabled()){A.graph.setCellStyles(mxConstants.STYLE_VERTICAL_ALIGN,mxConstants.ALIGN_BOTTOM);}});this.addAction("zoom",function(A){var B=A.graph.getView().scale*100;var C=parseFloat(mxUtils.prompt(mxResources.get(A.askZoomResource)||A.askZoomResource,B))/100;if(!isNaN(C)){A.graph.getView().setScale(C);}});this.addAction("toggleTasks",function(A){if(A.tasks!=null){A.tasks.setVisible(!A.tasks.isVisible());}else{A.showTasks();}});this.addAction("toggleHelp",function(A){if(A.help!=null){A.help.setVisible(!A.help.isVisible());}else{A.showHelp();}});this.addAction("toggleOutline",function(A){if(A.outline==null){A.showOutline();}else{A.outline.setVisible(!A.outline.isVisible());}});this.addAction("toggleConsole",function(A){mxLog.setVisible(!mxLog.isVisible());});};mxEditor.prototype.createSession=function(){var B=null;var A=mxUtils.bind(this,function(C){this.fireEvent(new mxEventObject(mxEvent.SESSION,"session",C));});B=this.connect(this.urlInit,this.urlPoll,this.urlNotify,A);B.addListener(mxEvent.FIRED,mxUtils.bind(this,function(D,C){var E=C.getProperty("changes");if(E.length<10){mxEffects.animateChanges(this.graph,E);}}));B.addListener(mxEvent.CONNECT,mxUtils.bind(this,function(D,C){this.resetHistory();}));};mxEditor.prototype.configure=function(A){if(A!=null){var B=new mxCodec(A.ownerDocument);B.decode(A,this);this.resetHistory();}};mxEditor.prototype.resetFirstTime=function(){document.cookie="mxgraph=seen; expires=Fri, 27 Jul 2001 02:47:11 UTC; path=/";};mxEditor.prototype.resetHistory=function(){this.lastSnapshot=new Date().getTime();this.undoManager.clear();this.ignoredChanges=0;this.setModified(false);};mxEditor.prototype.addAction=function(B,A){this.actions[B]=A;};mxEditor.prototype.execute=function(D,A,B){var E=this.actions[D];if(E!=null){try{var C=arguments;C[0]=this;E.apply(this,C);}catch(F){mxUtils.error("Cannot execute "+D+": "+F.message,280,true);throw F;}}else{mxUtils.error("Cannot find action "+D,280,true);}};mxEditor.prototype.addTemplate=function(A,B){this.templates[A]=B;};mxEditor.prototype.getTemplate=function(A){return this.templates[A];};mxEditor.prototype.createGraph=function(){var A=new mxGraph(null,null,this.graphRenderHint);A.setTooltips(true);A.setPanning(true);this.installDblClickHandler(A);this.installUndoHandler(A);this.installDrillHandler(A);this.installChangeHandler(A);this.installInsertHandler(A);A.panningHandler.factoryMethod=mxUtils.bind(this,function(D,B,C){return this.createPopupMenu(D,B,C);});A.connectionHandler.factoryMethod=mxUtils.bind(this,function(B,C){return this.createEdge(B,C);});this.createSwimlaneManager(A);this.createLayoutManager(A);return A;};mxEditor.prototype.createSwimlaneManager=function(B){var A=new mxSwimlaneManager(B,false);A.isHorizontal=mxUtils.bind(this,function(){return this.horizontalFlow;});A.isEnabled=mxUtils.bind(this,function(){return this.maintainSwimlanes;});return A;};mxEditor.prototype.createLayoutManager=function(C){var B=new mxLayoutManager(C);var A=this;B.getLayout=function(D){var F=null;var E=A.graph.getModel();if(E.getParent(D)!=null){if(A.layoutSwimlanes&&C.isSwimlane(D)){if(A.swimlaneLayout==null){A.swimlaneLayout=A.createSwimlaneLayout();}F=A.swimlaneLayout;}else{if(A.layoutDiagram&&(C.isValidRoot(D)||E.getParent(E.getParent(D))==null)){if(A.diagramLayout==null){A.diagramLayout=A.createDiagramLayout();}F=A.diagramLayout;}}}return F;};return B;};mxEditor.prototype.setGraphContainer=function(A){if(this.graph.container==null){this.graph.init(A);this.rubberband=new mxRubberband(this.graph);if(this.disableContextMenu){mxEvent.disableContextMenu(A);}if(false){new mxDivResizer(A);}}};mxEditor.prototype.installDblClickHandler=function(A){A.addListener(mxEvent.DOUBLE_CLICK,mxUtils.bind(this,function(D,C){var B=C.getProperty("cell");if(B!=null&&A.isEnabled()&&this.dblClickAction!=null){this.execute(this.dblClickAction,B);C.consume();}}));};mxEditor.prototype.installUndoHandler=function(B){var A=mxUtils.bind(this,function(E,D){var F=D.getProperty("edit");this.undoManager.undoableEditHappened(F);});B.getModel().addListener(mxEvent.UNDO,A);B.getView().addListener(mxEvent.UNDO,A);var C=function(E,D){var F=D.getProperty("edit").changes;B.setSelectionCells(B.getSelectionCellsForChanges(F));};this.undoManager.addListener(mxEvent.UNDO,C);this.undoManager.addListener(mxEvent.REDO,C);};mxEditor.prototype.installDrillHandler=function(B){var A=mxUtils.bind(this,function(C){this.fireEvent(new mxEventObject(mxEvent.ROOT));});B.getView().addListener(mxEvent.DOWN,A);B.getView().addListener(mxEvent.UP,A);};mxEditor.prototype.installChangeHandler=function(B){var A=mxUtils.bind(this,function(E,C){this.setModified(true);if(this.validating==true){B.validateGraph();}var F=C.getProperty("changes");for(var D=0;D<F.length;D++){var G=F[D];if(G.constructor==mxRootChange||(G.constructor==mxValueChange&&G.cell==this.graph.model.root)||(G.constructor==mxCellAttributeChange&&G.cell==this.graph.model.root)){this.fireEvent(new mxEventObject(mxEvent.ROOT));break;}}});B.getModel().addListener(mxEvent.CHANGE,A);};mxEditor.prototype.installInsertHandler=function(B){var A=this;var C={mouseDown:function(D,E){if(A.insertFunction!=null&&!E.isPopupTrigger()&&(A.forcedInserting||E.getState()==null)){A.graph.clearSelection();A.insertFunction(E.getEvent(),E.getCell());this.isActive=true;E.consume();}},mouseMove:function(D,E){if(this.isActive){E.consume();}},mouseUp:function(D,E){if(this.isActive){this.isActive=false;E.consume();}}};B.addMouseListener(C);};mxEditor.prototype.createDiagramLayout=function(){var A=this.graph.gridSize;var B=new mxStackLayout(this.graph,!this.horizontalFlow,this.swimlaneSpacing,2*A,2*A);B.isVertexIgnored=function(C){return !B.graph.isSwimlane(C);};return B;};mxEditor.prototype.createSwimlaneLayout=function(){return new mxCompactTreeLayout(this.graph,this.horizontalFlow);};mxEditor.prototype.createToolbar=function(){return new mxDefaultToolbar(null,this);};mxEditor.prototype.setToolbarContainer=function(A){this.toolbar.init(A);if(false){new mxDivResizer(A);}};mxEditor.prototype.setStatusContainer=function(A){if(this.status==null){this.status=A;this.addListener(mxEvent.SAVE,mxUtils.bind(this,function(){var B=new Date().toLocaleString();this.setStatus((mxResources.get(this.lastSavedResource)||this.lastSavedResource)+": "+B);}));this.addListener(mxEvent.OPEN,mxUtils.bind(this,function(){this.setStatus((mxResources.get(this.currentFileResource)||this.currentFileResource)+": "+this.filename);}));if(false){new mxDivResizer(A);}}};mxEditor.prototype.setStatus=function(A){if(this.status!=null&&A!=null){this.status.innerHTML=A;}};mxEditor.prototype.setTitleContainer=function(A){this.addListener(mxEvent.ROOT,mxUtils.bind(this,function(B){A.innerHTML=this.getTitle();}));if(false){new mxDivResizer(A);}};mxEditor.prototype.treeLayout=function(A,B){if(A!=null){var C=new mxCompactTreeLayout(this.graph,B);C.execute(A);}};mxEditor.prototype.getTitle=function(){var D="";var C=this.graph;var A=C.getCurrentRoot();while(A!=null&&C.getModel().getParent(C.getModel().getParent(A))!=null){if(C.isValidRoot(A)){D=" > "+C.convertValueToString(A)+D;}A=C.getModel().getParent(A);}var B=this.getRootTitle();return B+D;};mxEditor.prototype.getRootTitle=function(){var A=this.graph.getModel().getRoot();return this.graph.convertValueToString(A);};mxEditor.prototype.undo=function(){this.undoManager.undo();};mxEditor.prototype.redo=function(){this.undoManager.redo();};mxEditor.prototype.groupCells=function(){var A=(this.groupBorderSize!=null)?this.groupBorderSize:this.graph.gridSize;return this.graph.groupCells(this.createGroup(),A);};mxEditor.prototype.createGroup=function(){var A=this.graph.getModel();return A.cloneCell(this.defaultGroup);};mxEditor.prototype.open=function(A){if(A!=null){var B=mxUtils.load(A).getXml();this.readGraphModel(B.documentElement);this.filename=A;this.fireEvent(new mxEventObject(mxEvent.OPEN,"filename",A));}};mxEditor.prototype.readGraphModel=function(A){var B=new mxCodec(A.ownerDocument);B.decode(A,this.graph.getModel());this.resetHistory();};mxEditor.prototype.save=function(B,A){B=B||this.getUrlPost();if(B!=null&&B.length>0){var C=this.writeGraphModel(A);this.postDiagram(B,C);this.setModified(false);}this.fireEvent(new mxEventObject(mxEvent.SAVE,"url",B));};mxEditor.prototype.postDiagram=function(A,B){if(this.escapePostData){B=encodeURIComponent(B);}mxUtils.post(A,this.postParameterName+"="+B,mxUtils.bind(this,function(C){this.fireEvent(new mxEventObject(mxEvent.POST,"request",C,"url",A,"data",B));}));};mxEditor.prototype.writeGraphModel=function(B){B=(B!=null)?B:this.linefeed;var A=new mxCodec();var C=A.encode(this.graph.getModel());return mxUtils.getXml(C,B);};mxEditor.prototype.getUrlPost=function(){return this.urlPost;};mxEditor.prototype.getUrlImage=function(){return this.urlImage;};mxEditor.prototype.connect=function(C,B,E,A){var D=null;if(!mxClient.IS_LOCAL){var D=new mxSession(this.graph.getModel(),C,B,E);D.addListener(mxEvent.RECEIVE,mxUtils.bind(this,function(G,F){var H=F.getProperty("node");if(H.nodeName=="mxGraphModel"){this.readGraphModel(H);}}));D.addListener(mxEvent.DISCONNECT,A);D.addListener(mxEvent.CONNECT,A);D.addListener(mxEvent.NOTIFY,A);D.addListener(mxEvent.GET,A);D.start();}return D;};mxEditor.prototype.swapStyles=function(C,A){var B=this.graph.getStylesheet().styles[A];this.graph.getView().getStylesheet().putCellStyle(A,this.graph.getStylesheet().styles[C]);this.graph.getStylesheet().putCellStyle(C,B);this.graph.refresh();};mxEditor.prototype.showProperties=function(B){B=B||this.graph.getSelectionCell();if(B==null){B=this.graph.getCurrentRoot();if(B==null){B=this.graph.getModel().getRoot();}}if(B!=null){this.graph.stopEditing(true);var E=mxUtils.getOffset(this.graph.container);var A=E.x+10;var F=E.y;if(this.properties!=null&&!this.movePropertiesDialog){A=this.properties.getX();F=this.properties.getY();}else{var D=this.graph.getCellBounds(B);if(D!=null){A+=D.x+Math.min(200,D.width);F+=D.y;}}this.hideProperties();var C=this.createProperties(B);if(C!=null){this.properties=new mxWindow(mxResources.get(this.propertiesResource)||this.propertiesResource,C,A,F,this.propertiesWidth,this.propertiesHeight,false);this.properties.setVisible(true);}}};mxEditor.prototype.isPropertiesVisible=function(){return this.properties!=null;};mxEditor.prototype.createProperties=function(B){var G=this.graph.getModel();var L=G.getValue(B);if(mxUtils.isNode(L)){var C=new mxForm("properties");var I=C.addText("ID",B.getId());I.setAttribute("readonly","true");var Q=null;var H=null;var D=null;var F=null;var E=null;if(G.isVertex(B)){Q=G.getGeometry(B);if(Q!=null){H=C.addText("top",Q.y);D=C.addText("left",Q.x);F=C.addText("width",Q.width);E=C.addText("height",Q.height);}}var O=G.getStyle(B);var N=C.addText("Style",O||"");var J=L.attributes;var A=[];for(var M=0;M<J.length;M++){var R=J[M].nodeValue;A[M]=C.addTextarea(J[M].nodeName,R,(J[M].nodeName=="label")?4:2);}var K=mxUtils.bind(this,function(){this.hideProperties();G.beginUpdate();try{if(Q!=null){Q=Q.clone();Q.x=parseFloat(D.value);Q.y=parseFloat(H.value);Q.width=parseFloat(F.value);Q.height=parseFloat(E.value);G.setGeometry(B,Q);}if(N.value.length>0){G.setStyle(B,N.value);}else{G.setStyle(B,null);}for(var S=0;S<J.length;S++){var T=new mxCellAttributeChange(B,J[S].nodeName,A[S].value);G.execute(T);}if(this.graph.isAutoSizeCell(B)){this.graph.updateCellSize(B);}}finally{G.endUpdate();}});var P=mxUtils.bind(this,function(){this.hideProperties();});C.addButtons(K,P);return C.table;}return null;};mxEditor.prototype.hideProperties=function(){if(this.properties!=null){this.properties.destroy();this.properties=null;}};mxEditor.prototype.showTasks=function(E){if(this.tasks==null){var D=document.createElement("div");D.style.padding="4px";D.style.paddingLeft="20px";var B=document.body.clientWidth;var C=new mxWindow(mxResources.get(this.tasksResource)||this.tasksResource,D,B-220,this.tasksTop,200);C.setClosable(true);C.destroyOnClose=false;var A=mxUtils.bind(this,function(F){mxEvent.release(D);D.innerHTML="";this.createTasks(D);});this.graph.getModel().addListener(mxEvent.CHANGE,A);this.graph.getSelectionModel().addListener(mxEvent.CHANGE,A);this.graph.addListener(mxEvent.ROOT,A);if(this.tasksWindowImage!=null){C.setImage(this.tasksWindowImage);}this.tasks=C;this.createTasks(D);}this.tasks.setVisible(true);};mxEditor.prototype.refreshTasks=function(A){if(this.tasks!=null){var A=this.tasks.content;mxEvent.release(A);A.innerHTML="";this.createTasks(A);}};mxEditor.prototype.createTasks=function(A){};mxEditor.prototype.showHelp=function(F){if(this.help==null){var E=document.createElement("iframe");E.setAttribute("src",mxResources.get("urlHelp")||this.urlHelp);E.setAttribute("height","100%");E.setAttribute("width","100%");E.setAttribute("frameborder","0");E.style.backgroundColor="white";var A=document.body.clientWidth;var C=(document.body.clientHeight||document.documentElement.clientHeight);var D=new mxWindow(mxResources.get(this.helpResource)||this.helpResource,E,(A-this.helpWidth)/2,(C-this.helpHeight)/3,this.helpWidth,this.helpHeight);D.setMaximizable(true);D.setClosable(true);D.destroyOnClose=false;D.setResizable(true);if(this.helpWindowImage!=null){D.setImage(this.helpWindowImage);}if(true){var B=function(G){var H=D.div.offsetHeight;E.setAttribute("height",(H-26)+"px");};D.addListener(mxEvent.RESIZE_END,B);D.addListener(mxEvent.MAXIMIZE,B);D.addListener(mxEvent.NORMALIZE,B);D.addListener(mxEvent.SHOW,B);}this.help=D;}this.help.setVisible(true);};mxEditor.prototype.showOutline=function(){var A=this.outline==null;if(A){var D=document.createElement("div");D.style.overflow="hidden";D.style.width="100%";D.style.height="100%";D.style.background="white";D.style.cursor="move";var C=new mxWindow(mxResources.get(this.outlineResource)||this.outlineResource,D,600,480,200,200,false);var B=new mxOutline(this.graph,D);C.setClosable(true);C.setResizable(true);C.destroyOnClose=false;C.addListener(mxEvent.RESIZE_END,function(){B.update();});this.outline=C;this.outline.outline=B;}this.outline.setVisible(true);this.outline.outline.refresh();};mxEditor.prototype.setMode=function(A){if(A=="select"){this.graph.panningHandler.useLeftButtonForPanning=false;this.graph.setConnectable(false);}else{if(A=="connect"){this.graph.panningHandler.useLeftButtonForPanning=false;this.graph.setConnectable(true);}else{if(A=="pan"){this.graph.panningHandler.useLeftButtonForPanning=true;this.graph.setConnectable(false);}}}};mxEditor.prototype.createPopupMenu=function(C,A,B){this.popupHandler.createMenu(this,C,A,B);};mxEditor.prototype.createEdge=function(C,F){var E=null;if(this.defaultEdge!=null){var A=this.graph.getModel();E=A.cloneCell(this.defaultEdge);}else{E=new mxCell("");E.setEdge(true);var D=new mxGeometry();D.relative=true;E.setGeometry(D);}var B=this.getEdgeStyle();if(B!=null){E.setStyle(B);}return E;};mxEditor.prototype.getEdgeStyle=function(){return this.defaultEdgeStyle;};mxEditor.prototype.consumeCycleAttribute=function(A){return(this.cycleAttributeValues!=null&&this.cycleAttributeValues.length>0&&this.graph.isSwimlane(A))?this.cycleAttributeValues[this.cycleAttributeIndex++%this.cycleAttributeValues.length]:null;};mxEditor.prototype.cycleAttribute=function(A){if(this.cycleAttributeName!=null){var B=this.consumeCycleAttribute(A);if(B!=null){A.setStyle(A.getStyle()+";"+this.cycleAttributeName+"="+B);}}};mxEditor.prototype.addVertex=function(K,H,J,I){var G=this.graph.getModel();while(K!=null&&!this.graph.isValidDropTarget(K)){K=G.getParent(K);}K=(K!=null)?K:this.graph.getSwimlaneAt(J,I);var D=this.graph.getView().scale;var F=G.getGeometry(H);var C=G.getGeometry(K);if(this.graph.isSwimlane(H)&&!this.graph.swimlaneNesting){K=null;}else{if(K==null&&this.swimlaneRequired){return null;}else{if(K!=null&&C!=null){var A=this.graph.getView().getState(K);if(A!=null){J-=A.origin.x*D;I-=A.origin.y*D;if(this.graph.isConstrainedMoving){var B=F.width;var L=F.height;var E=A.x+A.width;if(J+B>E){J-=J+B-E;}E=A.y+A.height;if(I+L>E){I-=I+L-E;}}}else{if(C!=null){J-=C.x*D;I-=C.y*D;}}}}}F=F.clone();F.x=this.graph.snap(J/D-this.graph.getView().translate.x-this.graph.gridSize/2);F.y=this.graph.snap(I/D-this.graph.getView().translate.y-this.graph.gridSize/2);H.setGeometry(F);if(K==null){K=this.graph.getDefaultParent();}this.cycleAttribute(H);this.fireEvent(new mxEventObject(mxEvent.BEFORE_ADD_VERTEX,"vertex",H,"parent",K));G.beginUpdate();try{H=this.graph.addCell(H,K);if(H!=null){this.graph.constrainChild(H);this.fireEvent(new mxEventObject(mxEvent.ADD_VERTEX,"vertex",H));}}finally{G.endUpdate();}if(H!=null){this.graph.setSelectionCell(H);this.graph.scrollCellToVisible(H);this.fireEvent(new mxEventObject(mxEvent.AFTER_ADD_VERTEX,"vertex",H));}return H;};mxEditor.prototype.destroy=function(){if(!this.destroyed){this.destroyed=true;if(this.tasks!=null){this.tasks.destroy();}if(this.outline!=null){this.outline.destroy();}if(this.properties!=null){this.properties.destroy();}if(this.keyHandler!=null){this.keyHandler.destroy();}if(this.rubberband!=null){this.rubberband.destroy();}if(this.toolbar!=null){this.toolbar.destroy();}if(this.graph!=null){this.graph.destroy();}this.status=null;this.templates=null;}};var mxCodecRegistry={codecs:[],aliases:[],register:function(B){if(B!=null){var A=B.getName();mxCodecRegistry.codecs[A]=B;var C=mxUtils.getFunctionName(B.template.constructor);if(C!=A){mxCodecRegistry.addAlias(C,A);}}return B;},addAlias:function(B,A){mxCodecRegistry.aliases[B]=A;},getCodec:function(C){var D=null;if(C!=null){var A=mxUtils.getFunctionName(C);var B=mxCodecRegistry.aliases[A];if(B!=null){A=B;}D=mxCodecRegistry.codecs[A];if(D==null){try{D=new mxObjectCodec(new C());mxCodecRegistry.register(D);}catch(E){}}}return D;}};function mxCodec(A){this.document=A||mxUtils.createXmlDocument();this.objects=[];}mxCodec.prototype.document=null;mxCodec.prototype.objects=null;mxCodec.prototype.encodeDefaults=false;mxCodec.prototype.putObject=function(B,A){this.objects[B]=A;return A;};mxCodec.prototype.getObject=function(C){var B=null;if(C!=null){B=this.objects[C];if(B==null){B=this.lookup(C);if(B==null){var A=this.getElementById(C);if(A!=null){B=this.decode(A);}}}}return B;};mxCodec.prototype.lookup=function(A){return null;};mxCodec.prototype.getElementById=function(C,A){A=A||"id";var B="//*[@"+A+"='"+C+"']";return mxUtils.selectSingleNode(this.document,B);};mxCodec.prototype.getId=function(A){var B=null;if(A!=null){B=this.reference(A);if(B==null&&A.constructor==mxCell){B=A.getId();if(B==null){B=mxCellPath.create(A);if(B.length==0){B="root";}}}}return B;};mxCodec.prototype.reference=function(A){return null;};mxCodec.prototype.encode=function(C){var B=null;if(C!=null&&C.constructor!=null){var A=mxCodecRegistry.getCodec(C.constructor);if(A!=null){B=A.encode(this,C);}else{if(isNode(C)){B=(false)?C.value.cloneNode(true):this.document.importNode(C.value,true);}else{mxLog.warn("mxCodec.encode: No codec for "+mxUtils.getFunctionName(C.constructor));}}}return B;};mxCodec.prototype.decode=function(node,into){var obj=null;if(node!=null&&node.nodeType==mxConstants.NODETYPE_ELEMENT){var ctor=null;try{var ctor=eval(node.nodeName);}catch(err){}try{var dec=mxCodecRegistry.getCodec(ctor);if(dec!=null){obj=dec.decode(this,node,into);}else{obj=node.cloneNode(true);obj.removeAttribute("as");}}catch(err){mxLog.debug("Cannot decode "+node.nodeName+": "+err.message);}}return obj;};mxCodec.prototype.encodeCell=function(B,E,A){E.appendChild(this.encode(B));if(A==null||A){var C=B.getChildCount();for(var D=0;D<C;D++){this.encodeCell(B.getChildAt(D),E);}}};mxCodec.prototype.isCellCodec=function(A){if(A!=null&&typeof (A.isCellCodec)=="function"){return A.isCellCodec();}return false;};mxCodec.prototype.decodeCell=function(D,B){var A=null;if(D!=null&&D.nodeType==mxConstants.NODETYPE_ELEMENT){var H=mxCodecRegistry.getCodec(D.nodeName);if(!this.isCellCodec(H)){var G=D.firstChild;while(G!=null&&!this.isCellCodec(H)){H=mxCodecRegistry.getCodec(G.nodeName);G=G.nextSibling;}}if(!this.isCellCodec(H)){H=mxCodecRegistry.getCodec(mxCell);}A=H.decode(this,D);if(B==null||B){var C=A.getParent();if(C!=null){C.insert(A);}var E=A.getTerminal(true);if(E!=null){E.insertEdge(A,true);}var F=A.getTerminal(false);if(F!=null){F.insertEdge(A,false);}}}return A;};mxCodec.prototype.setAttribute=function(B,A,C){if(A!=null&&C!=null){B.setAttribute(A,C);}};function mxObjectCodec(E,A,D,B){this.template=E;this.exclude=(A!=null)?A:[];this.idrefs=(D!=null)?D:[];this.mapping=(B!=null)?B:[];this.reverse=new Object();for(var C in this.mapping){this.reverse[this.mapping[C]]=C;}}mxObjectCodec.prototype.template=null;mxObjectCodec.prototype.exclude=null;mxObjectCodec.prototype.idrefs=null;mxObjectCodec.prototype.mapping=null;mxObjectCodec.prototype.reverse=null;mxObjectCodec.prototype.getName=function(){return mxUtils.getFunctionName(this.template.constructor);};mxObjectCodec.prototype.cloneTemplate=function(){return new this.template.constructor();};mxObjectCodec.prototype.getFieldName=function(B){if(B!=null){var A=this.reverse[B];if(A!=null){B=A;}}return B;};mxObjectCodec.prototype.getAttributeName=function(B){if(B!=null){var A=this.mapping[B];if(A!=null){B=A;}}return B;};mxObjectCodec.prototype.isExcluded=function(D,A,C,B){return A==mxObjectIdentity.FIELD_NAME||mxUtils.indexOf(this.exclude,A)>=0;};mxObjectCodec.prototype.isReference=function(D,A,C,B){return mxUtils.indexOf(this.idrefs,A)>=0;};mxObjectCodec.prototype.encode=function(A,C){var B=A.document.createElement(this.getName());C=this.beforeEncode(A,C,B);this.encodeObject(A,C,B);return this.afterEncode(A,C,B);};mxObjectCodec.prototype.encodeObject=function(A,F,D){A.setAttribute(D,"id",A.getId(F));for(var C in F){var B=C;var E=F[B];if(E!=null&&!this.isExcluded(F,B,E,true)){if(mxUtils.isNumeric(B)){B=null;}this.encodeValue(A,F,B,E,D);}}};mxObjectCodec.prototype.encodeValue=function(B,G,C,F,E){if(F!=null){if(this.isReference(G,C,F,true)){var D=B.getId(F);if(D==null){mxLog.warn("mxObjectCodec.encode: No ID for "+this.getName()+"."+C+"="+F);return ;}F=D;}var A=this.template[C];if(C==null||B.encodeDefaults||A!=F){C=this.getAttributeName(C);this.writeAttribute(B,G,C,F,E);}}};mxObjectCodec.prototype.writeAttribute=function(B,E,A,D,C){if(typeof (D)!="object"){this.writePrimitiveAttribute(B,E,A,D,C);}else{this.writeComplexAttribute(B,E,A,D,C);}};mxObjectCodec.prototype.writePrimitiveAttribute=function(B,E,A,D,C){D=this.convertValueToXml(D);if(A==null){var F=B.document.createElement("add");if(typeof (D)=="function"){F.appendChild(B.document.createTextNode(D));}else{B.setAttribute(F,"value",D);}C.appendChild(F);}else{if(typeof (D)!="function"){B.setAttribute(C,A,D);}}};mxObjectCodec.prototype.writeComplexAttribute=function(B,E,A,D,C){var F=B.encode(D);if(F!=null){if(A!=null){F.setAttribute("as",A);}C.appendChild(F);}else{mxLog.warn("mxObjectCodec.encode: No node for "+this.getName()+"."+A+": "+D);}};mxObjectCodec.prototype.convertValueToXml=function(A){if(typeof (A.length)=="undefined"&&(A==true||A==false)){A=(A==true)?"1":"0";}return A;};mxObjectCodec.prototype.convertValueFromXml=function(A){if(mxUtils.isNumeric(A)){A=parseFloat(A);}return A;};mxObjectCodec.prototype.beforeEncode=function(A,C,B){return C;};mxObjectCodec.prototype.afterEncode=function(A,C,B){return B;};mxObjectCodec.prototype.decode=function(E,B,A){var D=B.getAttribute("id");var C=E.objects[D];if(C==null){C=A||this.cloneTemplate();if(D!=null){E.putObject(D,C);}}B=this.beforeDecode(E,B,C);this.decodeNode(E,B,C);return this.afterDecode(E,B,C);};mxObjectCodec.prototype.decodeNode=function(C,A,B){if(A!=null){this.decodeAttributes(C,A,B);this.decodeChildren(C,A,B);}};mxObjectCodec.prototype.decodeAttributes=function(E,C,D){var A=C.attributes;if(A!=null){for(var B=0;B<A.length;B++){this.decodeAttribute(E,A[B],D);}}};mxObjectCodec.prototype.decodeAttribute=function(G,A,F){var C=A.nodeName;if(C!="as"&&C!="id"){var E=this.convertValueFromXml(A.nodeValue);var B=this.getFieldName(C);if(this.isReference(F,B,E,false)){var D=G.getObject(E);if(D==null){mxLog.warn("mxObjectCodec.decode: No object for "+this.getName()+"."+C+"="+E);return ;}E=D;}if(!this.isExcluded(F,C,E,false)){F[C]=E;}}};mxObjectCodec.prototype.decodeChildren=function(E,B,C){var D=B.firstChild;while(D!=null){var A=D.nextSibling;if(D.nodeType==mxConstants.NODETYPE_ELEMENT&&!this.processInclude(E,D,C)){this.decodeChild(E,D,C);}D=A;}};mxObjectCodec.prototype.decodeChild=function(dec,child,obj){var fieldname=this.getFieldName(child.getAttribute("as"));if(fieldname==null||!this.isExcluded(obj,fieldname,child,false)){var value=null;var template=obj[fieldname];if(child.nodeName=="add"){value=child.getAttribute("value");if(value==null){value=mxUtils.eval(mxUtils.getTextContent(child));}}else{if(template instanceof Array&&template.length>0){template=null;}value=dec.decode(child,template);}if(value!=null&&value!=template){if(fieldname!=null&&fieldname.length>0){obj[fieldname]=value;}else{obj.push(value);}}}};mxObjectCodec.prototype.processInclude=function(F,D,C){if(D.nodeName=="include"){var B=D.getAttribute("name");if(B!=null){try{var A=mxUtils.load(B).getDocumentElement();if(A!=null){F.decode(A,C);}}catch(E){}}return true;}return false;};mxObjectCodec.prototype.beforeDecode=function(C,A,B){return A;};mxObjectCodec.prototype.afterDecode=function(C,A,B){return B;};mxCodecRegistry.register(function(){var A=new mxObjectCodec(new mxCell(),["children","edges","overlays","mxTransient"],["parent","source","target"]);A.isCellCodec=function(){return true;};A.isExcluded=function(E,B,D,C){return mxObjectCodec.prototype.isExcluded.apply(this,arguments)||(C&&B=="value"&&D.nodeType==mxConstants.NODETYPE_ELEMENT);};A.afterEncode=function(B,E,D){if(E.value!=null&&E.value.nodeType==mxConstants.NODETYPE_ELEMENT){var C=D;D=(false)?E.value.cloneNode(true):B.document.importNode(E.value,true);D.appendChild(C);var F=C.getAttribute("id");D.setAttribute("id",F);C.removeAttribute("id");}return D;};A.beforeDecode=function(F,E,J){var N=E;var G=this.getName();if(E.nodeName!=G){var K=E.getElementsByTagName(G)[0];if(K!=null&&K.parentNode==E){mxUtils.removeWhitespace(K,true);mxUtils.removeWhitespace(K,false);K.parentNode.removeChild(K);N=K;}else{N=null;}J.value=E.cloneNode(true);var B=J.value.getAttribute("id");if(B!=null){J.setId(B);J.value.removeAttribute("id");}}else{J.setId(E.getAttribute("id"));}if(N!=null){for(var L=0;L<this.idrefs.length;L++){var M=this.idrefs[L];var C=N.getAttribute(M);if(C!=null){N.removeAttribute(M);var H=F.objects[C]||F.lookup(C);if(H==null){var I=F.getElementById(C);if(I!=null){var D=mxCodecRegistry.codecs[I.nodeName]||this;H=D.decode(F,I);}}J[M]=H;}}}return N;};return A;}());mxCodecRegistry.register(function(){var A=new mxObjectCodec(new mxGraphModel());A.encode=function(C,E){var D=C.document.createElement(this.getName());var B=C.document.createElement("root");C.encodeCell(E.getRoot(),B);D.appendChild(B);return D;};A.decodeChild=function(D,C,B){if(C.nodeName=="root"){this.decodeRoot(D,C,B);}else{mxObjectCodec.prototype.decodeChild.apply(this,arguments);}};A.decodeRoot=function(G,C,D){var F=null;var E=C.firstChild;while(E!=null){var B=G.decodeCell(E);if(B!=null&&B.getParent()==null){F=B;}E=E.nextSibling;}if(F!=null){D.setRoot(F);}};return A;}());mxCodecRegistry.register(function(){var A=new mxObjectCodec(new mxRootChange(),["model","previous","root"]);A.afterEncode=function(B,D,C){B.encodeCell(D.root,C);return C;};A.beforeDecode=function(F,D,E){if(D.firstChild!=null&&D.firstChild.nodeType==mxConstants.NODETYPE_ELEMENT){var B=D.firstChild;E.root=F.decodeCell(B,false);var C=B.nextSibling;B.parentNode.removeChild(B);B=C;while(B!=null){var C=B.nextSibling;F.decodeCell(B);B.parentNode.removeChild(B);B=C;}}return D;};A.afterDecode=function(D,B,C){C.previous=C.root;return C;};return A;}());mxCodecRegistry.register(function(){var A=new mxObjectCodec(new mxChildChange(),["model","previous","previousIndex","child"],["parent"]);A.isReference=function(E,B,D,C){if(B=="child"&&(E.previous!=null||!C)){return true;}return mxUtils.indexOf(this.idrefs,B)>=0;};A.afterEncode=function(B,D,C){if(this.isReference(D,"child",D.child,true)){C.setAttribute("child",B.getId(D.child));}else{B.encodeCell(D.child,C);}return C;};A.beforeDecode=function(H,D,F){if(D.firstChild!=null&&D.firstChild.nodeType==mxConstants.NODETYPE_ELEMENT){var B=D.firstChild;F.child=H.decodeCell(B,false);var C=B.nextSibling;B.parentNode.removeChild(B);B=C;while(B!=null){var C=B.nextSibling;if(B.nodeType==mxConstants.NODETYPE_ELEMENT){var G=B.getAttribute("id");if(H.lookup(G)==null){H.decodeCell(B);}}B.parentNode.removeChild(B);B=C;}}else{var E=D.getAttribute("child");F.child=H.getObject(E);}return D;};A.afterDecode=function(D,B,C){C.previous=C.parent;C.previousIndex=C.index;return C;};return A;}());mxCodecRegistry.register(function(){var A=new mxObjectCodec(new mxTerminalChange(),["model","previous"],["cell","terminal"]);A.afterDecode=function(D,B,C){C.previous=C.terminal;return C;};return A;}());var mxGenericChangeCodec=function(C,A){var B=new mxObjectCodec(C,["model","previous"],["cell"]);B.afterDecode=function(F,D,E){if(mxUtils.isNode(E.cell)){E.cell=F.decodeCell(E.cell);}if(E.previous==null){E.previous=E[A];}return E;};return B;};mxCodecRegistry.register(mxGenericChangeCodec(new mxValueChange(),"value"));mxCodecRegistry.register(mxGenericChangeCodec(new mxStyleChange(),"style"));mxCodecRegistry.register(mxGenericChangeCodec(new mxGeometryChange(),"geometry"));mxCodecRegistry.register(mxGenericChangeCodec(new mxCollapseChange(),"collapsed"));mxCodecRegistry.register(mxGenericChangeCodec(new mxVisibleChange(),"visible"));mxCodecRegistry.register(mxGenericChangeCodec(new mxCellAttributeChange(),"value"));mxCodecRegistry.register(function(){return new mxObjectCodec(new mxGraph(),["graphListeners","eventListeners","view","container","cellRenderer","editor","selection"]);}());mxCodecRegistry.register(function(){var A=new mxObjectCodec(new mxGraphView());A.encode=function(C,B){return this.encodeCell(C,B,B.graph.getModel().getRoot());};A.encodeCell=function(G,M,P){var L=M.graph.getModel();var D=M.getState(P);var H=L.getChildCount(P);var O=L.getParent(P);var J=M.graph.getCellGeometry(P);var C=null;if(O==L.getRoot()){C="layer";}else{if(O==null){C="graph";}else{if(L.isEdge(P)){C="edge";}else{if(H>0&&J!=null){C="group";}else{if(L.isVertex(P)){C="vertex";}}}}}if(C!=null){var E=G.document.createElement(C);var K=M.graph.getLabel(P);if(K!=null){E.setAttribute("label",M.graph.getLabel(P));if(M.graph.isHtmlLabel(P)){E.setAttribute("html",true);}}if(O==null){var B=M.getGraphBounds();if(B!=null){E.setAttribute("x",Math.round(B.x));E.setAttribute("y",Math.round(B.y));E.setAttribute("width",Math.round(B.width));E.setAttribute("height",Math.round(B.height));}E.setAttribute("scale",M.scale);}else{if(D!=null&&J!=null){for(var I in D.style){var N=D.style[I];if(typeof (N)=="function"&&typeof (N)=="object"){N=mxStyleRegistry.getName(N);}if(N!=null&&typeof (N)!="function"&&typeof (N)!="object"){E.setAttribute(I,N);}}var R=D.absolutePoints;if(R!=null&&R.length>0){var Q=Math.round(R[0].x)+","+Math.round(R[0].y);for(var I=1;I<R.length;I++){Q+=" "+Math.round(R[I].x)+","+Math.round(R[I].y);}E.setAttribute("points",Q);}else{E.setAttribute("x",Math.round(D.x));E.setAttribute("y",Math.round(D.y));E.setAttribute("width",Math.round(D.width));E.setAttribute("height",Math.round(D.height));}var F=D.absoluteOffset;if(F!=null){if(F.x!=0){E.setAttribute("dx",Math.round(F.x));}if(F.y!=0){E.setAttribute("dy",Math.round(F.y));}}}}}for(var I=0;I<H;I++){E.appendChild(this.encodeCell(G,M,L.getChildAt(P,I)));}return E;};return A;}());mxCodecRegistry.register(function(){var codec=new mxObjectCodec(new mxStylesheet());codec.encode=function(enc,obj){var node=enc.document.createElement(this.getName());for(var i in obj.styles){var style=obj.styles[i];var styleNode=enc.document.createElement("add");if(i!=null){styleNode.setAttribute("as",i);for(var j in style){var entry=enc.document.createElement("add");entry.setAttribute("as",j);var type=typeof (style[j]);if(type=="function"){var name=mxStyleRegistry.getName(style[j]);if(name!=null){entry.setAttribute("value",name);}}else{if(type!="object"){entry.setAttribute("value",style[j]);}}styleNode.appendChild(entry);}if(styleNode.childNodes.length>0){node.appendChild(styleNode);}}}return node;};codec.decode=function(dec,node,into){var obj=into||new this.template.constructor();var id=node.getAttribute("id");if(id!=null){dec.objects[id]=obj;}node=node.firstChild;while(node!=null){if(!this.processInclude(dec,node,obj)&&node.nodeName=="add"){var as=node.getAttribute("as");if(as!=null){var extend=node.getAttribute("extend");var style=(extend!=null)?mxUtils.clone(obj.styles[extend]):null;if(style==null){if(extend!=null){mxLog.warn("mxStylesheetCodec.decode: stylesheet "+extend+" not found to extend");}style=new Object();}var entry=node.firstChild;while(entry!=null){if(entry.nodeType==mxConstants.NODETYPE_ELEMENT){var key=entry.getAttribute("as");if(entry.nodeName=="add"){var text=mxUtils.getTextContent(entry);var value=null;if(text!=null&&text.length>0){value=mxUtils.eval(text);}else{value=entry.getAttribute("value");if(mxUtils.isNumeric(value)){value=parseFloat(value);}}if(value!=null){style[key]=value;}}else{if(entry.nodeName=="remove"){delete style[key];}}}entry=entry.nextSibling;}obj.putCellStyle(as,style);}}node=node.nextSibling;}return obj;};return codec;}());mxCodecRegistry.register(function(){var A=new mxObjectCodec(new mxDefaultKeyHandler());A.encode=function(B,C){return null;};A.decode=function(H,E,C){if(C!=null){var D=C.editor;E=E.firstChild;while(E!=null){if(!this.processInclude(H,E,C)&&E.nodeName=="add"){var B=E.getAttribute("as");var F=E.getAttribute("action");var G=E.getAttribute("control");C.bindAction(B,F,G);}E=E.nextSibling;}}return C;};return A;}());mxCodecRegistry.register(function(){var codec=new mxObjectCodec(new mxDefaultToolbar());codec.encode=function(enc,obj){return null;};codec.decode=function(dec,node,into){if(into!=null){var editor=into.editor;var model=editor.graph.getModel();node=node.firstChild;while(node!=null){if(node.nodeType==mxConstants.NODETYPE_ELEMENT){if(!this.processInclude(dec,node,into)){if(node.nodeName=="separator"){into.addSeparator();}else{if(node.nodeName=="br"){into.toolbar.addBreak();}else{if(node.nodeName=="hr"){into.toolbar.addLine();}else{if(node.nodeName=="add"){var as=node.getAttribute("as");as=mxResources.get(as)||as;var icon=node.getAttribute("icon");var pressedIcon=node.getAttribute("pressedIcon");var action=node.getAttribute("action");var mode=node.getAttribute("mode");var template=node.getAttribute("template");if(action!=null){into.addItem(as,icon,action,pressedIcon);}else{if(mode!=null){var funct=mxUtils.eval(mxUtils.getTextContent(node));into.addMode(as,icon,mode,pressedIcon,funct);}else{if(template!=null){var cell=editor.templates[template];var style=node.getAttribute("style");if(style!=null){cell=cell.clone();cell.setStyle(style);}var insertFunction=null;var text=mxUtils.getTextContent(node);if(text!=null&&text.length>0){insertFunction=mxUtils.eval(text);}into.addPrototype(as,icon,cell,pressedIcon,insertFunction);}else{var children=mxUtils.getChildNodes(node);if(children.length>0){if(icon==null){var combo=into.addActionCombo(as);for(var i=0;i<children.length;i++){var child=children[i];if(child.nodeName=="separator"){into.addOption(combo,"---");}else{if(child.nodeName=="add"){var lab=child.getAttribute("as");var act=child.getAttribute("action");into.addActionOption(combo,lab,act);}}}}else{var select=null;var create=function(){var template=editor.templates[select.value];if(template!=null){var clone=template.clone();var style=select.options[select.selectedIndex].cellStyle;if(style!=null){clone.setStyle(style);}return clone;}else{mxLog.warn("Template "+template+" not found");}return null;};var img=into.addPrototype(as,icon,create);select=into.addCombo();mxEvent.addListener(select,"change",function(){into.toolbar.selectMode(img,function(evt){var pt=mxUtils.convertPoint(editor.graph.container,evt.clientX,evt.clientY);return editor.addVertex(null,funct(),pt.x,pt.y);});into.toolbar.noReset=false;});for(var i=0;i<children.length;i++){var child=children[i];if(child.nodeName=="separator"){into.addOption(select,"---");}else{if(child.nodeName=="add"){var lab=child.getAttribute("as");var tmp=child.getAttribute("template");var option=into.addOption(select,lab,tmp||template);option.cellStyle=child.getAttribute("style");}}}}}}}}}}}}}}node=node.nextSibling;}}return into;};return codec;}());mxCodecRegistry.register(function(){var A=new mxObjectCodec(new mxDefaultPopupMenu());A.encode=function(B,C){return null;};A.decode=function(E,C,B){var D=C.getElementsByTagName("include")[0];if(D!=null){this.processInclude(E,D,B);}else{if(B!=null){B.config=C;}}return B;};return A;}());mxCodecRegistry.register(function(){var A=new mxObjectCodec(new mxEditor(),["modified","lastSnapshot","ignoredChanges","undoManager","graphContainer","toolbarContainer"]);A.afterDecode=function(F,D,E){var B=D.getAttribute("defaultEdge");if(B!=null){D.removeAttribute("defaultEdge");E.defaultEdge=E.templates[B];}var C=D.getAttribute("defaultGroup");if(C!=null){D.removeAttribute("defaultGroup");E.defaultGroup=E.templates[C];}return E;};A.decodeChild=function(E,D,B){if(D.nodeName=="Array"){var C=D.getAttribute("as");if(C=="templates"){this.decodeTemplates(E,D,B);return ;}}else{if(D.nodeName=="ui"){this.decodeUi(E,D,B);return ;}}mxObjectCodec.prototype.decodeChild.apply(this,arguments);};A.decodeUi=function(G,E,K){var I=E.firstChild;while(I!=null){if(I.nodeName=="add"){var F=I.getAttribute("as");var H=I.getAttribute("element");var B=I.getAttribute("style");var J=null;if(H!=null){J=document.getElementById(H);if(J!=null&&B!=null){J.style.cssText+=";"+B;}}else{var M=parseInt(I.getAttribute("x"));var L=parseInt(I.getAttribute("y"));var C=I.getAttribute("width");var N=I.getAttribute("height");J=document.createElement("div");J.style.cssText=B;var D=new mxWindow(mxResources.get(F)||F,J,M,L,C,N,false,true);D.setVisible(true);}if(F=="graph"){K.setGraphContainer(J);}else{if(F=="toolbar"){K.setToolbarContainer(J);}else{if(F=="title"){K.setTitleContainer(J);}else{if(F=="status"){K.setStatusContainer(J);}else{if(F=="map"){K.setMapContainer(J);}}}}}}else{if(I.nodeName=="resource"){mxResources.add(I.getAttribute("basename"));}else{if(I.nodeName=="stylesheet"){mxClient.link("stylesheet",I.getAttribute("name"));}}}I=I.nextSibling;}};A.decodeTemplates=function(H,F,E){if(E.templates==null){E.templates=[];}var D=mxUtils.getChildNodes(F);for(var C=0;C<D.length;C++){var B=D[C].getAttribute("as");var G=D[C].firstChild;while(G!=null&&G.nodeType!=1){G=G.nextSibling;}if(G!=null){E.templates[B]=H.decodeCell(G);}}};return A;}());if(true&&!false&&!false){mxClient.include("chrome://global/content/contentAreaUtils.js");}if(false){window.attachEvent("onunload",function(){mxClient.unload();});}