Ext.namespace("utils.km.portal");utils.km.portal.NavPanel=function(B){this.frames=B;this.menuTree=new MenuTree(Tool.parseXML('<root _id="root"><forder _hasChild="1" event="event1"><e _id="0" _parent="root" title="'+"门户管理".loc()+'"  program="portal"  params="isSystem=y&amp;id=0&amp;portal_id=0" url="/utils/km/portal/tree.jcp?id=0&amp;level=1&amp;root=&amp;view=create"/></forder></root>'));this.event1=new Object();this.clickEvent=function(C){var E=this.frames.get("Portal");if(C.prop.program=="menu"){if(!E.mainPanel.havePanel("portalBase")){using("utils.km.portal.PortalPanel");E.menu=new utils.km.portal.PortalPanel(this.frames,E);E.mainPanel.add(E.menu.MainTabPanel);}E.mainPanel.setActiveTab("portalBase");if(C.prop.params){var G={};var F=C.prop.params.split("&");for(var D=0;D<F.length;D++){G[F[D].split("=")[0]]=F[D].split("=")[1];}G.son=C.prop._hasChild;E.menu.formEdit();G.prgType="menu";E.menu.loadData(G);}}else{if(C.prop.program=="top"){if(C.prop.params){var G={};var F=C.prop.params.split("&");for(var D=0;D<F.length;D++){G[F[D].split("=")[0]]=F[D].split("=")[1];}G.parent_id=G.id;if(!E.mainPanel.havePanel("topPortalBase")){using("utils.km.portal.TopPortalPanel");E.topMenu=new utils.km.portal.TopPortalPanel(this.frames,E,"topPortal",G);E.mainPanel.add(E.topMenu.MainTabPanel);}E.mainPanel.setActiveTab("topPortalBase");E.topMenu.formEdit();G.prgType="top";E.topMenu.loadData(G);}}else{if(C.prop.program=="portal"){if(C.prop.params){var G={};var F=C.prop.params.split("&");for(var D=0;D<F.length;D++){G[F[D].split("=")[0]]=F[D].split("=")[1];}G.parent_id=G.id;if(!E.mainPanel.havePanel("topPortalBase")){using("utils.km.portal.TopPortalPanel");E.topMenu=new utils.km.portal.TopPortalPanel(this.frames,E,"topPortal",G);E.mainPanel.add(E.topMenu.MainTabPanel);}E.mainPanel.setActiveTab("topPortalBase");G.prgType="portal";E.topMenu.formCreate(G);}}else{if(C.prop.program=="publish"){if(!E.mainPanel.havePanel("publishBase")){using("utils.km.portal.PublishPanel");E.menu=new utils.km.portal.PublishPanel(this.frames,E);E.mainPanel.add(E.menu.MainTabPanel);}E.mainPanel.setActiveTab("publishBase");if(C.prop.params){var G={};var F=C.prop.params.split("&");for(var D=0;D<F.length;D++){G[F[D].split("=")[0]]=F[D].split("=")[1];}G.son=C.prop._hasChild;E.menu.formEdit();G.prgType="publish";E.menu.loadData(G);}}}}}}.createDelegate(this);this.frames.set("clickEvent",this.clickEvent);var A=this.clickEvent;this.event1.title_click=function(){A(this);};this.menuTree.setEvent("event1",this.event1);utils.km.portal.NavPanel.superclass.constructor.call(this,{title:"门户导航".loc(),region:"west",split:true,width:225,collapsible:true,resizable:false,cmargins:"3 3 3 3"});};Ext.extend(utils.km.portal.NavPanel,Ext.Panel,{init:function(){this.menuTree.finish(this.body.dom,document);this.focusHistoryNode();},getTree:function(){return this.menuTree;},exeHistoryNode:function(C,B){if(B.prop.event&&B.prop.params){this.clickEvent(B);}else{if(B.prop._parent=="0"&&B.index()==B.parent.son.length-1){return ;}else{C.moveNext();var A=C.getNowNode();this.exeHistoryNode(C,A);}}},focusHistoryNode:function(){uStore=new UserStore(tree_store);if(uStore.getAttribute("menu")){this.menuTree.loadHistory("menu");var A=this.menuTree.getNowNode();}else{var A=this.menuTree.getNowNode();this.menuTree.loadHistory("menu");}this.exeHistoryNode(this.menuTree,A);}});