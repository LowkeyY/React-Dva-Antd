Ext.namespace("lib.GroupHeaderGrid");lib.GroupHeaderGrid.LockedGroupHeaderGrid=function(A){Ext.apply(this,A);};Ext.extend(lib.GroupHeaderGrid.LockedGroupHeaderGrid,Ext.util.Observable,{init:function(B){var A=B.getView();A.beforeMethod("initTemplates",this.initTemplates);A.renderHeaders=this.renderHeaders.createDelegate(A,[A.renderHeaders]);A.afterMethod("onColumnWidthUpdated",this.updateGroupStyles);A.afterMethod("onAllColumnWidthsUpdated",this.updateGroupStyles);A.afterMethod("onColumnHiddenUpdated",this.updateGroupStyles);A.getHeaderCell=this.getHeaderCell;A.updateSortIcon=this.updateSortIcon;A.getGroupStyle=this.getGroupStyle;},initTemplates:function(){var A=this.templates||{};if(!A.gcell){A.gcell=new Ext.Template('<td class="x-grid3-hd {cls} x-grid3-td-{id}" style="{style}">','<div {tooltip} class="x-grid3-hd-inner x-grid3-hd-{id}" unselectable="on" style="{istyle}">{value}</div>',"</td>");}this.templates=A;},renderHeaders:function(B){var K=this.templates,N=[[],[]],J=this.cm.getTotalWidth(),E=this.cm.getTotalLockedWidth();for(var H=0;H<this.cm.rows.length;H++){var A=this.cm.rows[H],M=[[],[]],D=0;for(var G=0;G<A.length;G++){var L=A[G];L.colspan=L.colspan||1;L.col=D;var F=this.cm.isLocked(D)?1:0;D+=L.colspan;var C=this.getGroupStyle(L);M[F][G]=K.gcell.apply({id:L.id||H+"-"+D,cls:L.header?"ux-grid-hd-group-cell":"ux-grid-hd-nogroup-cell",style:"width:"+C.width+";"+(C.hidden?"display:none;":"")+(L.align?"text-align:"+L.align+";":""),tooltip:L.tooltip?(Ext.QuickTips.isEnabled()?"ext:qtip":"title")+'="'+L.tooltip+'"':"",value:L.header||"*",istyle:L.align=="right"?"padding-right:16px":""});}N[0][H]=K.header.apply({tstyle:"width:"+(J-E)+"px;",cells:M[0].join("")});N[1][H]=K.header.apply({tstyle:"width:"+E+"px;",cells:M[1].join("")});}var I=B.call(this);N[0][N.length]=I[0];N[1][N.length]=I[1];return[N[0].join(""),N[1].join("")];},getGroupStyle:function(E){var B=0,D=true;for(var C=E.col;C<E.col+E.colspan;C++){if(!this.cm.isHidden(C)){var A=this.cm.getColumnWidth(C);if(typeof A=="number"){B+=A;}D=false;}}return{width:(Ext.isBorderBox?B:Math.max(B-this.borderWidth,0))+"px",hidden:D};},updateGroupStyles:function(B){var H=[this.mainHd.query(".x-grid3-header-offset > table"),this.lockedHd.query(".x-grid3-header-offset > table")],F=this.cm.getTotalWidth(),C=this.cm.getTotalLockedWidth();for(var E=0;E<H[0].length;E++){H[0][E].style.width=(F-C)+"px";H[1][E].style.width=C+"px";if(E<this.cm.rows.length){var I=[],G=[H[1][E].firstChild.firstChild.childNodes,H[0][E].firstChild.firstChild.childNodes];for(l=0;l<2;l++){for(D=0;D<G[l].length;D++){I.push(G[l][D]);}}for(var D=0;D<I.length;D++){var G=this.cm.rows[E][D];if((typeof B!="number")||(B>=G.col&&B<G.col+G.colspan)){var A=this.getGroupStyle(G);I[D].style.width=A.width;I[D].style.display=A.hidden?"none":"";}}}}},getHeaderCell:function(B){var A=this.cm.getLockedCount();if(B<A){return this.lockedHd.query("td.x-grid3-cell")[B];}else{return this.mainHd.query("td.x-grid3-cell")[(B-A)];}},updateSortIcon:function(C,B){var F=this.sortClasses;var A=this.cm.getColumnCount();var G=this.cm.getLockedCount();var E=this.mainHd.select("td.x-grid3-cell").removeClass(F);var D=this.lockedHd.select("td.x-grid3-cell").removeClass(F);if(G>0&&C<G){D.item(C).addClass(F[B=="DESC"?1:0]);}else{E.item(C-G).addClass(F[B=="DESC"?1:0]);}}});