Ext.namespace("lib.ColorField");lib.ColorField.ColorField=Ext.extend(Ext.form.TriggerField,{invalidText:"'{0}' is not a valid color - it must be in a the hex format (# followed by 3 or 6 letters/numbers 0-9 A-F)",defaultAutoCreate:{tag:"input",type:"text",size:"10",maxlength:"7",autocomplete:"off"},maskRe:/[#a-f0-9]/i,validateValue:function(value){if(!this.rendered||!Ext.isDefined(this.el)){return true;}if(!lib.ColorField.ColorField.superclass.validateValue.call(this,value)){return false;}if(value.length<1){this.setColor("");return true;}var parseOK=this.parseColor(value);if(!value||(parseOK==false)){this.markInvalid(String.format(this.invalidText,value));return false;}this.setColor(value);return true;},setColor:function(color){if(color==""||color==undefined){if(this.emptyText!=""&&this.parseColor(this.emptyText)){color=this.emptyText;}else{color="transparent";}}if(this.el){this.getEl().setStyle("color",color);}},validateBlur:function(){return !this.menu||!this.menu.isVisible();},getValue:function(){return lib.ColorField.ColorField.superclass.getValue.call(this)||"";},setValue:function(color){var co=this.formatColor(color);lib.ColorField.ColorField.superclass.setValue.call(this,co);this.setColor(co);if(this.rendered){if(co=="#FFFFFF"||co=="#FFF"){this.setTextFiledBgColor("#EEEEEE");this.grayBackGround=true;}else{if(this.grayBackGround){this.setTextFiledBgColor();this.grayBackGround=false;}}}},setTextFiledBgColor:function(co){if(co){this.el.setStyle("background-image","none");this.el.setStyle("font-weight","bold");this.el.setStyle("background-color",co);}else{this.el.setStyle("background-image","");this.el.setStyle("font-weight","");this.el.setStyle("background-color","");}},parseColor:function(value){return(!value||(value.substring(0,1)!="#"))?false:(value.length==4||value.length==7);},formatColor:function(value){if(!value||this.parseColor(value)){return value;}if(value.length==3||value.length==6){return"#"+value;}return"";},menuListeners:{select:function(e,c){this.setValue(c);},show:function(){this.onFocus();},hide:function(){this.focus.defer(10,this);var ml=this.menuListeners;this.menu.un("select",ml.select,this);this.menu.un("show",ml.show,this);this.menu.un("hide",ml.hide,this);}},onTriggerClick:function(){if(this.disabled){return ;}if(this.menu==null){this.menu=new Ext.menu.ColorMenu();}this.menu.on(Ext.apply({},this.menuListeners,{scope:this}));this.menu.show(this.el,"tl-bl?");}});Ext.reg("colorfield",lib.ColorField.ColorField);