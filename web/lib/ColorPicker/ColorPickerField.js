Ext.namespace("lib.ColorPicker");lib.ColorPicker.ColorPickerField=Ext.extend(Ext.form.TwinTriggerField,{editMode:"picker",onResize:function(A,B){lib.ColorPicker.ColorPickerField.superclass.onResize.apply(this,arguments);if(this.hideHtmlCode&&this.colorMask){this.colorMask.setBox(this.createColorMaskBox());}},onRender:function(B,A){lib.ColorPicker.ColorPickerField.superclass.onRender.apply(this,arguments);if(this.hideHtmlCode){this.colorMask=this.el.createProxy("x-form-colorfield-colorMask",null,true);this.colorMask.setBox(this.createColorMaskBox());}this.updateElColor();},updateElColor:function(){if(this.el){var B=this.getValue();var C="ffffff";var A="ffffff";if(B){alphaRgb=this.splitAphaRgbHex(B.replace("#",""));C=alphaRgb.rgbHex;A=(this.hideHtmlCode)?C:this.rgbToHex(this.invert(this.hexToRgb(C)));}this.el.applyStyles("background: #"+C+";color:#"+A);if(this.colorMask){this.colorMask.applyStyles("background: #"+C+";");}}},createColorMaskBox:function(){var A=this.el.getBox();A.x+=2;A[0]+=2;A.y+=2;A[1]+=2;A.width-=3;A.height-=4;A.right-=1;A.bottom-=2;return A;},initComponent:function(){this.editable=!this.hideHtmlCode;this.selectOnFocus=!(this.hideHtmlCode||!this.selectOnFocus);lib.ColorPicker.ColorPickerField.superclass.initComponent.apply(this,arguments);this.picker=-1;switch(this.editMode){case"picker":this.trigger1Class="x-form-colorfield-picker";this.triggerConfig={tag:"span",cls:"x-form-twin-triggers",cn:[{tag:"img",src:Ext.BLANK_IMAGE_URL,cls:"x-form-trigger "+this.trigger1Class}]};this.picker=0;break;case"palette":this.trigger1Class="x-form-colorfield-palette";this.triggerConfig={tag:"span",cls:"x-form-twin-triggers",cn:[{tag:"img",src:Ext.BLANK_IMAGE_URL,cls:"x-form-trigger "+this.trigger1Class}]};this.palette=0;break;default:this.trigger1Class="x-form-colorfield-palette";this.trigger2Class="x-form-colorfield-picker";this.triggerConfig={tag:"span",cls:"x-form-twin-triggers",cn:[{tag:"img",src:Ext.BLANK_IMAGE_URL,cls:"x-form-trigger "+this.trigger1Class},{tag:"img",src:Ext.BLANK_IMAGE_URL,cls:"x-form-trigger "+this.trigger2Class}]};this.palette=0;this.picker=1;}this.menus=[];if(this.palette>=0){this.menus[this.palette]=new Ext.menu.ColorMenu({listeners:{select:this.onSelect,scope:this}});}if(this.picker>=0){this.menus[this.picker]=new Ext.ux.menu.ColorMenu({opacity:this.opacity,listeners:{select:this.onSelect,scope:this}});}},onSelect:function(A,B){this.setValue(B);this.focus.defer(10,this);},focus:function(B,A){lib.ColorPicker.ColorPickerField.superclass.focus.call(this,B&&!this.hideHtmlCode,A);},setValue:function(A){if(A){A=A.replace("#","").toUpperCase();var B=this.splitAphaRgbHex(A);if(this.opacity&&B){A=B.alphaRgbHex;}A="#"+A;}lib.ColorPicker.ColorPickerField.superclass.setValue.call(this,A);this.updateElColor();},onDestroy:function(){Ext.destroy(this.menus,this.wrap,this.colorMask);lib.ColorPicker.ColorPickerField.superclass.onDestroy.apply(this,arguments);},onBlur:function(){lib.ColorPicker.ColorPickerField.superclass.onBlur.apply(this,arguments);this.setValue(this.getValue());},onTrigger1Click:function(){if(this.disabled){return ;}this.menus[0].show(this.el,"tl-bl?");if(this.picker==0){this.menus[0].picker.setColor(this.getValue());}},onTrigger2Click:function(){if(this.disabled){return ;}this.menus[1].show(this.el,"tl-bl?");if(this.picker==1){this.menus[1].picker.setColor(this.getValue());}},hexToRgb:Ext.ux.ColorPicker.prototype.hexToRgb,rgbToHex:Ext.ux.ColorPicker.prototype.rgbToHex,decToHex:Ext.ux.ColorPicker.prototype.decToHex,hexToDec:Ext.ux.ColorPicker.prototype.hexToDec,getHCharPos:Ext.ux.ColorPicker.prototype.getHCharPos,invert:Ext.ux.ColorPicker.prototype.invert,splitAphaRgbHex:Ext.ux.ColorPicker.prototype.splitAphaRgbHex});Ext.reg("colorpickerfield",lib.ColorPicker.ColorPickerField);