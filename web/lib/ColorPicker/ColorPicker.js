Ext.namespace("lib.ColorPicker");lib.ColorPicker.ColorPicker=Ext.extend(Ext.BoxComponent,{opacity:true,colorNames:{aliceblue:"F0F8FF",antiquewhite:"FAEBD7",aqua:"00FFFF",aquamarine:"7FFFD4",azure:"F0FFFF",beige:"F5F5DC",bisque:"FFE4C4",black:"000000",blanchedalmond:"FFEBCD",blue:"0000FF",blueviolet:"8A2BE2",brown:"A52A2A",burlywood:"DEB887",cadetblue:"5F9EA0",chartreuse:"7FFF00",chocolate:"D2691E",coral:"FF7F50",cornflowerblue:"6495ED",cornsilk:"FFF8DC",crimson:"DC143C",cyan:"00FFFF",darkblue:"00008B",darkcyan:"008B8B",darkgoldenrod:"B8860B",darkgray:"A9A9A9",darkgreen:"006400",darkgrey:"A9A9A9",darkkhaki:"BDB76B",darkmagenta:"8B008B",darkolivegreen:"556B2F",darkorange:"FF8C00",darkorchid:"9932CC",darkred:"8B0000",darksalmon:"E9967A",darkseagreen:"8FBC8F",darkslateblue:"483D8B",darkslategray:"2F4F4F",darkslategrey:"2F4F4F",darkturquoise:"00CED1",darkviolet:"9400D3",deeppink:"FF1493",deepskyblue:"00BFFF",dimgray:"696969",dimgrey:"696969",dodgerblue:"1E90FF",firebrick:"B22222",floralwhite:"FFFAF0",forestgreen:"228B22",fuchsia:"FF00FF",gainsboro:"DCDCDC",ghostwhite:"F8F8FF",gold:"FFD700",goldenrod:"DAA520",gray:"808080",green:"008000",greenyellow:"ADFF2F",grey:"808080",honeydew:"F0FFF0",hotpink:"FF69B4",indianred:"CD5C5C",indigo:"4B0082",ivory:"FFFFF0",khaki:"F0E68C",lavender:"E6E6FA",lavenderblush:"FFF0F5",lawngreen:"7CFC00",lemonchiffon:"FFFACD",lightblue:"ADD8E6",lightcoral:"F08080",lightcyan:"E0FFFF",lightgoldenrodyellow:"FAFAD2",lightgray:"D3D3D3",lightgreen:"90EE90",lightgrey:"D3D3D3",lightpink:"FFB6C1",lightsalmon:"FFA07A",lightseagreen:"20B2AA",lightskyblue:"87CEFA",lightslategray:"778899",lightslategrey:"778899",lightsteelblue:"B0C4DE",lightyellow:"FFFFE0",lime:"00FF00",limegreen:"32CD32",linen:"FAF0E6",magenta:"FF00FF",maroon:"800000",mediumaquamarine:"66CDAA",mediumblue:"0000CD",mediumorchid:"BA55D3",mediumpurple:"9370DB",mediumseagreen:"3CB371",mediumslateblue:"7B68EE",mediumspringgreen:"00FA9A",mediumturquoise:"48D1CC",mediumvioletred:"C71585",midnightblue:"191970",mintcream:"F5FFFA",mistyrose:"FFE4E1",moccasin:"FFE4B5",navajowhite:"FFDEAD",navy:"000080",oldlace:"FDF5E6",olive:"808000",olivedrab:"6B8E23",orange:"FFA500",orangered:"FF4500",orchid:"DA70D6",palegoldenrod:"EEE8AA",palegreen:"98FB98",paleturquoise:"AFEEEE",palevioletred:"DB7093",papayawhip:"FFEFD5",peachpuff:"FFDAB9",peru:"CD853F",pink:"FFC0CB",plum:"DDA0DD",powderblue:"B0E0E6",purple:"800080",red:"FF0000",rosybrown:"BC8F8F",royalblue:"4169E1",saddlebrown:"8B4513",salmon:"FA8072",sandybrown:"F4A460",seagreen:"2E8B57",seashell:"FFF5EE",sienna:"A0522D",silver:"C0C0C0",skyblue:"87CEEB",slateblue:"6A5ACD",slategray:"708090",slategrey:"708090",snow:"FFFAFA",springgreen:"00FF7F",steelblue:"4682B4",tan:"D2B48C",teal:"008080",thistle:"D8BFD8",tomato:"FF6347",turquoise:"40E0D0",violet:"EE82EE",wheat:"F5DEB3",white:"FFFFFF",whitesmoke:"F5F5F5",yellow:"FFFF00",yellowgreen:"9ACD32"},initComponent:function(){this.applyDefaultsCP();lib.ColorPicker.ColorPicker.superclass.initComponent.apply(this,arguments);this.addEvents("select");},onRender:function(){lib.ColorPicker.ColorPicker.superclass.onRender.apply(this,arguments);this.body=this.body||(this.container||(this.renderTo||Ext.DomHelper.append(Ext.getBody(),{},true)));if(!this.el){this.el=this.body;if(this.cls){Ext.get(this.el).addClass(this.cls);}}this.body.setSize(328,this.opacity?211:191);this.renderComponent();},applyDefaultsCP:function(){Ext.apply(this,{cls:"x-cp-mainpanel",resizable:this.resizable||false,HSV:{h:0,s:0,v:0},updateMode:null});},renderComponent:function(){this.rgbEl=Ext.DomHelper.append(this.body,{id:this.cpGetId("rgb"),cls:"x-cp-rgbpicker"},true);this.hueEl=Ext.DomHelper.append(this.body,{id:this.cpGetId("hue"),cls:"x-cp-huepicker"},true);if(this.opacity){this.opacityEl=Ext.DomHelper.append(this.body,{id:this.cpGetId("opacity"),cls:"x-cp-opacitypicker"},true);}this.hueSliderEl=Ext.DomHelper.append(this.body,{cls:"x-cp-slider",id:this.cpGetId("hueSlider")},true);this.hueDD=new Ext.dd.DD(this.hueSliderEl,"huePicker");this.hueDD.constrainTo(this.hueEl.id,{top:-7,right:-3,bottom:-7,left:-3});this.hueDD.onDrag=this.moveHuePicker.createDelegate(this);this.hueEl.on("mousedown",this.clickHUEPicker.createDelegate(this));Ext.get(this.hueSliderEl).moveTo(this.hueEl.getLeft()-3,this.hueEl.getTop()-7);this.rgbSliderEl=Ext.DomHelper.append(this.body,{cls:"x-cp-slider",id:this.cpGetId("rgbSlider")},true);this.rgbDD=new Ext.dd.DD(this.rgbSliderEl.id,"rgbPicker");this.rgbDD.constrainTo(this.rgbEl.id,-7);this.rgbDD.onDrag=this.moveRGBPicker.createDelegate(this);this.rgbEl.on("mousedown",this.clickRGBPicker.createDelegate(this));this.rgbSliderEl.moveTo(this.rgbEl.getLeft()-7,this.rgbEl.getTop()-7);if(this.opacity){this.opacitySliderEl=Ext.DomHelper.append(this.body,{cls:"x-cp-slider",id:this.cpGetId("opacitySlider")},true);this.opacityDD=new Ext.dd.DD(this.opacitySliderEl.id,"opacityPicker");this.opacityDD.constrainTo(this.opacityEl.id,{top:-3,right:-7,bottom:-3,left:-7});this.opacityDD.onDrag=this.moveOpacityPicker.createDelegate(this);this.opacityEl.on("mousedown",this.clickOpacityPicker.createDelegate(this));this.opacitySliderEl.moveTo(this.opacityEl.getRight()-7,this.opacityEl.getTop()-3);this.alpha=255;}Ext.DomHelper.append(this.body,{id:this.cpGetId("fCont"),cls:"x-cp-formcontainer"},true);this.formPanel=new Ext.form.FormPanel({renderTo:this.cpGetId("fCont"),height:this.opacity?202:182,width:110,frame:true,header:false,id:"colorPickerFormContainer",labelAlign:"left",labelWidth:37,forceLayout:true,items:[{layout:"column",defaults:{columnWidth:0.5,layout:"form",labelWidth:10,defaultType:"numberfield",defaults:{width:30,value:0,minValue:0,maxValue:255,allowBlank:false,labelSeparator:""}},items:[{items:[{fieldLabel:"R",tabIndex:1,id:this.cpGetId("iRed")},{fieldLabel:"G",tabIndex:2,id:this.cpGetId("iGreen")},{fieldLabel:"B",tabIndex:3,id:this.cpGetId("iBlue")}]},{style:{paddingLeft:"3px"},items:[{fieldLabel:"H",maxValue:360,tabIndex:4,id:this.cpGetId("iHue")},{fieldLabel:"S",tabIndex:5,id:this.cpGetId("iSat")},{fieldLabel:"V",tabIndex:6,id:this.cpGetId("iVal")}]}]},{layout:"form",labelAlign:"left",items:[{xtype:"textfield",width:55,allowBlank:false,fieldLabel:"HTML",tabIndex:7,labelSeparator:"",id:this.cpGetId("iHexa"),value:"000000"},{hideLabel:true,width:116,layout:"form",labelWidth:62,hidden:!this.opacity,items:[{xtype:"numberfield",fieldLabel:"Opacity",id:this.cpGetId("iOpacity"),width:30,value:100,minValue:0,maxValue:100,allowBlank:false,labelSeparator:""}]},{hideLabel:true,anchor:"100%",height:44,width:98,layout:"table",layoutConfig:{columns:"2"},id:this.cpGetId("cColorCt"),cls:"x-cp-preview",items:[{border:true,width:75,height:42,rowspan:2,html:[{id:this.cpGetId("cColor"),cls:"x-cp-previewbox"},{id:this.cpGetId("cColorOpacity"),cls:"x-cp-previewbox"}]},{xtype:"button",iconCls:"x-cp-webSafe",tabIndex:8,id:this.cpGetId("cWebSafe"),handler:this.updateFromBox.createDelegate(this)},{xtype:"button",iconCls:"x-cp-inverse",tabIndex:9,id:this.cpGetId("cInverse"),handler:this.updateFromBox.createDelegate(this)}]}]}]});this.redCmp=Ext.getCmp(this.cpGetId("iRed"));this.greenCmp=Ext.getCmp(this.cpGetId("iGreen"));this.blueCmp=Ext.getCmp(this.cpGetId("iBlue"));this.hueCmp=Ext.getCmp(this.cpGetId("iHue"));this.satCmp=Ext.getCmp(this.cpGetId("iSat"));this.valCmp=Ext.getCmp(this.cpGetId("iVal"));this.hexaCmp=Ext.getCmp(this.cpGetId("iHexa"));this.redCmp.on("change",this.updateFromIRGB.createDelegate(this));this.greenCmp.on("change",this.updateFromIRGB.createDelegate(this));this.blueCmp.on("change",this.updateFromIRGB.createDelegate(this));this.hueCmp.on("change",this.updateFromIHSV.createDelegate(this));this.satCmp.on("change",this.updateFromIHSV.createDelegate(this));this.valCmp.on("change",this.updateFromIHSV.createDelegate(this));this.hexaCmp.on("change",this.updateFromIHexa.createDelegate(this));this.previewEl=Ext.get(this.cpGetId("cColor"));this.opacityPreviewEl=Ext.get(this.cpGetId("cColorOpacity"));this.inverseButton=Ext.getCmp(this.cpGetId("cInverse"));this.webSafeButton=Ext.getCmp(this.cpGetId("cWebSafe"));Ext.DomHelper.append(this.body,{tag:"br",cls:"x-cp-clearfloat"});},onDestroy:function(){lib.ColorPicker.ColorPicker.superclass.onDestroy.apply(this,arguments);Ext.destroyMembers(this,"formPanel","inverseButton","webSafeButton","rgbEl","hueEl","opacityEl","rgbSliderEl","hueSliderEl","opacitySliderEl","previewEl","opacityPreviewEl","redCmp","greenCmp","blueCmp","hueCmp","satCmp","valCmp","hexaCmp");},cpGetId:function(A){return this.getId()+"__"+(A||"cp");},updateRGBPosition:function(A,B){this.updateMode="click";A=A<0?0:A;A=A>181?181:A;B=B<0?0:B;B=B>181?181:B;this.HSV.s=this.getSaturation(A);this.HSV.v=this.getValue(B);this.rgbSliderEl.moveTo(this.rgbEl.getLeft()+A-7,this.rgbEl.getTop()+B-7,(this.animateMove||true));this.updateColor();},updateHUEPosition:function(A){this.updateMode="click";A=A<1?1:A;A=A>181?181:A;this.HSV.h=Math.round(360/181*(181-A));this.hueSliderEl.moveTo(this.hueSliderEl.getLeft(),this.hueEl.getTop()+A-7,(this.animateMove||true));this.updateRGBPicker(this.HSV.h);this.updateColor();},updateOpacityPosition:function(A){this.updateMode="click";A=A<1?1:A;A=A>181?181:A;this.alpha=Math.round(A/181*255);this.opacitySliderEl.moveTo(this.opacityEl.getLeft()+A-7,this.opacitySliderEl.getTop(),(this.animateMove||true));this.updateColor();},clickRGBPicker:function(B,A){this.updateRGBPosition(B.xy[0]-this.rgbEl.getLeft(),B.xy[1]-this.rgbEl.getTop());},clickHUEPicker:function(B,A){this.updateHUEPosition(B.xy[1]-this.hueEl.getTop());},clickOpacityPicker:function(B,A){this.updateOpacityPosition(B.xy[0]-this.opacityEl.getLeft());},moveRGBPicker:function(A){this.rgbDD.constrainTo(this.rgbEl.id,-7);this.updateRGBPosition(this.rgbSliderEl.getLeft()-this.rgbEl.getLeft()+7,this.rgbSliderEl.getTop()-this.rgbEl.getTop()+7);},moveHuePicker:function(A){this.hueDD.constrainTo(this.hueEl.id,{top:-7,right:-3,bottom:-7,left:-3});this.updateHUEPosition(this.hueSliderEl.getTop()-this.hueEl.getTop()+7);},moveOpacityPicker:function(A){this.opacityDD.constrainTo(this.opacityEl.id,{top:-3,right:-7,bottom:-3,left:-7});this.updateOpacityPosition(this.opacitySliderEl.getLeft()-this.opacityEl.getLeft()+7);},updateRGBPicker:function(A){this.updateMode="click";this.rgbEl.setStyle({"background-color":"#"+this.rgbToHex(this.hsvToRgb(A,1,1))});this.updateColor();},updateColor:function(){var B=this.hsvToRgb(this.HSV.h,this.HSV.s,this.HSV.v);var E=this.websafe(B);var F=this.invert(B);var A=this.invert(E);if(this.updateMode!=="hexa"){this.hexaCmp.setValue(this.rgbToHex(B));}if(this.updateMode!=="rgb"){this.redCmp.setValue(B[0]);this.greenCmp.setValue(B[1]);this.blueCmp.setValue(B[2]);}if(this.updateMode!=="hsv"){this.hueCmp.setValue(Math.round(this.HSV.h));this.satCmp.setValue(Math.round(this.HSV.s*100));this.valCmp.setValue(Math.round(this.HSV.v*100));}var G=this.rgbToHex(B);var D=this.rgbToHex(E);var C=this.rgbToHex(F);this.previewEl.setStyle({background:"#"+G});this.opacityPreviewEl.setStyle({background:"#"+G});if(this.opacity){this.opacityEl.setStyle({"background-color":"#"+G});Ext.getCmp(this.cpGetId("iOpacity")).setValue(Math.round(this.alpha/2.56));this.opacityPreviewEl.applyStyles("opacity:"+(this.alpha/255));}this.webSafeButton.cpColor=D;this.inverseButton.cpColor=C;this.inverseButton.setTooltip({title:"Inverse Color",text:'<div class="x-cp-tooltipcolorbox" style="background-color:#'+C+";color:#"+G+'">#'+C+"</div>"});this.webSafeButton.setTooltip({title:"WebSafe Color",text:'<div class="x-cp-tooltipcolorbox" style="background-color:#'+D+";color:#"+C+'">#'+D+"</div>"});this.hueSliderEl.moveTo(this.hueSliderEl.getLeft(),this.hueEl.getTop()+this.getHPos(this.hueCmp.getValue())-7,(this.animateMove||true));this.rgbSliderEl.moveTo(this.rgbEl.getLeft()+this.getSPos(this.satCmp.getValue()/100)-7,this.hueEl.getTop()+this.getVPos(this.valCmp.getValue()/100)-7,(this.animateMove||true));this.rgbEl.setStyle({"background-color":"#"+this.rgbToHex(this.hsvToRgb(this.hueCmp.getValue(),1,1))});},setColor:function(B){var A=this.splitAphaRgbHex(B.replace("#",""));if(!A){return ;}this.alpha=A.alpha;if(this.opacity){this.opacitySliderEl.moveTo(this.opacityEl.getLeft()+(A.alpha/255*181)-7,this.opacitySliderEl.getTop(),(this.animateMove||true));}this.hexaCmp.setValue(A.rgbHex);this.updateFromIHexa();},splitAphaRgbHex:function(A){if(this.opacity&&/^[0-9a-fA-F]{8}$/.test(A)){return{alphaRgbHex:A,alphaHex:A.substring(0,2),rgbHex:A.substring(2),alpha:this.hexToDec(A.substring(0,2))};}if(A.indexOf("rgb(")==0){A=A.replace(/ /g,"");A=A.substring(4,A.length-1).split(",");A=this.rgbToHex(A[0],A[1],A[2]);}else{if(!/^[0-9a-fA-F]{6}$/.test(A)){A=lib.ColorPicker.ColorPicker.colorNames[A];if(!Ext.isDefined(A)){return ;}}}return{alphaRgbHex:"FF"+A,alphaHex:"FF",rgbHex:A,alpha:255};},updateFromIRGB:function(B,D,C){this.updateMode="rgb";var A=this.rgbToHsv(this.redCmp.getValue(),this.greenCmp.getValue(),this.blueCmp.getValue());this.HSV={h:A[0],s:A[1],v:A[2]};this.updateColor();},updateFromIHSV:function(A,C,B){this.updateMode="hsv";this.HSV={h:this.hueCmp.getValue(),s:this.satCmp.getValue()/100,v:this.valCmp.getValue()/100};this.updateColor();},updateFromIHexa:function(B,D,C){this.updateMode="hexa";var A=this.rgbToHsv(this.hexToRgb(this.hexaCmp.getValue()));this.HSV={h:A[0],s:A[1],v:A[2]};this.updateColor();},updateFromBox:function(C,D){this.updateMode="click";var B=C.cpColor;B=B.replace("#","");var A=this.rgbToHsv(this.hexToRgb(B));this.HSV={h:A[0],s:A[1],v:A[2]};this.updateColor();},selectColor:function(B,A){var C=this.previewEl.getColor("backgroundColor","","");if(this.opacity){C=this.decToHex(this.alpha)+C;}this.fireEvent("select",this,C);},hsvToRgb:function(E,K,I){if(E instanceof Array){return this.hsvToRgb.call(this,E[0],E[1],E[2]);}var A,F,H,D,G,C,B,J;D=Math.floor((E/60)%6);G=(E/60)-D;C=I*(1-K);B=I*(1-G*K);J=I*(1-(1-G)*K);switch(D){case 0:A=I;F=J;H=C;break;case 1:A=B;F=I;H=C;break;case 2:A=C;F=I;H=J;break;case 3:A=C;F=B;H=I;break;case 4:A=J;F=C;H=I;break;case 5:A=I;F=C;H=B;break;}return[this.realToDec(A),this.realToDec(F),this.realToDec(H)];},rgbToHsv:function(A,D,E){if(A instanceof Array){return this.rgbToHsv.call(this,A[0],A[1],A[2]);}A=A/255;D=D/255;E=E/255;var B,F,H,C,I,G;B=Math.min(Math.min(A,D),E);F=Math.max(Math.max(A,D),E);H=F-B;switch(F){case B:C=0;break;case A:C=60*(D-E)/H;if(D<E){C+=360;}break;case D:C=(60*(E-A)/H)+120;break;case E:C=(60*(A-D)/H)+240;break;}I=(F===0)?0:1-(B/F);return[Math.round(C),I,F];},realToDec:function(A){return Math.min(255,Math.round(A*256));},rgbToHex:function(C,B,A){if(C instanceof Array){return this.rgbToHex.call(this,C[0],C[1],C[2]);}return this.decToHex(C)+this.decToHex(B)+this.decToHex(A);},decToHex:function(B){var A="0123456789ABCDEF";B=parseInt(B,10);B=(!isNaN(B))?B:0;B=(B>255||B<0)?0:B;return A.charAt((B-B%16)/16)+A.charAt(B%16);},getHCharPos:function(B){var A="0123456789ABCDEF";return A.indexOf(B.toUpperCase());},hexToDec:function(B){var A=B.split("");return((this.getHCharPos(A[0])*16)+this.getHCharPos(A[1]));},hexToRgb:function(A){return[this.hexToDec(A.substr(0,2)),this.hexToDec(A.substr(2,2)),this.hexToDec(A.substr(4,2))];},getHue:function(B){var A=360-Math.round(((181-B)/181)*360);return A===360?0:A;},getHPos:function(A){return 181-A*(181/360);},getSaturation:function(A){return A/181;},getSPos:function(A){return A*181;},getValue:function(A){return(181-A)/181;},getVPos:function(A){return 181-(A*181);},checkSafeNumber:function(A){if(!isNaN(A)){A=Math.min(Math.max(0,A),255);var B,C;for(B=0;B<256;B=B+51){C=B+51;if(A>=B&&A<=C){return(A-B>25)?C:B;}}}return A;},websafe:function(C,B,A){if(C instanceof Array){return this.websafe.call(this,C[0],C[1],C[2]);}return[this.checkSafeNumber(C),this.checkSafeNumber(B),this.checkSafeNumber(A)];},invert:function(C,B,A){if(C instanceof Array){return this.invert.call(this,C[0],C[1],C[2]);}return[255-C,255-B,255-A];}});lib.ColorPicker.ColorDialog=Ext.extend(Ext.Window,{initComponent:function(){this.width=(!this.width||this.width<353)?353:this.width;this.applyDefaultsCP();lib.ColorPicker.ColorDialog.superclass.initComponent.apply(this,arguments);},onRender:function(){lib.ColorPicker.ColorDialog.superclass.onRender.apply(this,arguments);this.renderComponent();}});Ext.applyIf(lib.ColorPicker.ColorDialog.prototype,lib.ColorPicker.ColorPicker.prototype);lib.ColorPicker.ColorPanel=Ext.extend(Ext.Panel,{initComponent:function(){this.width=(!this.width||this.width<333)?333:this.width;this.applyDefaultsCP();lib.ColorPicker.ColorPanel.superclass.initComponent.apply(this,arguments);},onRender:function(){lib.ColorPicker.ColorPanel.superclass.onRender.apply(this,arguments);this.renderComponent();}});Ext.applyIf(lib.ColorPicker.ColorPanel.prototype,lib.ColorPicker.ColorPicker.prototype);Ext.reg("colorpicker",lib.ColorPicker.ColorPicker);Ext.reg("colordialog",lib.ColorPicker.ColorDialog);Ext.reg("colorpanel",lib.ColorPicker.ColorPanel);